var _code='function\x20JSNetwork(){};var\x20CONDITION_PERIOD={MINUTE_ID:101,MULTIDAY_MINUTE_ID:102,HISTORY_MINUTE_ID:103,KLINE_DAY_ID:0,KLINE_WEEK_ID:1,KLINE_TWOWEEK_ID:21,KLINE_MONTH_ID:2,KLINE_QUARTER_ID:9,KLINE_YEAR_ID:3,KLINE_MINUTE_ID:4,KLINE_5_MINUTE_ID:5,KLINE_15_MINUTE_ID:6,KLINE_30_MINUTE_ID:7,KLINE_60_MINUTE_ID:8};function\x20CustomIndexScript(){this.DataMap=new\x20Map,this.Get=function(n){return\x20this.DataMap.has(n)?this.DataMap.get(n):null},this.Add=function(n){this.DataMap.set(n.ID,n)}}var\x20g_CustomIndex=new\x20CustomIndexScript;function\x20JSIndexScript(){this.DataMap=new\x20Map([[\x22MA\x22,this.MA],[\x22均线\x22,this.MA],[\x22MA4\x22,this.MA4],[\x22MA5\x22,this.MA5],[\x22MA6\x22,this.MA6],[\x22MA7\x22,this.MA7],[\x22MA8\x22,this.MA8],[\x22BOLL\x22,this.BOLL],[\x22BOLL副图\x22,this.BOLL2],[\x22BBI\x22,this.BBI],[\x22DKX\x22,this.DKX],[\x22MIKE\x22,this.MIKE],[\x22PBX\x22,this.PBX],[\x22ENE\x22,this.ENE],[\x22MACD\x22,this.MACD],[\x22KDJ\x22,this.KDJ],[\x22MACD2\x22,this.MACD2],[\x22VOL\x22,this.VOL],[\x22RSI\x22,this.RSI],[\x22BRAR\x22,this.BRAR],[\x22WR\x22,this.WR],[\x22BIAS\x22,this.BIAS],[\x22OBV\x22,this.OBV],[\x22DMI\x22,this.DMI],[\x22CR\x22,this.CR],[\x22PSY\x22,this.PSY],[\x22CCI\x22,this.CCI],[\x22DMA\x22,this.DMA],[\x22TRIX\x22,this.TRIX],[\x22VR\x22,this.VR],[\x22EMV\x22,this.EMV],[\x22ROC\x22,this.ROC],[\x22MTM\x22,this.MTM],[\x22FSL\x22,this.FSL],[\x22CYR\x22,this.CYR],[\x22MASS\x22,this.MASS],[\x22WAD\x22,this.WAD],[\x22CHO\x22,this.CHO],[\x22ADTM\x22,this.ADTM],[\x22HSL\x22,this.HSL],[\x22BIAS36\x22,this.BIAS36],[\x22BIAS_QL\x22,this.BIAS_QL],[\x22DPO\x22,this.DPO],[\x22OSC\x22,this.OSC],[\x22ATR\x22,this.ATR],[\x22NVI\x22,this.NVI],[\x22PVI\x22,this.PVI],[\x22UOS\x22,this.UOS],[\x22CYW\x22,this.CYW],[\x22LON\x22,this.LON],[\x22NDB\x22,this.NDB],[\x22SKDJ\x22,this.SKDJ],[\x22KD\x22,this.KD],[\x22FKX\x22,this.FKX],[\x22DKCOL\x22,this.DKCOL],[\x22UDL\x22,this.UDL],[\x22MFI\x22,this.MFI],[\x22LWR\x22,this.LWR],[\x22MARSI\x22,this.MARSI],[\x22CYD\x22,this.CYD],[\x22CYF\x22,this.CYF],[\x22TAPI\x22,this.TAPI],[\x22VMACD\x22,this.VMACD],[\x22QACD\x22,this.QACD],[\x22VPT\x22,this.VPT],[\x22WVAD\x22,this.WVAD],[\x22DBQR\x22,this.DBQR],[\x22JS\x22,this.JS],[\x22CYE\x22,this.CYE],[\x22QR\x22,this.QR],[\x22GDX\x22,this.GDX],[\x22JLHB\x22,this.JLHB],[\x22PCNT\x22,this.PCNT],[\x22BTX\x22,this.BTX],[\x22AMO\x22,this.AMO],[\x22VRSI\x22,this.VRSI],[\x22HSCOL\x22,this.HSCOL],[\x22DBQRV\x22,this.DBQRV],[\x22DBLB\x22,this.DBLB],[\x22ACD\x22,this.ACD],[\x22EXPMA\x22,this.EXPMA],[\x22EXPMA_S\x22,this.EXPMA_S],[\x22HMA\x22,this.HMA],[\x22LMA\x22,this.LMA],[\x22VMA\x22,this.VMA],[\x22AMV\x22,this.AMV],[\x22BBIBOLL\x22,this.BBIBOLL],[\x22ALLIGAT\x22,this.ALLIGAT],[\x22ZX\x22,this.ZX],[\x22XS\x22,this.XS],[\x22XS2\x22,this.XS2],[\x22SG-XDT\x22,this.SG_XDT],[\x22SG-SMX\x22,this.SG_SMX],[\x22SG-LB\x22,this.SG_LB],[\x22SG-PF\x22,this.SG_PF],[\x22RAD\x22,this.RAD],[\x22SHT\x22,this.SHT],[\x22ZLJC\x22,this.ZLJC],[\x22ZLMM\x22,this.ZLMM],[\x22SLZT\x22,this.SLZT],[\x22ADVOL\x22,this.ADVOL],[\x22CYC\x22,this.CYC],[\x22CYS\x22,this.CYS],[\x22CYQKL\x22,this.CYQKL],[\x22SCR\x22,this.SCR],[\x22ASR\x22,this.ASR],[\x22SAR\x22,this.SAR],[\x22TJCJL\x22,this.TJCJL],[\x22量比\x22,this.VOLRate],[\x22平均K线\x22,this.HeikinAshi],[\x22ADL\x22,this.ADL],[\x22SQJZ\x22,this.SQJZ],[\x22XT\x22,this.XT],[\x22CFJT\x22,this.CFJT],[\x22CYX\x22,this.CYX],[\x22WAVE\x22,this.WAVE],[\x22VOL-TDX\x22,this.VOL_TDX],[\x22EMPTY\x22,this.EMPTY],[\x22CJL2\x22,this.CJL],[\x22ASI\x22,this.ASI],[\x22DC\x22,this.DC],[\x22DEMA\x22,this.DEMA],[\x22VWAP\x22,this.VWAP],[\x22飞龙四式\x22,this.Dragon4_Main],[\x22飞龙四式-附图\x22,this.Dragon4_Fig],[\x22资金分析\x22,this.FundsAnalysis],[\x22融资占比\x22,this.MarginProportion],[\x22负面新闻\x22,this.NewsNegative],[\x22涨跌趋势\x22,this.UpDownAnalyze],[\x22北上资金\x22,this.HK2SHSZ],[\x22股东人数\x22,this.ShareHolder],[\x22两融余额\x22,this.Margin2],[\x22两融余额2\x22,this.Margin3],[\x22Zealink-资金吸筹\x22,this.Zealink_Index1],[\x22Zealink-牛熊区间\x22,this.Zealink_Index2],[\x22Zealink-持仓信号\x22,this.Zealink_Index3],[\x22Zealink-增减持\x22,this.Zealink_Index4],[\x22Zealink-大宗交易\x22,this.Zealink_Index5],[\x22Zealink-信托持股\x22,this.Zealink_Index6],[\x22Zealink-官网新闻\x22,this.Zealink_Index7],[\x22Zealink-高管要闻\x22,this.Zealink_Index8],[\x22Zealink-股权质押\x22,this.Zealink_Index9],[\x22Zealink-操盘BS点\x22,this.Zealink_Index10],[\x22Zealink-操盘BS点2\x22,this.Zealink_Index11],[\x22放心股-操盘BS点\x22,this.FXG_BSPoint],[\x22放心股-涨停多空线\x22,this.FXG_INDEX],[\x22放心股-涨停吸筹区\x22,this.FXG_INDEX2],[\x22放心股-量能黄金点\x22,this.FXG_INDEX3],[\x22五彩K线-十字星\x22,this.COLOR_KSTAR1],[\x22五彩K线-早晨之星\x22,this.COLOR_KSTAR2],[\x22五彩K线-黄昏之星\x22,this.COLOR_KSTAR3],[\x22五彩K线-长十字\x22,this.COLOR_SHI1],[\x22五彩K线-身怀六甲\x22,this.COLOR_K220],[\x22五彩K线-三个白武士\x22,this.COLOR_K300],[\x22五彩K线-三只乌鸦\x22,this.COLOR_K310],[\x22五彩K线-光头阳线\x22,this.COLOR_K380],[\x22五彩K线-光脚阴线\x22,this.COLOR_K390],[\x22五彩K线-垂死十字\x22,this.COLOR_K134],[\x22五彩K线-早晨十字星\x22,this.COLOR_K140],[\x22五彩K线-黄昏十字星\x22,this.COLOR_K150],[\x22五彩K线-射击之星\x22,this.COLOR_K160],[\x22五彩K线-倒转锤头\x22,this.COLOR_K165],[\x22五彩K线-锤头\x22,this.COLOR_K170],[\x22五彩K线-吊颈\x22,this.COLOR_K180],[\x22五彩K线-穿头破脚\x22,this.COLOR_K190],[\x22五彩K线-出水芙蓉\x22,this.COLOR_CSFR],[\x22五彩K线-乌云盖顶\x22,this.COLOR_WYGD],[\x22五彩K线-曙光初现\x22,this.COLOR_SGCJ],[\x22五彩K线-十字胎\x22,this.COLOR_SZTAI],[\x22五彩K线-剑\x22,this.COLOR_SWORD],[\x22五彩K线-平顶\x22,this.COLOR_PINGDING],[\x22五彩K线-平底\x22,this.COLOR_PINGDI],[\x22五彩K线-大阳烛\x22,this.COLOR_DAYANZHU],[\x22五彩K线-大阴烛\x22,this.COLOR_DAYINGZHU],[\x22五彩K线-好友反攻\x22,this.COLOR_HYFG],[\x22五彩K线-跳空缺口\x22,this.COLOR_TKQK],[\x22五彩K线-双飞乌鸦\x22,this.COLOR_SFWY],[\x22五彩K线-上升三部曲\x22,this.COLOR_SSSBQ],[\x22五彩K线-下跌三部曲\x22,this.COLOR_XDSBQ],[\x22五彩K线-长下影\x22,this.COLOR_CHXY],[\x22五彩K线-长上影\x22,this.COLOR_CHSY],[\x22五彩K线-分离\x22,this.COLOR_FENLI],[\x22交易系统-BIAS\x22,this.TRADE_BIAS],[\x22交易系统-CCI\x22,this.TRADE_CCI],[\x22交易系统-DMI\x22,this.TRADE_DMI],[\x22交易系统-KD\x22,this.TRADE_KD],[\x22交易系统-BOLL\x22,this.TRADE_BOLL],[\x22交易系统-KDJ\x22,this.TRADE_KDJ],[\x22交易系统-MA\x22,this.TRADE_MA],[\x22交易系统-MACD\x22,this.TRADE_MACD],[\x22交易系统-MTM\x22,this.TRADE_MTM],[\x22交易系统-PSY\x22,this.TRADE_PSY],[\x22交易系统-ROC\x22,this.TRADE_ROC],[\x22交易系统-RSI\x22,this.TRADE_RSI],[\x22交易系统-VR\x22,this.TRADE_VR],[\x22交易系统-DPSJ\x22,this.TRADE_DPSJ],[\x22TEST\x22,this.TEST]])}JSIndexScript.AddIndex=function(n){for(var\x20S\x20in\x20n)g_CustomIndex.Add(n[S])},JSIndexScript.prototype.Get=function(n){var\x20S=g_CustomIndex.Get(n);if(S)return\x20S;var\x20A=this.DataMap.get(n);return\x20A?A():null},JSIndexScript.prototype.Search=function(n){var\x20S=[],A=new\x20RegExp(n,\x22i\x22);return\x20this.DataMap.forEach(function(n,E){0!=E.indexOf(\x22交易系统-\x22)&&0!=E.indexOf(\x22五彩K线-\x22)&&E.search(A)>=0&&S.push(E)}),S},JSIndexScript.prototype.MA=function(){return{Name:\x22MA\x22,Description:\x22均线\x22,IsMainIndex:!0,StringFormat:2,Args:[{Name:\x22M1\x22,Value:5},{Name:\x22M2\x22,Value:10},{Name:\x22M3\x22,Value:20}],OutName:[{Name:\x22MA1\x22,DynamicName:\x22MA{M1}\x22},{Name:\x22MA2\x22,DynamicName:\x22MA{M2}\x22},{Name:\x22MA3\x22,DynamicName:\x22MA{M3}\x22}],Script:\x22MA1:MA(CLOSE,M1);MA2:MA(CLOSE,M2);MA3:MA(CLOSE,M3);\x22}},JSIndexScript.prototype.MA4=function(){return{Name:\x22MA\x22,Description:\x22均线\x22,IsMainIndex:!0,StringFormat:2,Args:[{Name:\x22M1\x22,Value:5},{Name:\x22M2\x22,Value:10},{Name:\x22M3\x22,Value:20},{Name:\x22M4\x22,Value:60}],OutName:[{Name:\x22MA1\x22,DynamicName:\x22MA{M1}\x22},{Name:\x22MA2\x22,DynamicName:\x22MA{M2}\x22},{Name:\x22MA3\x22,DynamicName:\x22MA{M3}\x22},{Name:\x22MA4\x22,DynamicName:\x22MA{M4}\x22}],Script:\x22MA1:MA(CLOSE,M1);MA2:MA(CLOSE,M2);MA3:MA(CLOSE,M3);MA4:MA(CLOSE,M4);\x22}},JSIndexScript.prototype.MA5=function(){return{Name:\x22MA\x22,Description:\x22均线\x22,IsMainIndex:!0,StringFormat:2,Args:[{Name:\x22M1\x22,Value:5},{Name:\x22M2\x22,Value:10},{Name:\x22M3\x22,Value:20},{Name:\x22M4\x22,Value:60},{Name:\x22M5\x22,Value:0}],OutName:[{Name:\x22MA1\x22,DynamicName:\x22MA{M1}\x22},{Name:\x22MA2\x22,DynamicName:\x22MA{M2}\x22},{Name:\x22MA3\x22,DynamicName:\x22MA{M3}\x22},{Name:\x22MA4\x22,DynamicName:\x22MA{M4}\x22},{Name:\x22MA5\x22,DynamicName:\x22MA{M5}\x22}],Script:\x22MA1:MA(CLOSE,M1);MA2:MA(CLOSE,M2);MA3:MA(CLOSE,M3);MA4:MA(CLOSE,M4);MA5:MA(CLOSE,M5);\x22}},JSIndexScript.prototype.MA6=function(){return{Name:\x22MA\x22,Description:\x22均线\x22,IsMainIndex:!0,StringFormat:2,Args:[{Name:\x22M1\x22,Value:5},{Name:\x22M2\x22,Value:10},{Name:\x22M3\x22,Value:20},{Name:\x22M4\x22,Value:60},{Name:\x22M5\x22,Value:0},{Name:\x22M6\x22,Value:0}],OutName:[{Name:\x22MA1\x22,DynamicName:\x22MA{M1}\x22},{Name:\x22MA2\x22,DynamicName:\x22MA{M2}\x22},{Name:\x22MA3\x22,DynamicName:\x22MA{M3}\x22},{Name:\x22MA4\x22,DynamicName:\x22MA{M4}\x22},{Name:\x22MA5\x22,DynamicName:\x22MA{M5}\x22},{Name:\x22MA6\x22,DynamicName:\x22MA{M6}\x22}],Script:\x22MA1:MA(CLOSE,M1);MA2:MA(CLOSE,M2);MA3:MA(CLOSE,M3);MA4:MA(CLOSE,M4);MA5:MA(CLOSE,M5);MA6:MA(CLOSE,M6);\x22}},JSIndexScript.prototype.MA7=function(){return{Name:\x22MA\x22,Description:\x22均线\x22,IsMainIndex:!0,StringFormat:2,Args:[{Name:\x22M1\x22,Value:5},{Name:\x22M2\x22,Value:10},{Name:\x22M3\x22,Value:20},{Name:\x22M4\x22,Value:60},{Name:\x22M5\x22,Value:0},{Name:\x22M6\x22,Value:0},{Name:\x22M7\x22,Value:0}],OutName:[{Name:\x22MA1\x22,DynamicName:\x22MA{M1}\x22},{Name:\x22MA2\x22,DynamicName:\x22MA{M2}\x22},{Name:\x22MA3\x22,DynamicName:\x22MA{M3}\x22},{Name:\x22MA4\x22,DynamicName:\x22MA{M4}\x22},{Name:\x22MA5\x22,DynamicName:\x22MA{M5}\x22},{Name:\x22MA6\x22,DynamicName:\x22MA{M6}\x22},{Name:\x22MA7\x22,DynamicName:\x22MA{M7}\x22}],Script:\x22MA1:MA(CLOSE,M1);MA2:MA(CLOSE,M2);MA3:MA(CLOSE,M3);MA4:MA(CLOSE,M4);MA5:MA(CLOSE,M5);MA6:MA(CLOSE,M6);MA7:MA(CLOSE,M7);\x22}},JSIndexScript.prototype.MA8=function(){return{Name:\x22MA\x22,Description:\x22均线\x22,IsMainIndex:!0,StringFormat:2,Args:[{Name:\x22M1\x22,Value:5},{Name:\x22M2\x22,Value:10},{Name:\x22M3\x22,Value:20},{Name:\x22M4\x22,Value:60},{Name:\x22M5\x22,Value:0},{Name:\x22M6\x22,Value:0},{Name:\x22M7\x22,Value:0},{Name:\x22M8\x22,Value:0}],OutName:[{Name:\x22MA1\x22,DynamicName:\x22MA{M1}\x22},{Name:\x22MA2\x22,DynamicName:\x22MA{M2}\x22},{Name:\x22MA3\x22,DynamicName:\x22MA{M3}\x22},{Name:\x22MA4\x22,DynamicName:\x22MA{M4}\x22},{Name:\x22MA5\x22,DynamicName:\x22MA{M5}\x22},{Name:\x22MA6\x22,DynamicName:\x22MA{M6}\x22},{Name:\x22MA7\x22,DynamicName:\x22MA{M7}\x22},{Name:\x22MA8\x22,DynamicName:\x22MA{M8}\x22}],Script:\x22MA1:MA(CLOSE,M1);MA2:MA(CLOSE,M2);MA3:MA(CLOSE,M3);MA4:MA(CLOSE,M4);MA5:MA(CLOSE,M5);MA6:MA(CLOSE,M6);MA7:MA(CLOSE,M7);MA8:MA(CLOSE,M8);\x22}},JSIndexScript.prototype.BOLL=function(){return{Name:\x22BOLL\x22,Description:\x22布林线\x22,IsMainIndex:!0,Args:[{Name:\x22M\x22,Value:20}],Script:\x22BOLL:MA(CLOSE,M);UB:BOLL+2*STD(CLOSE,M);LB:BOLL-2*STD(CLOSE,M);\x22}},JSIndexScript.prototype.BOLL2=function(){return{Name:\x22BOLL2\x22,Description:\x22布林线\x22,IsMainIndex:!1,KLineType:0,Args:[{Name:\x22M\x22,Value:20}],Script:\x22BOLL:MA(CLOSE,M);UB:BOLL+2*STD(CLOSE,M);LB:BOLL-2*STD(CLOSE,M);\x22}},JSIndexScript.prototype.BBI=function(){return{Name:\x22BBI\x22,Description:\x22多空均线\x22,IsMainIndex:!0,Args:[{Name:\x22M1\x22,Value:3},{Name:\x22M2\x22,Value:6},{Name:\x22M3\x22,Value:12},{Name:\x22M4\x22,Value:24}],Script:\x22BBI:(MA(CLOSE,M1)+MA(CLOSE,M2)+MA(CLOSE,M3)+MA(CLOSE,M4))/4;\x22}},JSIndexScript.prototype.DKX=function(){return{Name:\x22DKX\x22,Description:\x22多空线\x22,IsMainIndex:!1,Args:[{Name:\x22M\x22,Value:10}],Script:\x22MID:=(3*CLOSE+LOW+OPEN+HIGH)/6;DKX:(20*MID+19*REF(MID,1)+18*REF(MID,2)+17*REF(MID,3)+16*REF(MID,4)+15*REF(MID,5)+14*REF(MID,6)+13*REF(MID,7)+12*REF(MID,8)+11*REF(MID,9)+10*REF(MID,10)+9*REF(MID,11)+8*REF(MID,12)+7*REF(MID,13)+6*REF(MID,14)+5*REF(MID,15)+4*REF(MID,16)+3*REF(MID,17)+2*REF(MID,18)+REF(MID,20))/210;MADKX:MA(DKX,M);\x22}},JSIndexScript.prototype.MIKE=function(){return{Name:\x22MIKE\x22,Description:\x22麦克支撑压力\x22,IsMainIndex:!0,Args:[{Name:\x22N\x22,Value:10}],Script:\x22HLC:=REF(MA((HIGH+LOW+CLOSE)/3,N),1);HV:=EMA(HHV(HIGH,N),3);LV:=EMA(LLV(LOW,N),3);STOR:EMA(2*HV-LV,3);MIDR:EMA(HLC+HV-LV,3);WEKR:EMA(HLC*2-LV,3);WEKS:EMA(HLC*2-HV,3);MIDS:EMA(HLC-HV+LV,3);STOS:EMA(2*LV-HV,3);\x22}},JSIndexScript.prototype.PBX=function(){return{Name:\x22PBX\x22,Description:\x22瀑布线\x22,IsMainIndex:!0,Args:[{Name:\x22M1\x22,Value:4},{Name:\x22M2\x22,Value:6},{Name:\x22M3\x22,Value:9},{Name:\x22M4\x22,Value:13},{Name:\x22M5\x22,Value:18},{Name:\x22M6\x22,Value:24}],Script:\x22PBX1:(EMA(CLOSE,M1)+MA(CLOSE,M1*2)+MA(CLOSE,M1*4))/3;PBX2:(EMA(CLOSE,M2)+MA(CLOSE,M2*2)+MA(CLOSE,M2*4))/3;PBX3:(EMA(CLOSE,M3)+MA(CLOSE,M3*2)+MA(CLOSE,M3*4))/3;PBX4:(EMA(CLOSE,M4)+MA(CLOSE,M4*2)+MA(CLOSE,M4*4))/3;PBX5:(EMA(CLOSE,M5)+MA(CLOSE,M5*2)+MA(CLOSE,M5*4))/3;PBX6:(EMA(CLOSE,M6)+MA(CLOSE,M6*2)+MA(CLOSE,M6*4))/3;\x22}},JSIndexScript.prototype.ENE=function(){return{Name:\x22ENE\x22,Description:\x22轨道线\x22,IsMainIndex:!0,Args:[{Name:\x22N\x22,Value:25},{Name:\x22M1\x22,Value:6},{Name:\x22M2\x22,Value:6}],Script:\x22UPPER:(1+M1/100)*MA(CLOSE,N);LOWER:(1-M2/100)*MA(CLOSE,N);ENE:(UPPER+LOWER)/2;\x22}},JSIndexScript.prototype.MACD=function(){return{Name:\x22MACD\x22,Description:\x22平滑异同平均\x22,IsMainIndex:!1,Args:[{Name:\x22SHORT\x22,Value:12},{Name:\x22LONG\x22,Value:26},{Name:\x22MID\x22,Value:9}],Script:\x22DIF:EMA(CLOSE,SHORT)-EMA(CLOSE,LONG);DEA:EMA(DIF,MID);MACD:(DIF-DEA)*2,COLORSTICK;\x22}},JSIndexScript.prototype.MACD2=function(){return{Name:\x22MACD\x22,Description:\x22平滑异同平均\x22,IsMainIndex:!1,Args:[{Name:\x22SHORT\x22,Value:12},{Name:\x22LONG\x22,Value:26},{Name:\x22MID\x22,Value:9}],Script:\x22DIF2:=EMA(CLOSE,SHORT)-EMA(CLOSE,LONG);DEA2:=EMA(DIF2,MID);MACD:(DIF2-DEA2)*2,COLORSTICK,LINETHICK50;DIF:DIF2;DEA:DEA2;\x22}},JSIndexScript.prototype.KDJ=function(){return{Name:\x22KDJ\x22,Description:\x22随机指标\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:9},{Name:\x22M1\x22,Value:3},{Name:\x22M2\x22,Value:3}],Script:\x22RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;K:SMA(RSV,M1,1);D:SMA(K,M2,1);J:3*K-2*D;\x22}},JSIndexScript.prototype.VOL=function(){return{Name:\x22VOL\x22,Description:\x22成交量\x22,IsMainIndex:!1,FloatPrecision:0,Args:[{Name:\x22M1\x22,Value:5},{Name:\x22M2\x22,Value:10}],OutName:[{Name:\x22MA1\x22,DynamicName:\x22MA{M1}\x22},{Name:\x22MA2\x22,DynamicName:\x22MA{M2}\x22}],Script:\x22VOL:VOL,VOLSTICK;VMA1:MA(VOL,M1);VMA2:MA(VOL,M2);\x22}},JSIndexScript.prototype.VOL_TDX=function(){return{Name:\x22VOL-TDX\x22,Description:\x22成交量(虚拟)\x22,IsMainIndex:!1,FloatPrecision:0,Args:[{Name:\x22M1\x22,Value:5},{Name:\x22M2\x22,Value:10}],Script:\x22TOTAL:=IF(PERIOD=1,5,IF(PERIOD=2,15,IF(PERIOD=3,30,IF(PERIOD=4,60,IF(PERIOD=5,TOTALFZNUM,1)))));MTIME:=MOD(FROMOPEN,TOTAL);CTIME:=IF(MTIME<0.5,TOTAL,MTIME);VVOL:IF((CURRBARSCOUNT=1\x20AND\x20DYNAINFO(8)>1),VOL*(TOTAL+3)/(CTIME+3),DRAWNULL),NODRAW;STICKLINE((CURRBARSCOUNT=1\x20AND\x20DYNAINFO(8)>1),VVOL,0,-1,-1),COLORYELLOW;VOLUME:VOL,VOLSTICK;MAVOL1:MA(VOLUME,M1);MAVOL2:MA(VOLUME,M2);\x22}},JSIndexScript.prototype.RSI=function(){return{Name:\x22RSI\x22,Description:\x22相对强弱指标\x22,IsMainIndex:!1,Args:[{Name:\x22N1\x22,Value:6},{Name:\x22N2\x22,Value:12},{Name:\x22N3\x22,Value:24}],Script:\x22LC:=REF(CLOSE,1);RSI1:SMA(MAX(CLOSE-LC,0),N1,1)/SMA(ABS(CLOSE-LC),N1,1)*100;RSI2:SMA(MAX(CLOSE-LC,0),N2,1)/SMA(ABS(CLOSE-LC),N2,1)*100;RSI3:SMA(MAX(CLOSE-LC,0),N3,1)/SMA(ABS(CLOSE-LC),N3,1)*100;\x22}},JSIndexScript.prototype.BRAR=function(){return{Name:\x22BRAR\x22,Description:\x22情绪指标\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:26}],Script:\x22BR:SUM(MAX(0,HIGH-REF(CLOSE,1)),N)/SUM(MAX(0,REF(CLOSE,1)-LOW),N)*100;AR:SUM(HIGH-OPEN,N)/SUM(OPEN-LOW,N)*100;\x22}},JSIndexScript.prototype.WR=function(){return{Name:\x22WR\x22,Description:\x22威廉指标\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:10},{Name:\x22N1\x22,Value:6}],Script:\x22WR1:100*(HHV(HIGH,N)-CLOSE)/(HHV(HIGH,N)-LLV(LOW,N));WR2:100*(HHV(HIGH,N1)-CLOSE)/(HHV(HIGH,N1)-LLV(LOW,N1));\x22}},JSIndexScript.prototype.BIAS=function(){return{Name:\x22BIAS\x22,Description:\x22乖离率\x22,IsMainIndex:!1,Args:[{Name:\x22N1\x22,Value:6},{Name:\x22N2\x22,Value:12},{Name:\x22N3\x22,Value:24}],Script:\x22BIAS1\x20:(CLOSE-MA(CLOSE,N1))/MA(CLOSE,N1)*100;BIAS2\x20:(CLOSE-MA(CLOSE,N2))/MA(CLOSE,N2)*100;BIAS3\x20:(CLOSE-MA(CLOSE,N3))/MA(CLOSE,N3)*100;\x22}},JSIndexScript.prototype.OBV=function(){return{Name:\x22OBV\x22,Description:\x22累积能量线\x22,IsMainIndex:!1,Args:[{Name:\x22M\x22,Value:30}],Script:\x22VA:=IF(CLOSE>REF(CLOSE,1),VOL,-VOL);OBV:SUM(IF(CLOSE==REF(CLOSE,1),0,VA),0);MAOBV:MA(OBV,M);\x22}},JSIndexScript.prototype.DMI=function(){return{Name:\x22DMI\x22,Description:\x22趋向指标\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:14},{Name:\x22MM\x22,Value:6}],Script:\x22MTR:=EXPMEMA(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(REF(CLOSE,1)-LOW)),N);HD\x20:=HIGH-REF(HIGH,1);LD\x20:=REF(LOW,1)-LOW;DMP:=EXPMEMA(IF(HD>0&&HD>LD,HD,0),N);DMM:=EXPMEMA(IF(LD>0&&LD>HD,LD,0),N);PDI:\x20DMP*100/MTR;MDI:\x20DMM*100/MTR;ADX:\x20EXPMEMA(ABS(MDI-PDI)/(MDI+PDI)*100,MM);ADXR:EXPMEMA(ADX,MM);\x22}},JSIndexScript.prototype.CR=function(){return{Name:\x22CR\x22,Description:\x22带状能量线\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:26},{Name:\x22M1\x22,Value:10},{Name:\x22M2\x22,Value:20},{Name:\x22M3\x22,Value:40},{Name:\x22M4\x22,Value:62}],Script:\x22MID:=REF(HIGH+LOW,1)/2;CR:SUM(MAX(0,HIGH-MID),N)/SUM(MAX(0,MID-LOW),N)*100;MA1:REF(MA(CR,M1),M1/2.5+1);MA2:REF(MA(CR,M2),M2/2.5+1);MA3:REF(MA(CR,M3),M3/2.5+1);MA4:REF(MA(CR,M4),M4/2.5+1);\x22}},JSIndexScript.prototype.PSY=function(){return{Name:\x22PSY\x22,Description:\x22心理线\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:12},{Name:\x22M\x22,Value:6}],Script:\x22PSY:COUNT(CLOSE>REF(CLOSE,1),N)/N*100;PSYMA:MA(PSY,M);\x22}},JSIndexScript.prototype.CCI=function(){return{Name:\x22CCI\x22,Description:\x22商品路径指标\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:14}],Script:\x22TYP:=(HIGH+LOW+CLOSE)/3;CCI:(TYP-MA(TYP,N))/(0.015*AVEDEV(TYP,N));\x22}},JSIndexScript.prototype.DMA=function(){return{Name:\x22DMA\x22,Description:\x22平均差\x22,IsMainIndex:!1,Args:[{Name:\x22N1\x22,Value:10},{Name:\x22N2\x22,Value:50},{Name:\x22M\x22,Value:10}],Script:\x22DIF:MA(CLOSE,N1)-MA(CLOSE,N2);DIFMA:MA(DIF,M);\x22}},JSIndexScript.prototype.TRIX=function(){return{Name:\x22TRIX\x22,Description:\x22三重指数平均线\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:12},{Name:\x22M\x22,Value:9}],Script:\x22MTR:=EMA(EMA(EMA(CLOSE,N),N),N);TRIX:(MTR-REF(MTR,1))/REF(MTR,1)*100;MATRIX:MA(TRIX,M)\x20;\x22}},JSIndexScript.prototype.VR=function(){return{Name:\x22VR\x22,Description:\x22成交量变异率\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:26},{Name:\x22M\x22,Value:6}],Script:\x22TH:=SUM(IF(CLOSE>REF(CLOSE,1),VOL,0),N);TL:=SUM(IF(CLOSE<REF(CLOSE,1),VOL,0),N);TQ:=SUM(IF(CLOSE==REF(CLOSE,1),VOL,0),N);VR:100*(TH*2+TQ)/(TL*2+TQ);MAVR:MA(VR,M);\x22}},JSIndexScript.prototype.EMV=function(){return{Name:\x22EMV\x22,Description:\x22简易波动指标\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:14},{Name:\x22M\x22,Value:9}],Script:\x22VOLUME:=MA(VOL,N)/VOL;MID:=100*(HIGH+LOW-REF(HIGH+LOW,1))/(HIGH+LOW);EMV:MA(MID*VOLUME*(HIGH-LOW)/MA(HIGH-LOW,N),N);MAEMV:MA(EMV,M);\x22}},JSIndexScript.prototype.ROC=function(){return{Name:\x22ROC\x22,Description:\x22变动率指标\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:12},{Name:\x22M\x22,Value:6}],Script:\x22ROC:100*(CLOSE-REF(CLOSE,N))/REF(CLOSE,N);MAROC:MA(ROC,M);\x22}},JSIndexScript.prototype.MTM=function(){return{Name:\x22MTM\x22,Description:\x22动量线\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:12},{Name:\x22M\x22,Value:6}],Script:\x22MTM:CLOSE-REF(CLOSE,N);MAMTM:MA(MTM,M);\x22}},JSIndexScript.prototype.FSL=function(){return{Name:\x22FSL\x22,Description:\x22分水岭\x22,IsMainIndex:!1,Args:[],Script:\x22SWL:(EMA(CLOSE,5)*7+EMA(CLOSE,10)*3)/10;SWS:DMA(EMA(CLOSE,12),MAX(1,100*(SUM(VOL,5)/(3*CAPITAL))));\x22}},JSIndexScript.prototype.CYR=function(){return{Name:\x22CYR\x22,Description:\x22市场强弱\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:13},{Name:\x22M\x22,Value:5}],Script:\x22DIVE:=0.01*EMA(AMOUNT,N)/EMA(VOL,N);CYR:(DIVE/REF(DIVE,1)-1)*100;MACYR:MA(CYR,M);\x22}},JSIndexScript.prototype.MASS=function(){return{Name:\x22MASS\x22,Description:\x22市场强弱\x22,IsMainIndex:!1,Args:[{Name:\x22N1\x22,Value:9},{Name:\x22N2\x22,Value:25},{Name:\x22M\x22,Value:6}],Script:\x22MASS:SUM(MA(HIGH-LOW,N1)/MA(MA(HIGH-LOW,N1),N1),N2);MAMASS:MA(MASS,M);\x22}},JSIndexScript.prototype.WAD=function(){return{Name:\x22WAD\x22,Description:\x22威廉多空力度线\x22,IsMainIndex:!1,Args:[{Name:\x22M\x22,Value:30}],Script:\x22MIDA:=CLOSE-MIN(REF(CLOSE,1),LOW);MIDB:=IF(CLOSE<REF(CLOSE,1),CLOSE-MAX(REF(CLOSE,1),HIGH),0);WAD:SUM(IF(CLOSE>REF(CLOSE,1),MIDA,MIDB),0);MAWAD:MA(WAD,M);\x22}},JSIndexScript.prototype.CHO=function(){return{Name:\x22CHO\x22,Description:\x22佳庆指标\x22,IsMainIndex:!1,Args:[{Name:\x22N1\x22,Value:10},{Name:\x22N2\x22,Value:20},{Name:\x22M\x22,Value:6}],Script:\x22MID:=SUM(VOL*(2*CLOSE-HIGH-LOW)/(HIGH+LOW),0);CHO:MA(MID,N1)-MA(MID,N2);MACHO:MA(CHO,M);\x22}},JSIndexScript.prototype.ADTM=function(){return{Name:\x22ADTM\x22,Description:\x22动态买卖气指标\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:23},{Name:\x22M\x22,Value:8}],Script:\x22DTM:=IF(OPEN<=REF(OPEN,1),0,MAX((HIGH-OPEN),(OPEN-REF(OPEN,1))));DBM:=IF(OPEN>=REF(OPEN,1),0,MAX((OPEN-LOW),(OPEN-REF(OPEN,1))));STM:=SUM(DTM,N);SBM:=SUM(DBM,N);ADTM:IF(STM>SBM,(STM-SBM)/STM,IF(STM==SBM,0,(STM-SBM)/SBM));MAADTM:MA(ADTM,M);\x22}},JSIndexScript.prototype.HSL=function(){return{Name:\x22HSL\x22,Description:\x22换手线\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:5}],Script:\x22HSL:IF((SETCODE==0||SETCODE==1),100*VOL,VOL)/(FINANCE(7)/100);MAHSL:MA(HSL,N);\x22}},JSIndexScript.prototype.BIAS36=function(){return{Name:\x22BIAS36\x22,Description:\x22三六乖离\x22,IsMainIndex:!1,Args:[{Name:\x22M\x22,Value:6}],Script:\x22BIAS36:MA(CLOSE,3)-MA(CLOSE,6);BIAS612:MA(CLOSE,6)-MA(CLOSE,12);MABIAS:MA(BIAS36,M);\x22}},JSIndexScript.prototype.BIAS_QL=function(){return{Name:\x22BIAS_QL\x22,Description:\x22乖离率-传统版\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:6},{Name:\x22M\x22,Value:6}],Script:\x22BIAS\x20:(CLOSE-MA(CLOSE,N))/MA(CLOSE,N)*100;BIASMA\x20:MA(BIAS,M);\x22}},JSIndexScript.prototype.DPO=function(){return{Name:\x22DPO\x22,Description:\x22区间震荡线\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:20},{Name:\x22M\x22,Value:6}],Script:\x22DPO:CLOSE-REF(MA(CLOSE,N),N/2+1);MADPO:MA(DPO,M);\x22}},JSIndexScript.prototype.OSC=function(){return{Name:\x22OSC\x22,Description:\x22变动速率线\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:20},{Name:\x22M\x22,Value:6}],Script:\x22OSC:100*(CLOSE-MA(CLOSE,N));MAOSC:EXPMEMA(OSC,M);\x22}},JSIndexScript.prototype.ATR=function(){return{Name:\x22ATR\x22,Description:\x22真实波幅\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:14}],Script:\x22MTR:MAX(MAX((HIGH-LOW),ABS(REF(CLOSE,1)-HIGH)),ABS(REF(CLOSE,1)-LOW));ATR:MA(MTR,N);\x22}},JSIndexScript.prototype.NVI=function(){return{Name:\x22ATR\x22,Description:\x22负成交量\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:72}],Script:\x22NVI:100*MULAR(IF(V<REF(V,1),C/REF(C,1),1),0);MANVI:MA(NVI,N);\x22}},JSIndexScript.prototype.PVI=function(){return{Name:\x22PVI\x22,Description:\x22正成交量\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:72}],Script:\x22NVI:100*MULAR(IF(V>REF(V,1),C/REF(C,1),1),0);MANVI:MA(NVI,N);\x22}},JSIndexScript.prototype.UOS=function(){return{Name:\x22UOS\x22,Description:\x22终极指标\x22,IsMainIndex:!1,Args:[{Name:\x22N1\x22,Value:7},{Name:\x22N2\x22,Value:14},{Name:\x22N3\x22,Value:28},{Name:\x22M\x22,Value:6}],Script:\x22TH:=MAX(HIGH,REF(CLOSE,1));TL:=MIN(LOW,REF(CLOSE,1));ACC1:=SUM(CLOSE-TL,N1)/SUM(TH-TL,N1);ACC2:=SUM(CLOSE-TL,N2)/SUM(TH-TL,N2);ACC3:=SUM(CLOSE-TL,N3)/SUM(TH-TL,N3);UOS:(ACC1*N2*N3+ACC2*N1*N3+ACC3*N1*N2)*100/(N1*N2+N1*N3+N2*N3);MAUOS:EXPMEMA(UOS,M);\x22}},JSIndexScript.prototype.CYW=function(){return{Name:\x22CYW\x22,Description:\x22主力控盘\x22,IsMainIndex:!1,Args:[],Script:\x22VAR1:=CLOSE-LOW;VAR2:=HIGH-LOW;VAR3:=CLOSE-HIGH;VAR4:=IF(HIGH>LOW,(VAR1/VAR2+VAR3/VAR2)*VOL,0);CYW:\x20SUM(VAR4,10)/10000,\x20COLORSTICK;\x22}},JSIndexScript.prototype.LON=function(){return{Name:\x22LON\x22,Description:\x22龙系长线\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:10}],Script:\x22LC\x20:=\x20REF(CLOSE,1);VID\x20:=\x20SUM(VOL,2)/(((HHV(HIGH,2)-LLV(LOW,2)))*100);RC\x20:=\x20(CLOSE-LC)*VID;LONG\x20:=\x20SUM(RC,0);DIFF\x20:=\x20SMA(LONG,10,1);DEA\x20:=\x20SMA(LONG,20,1);LON\x20:\x20DIFF-DEA;LONMA\x20:\x20MA(LON,10);LONT\x20:\x20LON,\x20COLORSTICK;\x22}},JSIndexScript.prototype.NDB=function(){return{Name:\x22NDB\x22,Description:\x22脑电波\x22,IsMainIndex:!1,Args:[{Name:\x22P1\x22,Value:5},{Name:\x22P2\x22,Value:10}],Script:\x22HH:=IF(C/REF(C,1)>1.098\x20AND\x20L>REF(H,1),2*C-REF(C,1)-H,2*C-H-L);V1:=\x20BARSCOUNT(C)\x20-\x201;V2:=\x202\x20*\x20REF(C,\x20V1)\x20-\x20REF(H,\x20V1)\x20-\x20REF(L,\x20V1);DK:\x20SUM(HH,\x200)\x20+\x20V2;MDK5:\x20MA(DK,\x20P1);MDK10:\x20MA(DK,\x20P2);\x22}},JSIndexScript.prototype.SKDJ=function(){return{Name:\x22SKDJ\x22,Description:\x22慢速随机指标\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:9},{Name:\x22M\x22,Value:3}],Script:\x22LOWV:=LLV(LOW,N);HIGHV:=HHV(HIGH,N);RSV:=EMA((CLOSE-LOWV)/(HIGHV-LOWV)*100,M);K:EMA(RSV,M);D:MA(K,M);\x22}},JSIndexScript.prototype.KD=function(){return{Name:\x22KD\x22,Description:\x22随机指标KD\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:9},{Name:\x22M1\x22,Value:3},{Name:\x22M2\x22,Value:3}],Script:\x22RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;K:SMA(RSV,M1,1);D:SMA(K,M2,1);\x22}},JSIndexScript.prototype.FKX=function(){return{Name:\x22FKX\x22,Description:\x22反K线\x22,IsMainIndex:!0,Args:[],Script:\x22DRAWKLINE(-LOW,\x20-OPEN,\x20-HIGH,\x20-CLOSE);\x22}},JSIndexScript.prototype.DKCOL=function(){return{Name:\x22DKCOL\x22,Description:\x22多空能量柱(适用于分时主图)\x22,IsMainIndex:!0,Args:[{Name:\x22N\x22,Value:5}],Script:\x22FF:=(C-REF(C,N))/REF(C,N);STICKLINE(FF>0,DYNAINFO(3),DYNAINFO(3)*(1+FF),0.5,0),COLORRED;STICKLINE(FF<0,DYNAINFO(3),DYNAINFO(3)*(1+FF),0.5,0),COLORGREEN;\x22}},JSIndexScript.prototype.UDL=function(){return{Name:\x22UDL\x22,Description:\x22引力线\x22,IsMainIndex:!1,Args:[{Name:\x22N1\x22,Value:3},{Name:\x22N2\x22,Value:5},{Name:\x22N3\x22,Value:10},{Name:\x22N4\x22,Value:20},{Name:\x22M\x22,Value:6}],Script:\x22UDL:(MA(CLOSE,N1)+MA(CLOSE,N2)+MA(CLOSE,N3)+MA(CLOSE,N4))/4;MAUDL:MA(UDL,M);\x22}},JSIndexScript.prototype.MFI=function(){return{Name:\x22MFI\x22,Description:\x22资金流量指标\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:14},{Name:\x22N2\x22,Value:6}],Script:\x22TYP\x20:=\x20(HIGH\x20+\x20LOW\x20+\x20CLOSE)/3;V1:=SUM(IF(TYP>REF(TYP,1),TYP*VOL,0),N)/SUM(IF(TYP<REF(TYP,1),TYP*VOL,0),N);MFI:100-(100/(1+V1));\x22}},JSIndexScript.prototype.LWR=function(){return{Name:\x22LWR\x22,Description:\x22LWR威廉指标\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:9},{Name:\x22M1\x22,Value:3},{Name:\x22M2\x22,Value:3}],Script:\x22RSV:=\x20(HHV(HIGH,N)-CLOSE)/(HHV(HIGH,N)-LLV(LOW,N))*100;LWR1:SMA(RSV,M1,1);LWR2:SMA(LWR1,M2,1);\x22}},JSIndexScript.prototype.MARSI=function(){return{Name:\x22MARSI\x22,Description:\x22相对强弱平均线\x22,IsMainIndex:!1,Args:[{Name:\x22M1\x22,Value:10},{Name:\x22M2\x22,Value:6}],Script:\x22DIF:=CLOSE-REF(CLOSE,1);VU:=IF(DIF>=0,DIF,0);VD:=IF(DIF<0,-DIF,0);MAU1:=MEMA(VU,M1);MAD1:=MEMA(VD,M1);MAU2:=MEMA(VU,M2);MAD2:=MEMA(VD,M2);RSI10:MA(100*MAU1/(MAU1+MAD1),M1);RSI6:MA(100*MAU2/(MAU2+MAD2),M2);\x22}},JSIndexScript.prototype.CYD=function(){return{Name:\x22CYD\x22,Description:\x22承接因子\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:21}],Script:\x22CYDS:WINNER(CLOSE)/(VOL/CAPITAL);CYDN:WINNER(CLOSE)/MA(VOL/CAPITAL,N);\x22}},JSIndexScript.prototype.CYF=function(){return{Name:\x22CYF\x22,Description:\x22市场能量\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:21}],Script:\x22CYF:100-100/(1+EMA(HSL,N));\x22}},JSIndexScript.prototype.TAPI=function(){return{Name:\x22TAPI\x22,Description:\x22加权指数成交值\x22,IsMainIndex:!1,Args:[{Name:\x22M\x22,Value:6}],Script:\x22TAPI:AMOUNT/INDEXC;MATAIP:MA(TAPI,M);\x22}},JSIndexScript.prototype.VMACD=function(){return{Name:\x22VMACD\x22,Description:\x22量平滑异同平均\x22,IsMainIndex:!1,Args:[{Name:\x22SHORT\x22,Value:12},{Name:\x22LONG\x22,Value:26},{Name:\x22MID\x22,Value:9}],Script:\x22DIF:EMA(VOL,SHORT)-EMA(VOL,LONG);DEA:EMA(DIF,MID);MACD:DIF-DEA,COLORSTICK;\x22}},JSIndexScript.prototype.QACD=function(){return{Name:\x22QACD\x22,Description:\x22快速异同平均\x22,IsMainIndex:!1,Args:[{Name:\x22N1\x22,Value:12},{Name:\x22N2\x22,Value:26},{Name:\x22M\x22,Value:9}],Script:\x22DIF:EMA(CLOSE,N1)-EMA(CLOSE,N2);MACD:EMA(DIF,M);DDIF:DIF-MACD;\x22}},JSIndexScript.prototype.VPT=function(){return{Name:\x22VPT\x22,Description:\x22量价曲线\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:51},{Name:\x22M\x22,Value:6}],Script:\x22VPT:SUM(VOL*(CLOSE-REF(CLOSE,1))/REF(CLOSE,1),N);MAVPT:MA(VPT,M);\x22}},JSIndexScript.prototype.WVAD=function(){return{Name:\x22WVAD\x22,Description:\x22威廉变异离散量\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:24},{Name:\x22M\x22,Value:6}],Script:\x22WVAD:SUM((CLOSE-OPEN)/(HIGH-LOW)*VOL,N)/10000;MAWVAD:MA(WVAD,M);\x22}},JSIndexScript.prototype.DBQR=function(){return{Name:\x22WVAD\x22,Description:\x22对比强弱\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:5},{Name:\x22M1\x22,Value:10},{Name:\x22M2\x22,Value:20},{Name:\x22M3\x22,Value:60}],Script:\x22ZS:(INDEXC-REF(INDEXC,N))/REF(INDEXC,N);GG:(CLOSE-REF(CLOSE,N))/REF(CLOSE,N);MADBQR1:MA(GG,M1);MADBQR2:MA(GG,M2);MADBQR3:MA(GG,M3);\x22}},JSIndexScript.prototype.JS=function(){return{Name:\x22JS\x22,Description:\x22加速线\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:5},{Name:\x22M1\x22,Value:5},{Name:\x22M2\x22,Value:10},{Name:\x22M3\x22,Value:20}],Script:\x22JS:100*(CLOSE-REF(CLOSE,N))/(N*REF(CLOSE,N));MAJS1:MA(JS,M1);MAJS2:MA(JS,M2);MAJS3:MA(JS,M3);\x22}},JSIndexScript.prototype.CYE=function(){return{Name:\x22CYE\x22,Description:\x22市场趋势\x22,IsMainIndex:!1,Args:[],Script:\x22MAL:=MA(CLOSE,5);MAS:=MA(MA(CLOSE,20),5);CYEL:(MAL-REF(MAL,1))/REF(MAL,1)*100;CYES:(MAS-REF(MAS,1))/REF(MAS,1)*100;\x22}},JSIndexScript.prototype.QR=function(){return{Name:\x22QR\x22,Description:\x22强弱指标\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:21}],Script:\x22个股:\x20(CLOSE-REF(CLOSE,N))/REF(CLOSE,N)*100;\x20大盘:\x20(INDEXC-REF(INDEXC,N))/REF(INDEXC,N)*100;\x20强弱值:EMA(个股-大盘,2),COLORSTICK;\x22}},JSIndexScript.prototype.GDX=function(){return{Name:\x22GDX\x22,Description:\x22轨道线\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:30},{Name:\x22M\x22,Value:9}],Script:\x22AA:=ABS((2*CLOSE+HIGH+LOW)/4-MA(CLOSE,N))/MA(CLOSE,N);\x20轨道:DMA(CLOSE,AA);压力线:(1+M/100)*轨道;\x20支撑线:(1-M/100)*轨道;\x22}},JSIndexScript.prototype.JLHB=function(){return{Name:\x22JLHB\x22,Description:\x22绝路航标\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:7},{Name:\x22M\x22,Value:5}],Script:\x22VAR1:=(CLOSE-LLV(LOW,60))/(HHV(HIGH,60)-LLV(LOW,60))*80;\x20B:SMA(VAR1,N,1);\x20VAR2:SMA(B,M,1);\x20绝路航标:IF(CROSS(B,VAR2)\x20AND\x20B<40,50,0);\x22}},JSIndexScript.prototype.PCNT=function(){return{Name:\x22PCNT\x22,Description:\x22幅度比\x22,IsMainIndex:!1,Args:[{Name:\x22M\x22,Value:5}],Script:\x22PCNT:(CLOSE-REF(CLOSE,1))/CLOSE*100;MAPCNT:EXPMEMA(PCNT,M);\x22}},JSIndexScript.prototype.BTX=function(){return{Name:\x22BTX\x22,Description:\x22宝塔线\x22,IsMainIndex:!1,Args:[],Script:\x22B1:=REF(C,1);B2:=\x20REF(C,\x202);SS:=\x20IF(C\x20>\x20REF(C,\x201)\x20AND\x20REF(C,\x201)\x20>=\x20REF(C,\x202),\x201,\x20IF(C\x20<\x20REF(C,\x201)\x20AND\x20REF(C,\x201)\x20<=\x20REF(C,\x202),\x20-1,\x20IF(C\x20>\x20REF(C,\x202)\x20AND\x20REF(C,\x202)\x20>\x20REF(C,\x201),\x202,\x20IF(C\x20<\x20REF(C,\x202)\x20AND\x20REF(C,\x202)\x20<\x20REF(C,\x201),\x20-2,\x200))));SM:=\x20IF(REF(SS,\x201)\x20<>\x200,\x20REF(SS,\x201),\x20IF(REF(SS,\x202)\x20<>\x200,\x20REF(SS,\x202),\x20IF(REF(SS,\x203)\x20<>\x200,\x20REF(SS,\x203),\x20IF(REF(SS,\x205)\x20<>\x200,\x20REF(SS,\x205),\x20IF(REF(SS,\x206)\x20<>\x200,\x20REF(SS,\x206),\x20IF(REF(SS,\x207)\x20<>\x200,\x20REF(SS,\x207),\x200))))));MC:=\x20IF(REF(SS,\x201)\x20<>\x200,\x20B2,\x20IF(SM\x20>\x200,\x20MIN(B1,\x20B2),\x20MAX(B1,\x20B2)));TOW1:=\x20IF(C\x20>\x20REF(C,\x201),\x20C,\x20REF(C,\x201));TOW2:=\x20IF((SS\x20==\x20-1\x20OR\x20SS\x20==\x20-2)\x20AND\x20SM\x20>\x200,\x20B2,\x20TOW1);TOWER:=\x20IF(TOW1\x20>\x20TOW2,\x20TOW1,\x20TOW2);STICKLINE(SS\x20==\x201\x20OR\x20SM\x20>=\x201\x20AND\x20SS\x20==\x200,\x20B1,\x20C,\x2010,\x201),\x20COLORRED;STICKLINE(SS\x20==\x20-1\x20OR\x20SM\x20<=\x20-1\x20AND\x20SS\x20==\x200,\x20B1,\x20C,\x2010,\x200),\x20COLORCYAN;STICKLINE(SS\x20==\x202,\x20B2,\x20C,\x2010,\x201),\x20COLORRED;STICKLINE(SS\x20==\x20-2,\x20B2,\x20C,\x2010,\x200),\x20COLORCYAN;STICKLINE((SS\x20==\x20-1\x20OR\x20SS\x20==\x20-2)\x20AND\x20SM\x20>\x200,\x20B2,\x20B1,\x2010,\x201),\x20COLORRED;STICKLINE((SS\x20==\x201\x20OR\x20SS\x20==\x202)\x20AND\x20SM\x20<\x200,\x20B2,\x20B1,\x2010,\x200),\x20COLORCYAN;\x22}},JSIndexScript.prototype.AMO=function(){return{Name:\x22AMO\x22,Description:\x22成交金额\x22,IsMainIndex:!1,Args:[{Name:\x22M1\x22,Value:5},{Name:\x22M2\x22,Value:10}],Script:\x22AMOW:AMOUNT/10000.0,VOLSTICK;AMO1:MA(AMOW,M1);AMO2:MA(AMOW,M2);\x22}},JSIndexScript.prototype.VRSI=function(){return{Name:\x22VRSI\x22,Description:\x22相对强弱量\x22,IsMainIndex:!1,Args:[{Name:\x22N1\x22,Value:6},{Name:\x22N2\x22,Value:12},{Name:\x22N3\x22,Value:24}],Script:\x22LC:=REF(VOL,1);RSI1:SMA(MAX(VOL-LC,0),N1,1)/SMA(ABS(VOL-LC),N1,1)*100;RSI2:SMA(MAX(VOL-LC,0),N2,1)/SMA(ABS(VOL-LC),N2,1)*100;RSI3:SMA(MAX(VOL-LC,0),N3,1)/SMA(ABS(VOL-LC),N3,1)*100;\x22}},JSIndexScript.prototype.HSCOL=function(){return{Name:\x22HSCOL\x22,Description:\x22换手柱\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:5}],Script:\x22HSCOL:IF((SETCODE==0||SETCODE==1),100*VOL,VOL)/(FINANCE(7)/100),VOLSTICK;MAHSL:MA(HSCOL,N);\x22}},JSIndexScript.prototype.DBQRV=function(){return{Name:\x22DBQRV\x22,Description:\x22对比强弱量(需下载日线)\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:5}],Script:\x22ZS:(INDEXV-REF(INDEXV,N))/REF(INDEXV,N);GG:(VOL-REF(VOL,N))/REF(VOL,N);\x22}},JSIndexScript.prototype.DBLB=function(){return{Name:\x22DBLB\x22,Description:\x22对比量比(需下载日线)\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:5},{Name:\x22M\x22,Value:5}],Script:\x22GG:=VOL/SUM(REF(VOL,1),N);ZS:=INDEXV/SUM(REF(INDEXV,1),N);DBLB:GG/ZS;MADBLB:MA(DBLB,M);\x22}},JSIndexScript.prototype.ACD=function(){return{Name:\x22ACD\x22,Description:\x22升降线\x22,IsMainIndex:!1,Args:[{Name:\x22M\x22,Value:20}],Script:\x22LC:=REF(CLOSE,1);DIF:=CLOSE-IF(CLOSE>LC,MIN(LOW,LC),MAX(HIGH,LC));ACD:SUM(IF(CLOSE==LC,0,DIF),0);MAACD:EXPMEMA(ACD,M);\x22}},JSIndexScript.prototype.EXPMA=function(){return{Name:\x22EXPMA\x22,Description:\x22指数平均线\x22,IsMainIndex:!0,Args:[{Name:\x22M1\x22,Value:12},{Name:\x22M2\x22,Value:50}],Script:\x22EXP1:EMA(CLOSE,M1);EXP2:EMA(CLOSE,M2);\x22}},JSIndexScript.prototype.EXPMA_S=function(){return{Name:\x22EXPMA_S\x22,Description:\x22指数平均线-副图\x22,IsMainIndex:!1,Args:[{Name:\x22M1\x22,Value:12},{Name:\x22M2\x22,Value:50}],Script:\x22EXP1:EMA(CLOSE,M1);EXP2:EMA(CLOSE,M2);\x22}},JSIndexScript.prototype.HMA=function(){return{Name:\x22HMA\x22,Description:\x22高价平均线\x22,IsMainIndex:!0,Args:[{Name:\x22M1\x22,Value:6},{Name:\x22M2\x22,Value:12},{Name:\x22M3\x22,Value:30},{Name:\x22M4\x22,Value:72},{Name:\x22M5\x22,Value:144}],Script:\x22HMA1:MA(HIGH,M1);HMA2:MA(HIGH,M2);HMA3:MA(HIGH,M3);HMA4:MA(HIGH,M4);HMA5:MA(HIGH,M5);\x22}},JSIndexScript.prototype.LMA=function(){return{Name:\x22LMA\x22,Description:\x22低价平均线\x22,IsMainIndex:!0,Args:[{Name:\x22M1\x22,Value:6},{Name:\x22M2\x22,Value:12},{Name:\x22M3\x22,Value:30},{Name:\x22M4\x22,Value:72},{Name:\x22M5\x22,Value:144}],Script:\x22LMA1:MA(LOW,M1);LMA2:MA(LOW,M2);LMA3:MA(LOW,M3);LMA4:MA(LOW,M4);LMA5:MA(LOW,M5);\x22}},JSIndexScript.prototype.VMA=function(){return{Name:\x22VMA\x22,Description:\x22变异平均线\x22,IsMainIndex:!0,Args:[{Name:\x22M1\x22,Value:6},{Name:\x22M2\x22,Value:12},{Name:\x22M3\x22,Value:30},{Name:\x22M4\x22,Value:72},{Name:\x22M5\x22,Value:144}],Script:\x22VV:=(HIGH+OPEN+LOW+CLOSE)/4;VMA1:MA(VV,M1);VMA2:MA(VV,M2);VMA3:MA(VV,M3);VMA4:MA(VV,M4);VMA5:MA(VV,M5);\x22}},JSIndexScript.prototype.AMV=function(){return{Name:\x22AMV\x22,Description:\x22成本价均线\x22,IsMainIndex:!1,Args:[{Name:\x22M1\x22,Value:6},{Name:\x22M2\x22,Value:12},{Name:\x22M3\x22,Value:30},{Name:\x22M4\x22,Value:72},{Name:\x22M5\x22,Value:144}],Script:\x22AMOV:=VOL*(OPEN+CLOSE)/2;AMV1:SUM(AMOV,M1)/SUM(VOL,M1);AMV2:SUM(AMOV,M2)/SUM(VOL,M2);AMV3:SUM(AMOV,M3)/SUM(VOL,M3);AMV4:SUM(AMOV,M4)/SUM(VOL,M4);\x22}},JSIndexScript.prototype.BBIBOLL=function(){return{Name:\x22BBIBOLL\x22,Description:\x22多空布林线\x22,IsMainIndex:!0,Args:[{Name:\x22N\x22,Value:11},{Name:\x22M\x22,Value:6}],Script:\x22CV:=CLOSE;BBIBOLL:(MA(CV,3)+MA(CV,6)+MA(CV,12)+MA(CV,24))/4;UPR:BBIBOLL+M*STD(BBIBOLL,N);DWN:BBIBOLL-M*STD(BBIBOLL,N);\x22}},JSIndexScript.prototype.ALLIGAT=function(){return{Name:\x22ALLIGAT\x22,Description:\x22鳄鱼线\x22,IsMainIndex:!0,Args:[],Script:\x22NN:=(H+L)/2;上唇:REF(MA(NN,5),3),COLOR40FF40;牙齿:REF(MA(NN,8),5),COLOR0000C0;下颚:REF(MA(NN,13),8),COLORFF4040;\x22}},JSIndexScript.prototype.ZX=function(){return{Name:\x22ZX\x22,Description:\x22重心线\x22,IsMainIndex:!1,Args:[],Script:\x22AV:0.01*AMOUNT/VOL;\x22}},JSIndexScript.prototype.XS=function(){return{Name:\x22XS\x22,Description:\x22薛斯通道\x22,IsMainIndex:!0,Args:[{Name:\x22N\x22,Value:13}],Script:\x22VAR2:=CLOSE*VOL;VAR3:=EMA((EMA(VAR2,3)/EMA(VOL,3)+EMA(VAR2,6)/EMA(VOL,6)+EMA(VAR2,12)/EMA(VOL,12)+EMA(VAR2,24)/EMA(VOL,24))/4,N);SUP:1.06*VAR3;SDN:VAR3*0.94;VAR4:=EMA(CLOSE,9);LUP:EMA(VAR4*1.14,5);LDN:EMA(VAR4*0.86,5);\x22}},JSIndexScript.prototype.XS2=function(){return{Name:\x22XS2\x22,Description:\x22薛斯通道II\x22,IsMainIndex:!0,Args:[{Name:\x22N\x22,Value:102},{Name:\x22M\x22,Value:7}],Script:\x22AA:=MA((2*CLOSE+HIGH+LOW)/4,5);\x20通道1:AA*N/100;\x20通道2:AA*(200-N)/100;\x20CC:=ABS((2*CLOSE+HIGH+LOW)/4-MA(CLOSE,20))/MA(CLOSE,20);\x20DD:=DMA(CLOSE,CC);\x20通道3:(1+M/100)*DD;\x20通道4:(1-M/100)*DD;\x22}},JSIndexScript.prototype.SG_XDT=function(){return{Name:\x22SG-XDT\x22,Description:\x22心电图(需下载日线)\x22,IsMainIndex:!1,Args:[{Name:\x22P1\x22,Value:5},{Name:\x22P2\x22,Value:10}],Script:\x22QR:CLOSE/INDEXC*1000;MQR1:MA(QR,5);MQR2:MA(QR,10);\x22}},JSIndexScript.prototype.SG_SMX=function(){return{Name:\x22SG-SMX\x22,Description:\x22生命线(需下载日线)\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:50}],Script:\x22H1:=HHV(HIGH,N);L1:=LLV(LOW,N);H2:=HHV(INDEXH,N);L2:=LLV(INDEXL,N);ZY:=CLOSE/INDEXC*2000;ZY1:EMA(ZY,3);ZY2:EMA(ZY,17);ZY3:EMA(ZY,34);\x22}},JSIndexScript.prototype.SG_LB=function(){return{Name:\x22SG-LB\x22,Description:\x22量比(需下载日线)\x22,IsMainIndex:!1,Args:[],Script:\x22ZY2:=VOL/INDEXV*1000;量比:ZY2;MA5:MA(ZY2,5);MA10:MA(ZY2,10);\x22}},JSIndexScript.prototype.SG_PF=function(){return{Name:\x22SG-PF\x22,Description:\x22强势股评分(需下载日线)\x22,IsMainIndex:!1,Args:[],Script:\x22ZY1:=CLOSE/INDEXC*1000;A1:=IF(ZY1>HHV(ZY1,3),10,0);A2:=IF(ZY1>HHV(ZY1,5),15,0);A3:=IF(ZY1>HHV(ZY1,10),20,0);A4:=IF(ZY1>HHV(ZY1,2),10,0);A5:=COUNT(ZY1>REF(ZY1,1)\x20,9)*5;强势股评分:A1+A2+A3+A4+A5;\x22}},JSIndexScript.prototype.RAD=function(){return{Name:\x22RAD\x22,Description:\x22威力雷达(需下载日线)\x22,IsMainIndex:!1,Args:[{Name:\x22D\x22,Value:3},{Name:\x22S\x22,Value:30},{Name:\x22M\x22,Value:30}],Script:\x22SM:=(OPEN+HIGH+CLOSE+LOW)/4;SMID:=MA(SM,D);IM:=(INDEXO+INDEXH+INDEXL+INDEXC)/4;IMID:=MA(IM,D);SI1:=(SMID-REF(SMID,1))/SMID;II:=(IMID-REF(IMID,1))/IMID;RADER1:SUM((SI1-II)*2,S)*1000;RADERMA:SMA(RADER1,M,1);\x22}},JSIndexScript.prototype.SHT=function(){return{Name:\x22SHT\x22,Description:\x22龙系短线\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:5}],Script:\x22VAR1:=MA((VOL-REF(VOL,1))/REF(VOL,1),5);VAR2:=(CLOSE-MA(CLOSE,24))/MA(CLOSE,24)*100;MY:\x20VAR2*(1+VAR1);SHT:\x20MY,\x20COLORSTICK;SHTMA:\x20MA(SHT,N);\x22}},JSIndexScript.prototype.ZLJC=function(){return{Name:\x22ZLJC\x22,Description:\x22主力进出\x22,IsMainIndex:!1,Args:[],Script:\x22VAR1:=(CLOSE+LOW+HIGH)/3;\x20VAR2:=SUM(((VAR1-REF(LOW,1))-(HIGH-VAR1))*VOL/100000/(HIGH-LOW),0);\x20VAR3:=EMA(VAR2,1);\x20JCS:VAR3;\x20JCM:MA(VAR3,12);\x20JCL:MA(VAR3,26);\x22}},JSIndexScript.prototype.ZLMM=function(){return{Name:\x22ZLMM\x22,Description:\x22主力买卖\x22,IsMainIndex:!1,Args:[],Script:\x22LC\x20:=REF(CLOSE,1);RSI2:=SMA(MAX(CLOSE-LC,0),12,1)/SMA(ABS(CLOSE-LC),12,1)*100;RSI3:=SMA(MAX(CLOSE-LC,0),18,1)/SMA(ABS(CLOSE-LC),18,1)*100;MMS:MA(3*RSI2-2*SMA(MAX(CLOSE-LC,0),16,1)/SMA(ABS(CLOSE-LC),16,1)*100,3);MMM:EMA(MMS,8);MML:MA(3*RSI3-2*SMA(MAX(CLOSE-LC,0),12,1)/SMA(ABS(CLOSE-LC),12,1)*100,5);\x22}},JSIndexScript.prototype.SLZT=function(){return{Name:\x22SLZT\x22,Description:\x22神龙在天\x22,IsMainIndex:!1,Args:[],Script:\x22白龙:\x20MA(CLOSE,125);黄龙:\x20白龙+2*STD(CLOSE,170);紫龙:\x20白龙-2*STD(CLOSE,145);青龙:\x20SAR(125,1,7),\x20LINESTICK;VAR2:=HHV(HIGH,70);VAR3:=HHV(HIGH,20);红龙:\x20VAR2*0.83;蓝龙:\x20VAR3*0.91;\x22}},JSIndexScript.prototype.ADVOL=function(){return{Name:\x22ADVOL\x22,Description:\x22龙系离散量\x22,IsMainIndex:!1,Args:[],Script:\x22A:=SUM(((CLOSE-LOW)-(HIGH-CLOSE))*VOL/10000/(HIGH-LOW),0);ADVOL:A;MA1:MA(A,30);MA2:MA(MA1,100);\x22}},JSIndexScript.prototype.CYC=function(){return{Name:\x22CYC\x22,Description:\x22成本均线\x22,IsMainIndex:!0,Args:[{Name:\x22P1\x22,Value:5},{Name:\x22P2\x22,Value:13},{Name:\x22P3\x22,Value:34}],Script:\x22JJJ:=IF(DYNAINFO(8)>0.01,0.01*DYNAINFO(10)/DYNAINFO(8),DYNAINFO(3));DDD:=(DYNAINFO(5)<0.01\x20||\x20DYNAINFO(6)<0.01);JJJT:=IF(DDD,1,(JJJ<(DYNAINFO(5)+0.01)\x20&&\x20JJJ>(DYNAINFO(6)-0.01)));CYC1:IF(JJJT,0.01*EMA(AMOUNT,P1)/EMA(VOL,P1),EMA((HIGH+LOW+CLOSE)/3,P1));CYC2:IF(JJJT,0.01*EMA(AMOUNT,P2)/EMA(VOL,P2),EMA((HIGH+LOW+CLOSE)/3,P2));CYC3:IF(JJJT,0.01*EMA(AMOUNT,P3)/EMA(VOL,P3),EMA((HIGH+LOW+CLOSE)/3,P3));CYC4:IF(JJJT,DMA(AMOUNT/(100*VOL),100*VOL/FINANCE(7)),EMA((HIGH+LOW+CLOSE)/3,120));\x22}},JSIndexScript.prototype.CYS=function(){return{Name:\x22CYS\x22,Description:\x22市场盈亏\x22,IsMainIndex:!1,Args:[],Script:\x22CYC13:EMA(AMOUNT,13)/EMA(VOL,13);CYS:(CLOSE-CYC13)/CYC13*100;\x22}},JSIndexScript.prototype.CYQKL=function(){return{Name:\x22CYQKL\x22,Description:\x22博弈K线长度\x22,IsMainIndex:!1,Args:[],Script:\x22KL:100*(WINNER(CLOSE)-WINNER(OPEN));\x22}},JSIndexScript.prototype.SCR=function(){return{Name:\x22SCR\x22,Description:\x22筹码集中度\x22,IsMainIndex:!1,Args:[{Name:\x22P1\x22,Value:90}],Script:\x22A:=P1+(100-P1)/2;B:=(100-P1)/2;CC:=COST(A);DD:=COST(B);SCR:(CC-DD)/(CC+DD)*100/2;\x22}},JSIndexScript.prototype.ASR=function(){return{Name:\x22ASR\x22,Description:\x22浮筹比例\x22,IsMainIndex:!1,Args:[],Script:\x22ASR:(WINNER(C*1.1)-WINNER(C*0.9))/WINNER(HHV(H,0))*100;\x22}},JSIndexScript.prototype.SAR=function(){return{Name:\x22SAR\x22,Description:\x22抛物转向\x22,IsMainIndex:!0,Args:[{Name:\x22P\x22,Value:10},{Name:\x22STEP\x22,Value:2},{Name:\x22MAXP\x22,Value:20}],Script:\x22S:SAR(P,STEP,MAXP),CIRCLEDOT;\x22}},JSIndexScript.prototype.TJCJL=function(){return{Name:\x22太极成交量\x22,Description:\x22太极成交量\x22,IsMainIndex:!0,Args:[],Script:\x22总手:VOL,NODRAW;ZZ:=IF(REF(C,1)>REF(O,1)\x20AND\x20O>REF(C,1)*1.014\x20AND\x20C<O*1.02,1,3);V5:=MA(V,5);V12:=MA(V,12);V34:=MA(V,34);C6:=MA(C,6);STICKLINE(VOL,0,VOL,10,0),COLORLIGRAY;STICKLINE(CROSS(C,C6)\x20AND\x20V>V5*1.2\x20AND\x20V>V12*1.2\x20AND\x20ZZ>2\x20AND\x20C>H*0.975,0,VOL,10,0),COLORRED;STICKLINE(CROSS(C6,C)\x20AND\x20V>V5*1.2\x20AND\x20V>V12*1.2,0,VOL,10,0),COLORGREEN;STICKLINE(VOL>MA(VOL,5)*2\x20AND\x20V>V34*3\x20AND\x20C<REF(C,1)*1.05,0,VOL,10,0),COLORYELLOW;STICKLINE(VOL<MA(VOL,5)/2\x20AND\x20V<V12/2,0,VOL,10,0),COLORBLUE;STICKLINE(VOL>MA(VOL,5)*2\x20AND\x20V>V34*3\x20AND\x20C<REF(C,1)*1.05\x20AND\x20CROSS(C,C6)\x20AND\x20V>V5*1.2\x20AND\x20V>V12*1.2\x20AND\x20ZZ>2\x20AND\x20C>H*0.975,VOL*0.5,0,10,0),COLORRED;STICKLINE(VOL>MA(VOL,5)*2\x20AND\x20V>V34*3\x20AND\x20C<REF(C,1)*1.05\x20AND\x20CROSS(C6,C)\x20AND\x20V>V5*1.2\x20AND\x20V>V12*1.2,VOL*0.5,0,10,0),COLORRED;\x22}},JSIndexScript.prototype.Dragon4_Main=function(){return{Name:\x22飞龙四式\x22,Description:\x22飞龙四式\x22,IsMainIndex:!0,Args:[{Name:\x22N1\x22,Value:5},{Name:\x22N2\x22,Value:10},{Name:\x22N3\x22,Value:50},{Name:\x22N4\x22,Value:60}],Script:\x22蜻蜓点水:=EMA(CLOSE,N1),COLORGRAY;魔界:=EMA(CLOSE,N2),COLORGREEN;水:=EMA(CLOSE,N3),COLORRED;DRAWKLINE(HIGH,OPEN,LOW,CLOSE);生命线:MA(CLOSE,N4),COLORBLUE,LINETHICK2;DRAWBAND(魔界,\x27RGB(186,225,250)\x27,水,\x27RGB(253,194,124)\x27);DRAWBAND(蜻蜓点水,\x27RGB(128,138,135)\x27,魔界,\x27RGB(0,0,255)\x27);\x22}},JSIndexScript.prototype.Dragon4_Fig=function(){return{Name:\x22飞龙四式\x22,Description:\x22飞龙四式\x22,IsMainIndex:!1,Args:[],Script:\x22倍:VOL>=REF(V,1)*1.90\x20AND\x20C>REF(C,1),COLORYELLOW;低:VOL<REF(LLV(VOL,13),1),COLORGREEN;地:VOL<REF(LLV(VOL,100),1),COLORMAGENTA;\x20平:=ABS(VOL-HHV(REF(VOL,1),5))/HHV(REF(VOL,1),5)<=0.03\x20OR\x20ABS(VOL-REF(VOL,1))/REF(VOL,1)<=0.03,NODRAW,COLORWHITE;倍缩:VOL<=REF(V,1)*0.5,COLORFF8000;梯量:COUNT(V>REF(V,1),3)==3\x20AND\x20COUNT(C>O,3)==3,COLORBROWN;缩量涨:COUNT(C>REF(C,1),2)==2\x20AND\x20COUNT(V<REF(V,1),2)==2,COLORBLUE;STICKLINE(C>=REF(C,1),V,0,2,0),COLORRED;STICKLINE(C<REF(C,1),V,0,2,0),COLORGREEN;STICKLINE(倍,0,V,2,0),COLORYELLOW;STICKLINE(低,0,V,2,0),COLORGREEN;STICKLINE(地,0,V,2,0),COLORLIMAGENTA;STICKLINE(平,0,V,2,0),COLORGRAY;STICKLINE(倍缩,0,V,2,0),COLORFF8000;STICKLINE(梯量,0,V,2,0),COLORBROWN;STICKLINE(缩量涨,0,V,2,0),COLORBLUE;\x22}},JSIndexScript.prototype.FundsAnalysis=function(){return{Name:\x22资金分析\x22,Description:\x22资金分析\x22,IsMainIndex:!1,Args:[{Name:\x22M\x22,Value:55},{Name:\x22N\x22,Value:34}],Script:\x22LC:=REF(CLOSE,1);RSI:=((SMA(MAX((CLOSE\x20-\x20LC),0),3,1)\x20/\x20SMA(ABS((CLOSE\x20-\x20LC)),3,1))\x20*\x20100);FF:=EMA(CLOSE,3);MA15:=EMA(CLOSE,21);\x20DRAWTEXT(CROSS(85,RSI),75,\x27▼\x27),COLORGREEN;VAR1:=IF(YEAR>=2038\x20AND\x20MONTH>=1,0,1);VAR2:=REF(LOW,1)*VAR1;VAR3:=SMA(ABS(LOW-VAR2),3,1)/SMA(MAX(LOW-VAR2,0),3,1)*100*VAR1;VAR4:=EMA(IF(CLOSE*1.3,VAR3*10,VAR3/10),3)*VAR1;VAR5:=LLV(LOW,30)*VAR1;VAR6:=HHV(VAR4,30)*VAR1;VAR7:=IF(MA(CLOSE,58),1,0)*VAR1;VAR8:=EMA(IF(LOW<=VAR5,(VAR4+VAR6*2)/2,0),3)/618*VAR7*VAR1;吸筹A:IF(VAR8>100,100,VAR8)*VAR1,COLORFB2F3B;{吸筹B}STICKLINE(吸筹A>-150,0,吸筹A,8,0),COLORFB2F3B;散户线:\x20100*(HHV(HIGH,M)-CLOSE)/(HHV(HIGH,M)-LLV(LOW,M)),COLORAA89BD,LINETHICK2;RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;K:=SMA(RSV,3,1);D:=SMA(K,3,1);J:=3*K-2*D;主力线:EMA(J,5),COLORF39800,LINETHICK2;DRAWICON(CROSS(主力线,散户线),主力线,1);DRAWICON(CROSS(散户线,主力线),主力线,2);\x22}},JSIndexScript.prototype.MarginProportion=function(){return{Name:\x22融资占比(%)\x22,Description:\x22融资占比\x22,IsMainIndex:!1,Condition:{Period:[CONDITION_PERIOD.KLINE_DAY_ID]},Args:[],Script:\x22占比:MARGIN(2);\x22}},JSIndexScript.prototype.Margin2=function(){return{Name:\x22两融余额\x22,Description:\x22融资融券余额\x22,IsMainIndex:!1,Condition:{Period:[CONDITION_PERIOD.KLINE_DAY_ID]},Args:[{Name:\x22N\x22,Value:5}],Script:\x22T1:MARGIN(1);\x20\x20\x20\x20\x20\x20\x20\x20T2:MA(MARGIN(1),N);\x22}},JSIndexScript.prototype.Margin3=function(){return{Name:\x22两融余额\x22,Description:\x22融资融券余额\x22,IsMainIndex:!1,Condition:{Period:[CONDITION_PERIOD.KLINE_DAY_ID]},Args:[{Name:\x22N\x22,Value:5}],Script:\x22T1:=MARGIN(1);\x20\x20\x20\x20\x20\x20\x20\x20T2:=MA(MARGIN(1),N);\x20\x20\x20\x20\x20\x20\x20\x20STICKLINE(T1-T2>=0,0,T1-T2,50,T1>T2),COLORRED;\x20\x20\x20\x20\x20\x20\x20\x20STICKLINE(T1-T2<0,T1-T2,0,50,T1>T2),COLORGREEN;\x22}},JSIndexScript.prototype.FXG_BSPoint=function(){return{Name:\x22操盘BS点\x22,Description:\x22操盘BS点\x22,IsMainIndex:!0,Args:[],Script:\x22MA5:MA(CLOSE,5);\x20\x20\x20\x20\x20\x20\x20\x20MA13:MA(CLOSE,13);\x20\x20\x20\x20\x20\x20\x20\x20MA21:MA(CLOSE,21);\x20\x20\x20\x20\x20\x20\x20\x20MA34:MA(CLOSE,34);\x20\x20\x20\x20\x20\x20\x20\x20{MA55:MA(CLOSE,55),COLOR0000FF;}\x20\x20\x20\x20\x20\x20\x20\x20{MA120:=MA(CLOSE,120),COLORFFFF00;}\x20\x20\x20\x20\x20\x20\x20\x20天使:=EMA(C,2),COLOR000000;\x20\x20\x20\x20\x20\x20\x20\x20魔鬼:=EMA(SLOPE(C,21)*20+C,42),COLOR000000;\x20\x20\x20\x20\x20\x20\x20\x20买:=CROSS(天使,魔鬼);\x20\x20\x20\x20\x20\x20\x20\x20卖:=CROSS(魔鬼,天使);\x20\x20\x20\x20\x20\x20\x20\x20DRAWICON(买,L*0.97,13);\x20\x20\x20\x20\x20\x20\x20\x20DRAWICON(卖,H*1.03,14);\x20\x20\x20\x20\x20\x20\x20\x20DRAWKLINE_IF(天使>=魔鬼,HIGH,CLOSE,LOW,OPEN),COLORRED;\x20\x20\x20\x20\x20\x20\x20\x20DRAWKLINE_IF(天使<魔鬼,HIGH,CLOSE,LOW,OPEN),COLORBLUE;\x20\x20\x20\x20\x20\x20\x20\x20DRAWKLINE_IF(CROSS(天使,魔鬼),HIGH,CLOSE,LOW,OPEN),COLORYELLOW;\x20\x20\x20\x20\x20\x20\x20\x20DRAWKLINE_IF(CROSS(魔鬼,天使),HIGH,CLOSE,LOW,OPEN),COLORBLACK;\x22}},JSIndexScript.prototype.FXG_INDEX=function(){return{Name:\x22涨停多空线\x22,Description:\x22涨停多空线\x22,IsMainIndex:!1,Args:[],Script:\x22做多能量线:\x20SMA((CLOSE-LLV(LOW,9))/(HHV(HIGH,9)-LLV(LOW,9))*100,5,1)-8,COLORRED,LINETHICK3;做空能量线:\x20SMA((HHV(HIGH,36)-CLOSE)/(HHV(HIGH,36)-LLV(LOW,36))*100,2,1),COLORGREEN,LINETHICK3;20,POINTDOT,COLORF00FF0;50,POINTDOT,COLORGREEN;80,POINTDOT,COLORLIBLUE;\x22}},JSIndexScript.prototype.FXG_INDEX2=function(){return{Name:\x22涨停吸筹区\x22,Description:\x22涨停吸筹区\x22,IsMainIndex:!1,Args:[],Script:\x22VAR0:=EMA(HHV(HIGH,500),21);\x20VAR1:=EMA(HHV(HIGH,250),21);VAR2:=EMA(HHV(HIGH,90),21);\x20VAR3:=EMA(LLV(LOW,500),21);\x20VAR4:=EMA(LLV(LOW,250),21);\x20VAR5:=EMA(LLV(LOW,90),21);VAR6:=EMA((VAR3*0.96+VAR4*0.96+VAR5*0.96+VAR0*0.558+VAR1*0.558+VAR2*0.558)/6,21);\x20VAR7:=EMA((VAR3*1.25+VAR4*1.23+VAR5*1.2+VAR0*0.55+VAR1*0.55+VAR2*0.65)/6,21);\x20VAR8:=EMA((VAR3*1.3+VAR4*1.3+VAR5*1.3+VAR0*0.68+VAR1*0.68+VAR2*0.68)/6,21);\x20VAR9:=EMA((VAR6*3+VAR7*2+VAR8)/6*1.738,21);\x20VAR10:=REF(LOW,1);\x20VAR11:=SMA(ABS(LOW-VAR10),3,1)/SMA(MAX(LOW-VAR10,0),3,1)*100;\x20VAR12:=EMA(IFF(CLOSE*1.35<=VAR9,VAR11*10,VAR11/10),3);\x20VAR13:=LLV(LOW,30);\x20VAR14:=HHV(VAR12,30);\x20VAR15:=IFF(MA(CLOSE,58),1,0);\x20VAR16:=EMA(IFF(LOW<=VAR13,(VAR12+VAR14*2)/2,0),3)/618*VAR15;资金入场:IFF(VAR16>0,VAR16,0),LINETHICK,LINETHICK2,\x20COLORFF0000;\x20A1:IFF(资金入场>0,资金入场*1.2,0),STICK,LINETHICK5,\x20COLORFF0000;A2:IFF(资金入场>0,资金入场*0.8,0),STICK,LINETHICK5,\x20COLORFF6600;A3:IFF(资金入场>0,资金入场*0.6,0),STICK,LINETHICK5,\x20COLORFF9900;A4:IFF(资金入场>0,资金入场*0.4,0)\x20,STICK,LINETHICK5,COLORFFCC00;A5:IFF(资金入场>0,资金入场*0.2,0)\x20,STICK,LINETHICK5,COLORFFFF00;\x22}},JSIndexScript.prototype.FXG_INDEX3=function(){return{Name:\x22量能黄金点\x22,Description:\x22量能黄金点\x22,IsMainIndex:!1,FloatPrecision:0,Args:[],Script:\x22A:=IFF((CLOSE>126.32),VOL,VOL);\x20主力:=MA(A,4),COLORRED;游资:=MA(A,8),COLORYELLOW;大户:=MA(A,16),COLORF0F000;散户:=MA(A,32),COLOR00FF00;主比:=ABS(((主力)/(主力\x20+\x20游资\x20+\x20大户\x20+\x20散户))*(100)),LINESTICK,COLORRED;游比:=ABS(((游资)/(主力\x20+\x20游资\x20+\x20大户\x20+\x20散户))*(100)),LINESTICK,COLORYELLOW;大比:=ABS(((大户)/(主力\x20+\x20游资\x20+\x20大户\x20+\x20散户))*(100)),LINESTICK,COLORF0F000;散比:=ABS(((散户)/(主力\x20+\x20游资\x20+\x20大户\x20+\x20散户))*(100)),LINESTICK,COLOR00FF00;警戒线:MA(A,180),COLORFF66FF;STICKLINE((主力\x20>\x200),0,主力,2.5,0),COLOR1020BB;STICKLINE((主力\x20>\x200),0,主力,0.7,0),COLORRED;STICKLINE((游资\x20>\x200),0,游资,2.5,0),COLOR009CFF;STICKLINE((游资\x20>\x200),0,游资,0.7,0),COLORYELLOW;STICKLINE((大户\x20>\x200),0,大户,2.5,0),COLORFF8800;STICKLINE((大户\x20>\x200),0,大户,0.7,0),COLORLIBLUE;STICKLINE((散户\x20>\x200),0,散户,2.5,0),COLOR00CA00;STICKLINE((散户\x20>\x200),0,散户,0.7,0),COLORGREEN;\x22}},JSIndexScript.prototype.NewsNegative=function(){return{Name:\x22负面新闻\x22,Description:\x22负面新闻统计\x22,IsMainIndex:!1,FloatPrecision:0,Args:[{Name:\x22N\x22,Value:5},{Name:\x22N2\x22,Value:10}],Script:\x22负面:NEWS(1);MA1:MA(负面,N);MA2:MA(负面,N2);\x22}},JSIndexScript.prototype.UpDownAnalyze=function(){return{Name:\x22涨跌趋势\x22,Description:\x22涨跌趋势\x22,IsMainIndex:!1,FloatPrecision:0,Condition:{Period:[CONDITION_PERIOD.MINUTE_ID,CONDITION_PERIOD.MULTIDAY_MINUTE_ID,CONDITION_PERIOD.KLINE_DAY_ID]},Args:[],Script:\x22上涨家数:UPCOUNT(\x27CNA.CI\x27),COLORRED;下跌家数:DOWNCOUNT(\x27CNA.CI\x27),COLORGREEN;\x22}},JSIndexScript.prototype.HK2SHSZ=function(){return{Name:\x22北上资金\x22,Description:\x22北上资金\x22,IsMainIndex:!1,FloatPrecision:0,Condition:{Period:[CONDITION_PERIOD.MINUTE_ID,CONDITION_PERIOD.MULTIDAY_MINUTE_ID,CONDITION_PERIOD.KLINE_DAY_ID]},Args:[],Script:\x22净流入:HK2SHSZ(1),COLORSTICK;\x22}},JSIndexScript.prototype.ShareHolder=function(){return{Name:\x22股东人数\x22,Description:\x22股东人数\x22,IsMainIndex:!1,FloatPrecision:0,Condition:{Period:[CONDITION_PERIOD.KLINE_DAY_ID,CONDITION_PERIOD.KLINE_MONTH_ID,CONDITION_PERIOD.KLINE_WEEK_ID,CONDITION_PERIOD.KLINE_YEAR_ID]},Args:[],Script:\x22人数:FINANCE(100);\x22}},JSIndexScript.prototype.VOLRate=function(){return{Name:\x22量比\x22,Description:\x22量比\x22,IsMainIndex:!1,Condition:{Period:[CONDITION_PERIOD.MINUTE_ID,CONDITION_PERIOD.MULTIDAY_MINUTE_ID]},Args:[],Script:\x22LIANGBI:VOLR;\x22}},JSIndexScript.prototype.COLOR_KSTAR1=function(){return{Name:\x22十字星\x22,Description:\x22十字星\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:CLOSE==OPEN&&HIGH>LOW;\x22}},JSIndexScript.prototype.COLOR_KSTAR2=function(){return{Name:\x22早晨之星\x22,Description:\x22早晨之星\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:(REF(CLOSE,2)/REF(OPEN,2)<0.95)\x20&&\x20(REF(OPEN,1)\x20<\x20REF(CLOSE,2))\x20&&\x20(ABS(REF(OPEN,1)-REF(CLOSE,1))/REF(CLOSE,1)<0.03)\x20&&\x20CLOSE/OPEN>1.05\x20&&\x20CLOSE>REF(CLOSE,2);\x22}},JSIndexScript.prototype.COLOR_KSTAR3=function(){return{Name:\x22黄昏之星\x22,Description:\x22黄昏之星\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:REF(CLOSE,2)/REF(OPEN,2)>1.05\x20&&\x20REF(OPEN,1)>REF(CLOSE,2)\x20&&\x20ABS(REF(OPEN,1)-REF(CLOSE,1))/REF(CLOSE,1)<0.03\x20&&\x20CLOSE/OPEN<0.95\x20&&\x20CLOSE<REF(CLOSE,2);\x22}},JSIndexScript.prototype.COLOR_SHI1=function(){return{Name:\x22长十字\x22,Description:\x22长十字\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:CLOSE==OPEN&&HIGH/LOW>1.03;\x22}},JSIndexScript.prototype.COLOR_K220=function(){return{Name:\x22身怀六甲\x22,Description:\x22身怀六甲\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:ABS(REF(CLOSE,1)-REF(OPEN,1))/REF(CLOSE,1)>0.04&&\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ABS(CLOSE-OPEN)/CLOSE<0.005&&\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20MAX(CLOSE,OPEN)<MAX(REF(CLOSE,1),REF(OPEN,1))&&\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20MIN(CLOSE,OPEN)>MIN(REF(CLOSE,1),REF(OPEN,1));\x22}},JSIndexScript.prototype.COLOR_K300=function(){return{Name:\x22三个白武士\x22,Description:\x22三个白武士\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:UPNDAY(CLOSE,3)&&NDAY(CLOSE,OPEN,3);\x22}},JSIndexScript.prototype.COLOR_K310=function(){return{Name:\x22三只乌鸦\x22,Description:\x22三只乌鸦\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:DOWNNDAY(CLOSE,3)&&NDAY(OPEN,CLOSE,3);\x22}},JSIndexScript.prototype.COLOR_K380=function(){return{Name:\x22光头阳线\x22,Description:\x22光头阳线\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:HIGH==CLOSE&&HIGH>LOW;\x22}},JSIndexScript.prototype.COLOR_K390=function(){return{Name:\x22光脚阴线\x22,Description:\x22光脚阴线\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:LOW==CLOSE&&HIGH>LOW;\x22}},JSIndexScript.prototype.COLOR_K134=function(){return{Name:\x22垂死十字\x22,Description:\x22垂死十字\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:CLOSE==OPEN&&CLOSE==LOW&&CLOSE<HIGH;\x22}},JSIndexScript.prototype.COLOR_K140=function(){return{Name:\x22早晨十字星\x22,Description:\x22早晨十字星\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:REF(CLOSE,2)/REF(OPEN,2)<0.95&&REF(OPEN,1)<REF(CLOSE,2)&&REF(OPEN,1)==REF(CLOSE,1)&&CLOSE/OPEN>1.05&&CLOSE>REF(CLOSE,2);\x22}},JSIndexScript.prototype.COLOR_K150=function(){return{Name:\x22黄昏十字星\x22,Description:\x22黄昏十字星\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:REF(CLOSE,2)/REF(OPEN,2)>1.05&&REF(OPEN,1)>REF(CLOSE,2)&&REF(OPEN,1)=REF(CLOSE,1)&&CLOSE/OPEN<0.95&&CLOSE<REF(CLOSE,2);\x22}},JSIndexScript.prototype.COLOR_K160=function(){return{Name:\x22射击之星\x22,Description:\x22射击之星\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:MIN(OPEN,CLOSE)==LOW&&HIGH-LOW>3*(MAX(OPEN,CLOSE)-LOW)&&CLOSE>MA(CLOSE,5);\x22}},JSIndexScript.prototype.COLOR_K165=function(){return{Name:\x22倒转锤头\x22,Description:\x22倒转锤头\x22,IsMainIndex:!0,InstructionType:2,Script:\x22KSTAR:MIN(OPEN,CLOSE)==LOW&&HIGH-LOW>3*(MAX(OPEN,CLOSE)-LOW)&&CLOSE<MA(CLOSE,5);\x22}},JSIndexScript.prototype.COLOR_K170=function(){return{Name:\x22锤头\x22,Description:\x22锤头\x22,IsMainIndex:!0,InstructionType:2,Script:\x22OUT:HIGH==MAX(OPEN,CLOSE)&&HIGH-LOW>3*(HIGH-MIN(OPEN,CLOSE))&&CLOSE<MA(CLOSE,5);\x22}},JSIndexScript.prototype.COLOR_K180=function(){return{Name:\x22吊颈\x22,Description:\x22吊颈\x22,IsMainIndex:!0,InstructionType:2,Script:\x22OUT:HIGH==MAX(OPEN,CLOSE)&&HIGH-LOW>3*(HIGH-MIN(OPEN,CLOSE))&&CLOSE>MA(CLOSE,5);\x22}},JSIndexScript.prototype.COLOR_K190=function(){return{Name:\x22穿头破脚\x22,Description:\x22穿头破脚\x22,IsMainIndex:!0,InstructionType:2,Script:\x22OUT:(REF(CLOSE,1)/REF(OPEN,1)>1.03&&CLOSE/OPEN<0.96&&CLOSE<REF(OPEN,1)&&OPEN>REF(CLOSE,1))||(REF(CLOSE,1)/REF(OPEN,1)<0.97&&CLOSE/OPEN>1.04&&CLOSE>REF(OPEN,1)&&OPEN<REF(CLOSE,1));\x22}},JSIndexScript.prototype.COLOR_SWORD=function(){return{Name:\x22剑\x22,Description:\x22剑\x22,IsMainIndex:!0,InstructionType:2,Script:\x22AA:=VOL>REF(VOL,1)||VOL>(CAPITAL*0.1);BB:=OPEN>=(REF(HIGH,1))&&REF(HIGH,1)>(REF(HIGH,2)*1.06);CC:=CLOSE>(REF(CLOSE,1))-(REF(CLOSE,1)*0.01);DD:=CLOSE<(HIGH*0.965)\x20&&\x20HIGH>(OPEN*1.05);EE:=LOW<OPEN\x20&&\x20LOW<CLOSE&&HIGH>(REF(CLOSE,1)*1.06);FF:=(HIGH-(MAX(OPEN,CLOSE)))/2>(MIN(OPEN,CLOSE))-LOW;GG:=(ABS(OPEN-CLOSE))/2<(MIN(OPEN,CLOSE)-LOW);SWORDO:AA&&BB&&CC&&DD&&EE&&FF&&GG;\x22}},JSIndexScript.prototype.COLOR_CSFR=function(){return{Name:\x22出水芙蓉\x22,Description:\x22出水芙蓉\x22,IsMainIndex:!0,InstructionType:2,Script:\x22A:=CLOSE>OPEN;B:=A&&CLOSE>MA(CLOSE,S)&&CLOSE>MA(CLOSE,M)&&CLOSE>MA(CLOSE,LL);CC:=B&&OPEN<MA(CLOSE,M)&&OPEN<MA(CLOSE,LL);CSFRO:CC&&(CLOSE-OPEN)>0.0618*CLOSE;\x22}},JSIndexScript.prototype.COLOR_WYGD=function(){return{Name:\x22乌云盖顶\x22,Description:\x22乌云盖顶\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR1:BACKSET(\x20REF(CLOSE,1)/REF(OPEN,1)>1.03\x20AND\x20CLOSE/OPEN<0.97\x20AND\x20OPEN>REF(CLOSE,1)\x20AND\x20CLOSE<REF(CLOSE,1),\x203);\x22}},JSIndexScript.prototype.COLOR_SGCJ=function(){return{Name:\x22曙光初现\x22,Description:\x22曙光初现\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR1:BACKSET(\x20REF(CLOSE,1)/REF(OPEN,1)<0.97\x20AND\x20CLOSE/OPEN>1.03\x20AND\x20OPEN<REF(CLOSE,1)\x20AND\x20CLOSE>REF(CLOSE,1),\x203);\x22}},JSIndexScript.prototype.COLOR_SZTAI=function(){return{Name:\x22十字胎\x22,Description:\x22十字胎\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR1:BACKSET(\x20ABS(REF(CLOSE,1)-REF(OPEN,1))/REF(CLOSE,1)\x20>\x200.04\x20AND\x20CLOSE==OPEN\x20AND\x20CLOSE\x20<\x20MAX(REF(CLOSE,1),REF(OPEN,1))\x20AND\x20CLOSE\x20>\x20MIN(REF(CLOSE,1),REF(OPEN,1)),\x202);\x22}},JSIndexScript.prototype.COLOR_PINGDING=function(){return{Name:\x22平顶\x22,Description:\x22平顶\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR1:BACKSET(ABS(HIGH-REF(HIGH,1))/HIGH<0.001,2);\x22}},JSIndexScript.prototype.COLOR_PINGDI=function(){return{Name:\x22平底\x22,Description:\x22平底\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR1:BACKSET((ABS(LOW-REF(LOW,1))/LOW<0.001\x20AND\x20ABS(REF(LOW,1)-REF(LOW,2))/REF(LOW,1)<=0.001),2);\x22}},JSIndexScript.prototype.COLOR_DAYANZHU=function(){return{Name:\x22大阳烛\x22,Description:\x22大阳烛\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR1:CLOSE/OPEN>1.05\x20AND\x20HIGH/LOW\x20<\x20CLOSE/OPEN+0.018;\x22}},JSIndexScript.prototype.COLOR_DAYINGZHU=function(){return{Name:\x22大阴烛\x22,Description:\x22大阴烛\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR1:OPEN/CLOSE\x20>\x201.05\x20AND\x20HIGH/LOW\x20<\x20OPEN/CLOSE+0.018;\x22}},JSIndexScript.prototype.COLOR_HYFG=function(){return{Name:\x22好友反攻\x22,Description:\x22好友反攻\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR1:BACKSET(\x20(REF(CLOSE,1)<REF(OPEN,1)\x20AND\x20CLOSE>OPEN\x20AND\x20ABS(CLOSE-REF(CLOSE,1))/CLOSE<0.002),2);\x22}},JSIndexScript.prototype.COLOR_TKQK=function(){return{Name:\x22跳空缺口\x22,Description:\x22跳空缺口\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR1:BACKSET(\x20HIGH<REF(LOW,1)\x20OR\x20LOW>REF(HIGH,1),2);\x22}},JSIndexScript.prototype.COLOR_SFWY=function(){return{Name:\x22双飞乌鸦\x22,Description:\x22双飞乌鸦\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR1:BACKSET(\x20REF(CLOSE,1)<REF(OPEN,1)\x20AND\x20CLOSE<OPEN\x20AND\x20CLOSE/OPEN<0.98,1);\x22}},JSIndexScript.prototype.COLOR_SSSBQ=function(){return{Name:\x22上升三部曲\x22,Description:\x22上升三部曲\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR1:BACKSET(\x20REF(CLOSE,4)/REF(OPEN,4)>1.03\x20AND\x20REF(CLOSE,3)<REF(OPEN,3)\x20AND\x20REF(CLOSE,2)<REF(OPEN,2)\x20AND\x20REF(CLOSE,1)<REF(OPEN,1)\x20AND\x20REF(LOW,4)<REF(LOW,3)\x20AND\x20REF(LOW,4)<REF(LOW,2)\x20AND\x20REF(LOW,4)<REF(LOW,1)\x20AND\x20REF(HIGH,4)>REF(HIGH,3)\x20AND\x20REF(HIGH,4)>REF(HIGH,2)\x20AND\x20REF(HIGH,4)>REF(HIGH,1)\x20AND\x20CLOSE/OPEN>1.03\x20AND\x20CLOSE>REF(CLOSE,4),\x205);\x22}},JSIndexScript.prototype.COLOR_XDSBQ=function(){return{Name:\x22下跌三部曲\x22,Description:\x22下跌三部曲\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR1:BACKSET(\x20REF(CLOSE,4)/REF(OPEN,4)<0.97\x20AND\x20REF(CLOSE,3)>REF(OPEN,3)\x20AND\x20REF(CLOSE,2)>REF(OPEN,2)\x20AND\x20REF(CLOSE,1)>REF(OPEN,1)\x20AND\x20REF(LOW,4)<REF(LOW,3)\x20AND\x20REF(LOW,4)<REF(LOW,2)\x20AND\x20REF(LOW,4)<REF(LOW,1)\x20AND\x20REF(HIGH,4)>REF(HIGH,3)\x20AND\x20REF(HIGH,4)>REF(HIGH,2)\x20AND\x20REF(HIGH,4)>REF(HIGH,1)\x20AND\x20CLOSE/OPEN<0.97\x20AND\x20CLOSE<REF(CLOSE,4),\x205);\x22}},JSIndexScript.prototype.COLOR_CHXY=function(){return{Name:\x22长下影\x22,Description:\x22长下影\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR2:(MIN(CLOSE,OPEN)-LOW)/(HIGH-LOW)>0.667;\x22}},JSIndexScript.prototype.COLOR_CHSY=function(){return{Name:\x22长上影\x22,Description:\x22长上影\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR2:(HIGH-MAX(CLOSE,OPEN))/(HIGH-LOW)>0.667,COLORBLUE;\x22}},JSIndexScript.prototype.COLOR_FENLI=function(){return{Name:\x22分离\x22,Description:\x22分离\x22,IsMainIndex:!0,InstructionType:2,Script:\x22VAR1:BACKSET(\x20OPEN==REF(OPEN,1)\x20AND\x20(CLOSE-OPEN)*(REF(CLOSE,1)-REF(OPEN,1))<0,2);\x22}},JSIndexScript.prototype.TRADE_BIAS=function(){return{Name:\x22BIAS\x22,Description:\x22乖离率专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22N\x22,Value:12},{Name:\x22LL\x22,Value:6},{Name:\x22LH\x22,Value:6}],Script:\x22BIAS:=(CLOSE-MA(CLOSE,N))/MA(CLOSE,N)*100;ENTERLONG:CROSS(-LL,BIAS);EXITLONG:CROSS(BIAS,LH);\x22}},JSIndexScript.prototype.TRADE_CCI=function(){return{Name:\x22CCI\x22,Description:\x22CCI专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22N\x22,Value:14}],Script:\x22TYP:=(HIGH+LOW+CLOSE)/3;CCI:=(TYP-MA(TYP,N))/(0.015*AVEDEV(TYP,N));INDEX:=CCI;ENTERLONG:CROSS(INDEX,-100);EXITLONG:CROSS(100,INDEX);\x22}},JSIndexScript.prototype.TRADE_DMI=function(){return{Name:\x22DMI\x22,Description:\x22趋向专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22N\x22,Value:14}],Script:\x22MTR:=SUM(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(LOW-REF(CLOSE,1))),N);HD\x20:=HIGH-REF(HIGH,1);LD\x20:=REF(LOW,1)-LOW;PDM:=SUM(IF(HD>0&&HD>LD,HD,0),N);MDM:=SUM(IF(LD>0&&LD>HD,LD,0),N);PDI:=PDM*100/MTR;MDI:=MDM*100/MTR;ENTERLONG:CROSS(PDI,MDI);EXITLONG:CROSS(MDI,PDI);\x22}},JSIndexScript.prototype.TRADE_KD=function(){return{Name:\x22KD\x22,Description:\x22KD指标专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22N\x22,Value:9},{Name:\x22M1\x22,Value:3},{Name:\x22M2\x22,Value:3}],Script:\x22WRSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;WK:=SMA(WRSV,M1,1);D:=SMA(WK,M2,1);ENTERLONG:CROSS(WK,D)&&WK<20;EXITLONG:CROSS(D,WK)&&WK>80;\x22}},JSIndexScript.prototype.TRADE_BOLL=function(){return{Name:\x22BOLL\x22,Description:\x22布林带专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22N\x22,Value:20}],Script:\x22MID\x20:=MA(CLOSE,N);UPPER:=MID+2*STD(CLOSE,N);LOWER:=MID-2*STD(CLOSE,N);ENTERLONG:CROSS(CLOSE,LOWER);EXITLONG:CROSS(CLOSE,UPPER);\x22}},JSIndexScript.prototype.TRADE_KDJ=function(){return{Name:\x22KDJ\x22,Description:\x22KDJ专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22N\x22,Value:9},{Name:\x22M1\x22,Value:3}],Script:\x22RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;K:=SMA(RSV,M1,1);D:=SMA(K,M1,1);J:=3*K-2*D;ENTERLONG:CROSS(J,0);EXITLONG:CROSS(100,J);\x22}},JSIndexScript.prototype.TRADE_MA=function(){return{Name:\x22MA\x22,Description:\x22均线专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22SHORT\x22,Value:5},{Name:\x22LONG\x22,Value:20}],Script:\x22ENTERLONG:CROSS(MA(CLOSE,SHORT),MA(CLOSE,LONG));EXITLONG:CROSS(MA(CLOSE,LONG),MA(CLOSE,SHORT));\x22}},JSIndexScript.prototype.TRADE_MACD=function(){return{Name:\x22MACD\x22,Description:\x22MACD专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22LONG\x22,Value:26},{Name:\x22SHORT\x22,Value:12},{Name:\x22M\x22,Value:9}],Script:\x22DIFF:=EMA(CLOSE,SHORT)\x20-\x20EMA(CLOSE,LONG);DEA\x20\x20:=\x20EMA(DIFF,M);MACD\x20:=\x202*(DIFF-DEA);ENTERLONG:CROSS(MACD,0);EXITLONG:CROSS(0,MACD);\x22}},JSIndexScript.prototype.TRADE_MTM=function(){return{Name:\x22MTM\x22,Description:\x22动力指标专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22N\x22,Value:6}],Script:\x22WMTM:=C-REF(C,N);ENTERLONG:CROSS(WMTM,0);EXITLONG:CROSS(0,WMTM);\x22}},JSIndexScript.prototype.TRADE_PSY=function(){return{Name:\x22PSY\x22,Description:\x22PSY心理线专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22N\x22,Value:12},{Name:\x22LL\x22,Value:10},{Name:\x22LH\x22,Value:85}],Script:\x22MYPSY:=COUNT(CLOSE>REF(CLOSE,1),N)/N*100;ENTERLONG:CROSS(LL,MYPSY);EXITLONG:CROSS(MYPSY,LH);\x22}},JSIndexScript.prototype.TRADE_ROC=function(){return{Name:\x22ROC\x22,Description:\x22变动速率专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22N\x22,Value:12},{Name:\x22M\x22,Value:6}],Script:\x22WROC:=MA(100*(CLOSE-REF(CLOSE,N))/REF(CLOSE,N),M);ENTERLONG:CROSS(WROC,0);EXITLONG:CROSS(0,WROC);\x22}},JSIndexScript.prototype.TRADE_RSI=function(){return{Name:\x22RSI\x22,Description:\x22相对强弱专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22N\x22,Value:6},{Name:\x22LL\x22,Value:20},{Name:\x22LH\x22,Value:80}],Script:\x22LC:=REF(CLOSE,1);WRSI:=SMA(MAX(CLOSE-LC,0),N,1)/SMA(ABS(CLOSE-LC),N,1)*100;ENTERLONG:CROSS(WRSI,LL);EXITLONG:CROSS(LH,WRSI);\x22}},JSIndexScript.prototype.TRADE_VR=function(){return{Name:\x22VR\x22,Description:\x22VR容量比率专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22N\x22,Value:26},{Name:\x22LL\x22,Value:70},{Name:\x22LH\x22,Value:250}],Script:\x22WVR\x20:=\x20SUM((IF(CLOSE>OPEN,VOL,0)+IF(CLOSE=OPEN,VOL/2,0)),N)/SUM((IF(CLOSE<OPEN,VOL,0)+IF(CLOSE=OPEN,VOL/2,0)),N)*100;ENTERLONG:CROSS(LL,WVR);EXITLONG:CROSS(WVR,LH);\x22}},JSIndexScript.prototype.TRADE_DPSJ=function(){return{Name:\x22DPSJ\x22,Description:\x22大盘随机专家系统\x22,IsMainIndex:!0,InstructionType:1,Args:[{Name:\x22N1\x22,Value:18},{Name:\x22N2\x22,Value:12}],Script:\x22RSV:=(INDEXC-LLV(INDEXL,N1))/(HHV(INDEXH,N1)-LLV(INDEXL,N1))*100;K:=SMA(RSV,N2,1);HSL:VOL/100/(FINANCE(7));ENTERLONG:\x20CROSS(K,20);EXITLONG:\x20(CROSS(HSL,5)\x20OR\x20CROSS(K,80));\x22}},JSIndexScript.prototype.Zealink_Index1=function(){return{Name:\x22资金吸筹\x22,Description:\x22资金吸筹\x22,IsMainIndex:!1,Args:[],Script:\x22VAR1:=REF((LOW+OPEN+CLOSE+HIGH)/4,1);\x20\x20VAR2:=\x20SMA(ABS(LOW\x20-\x20VAR1),\x2013,\x201)\x20/\x20SMA(MAX(LOW\x20-\x20VAR1,\x200),\x2010,\x201);VAR3:=\x20EMA(VAR2,\x2010);VAR4:=\x20LLV(LOW,\x2033);VAR5:=\x20EMA(IF(LOW\x20<=\x20VAR4,\x20VAR3,\x200),\x203)\x20*\x200.2;主力进场:\x20IF(VAR5\x20>\x20REF(VAR5,\x201),\x20VAR5,0),\x20COLORRED,\x20NODRAW;洗盘:\x20IF(VAR5\x20<\x20REF(VAR5,\x201),\x20\x20VAR5,0),\x20COLORYELLOW,\x20NODRAW;STICKLINE(VAR5>\x20REF(VAR5,\x201),0,\x20VAR5,\x2020,\x200),\x20COLORRED;STICKLINE(VAR5\x20<\x20REF(VAR5,\x201),\x200,\x20VAR5,\x2020,\x200),\x20COLORYELLOW;\x22}},JSIndexScript.prototype.Zealink_Index2=function(){return{Name:\x22牛熊区间\x22,Description:\x22牛熊区间\x22,IsMainIndex:!1,YSpecificMaxMin:{Max:100,Min:1,Count:4},YSplitScale:[1,50,100],Args:[],Script:\x22短高H:=(20*H+19*REF(H,1)+18*REF(H,2)+17*REF(H,3)+16*REF(H,4)+15*REF(H,5)+14*REF(H,6)+\x2013\x20*\x20REF(H,\x207)\x20+\x2012\x20*\x20REF(H,\x208)\x20+\x2011\x20*\x20REF(H,\x209)\x20+\x2010\x20*\x20REF(H,\x2010)\x20+\x209\x20*\x20REF(H,\x2011)\x20+\x208\x20*\x20REF(H,\x2012)+\x207\x20*\x20REF(H,\x2013)\x20+\x206\x20*\x20REF(H,\x2014)\x20+\x205\x20*\x20REF(H,\x2015)\x20+\x204\x20*\x20REF(H,\x2016)\x20+\x203\x20*\x20REF(H,\x2017)\x20+\x202\x20*\x20REF(H,\x2018)\x20+REF(H,\x2020))/\x20210,\x20COLORBLUE,\x20LINETHICK1;短低L:=\x20(20\x20*\x20L\x20+\x2019\x20*\x20REF(L,\x201)\x20+\x2018\x20*\x20REF(L,\x202)\x20+\x2017\x20*\x20REF(L,\x203)\x20+\x2016\x20*\x20REF(L,\x204)\x20+\x2015\x20*\x20REF(L,\x205)\x20+\x2014\x20*\x20REF(L,\x206)+\x2013\x20*\x20REF(L,\x207)\x20+\x2012\x20*\x20REF(L,\x208)\x20+\x2011\x20*\x20REF(L,\x209)\x20+\x2010\x20*\x20REF(L,\x2010)\x20+\x209\x20*\x20REF(L,\x2011)\x20+\x208\x20*\x20REF(L,\x2012)+\x207\x20*\x20REF(L,\x2013)\x20+\x206\x20*\x20REF(L,\x2014)\x20+\x205\x20*\x20REF(L,\x2015)\x20+\x204\x20*\x20REF(L,\x2016)\x20+\x203\x20*\x20REF(L,\x2017)\x20+\x202\x20*\x20REF(L,\x2018)\x20+REF(L,\x2020))\x20/\x20210,\x20COLORBLUE,\x20LINETHICK1;D90H:=\x20EMA(短高H,\x2090),\x20COLORRED,\x20LINETHICK1;D90L:=\x20EMA(短低L,\x2090),\x20COLORRED,\x20LINETHICK1;D90差:=\x20D90H\x20-\x20D90L;D90顶:=\x20D90H\x20+\x20D90差\x20*\x202,\x20COLORRED,\x20LINETHICK1;D90底:=\x20D90L\x20-\x20D90差\x20*\x202,\x20COLORRED,\x20LINETHICK1;高0:=\x20(EMA(EMA(H,\x2025),\x2025)\x20-\x20EMA(EMA(L,\x2025),\x2025))\x20*\x201\x20+\x20EMA(EMA(H,\x2025),\x2025),\x20LINETHICK1,\x20COLORWHITE;低0:=\x20EMA(EMA(L,\x2025),\x2025)\x20-\x20(EMA(EMA(H,\x2025),\x2025)\x20-\x20EMA(EMA(L,\x2025),\x2025))\x20*\x201,\x20LINETHICK1,\x20COLORWHITE;多头定位:=\x20低0\x20>=\x20D90底\x20AND\x20高0\x20>=\x20D90顶;空头定位:=\x20高0\x20<=\x20D90顶\x20AND\x20低0\x20<=\x20D90底;震荡定位:=\x20低0\x20>=\x20D90底\x20AND\x20高0\x20<=\x20D90顶;牛市:\x20IF(多头定位\x20==\x201,\x20100,\x201),\x20COLORRED,\x20NODRAW;熊市:\x20IF(空头定位\x20==\x201,\x20100,\x201),\x20COLORGREEN,\x20NODRAW;震荡:\x20IF(震荡定位\x20==\x201,\x20100,\x201),\x20COLORGRAY,\x20NODRAW;STICKLINE(多头定位\x20==\x201,\x20100,\x201,\x20100,\x200),\x20COLORRED;STICKLINE(空头定位\x20==\x201,\x20100,\x201,\x20100,\x200),\x20COLORGREEN;STICKLINE(震荡定位\x20==\x201,\x20100,\x201,\x20100,\x200),\x20COLORGRAY;\x22}},JSIndexScript.prototype.Zealink_Index3=function(){return{Name:\x22持仓信号\x22,Description:\x22持仓信号\x22,IsMainIndex:!0,Args:[],Script:\x27买线:=EMA(C,2);卖线:=EMA(SLOPE(C,30)*5+C,20);\x20BU:=CROSS(买线,卖线);SEL:=CROSS(卖线,买线);STICKLINE(买线>=卖线\x20AND\x20CLOSE>OPEN,LOW,HIGH,0,1),COLORRED;STICKLINE(买线>=卖线\x20AND\x20CLOSE<OPEN,LOW,HIGH,0,1),COLORRED;STICKLINE(买线>=卖线\x20AND\x20CLOSE>OPEN,CLOSE,OPEN,50,1),COLORRED;STICKLINE(买线>=卖线\x20AND\x20CLOSE<OPEN,CLOSE,OPEN,50,0),COLORRED;STICKLINE(买线<卖线\x20AND\x20CLOSE<OPEN,LOW,HIGH,0,1),COLORGREEN;STICKLINE(买线<卖线\x20AND\x20CLOSE>OPEN,LOW,HIGH,0,1),COLORGREEN;STICKLINE(买线<卖线\x20AND\x20CLOSE<OPEN,CLOSE,OPEN,50,0),COLORGREEN;STICKLINE(买线<卖线\x20AND\x20CLOSE>OPEN,CLOSE,OPEN,50,1),COLORGREEN;HHJSJDA:=(3*CLOSE+OPEN+LOW+HIGH)/6;HHJSJDB:(19*HHJSJDA+19*REF(HHJSJDA,1)+18*REF(HHJSJDA,2)+17*REF(HHJSJDA,3)+16*REF(HHJSJDA,4)+15*REF(HHJSJDA,5)+14*REF(HHJSJDA,6)+13*REF(HHJSJDA,7)+12*REF(HHJSJDA,8)+11*REF(HHJSJDA,9)+10*REF(HHJSJDA,10)+9*REF(HHJSJDA,11)+8*REF(HHJSJDA,12)+7*REF(HHJSJDA,13)+6*REF(HHJSJDA,14)+5*REF(HHJSJDA,15)+4*REF(HHJSJDA,16)+3*REF(HHJSJDA,17)+2*REF(HHJSJDA,20)+REF(HHJSJDA,19))/210,COLORYELLOW;HHJSJDC:MA(HHJSJDB,5),COLORRED;SVAR11:=HHV(HIGH,34);SVAR14:=CLOSE-REF(CLOSE,1);SVAR15:=MAX(SVAR14,0);SVAR16:=ABS(SVAR14);SVAR17:=SMA(SVAR15,7,1)/SMA(SVAR16,7,1)*100;SVAR18:=SMA(SVAR15,13,1)/SMA(SVAR16,13,1)*100;SVAR19:=BARSCOUNT(CLOSE);SVAR20:=SMA(MAX(SVAR14,0),6,1)/SMA(ABS(SVAR14),6,1)*100;SVAR21:=(-200)*(HHV(HIGH,60)-CLOSE)/(HHV(HIGH,60)-LLV(LOW,60))+100;SVAR1A:=(CLOSE-LLV(LOW,15))/(HHV(HIGH,15)-LLV(LOW,15))*100;SVAR1B:=SMA((SMA(SVAR1A,4,1)-50)*2,3,1);SVAR1C:=(INDEXC-LLV(INDEXL,14))/(HHV(INDEXH,14)-LLV(INDEXL,14))*100;SVAR1D:=SMA(SVAR1C,4,1);SVAR1E:=SMA(SVAR1D,3,1);SVAR1F:=(HHV(HIGH,30)-CLOSE)/CLOSE*100;SVAR22:=SVAR20<=25\x20AND\x20SVAR21<-95\x20AND\x20SVAR1F>20\x20AND\x20SVAR1B<-30\x20AND\x20SVAR1E<30\x20AND\x20SVAR11-CLOSE>=-0.25\x20AND\x20SVAR17<22\x20AND\x20SVAR18<28\x20AND\x20SVAR19>50;BUY3:=CROSS(SVAR22,0.5)\x20AND\x20COUNT(SVAR22==1,10)==1;SVARF:=LOW*0.9;SVAR10X:=100-3*SMA((OPEN-LLV(LOW,75))/(HHV(HIGH,75)-LLV(LOW,75))*100,20,1)+2*SMA(SMA((OPEN-LLV(LOW,75))/(HHV(HIGH,75)-LLV(LOW,75))*100,20,1),15,1);SVAR11X:=SVARF<REF(SVAR10X,1)\x20AND\x20VOL>REF(VOL,1)\x20AND\x20CLOSE>REF(CLOSE,1);BUY2:=SVAR11X\x20AND\x20COUNT(SVAR11X,30)==1;VAR1:=(CLOSE+HIGH+LOW+OPEN)/4;VAR2:=SUMBARS(VOL,CAPITAL);VAR3:=HHV(VAR1,VAR2);VAR4:=LLV(VAR1,VAR2);VAR5:=(2*VAR1-VAR4-REF(VAR4,1))/(VAR3-VAR4);VAR6:=(VAR1-VAR4)/(VAR3-VAR4);VAR7:=IF(VAR1<=VAR4,VAR5*60,VAR6*60);VAR8:=600*(EMA(CLOSE,3)-EMA(LOW,30))/EMA(LOW,30);VAR9:=EMA(VAR8,7);VARC:=HHV(HIGH,9)-LLV(LOW,9);VARD:=HHV(HIGH,9)-CLOSE;VARE:=CLOSE-LLV(LOW,9);VARF:=VARD/VARC*100-70;VAR10:=(CLOSE-LLV(LOW,60))/(HHV(HIGH,60)-LLV(LOW,60))*100;VAR11:=(2*CLOSE+HIGH+LOW)/4;VAR12:=SMA(VARE/VARC*100,3,1);VAR13:=LLV(LOW,34);VAR14:=SMA(VAR12,3,1)-SMA(VARF,9,1);VAR15:=IF(VAR14>100,VAR14-100,0);VAR16:=HHV(HIGH,34);VAR17:=EMA((VAR11-VAR13)/(VAR16-VAR13)*100,8);VAR18:=EMA(VAR17,5);BUY:=STICKLINE(VAR17-VAR18>0,VAR17,VAR18,8,1),COLORRED;SELL:=STICKLINE(VAR17-VAR18<0,VAR17,VAR18,8,1),COLORGREEN;BUY1:=VAR17>VAR18\x20AND\x20REF(VAR17,1)<REF(VAR18,1);SELL1:=VAR17<VAR18\x20AND\x20REF(VAR17,1)>REF(VAR18,1);短高H:=(20*H+19*REF(H,1)+18*REF(H,2)+17*REF(H,3)+16*REF(H,4)+15*REF(H,5)+14*REF(H,6)+13*REF(H,7)+12*REF(H,8)+11*REF(H,9)+10*REF(H,10)+9*REF(H,11)+8*REF(H,12)+7*REF(H,13)+6*REF(H,14)+5*REF(H,15)+4*REF(H,16)+3*REF(H,17)+2*REF(H,18)+REF(H,20))/210,COLORBLUE,LINETHICK1;短低L:=(20*L+19*REF(L,1)+18*REF(L,2)+17*REF(L,3)+16*REF(L,4)+15*REF(L,5)+14*REF(L,6)+13*REF(L,7)+12*REF(L,8)+11*REF(L,9)+10*REF(L,10)+9*REF(L,11)+8*REF(L,12)+7*REF(L,13)+6*REF(L,14)+5*REF(L,15)+4*REF(L,16)+3*REF(L,17)+2*REF(L,18)+REF(L,20))/210,COLORBLUE,LINETHICK1;D90H:=EMA(短高H,90),COLORRED,LINETHICK1;D90L:=EMA(短低L,90),COLORRED,LINETHICK1;D90差:=D90H-D90L;D90顶:=D90H+D90差*2,COLORRED,LINETHICK1;D90底:=D90L-D90差*2,COLORRED,LINETHICK1;高0:=(EMA(EMA(H,25),25)-EMA(EMA(L,25),25))*1+EMA(EMA(H,25),25),LINETHICK1,COLORWHITE;低0:=EMA(EMA(L,25),25)-(EMA(EMA(H,25),25)-EMA(EMA(L,25),25))*1,LINETHICK1,COLORWHITE;多头定位:=低0>=D90底\x20AND\x20高0>=D90顶;空头定位:=高0<=D90顶\x20AND\x20低0<=D90底;震荡定位:=低0>=D90底\x20AND\x20高0<=D90顶;牛市:=多头定位==1;熊市:=空头定位==1;震荡:=震荡定位==1;非牛市:=熊市\x20OR\x20震荡;非熊市:=牛市\x20OR\x20震荡;BUY11:=BUY1\x20AND\x20非熊市;SELL11:=SELL1\x20AND\x20震荡定位==0;BUY111:=BUY11\x20AND\x20COUNT(BUY11,10)<2;BUY0:=BUY111\x20AND\x20COUNT(BUY111,21)==1;SELL111:=SELL11\x20AND\x20COUNT(SELL11,10)<2;SELL0:=SELL111\x20AND\x20COUNT(SELL111,10)==1;XK1:=EMA(100*(CLOSE-LLV(LOW,34))/(HHV(HIGH,34)-LLV(LOW,34)),3)/4;上穿:=REF(XK1,1)<5\x20AND\x20XK1>=5;BUY4:=上穿\x20AND\x20COUNT(XK1<2,12)<1;SELL2:=REF(XK1,1)<=22.5\x20AND\x20XK1>22.5\x20AND\x20COUNT(REF(XK1,1)>=22.5\x20AND\x20XK1<22.5,5)>0;SELL3:=REF(XK1,1)>=21.5\x20AND\x20XK1<21.5\x20AND\x20COUNT(REF(XK1,1)>=22.5\x20AND\x20XK1<22.5,12)>1;SELL4:=SELL2\x20OR\x20SELL3\x20AND\x20COUNT((SELL2\x20OR\x20SELL3)==1,5)==1;SUPERDRAWTEXT(BUY0,L,\x22机会\x22,2,10),COLORRED;SUPERDRAWTEXT(SELL0,H,\x22风险\x22,1,10),COLORGREEN;SUPERDRAWTEXT(BUY2,L,\x22机会\x22,2,10),COLORRED;SUPERDRAWTEXT(BUY4,L,\x22机会\x22,2,10),COLORRED;SUPERDRAWTEXT(SELL4,H,\x22风险\x22,1,10),COLORGREEN;\x27}},JSIndexScript.prototype.Zealink_Index4=function(){return{Name:\x22股东实际增减持\x22,Description:\x22股东实际增减持\x22,IsMainIndex:!1,FloatPrecision:0,Args:[],Script:\x22增持:NEWS(4),NODRAW,COLORRED;减持:NEWS(5),NODRAW,COLORGREEN;STICKLINE(增持>0,0,增持,1,0),COLORRED;STICKLINE(减持<0,0,减持,1,0),COLORGREEN;\x22}},JSIndexScript.prototype.Zealink_Index5=function(){return{Name:\x22大宗交易\x22,Description:\x22大宗交易\x22,IsMainIndex:!1,FloatPrecision:0,Args:[],Script:\x22交易次数:NEWS(7);\x22}},JSIndexScript.prototype.Zealink_Index6=function(){return{Name:\x22信托持股\x22,Description:\x22信托持股\x22,IsMainIndex:!1,FloatPrecision:0,Args:[],Script:\x22家数:NEWS(6);\x22}},JSIndexScript.prototype.Zealink_Index7=function(){return{Name:\x22官网新闻\x22,Description:\x22官网新闻\x22,IsMainIndex:!1,FloatPrecision:0,Args:[],Script:\x22个数:NEWS(8);\x22}},JSIndexScript.prototype.Zealink_Index8=function(){return{Name:\x22高管要闻\x22,Description:\x22高管要闻\x22,IsMainIndex:!1,FloatPrecision:0,Args:[],Script:\x22个数:NEWS(9);\x22}},JSIndexScript.prototype.Zealink_Index9=function(){return{Name:\x22股权质押\x22,Description:\x22股权质押\x22,IsMainIndex:!1,FloatPrecision:0,Args:[],Script:\x22次数:NEWS(10);\x22}},JSIndexScript.prototype.Zealink_Index10=function(){return{Name:\x22操盘BS点\x22,Description:\x22操盘BS点\x22,IsMainIndex:!0,FloatPrecision:0,Args:[],Script:\x22JJ:=(CLOSE+HIGH+LOW)/3;\x20A:=EMA(JJ,10);\x20B:=REF(A,1);M1:=EMA(CLOSE,3);M2:=EMA(CLOSE,8);\x20M3:=EMA(M2,13);\x20M4:=EMA(M2,55);\x20B1:=A>B\x20AND\x20REF(A,1)<REF(B,1);S1:=A<B\x20AND\x20REF(A,1)>REF(B,1);INDEXCLOSE:INDEXC,EXDATA;INDEXOPEN:INDEXO,EXDATA;DRAWICON(REF(B1,1),L*0.97,13);DRAWICON(REF(S1,1),H*1.03,14);\x22}},JSIndexScript.prototype.Zealink_Index11=function(){return{Name:\x22操盘BS点\x22,Description:\x22操盘BS点\x22,IsMainIndex:!0,FloatPrecision:0,Args:[],Script:\x22JJ:=(CLOSE+HIGH+LOW)/3;A:=EMA(JJ,10);B:=REF(A,1);M1:=EMA(CLOSE,3);M2:=EMA(CLOSE,8);\x20M3:=EMA(M2,13);M4:=EMA(M2,55);持股区域:=STICKLINE(A>B,A,B,2,0),COLORYELLOW;\x20持币区域:=STICKLINE(A<B,A,B,2,0),COLORBLUE;VR1:=(C+O+REF(C,1))/3;VR3:=HHV(VR1,21);VR4:=LLV(VR1,21);VR5:=(2*VR1-VR4-REF(VR4,1))/(VR3-VR4);VR6:=(VR1-VR4)/(VR3-VR4);VR7:=IF(VR1<=VR4,VR5*60,VR6*60);VR8:=600*(EMA(C,3)-EMA(L,30))/EMA(L,30);VR9:=EMA(VR8,7);VRA:=(WINNER(120*C/100)-WINNER(100*C/100))*100;VRB:=(-100)*(WINNER(120*C/100)-WINNER(100*C/100))+5;VRC:=HHV(H,9)-LLV(L,9);VRD:=HHV(H,9)-C;VRE:=C-LLV(L,9);VRF:=VRD/VRC*100-70;VR10:=(C-LLV(L,60))/(HHV(H,60)-LLV(L,60))*100;VR11:=(2*C+H+L)/4;VR12:=SMA(VRE/VRC*100,3,1);VR13:=LLV(L,34);VR14:=SMA(VR12,3,1)-SMA(VRF,9,1);VR15:=IF(VR14>100,VR14-100,0);VR16:=HHV(H,34);VR17:=EMA((VR11-VR13)/(VR16-VR13)*100,8);VR18:=EMA(VR17,5);B1:=A>B\x20AND\x20REF(A,1)<REF(B,1);S1:=A<B\x20AND\x20REF(A,1)>REF(B,1);B9:=BARSLAST(REF(B1,1)\x20AND\x20(REF(VR17>VR18,1)\x20OR\x20MIN(VR17,VR18)>REF(MAX(VR17,VR18),1)));S9:=BARSLAST(REF(S1,1)\x20AND\x20(REF(VR17<VR18,1)\x20OR\x20MAX(VR17,VR18)<REF(MIN(VR17,VR18),1)));DRAWICON(REF(B1,1)\x20AND\x20(REF(VR17>VR18,1)\x20OR\x20MIN(VR17,VR18)>REF(MAX(VR17,VR18),1))\x20AND\x20REF(B9,2)>=S9,L*0.97,13);DRAWICON(REF(S1,1)\x20AND\x20(REF(VR17<VR18,1)\x20OR\x20MAX(VR17,VR18)<REF(MIN(VR17,VR18),1))\x20AND\x20REF(S9,1)>=B9,H*1.03,14);DRAWKLINE_IF(VR17>VR18,HIGH,CLOSE,LOW,OPEN),COLORRED;DRAWKLINE_IF(VR17<VR18,HIGH,CLOSE,LOW,OPEN),COLORBLUE;INDEXCLOSE:INDEXC,EXDATA;\x09\x09//取指数的收盘价\x20回测的时候计算BATE系数用\x20\x22}},JSIndexScript.prototype.HeikinAshi=function(){return{Name:\x22平均K线\x22,Description:\x22Heikin-Ashi\x20平均K线\x22,IsMainIndex:!0,KLineType:-1,Args:[],Script:\x22HCLOSE:(OPEN+HIGH+LOW+CLOSE)/4,\x20NODRAW;HOPEN:(REF(OPEN,1)+REF(CLOSE,1))/2,NODRAW;HHIGH:MAX(HIGH,MAX(HOPEN,HCLOSE)),NODRAW;HLOW:MIN(LOW,MIN(HOPEN,HCLOSE)),NODRAW;DRAWKLINE(HHIGH,HOPEN,HLOW,HCLOSE);\x22}},JSIndexScript.prototype.ADL=function(){return{Name:\x22腾落指标\x22,Description:\x22腾落指标\x22,IsMainIndex:!1,StringFormat:2,Condition:{Period:[CONDITION_PERIOD.KLINE_DAY_ID,CONDITION_PERIOD.KLINE_WEEK_ID,CONDITION_PERIOD.KLINE_TWOWEEK_ID,CONDITION_PERIOD.KLINE_MONTH_ID,CONDITION_PERIOD.KLINE_QUARTER_ID,CONDITION_PERIOD.KLINE_YEAR_ID],Include:[\x22000001.SH\x22,\x22000003.SH\x22,\x22000016.SH\x22,\x22000300.SH\x22,\x22000905.SH\x22,\x22399001.SZ\x22,\x22\x20399005.SZ\x22,\x22399006.SZ\x22]},Args:[{Name:\x22M\x22,Value:7}],Script:\x22ADL:SUM(ADVANCE-DECLINE,0);MAADL:MA(ADL,M);\x22}},JSIndexScript.prototype.EMPTY=function(){return{Name:\x22\x22,Description:\x22空指标\x22,IsMainIndex:!0,Args:[],Script:\x22VAR2:=C;\x22}},JSIndexScript.prototype.CJL=function(){return{Name:\x22CJL\x22,Description:\x22期货持仓量\x22,IsMainIndex:!1,Args:[],Script:\x22成交量:VOL,VOLSTICK;持仓量:VOLINSTK,LINEOVERLAY;\x22}},JSIndexScript.prototype.ASI=function(){return{Name:\x22ASI\x22,Description:\x22振动升降指标\x22,IsMainIndex:!1,Args:[{Name:\x22N1\x22,Value:6}],Script:\x22X_1:=REF(CLOSE,1);X_2:=ABS(HIGH-X_1);X_3:=ABS(LOW-X_1);X_4:=ABS(HIGH-REF(LOW,1));X_5:=ABS(X_1-REF(OPEN,1));X_6:=IF(X_2>X_3\x20AND\x20X_2>X_4,X_2+X_3/2+X_5/4,IF(X_3>X_4\x20AND\x20X_3>X_2,X_3+X_2/2+X_5/4,X_4+X_5/4));X_7:=CLOSE-X_1+(CLOSE-OPEN)/2+X_1-REF(OPEN,1);X_8:=8*X_7/X_6*MAX(X_2,X_3);ASI:SUM(X_8,0),LINETHICK2;MASI:MA(ASI,N1),LINETHICK2;\x22}},JSIndexScript.prototype.DC=function(){return{Name:\x22DC\x22,Description:\x22唐奇安通道\x22,IsMainIndex:!0,Args:[{Name:\x22N1\x22,Value:20}],Script:\x22UPPER:HHV(H,N1),COLORBLUE,LINETHICK2;LOWER:LLV(L,N1),COLORBLUE,LINETHICK2;MIDDLE:(UPPER+LOWER)/2,COLORRED,LINETHICK3;\x22}},JSIndexScript.prototype.DEMA=function(){return{Name:\x22DEMA\x22,Description:\x22双重指数移动均线\x22,IsMainIndex:!0,Args:[{Name:\x22N1\x22,Value:10}],Script:\x22ERR:=C-EMA(C,N1);DEMA:EMA(C,10)+EMA(ERR,N1);\x22}},JSIndexScript.prototype.VWAP=function(){return{Name:\x22VWAP\x22,Description:\x22成交量加权平均价\x22,IsMainIndex:!0,Args:[{Name:\x22N1\x22,Value:10}],Script:\x22PRICE:=(H+L+C)/3;T2:=VOL*PRICE;VWAP:SUM(T2,0)/SUM(VOL,0);\x22}},JSIndexScript.prototype.SQJZ=function(){return{Name:\x22SQJZ\x22,Description:\x22神奇九转\x22,IsMainIndex:!0,Script:\x22B:=C<REF(C,4);N:=CURRBARSCOUNT;B1:=(N=6\x20AND\x20REFXV(COUNT(B,6),5)=6)\x20OR\x20(N=7\x20AND\x20REFXV(COUNT(B,7),6)=7)\x20OR\x20(N=8\x20AND\x20REFXV(COUNT(B,8),7)=8)\x20OR\x20(N>=9\x20AND\x20REFXV(COUNT(B,9),8)=9);DRAWNUMBER(B1\x20AND\x20REF(B,1)=0,L,1),COLORMAGENTA;B2:=(N=5\x20AND\x20REFXV(COUNT(B,6),4)=6)\x20OR\x20(N=6\x20AND\x20REFXV(COUNT(B,7),5)=7)\x20OR\x20(N=7\x20AND\x20REFXV(COUNT(B,8),6)=8)\x20OR\x20(N>=8\x20AND\x20REFXV(COUNT(B,9),7)=9);DRAWNUMBER(B2\x20AND\x20REF(B,2)=0,L,2),COLORMAGENTA;B8:=(N=1\x20AND\x20COUNT(B,8)=8)\x20OR\x20(N>=2\x20AND\x20REFXV(COUNT(B,9),1)=9);DRAWNUMBER(B8\x20AND\x20REF(B,8)=0,L,8),COLORMAGENTA;B9:=(N>=1\x20AND\x20COUNT(B,9)=9);DRAWNUMBER(B9\x20AND\x20REF(B,9)=0,L,9),COLORBROWN;S:=C>REF(C,4);S1:=(N=6\x20AND\x20REFXV(COUNT(S,6),5)=6)\x20OR\x20(N=7\x20AND\x20REFXV(COUNT(S,7),6)=7)\x20OR\x20(N=8\x20AND\x20REFXV(COUNT(S,8),7)=8)\x20OR\x20(N>=9\x20AND\x20REFXV(COUNT(S,9),8)=9);DRAWNUMBER(S1\x20AND\x20REF(S,1)=0,H,1),COLORMAGENTA,DRAWABOVE;S2:=(N=5\x20AND\x20REFXV(COUNT(S,6),4)=6)\x20OR\x20(N=6\x20AND\x20REFXV(COUNT(S,7),5)=7)\x20OR\x20(N=7\x20AND\x20REFXV(COUNT(S,8),6)=8)\x20OR\x20(N>=8\x20AND\x20REFXV(COUNT(S,9),7)=9);DRAWNUMBER(S2\x20AND\x20REF(S,2)=0,H,2),COLORMAGENTA,DRAWABOVE;S8:=(N=1\x20AND\x20COUNT(S,8)=8)\x20OR\x20(N>=2\x20AND\x20REFXV(COUNT(S,9),1)=9);DRAWNUMBER(S8\x20AND\x20REF(S,8)=0,H,8),COLORMAGENTA,DRAWABOVE;S9:=(N>=1\x20AND\x20COUNT(S,9)=9);DRAWNUMBER(S9\x20AND\x20REF(S,9)=0,H,9),COLORGREEN,DRAWABOVE;\x22}},JSIndexScript.prototype.XT=function(){return{Name:\x22XT\x22,Description:\x22箱体\x22,IsMainIndex:!0,Args:[{Name:\x22N\x22,Value:10}],Script:\x22【箱顶】:PEAK(CLOSE,N,1)*0.98;【箱底】:TROUGH(CLOSE,N,1)*1.02;【箱高】:100*(【箱顶】-【箱底】)/【箱底】,NODRAW;\x22}},JSIndexScript.prototype.CFJT=function(){return{Name:\x22CFJT\x22,Description:\x22财富阶梯\x22,IsMainIndex:!0,Script:\x22突破:=REF(EMA(C,14),1);A1X:=(EMA(C,10)-突破)/突破*100;多方:=IF(A1X>=0,REF(EMA(C,10),BARSLAST(CROSS(A1X,0))+1),DRAWNULL);空方:=IF(A1X<0,REF(EMA(C,10),BARSLAST(CROSS(0,A1X))+1),DRAWNULL);STICKLINE(A1X>=0,多方,突破,110,0),COLORRED;STICKLINE(A1X<0,空方,突破,110,0),COLORGREEN;\x22}},JSIndexScript.prototype.CYX=function(){return{Name:\x22CYX\x22,Description:\x22撑压线\x22,IsMainIndex:!0,Args:[{Name:\x22N\x22,Value:7}],Script:\x22Z1:=STRCAT(HYBLOCK,\x27\x20\x27);Z2:=STRCAT(Z1,DYBLOCK);Z3:=STRCAT(Z2,\x27\x20\x27);DRAWTEXT_FIX(ISLASTBAR,0,0,0,STRCAT(Z3,GNBLOCK)),COLOR00C0C0;A1:=REF(H,N)=HHV(H,2*N+1);B1:=FILTER(A1,N);C1:=BACKSET(B1,N+1);D1:=FILTER(C1,N);A2:=REF(L,N)=LLV(L,2*N+1);B2:=FILTER(A2,N);C2:=BACKSET(B2,N+1);D2:=FILTER(C2,N);E1:=(REF(LLV(L,2*N),1)+REF(HHV(H,2*N),1))/2;E2:=(H+L)/2;H1:=(D1\x20AND\x20NOT(D2\x20AND\x20E1>=E2))\x20OR\x20ISLASTBAR\x20OR\x20BARSCOUNT(C)=1;L1:=(D2\x20AND\x20NOT(D1\x20AND\x20E1<E2));H2:=D1\x20AND\x20NOT(D2\x20AND\x20E1>=E2);X1:=REF(BARSLAST(H1),1)+1;F1:=BACKSET(H1\x20AND\x20COUNT(L1,X1)>0,LLVBARS(IF(L1,L,10000),X1));G1:=F1>REF(F1,1);I1:=BACKSET(G1,2);LD:=I1>REF(I1,1);L2:=LD\x20OR\x20ISLASTBAR\x20OR\x20BARSCOUNT(C)=1;X2:=REF(BARSLAST(L2),1)+1;F2:=BACKSET(L2\x20AND\x20COUNT(H2,X2)>0,HHVBARS(IF(H2,H,0),X2));G2:=F2>REF(F2,1);I2:=BACKSET(G2,2);HD:=I2>REF(I2,1);R1:=BACKSET(ISLASTBAR,BARSLAST(HD)+1);S1:=R1>REF(R1,1);T1:=BACKSET(ISLASTBAR,BARSLAST(LD)+1);U1:=T1>REF(T1,1);R2:=BACKSET(S1,REF(BARSLAST(HD),1)+2);S2:=R2>REF(R2,1);T2:=BACKSET(U1,REF(BARSLAST(LD),1)+2);U2:=T2>REF(T2,1);DRAWLINE(S2,H,S1,H,1),LINETHICK2,COLORRED;DRAWLINE(U2,L,U1,L,1),LINETHICK2,COLORGREEN;\x22}},JSIndexScript.prototype.WAVE=function(){return{Name:\x22WAVE\x22,Description:\x22波浪分析\x22,IsMainIndex:!0,Args:[{Name:\x22N\x22,Value:5}],Script:\x22ZIG(3,N);\x22}},JSIndexScript.prototype.TEST=function(){return{Name:\x22TEST\x22,Description:\x22测试脚本\x22,IsMainIndex:!1,Args:[{Name:\x22N\x22,Value:10}],Script:\x22DRAWCHANNEL(OPEN>C,H,L,\x20\x27RGB(255,94,102)\x27,\x202\x20,\x275,5\x27,\x27RGBA(58,20,62,0.3)\x27\x20);\x22}};var\x20debug=!1;function\x20oldChart(e,t){for(var\x20a=-1,r=0;r<e.OldPaint.length;r++)e.OldPaint[r].Name==t.Name&&(a=r);return!(a<0)&&e.OldPaint[a]}function\x20mylog(){debug&&console.log.apply(console,arguments)}if(!JSConsole)var\x20JSConsole={Chart:{Log:mylog},Complier:{Log:mylog}};var\x20g_JSComplierResource={Domain:\x22https://opensource.zealink.com\x22,CacheDomain:\x22https://opensourcecache.zealink.com\x22,DrawIcon:{Family:\x22iconfont\x22,Data:new\x20Map([[1,{Text:\x22\x22,Color:\x22rgb(255,106,106)\x22}],[2,{Text:\x22\x22,Color:\x22rgb(46,139,87)\x22}],[11,{Text:\x22\x22,Color:\x22rgb(245,159,40)\x22}],[12,{Text:\x22\x22,Color:\x22rgb(245,159,40)\x22}],[13,{Text:\x22\x22,Color:\x22rgb(209,37,35)\x22}],[14,{Text:\x22\x22,Color:\x22rgb(127,209,59)\x22}],[9,{Text:\x22\x22,Color:\x22rgb(245,159,40)\x22}],[36,{Text:\x22\x22,Color:\x22rgb(255,106,106)\x22}],[37,{Text:\x22\x22,Color:\x22rgb(46,139,87)\x22}],[38,{Text:\x22\x22,Color:\x22rgb(238,44,44)\x22}],[39,{Text:\x22\x22,Color:\x22rgb(0,139,69)\x22}],[46,{Text:\x22\x22,Color:\x22rgb(51,51,51)\x22}]])},CustomDrawIcon:{Data:new\x20Map},CustomFunction:{Data:new\x20Map},CustomVariant:{Data:new\x20Map},GetDrawIcon:function(e){if(g_JSComplierResource.CustomDrawIcon.Data.has(e)){const\x20t=g_JSComplierResource.CustomDrawIcon.Data.get(e);return{Symbol:t.Text,Color:t.Color,Family:t.Family,IconFont:!0,ID:e}}if(g_JSComplierResource.DrawIcon.Data.has(e)){const\x20t=g_JSComplierResource.DrawIcon.Data.get(e);return{Symbol:t.Text,Color:t.Color,Family:g_JSComplierResource.DrawIcon.Family,IconFont:!0,ID:e}}return\x20null},GetDrawTextIcon:function(e){return\x20new\x20Map([[1,{Symbol:\x22↑\x22,Color:\x22rgb(238,44,44)\x22}],[2,{Symbol:\x22↓\x22,Color:\x22rgb(0,139,69)\x22}],[3,{Symbol:\x22😧\x22}],[4,{Symbol:\x22😨\x22}],[5,{Symbol:\x22😁\x22}],[6,{Symbol:\x22😱\x22}],[7,{Symbol:\x22B\x22,Color:\x22rgb(238,44,44)\x22}],[8,{Symbol:\x22S\x22,Color:\x22rgb(0,139,69)\x22}],[9,{Symbol:\x22💰\x22}],[10,{Symbol:\x22📪\x22}],[11,{Symbol:\x22👆\x22}],[12,{Symbol:\x22👇\x22}],[13,{Symbol:\x22B\x22,Color:\x22rgb(178,34,34)\x22}],[14,{Symbol:\x22S\x22,Color:\x22rgb(0,139,69)\x22}],[36,{Symbol:\x22Χ\x22,Color:\x22rgb(238,44,44)\x22}],[37,{Symbol:\x22X\x22,Color:\x22rgb(0,139,69)\x22}],[38,{Symbol:\x22▲\x22,Color:\x22rgb(238,44,44)\x22}],[39,{Symbol:\x22▼\x22,Color:\x22rgb(0,139,69)\x22}],[40,{Symbol:\x22◉\x22,Color:\x22rgb(238,44,44)\x22}],[41,{Symbol:\x22◈\x22,Color:\x22rgb(238,44,44)\x22}],[42,{Symbol:\x22📌\x22}],[43,{Symbol:\x22💎\x22}],[44,{Symbol:\x22🥇\x22}],[45,{Symbol:\x22🥈\x22}],[46,{Symbol:\x22🥉\x22}],[47,{Symbol:\x22🏅\x22}]]).get(e)},IsCustomFunction:function(e){return!!g_JSComplierResource.CustomFunction.Data.has(e)},IsCustomVariant:function(e){return!!g_JSComplierResource.CustomVariant.Data.has(e)}},Messages={BadGetterArity:\x22Getter\x20must\x20not\x20have\x20any\x20formal\x20parameters\x22,BadSetterArity:\x22Setter\x20must\x20have\x20exactly\x20one\x20formal\x20parameter\x22,BadSetterRestParameter:\x22Setter\x20function\x20argument\x20must\x20not\x20be\x20a\x20rest\x20parameter\x22,ConstructorIsAsync:\x22Class\x20constructor\x20may\x20not\x20be\x20an\x20async\x20method\x22,ConstructorSpecialMethod:\x22Class\x20constructor\x20may\x20not\x20be\x20an\x20accessor\x22,DeclarationMissingInitializer:\x22Missing\x20initializer\x20in\x20%0\x20declaration\x22,DefaultRestParameter:\x22Unexpected\x20token\x20=\x22,DuplicateBinding:\x22Duplicate\x20binding\x20%0\x22,DuplicateConstructor:\x22A\x20class\x20may\x20only\x20have\x20one\x20constructor\x22,DuplicateProtoProperty:\x22Duplicate\x20__proto__\x20fields\x20are\x20not\x20allowed\x20in\x20object\x20literals\x22,ForInOfLoopInitializer:\x22%0\x20loop\x20variable\x20declaration\x20may\x20not\x20have\x20an\x20initializer\x22,GeneratorInLegacyContext:\x22Generator\x20declarations\x20are\x20not\x20allowed\x20in\x20legacy\x20contexts\x22,IllegalBreak:\x22Illegal\x20break\x20statement\x22,IllegalContinue:\x22Illegal\x20continue\x20statement\x22,IllegalExportDeclaration:\x22Unexpected\x20token\x22,IllegalImportDeclaration:\x22Unexpected\x20token\x22,IllegalLanguageModeDirective:\x22Illegal\x20\x27use\x20strict\x27\x20directive\x20in\x20function\x20with\x20non-simple\x20parameter\x20list\x22,IllegalReturn:\x22Illegal\x20return\x20statement\x22,InvalidEscapedReservedWord:\x22Keyword\x20must\x20not\x20contain\x20escaped\x20characters\x22,InvalidHexEscapeSequence:\x22Invalid\x20hexadecimal\x20escape\x20sequence\x22,InvalidLHSInAssignment:\x22Invalid\x20left-hand\x20side\x20in\x20assignment\x22,InvalidLHSInForIn:\x22Invalid\x20left-hand\x20side\x20in\x20for-in\x22,InvalidLHSInForLoop:\x22Invalid\x20left-hand\x20side\x20in\x20for-loop\x22,InvalidModuleSpecifier:\x22Unexpected\x20token\x22,InvalidRegExp:\x22Invalid\x20regular\x20expression\x22,LetInLexicalBinding:\x22let\x20is\x20disallowed\x20as\x20a\x20lexically\x20bound\x20name\x22,MissingFromClause:\x22Unexpected\x20token\x22,MultipleDefaultsInSwitch:\x22More\x20than\x20one\x20default\x20clause\x20in\x20switch\x20statement\x22,NewlineAfterThrow:\x22Illegal\x20newline\x20after\x20throw\x22,NoAsAfterImportNamespace:\x22Unexpected\x20token\x22,NoCatchOrFinally:\x22Missing\x20catch\x20or\x20finally\x20after\x20try\x22,ParameterAfterRestParameter:\x22Rest\x20parameter\x20must\x20be\x20last\x20formal\x20parameter\x22,Redeclaration:\x22%0\x20\x27%1\x27\x20has\x20already\x20been\x20declared\x22,StaticPrototype:\x22Classes\x20may\x20not\x20have\x20static\x20property\x20named\x20prototype\x22,StrictCatchVariable:\x22Catch\x20variable\x20may\x20not\x20be\x20eval\x20or\x20arguments\x20in\x20strict\x20mode\x22,StrictDelete:\x22Delete\x20of\x20an\x20unqualified\x20identifier\x20in\x20strict\x20mode.\x22,StrictFunction:\x22In\x20strict\x20mode\x20code,\x20functions\x20can\x20only\x20be\x20declared\x20at\x20top\x20level\x20or\x20inside\x20a\x20block\x22,StrictFunctionName:\x22Function\x20name\x20may\x20not\x20be\x20eval\x20or\x20arguments\x20in\x20strict\x20mode\x22,StrictLHSAssignment:\x22Assignment\x20to\x20eval\x20or\x20arguments\x20is\x20not\x20allowed\x20in\x20strict\x20mode\x22,StrictLHSPostfix:\x22Postfix\x20increment/decrement\x20may\x20not\x20have\x20eval\x20or\x20arguments\x20operand\x20in\x20strict\x20mode\x22,StrictLHSPrefix:\x22Prefix\x20increment/decrement\x20may\x20not\x20have\x20eval\x20or\x20arguments\x20operand\x20in\x20strict\x20mode\x22,StrictModeWith:\x22Strict\x20mode\x20code\x20may\x20not\x20include\x20a\x20with\x20statement\x22,StrictOctalLiteral:\x22Octal\x20literals\x20are\x20not\x20allowed\x20in\x20strict\x20mode.\x22,StrictParamDupe:\x22Strict\x20mode\x20function\x20may\x20not\x20have\x20duplicate\x20parameter\x20names\x22,StrictParamName:\x22Parameter\x20name\x20eval\x20or\x20arguments\x20is\x20not\x20allowed\x20in\x20strict\x20mode\x22,StrictReservedWord:\x22Use\x20of\x20future\x20reserved\x20word\x20in\x20strict\x20mode\x22,StrictVarName:\x22Variable\x20name\x20may\x20not\x20be\x20eval\x20or\x20arguments\x20in\x20strict\x20mode\x22,TemplateOctalLiteral:\x22Octal\x20literals\x20are\x20not\x20allowed\x20in\x20template\x20strings.\x22,UnexpectedEOS:\x22Unexpected\x20end\x20of\x20input\x22,UnexpectedIdentifier:\x22Unexpected\x20identifier\x22,UnexpectedNumber:\x22Unexpected\x20number\x22,UnexpectedReserved:\x22Unexpected\x20reserved\x20word\x22,UnexpectedString:\x22Unexpected\x20string\x22,UnexpectedTemplate:\x22Unexpected\x20quasi\x20%0\x22,UnexpectedToken:\x22Unexpected\x20token\x20%0\x22,UnexpectedTokenIllegal:\x22Unexpected\x20token\x20ILLEGAL\x22,UnknownLabel:\x22Undefined\x20label\x20\x27%0\x27\x22,UnterminatedRegExp:\x22Invalid\x20regular\x20expression:\x20missing\x20/\x22},Regex={NonAsciiIdentifierStart:/[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞭꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]|�[�-��-��-����-��-��-��-��-��-��-��-��-��-��-��-��-�]|�[�-��-��-��-��-��-�]|�[�-���-�����-��-��-��-����-��-��-�����-��-��-��-��-��-��-��-��-��-��-�]|�[�-��-��-�]|�[�-��-��-��-��-���-��-����-��-��-���-��-��-��-��-����-��-����-����-�]|�[�-�����-��-��-���-��-�]|�[�-���-�]|�[�-�]|�[�-��-�]|[��-��-��-�][�-�]|�[�-�]|�[�-�]|�[�-��-��-��-��-��-��-�]|�[�-���-�]|�[��]|�[�-��-��-��-�]|�[�-��-�������-��-���-��-��-��-��-��-��-��-���-��-��-��-��-��-��-��-��-��-��-��-��-�]|�[�-�]|�[�-��-������-��-��������-�������������-��-��-��-���-��-��-��-��-�]|�[�-��-�]|�[�-��-�]|�[�-��-�]|�[�-�]|�[�-�]/,NonAsciiIdentifierPart:/[ªµ·ºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽͿΆ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԯԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠ-ࢴࣣ-ॣ०-९ॱ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ૹଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఀ-ఃఅ-ఌఎ-ఐఒ-నప-హఽ-ౄె-ైొ-్ౕౖౘ-ౚౠ-ౣ౦-౯ಁ-ಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲഁ-ഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൟ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟ෦-෯ෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟፩-፱ᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤞᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧚ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧ᪰-᪽ᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶ᳸᳹ᴀ-᷵᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞭꞰ-ꞷꟷ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻꣽ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꧠ-ꧾꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︯︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]|�[�-��-��-����-��-��-��-���-��-���-��-��-��-��-��-��-�]|�[�-��-��-��-��-��-��-�]|�[�-���-�����-��-��-��-����-��-��-����-����-��-��-��-���-��-��-��-��-��-��-��-�]|�[�-��-��-�]|�[�-��-��-��-��-��-��-��-���-��-��-���-��-��-���-��-��-��-��-��-��-����-��-����-��-����-����-��-��-�]|�[�-���-��-��-��-��-���-��-��-��-��-��-�]|�[�-���-�]|�[�-�]|�[�-��-�]|[��-��-��-�][�-�]|�[�-�]|�[�-�]|�[�-��-��-��-��-��-��-��-��-��-�]|�[�-��-��-�]|�[��]|�[�-��-��-��-���]|�[�-��-��-��-��-��-�]|�[�-��-�������-��-���-��-��-��-��-��-��-��-���-��-��-��-��-��-��-��-��-��-��-��-��-��-�]|�[�-��-����-��-�]|�[�-��-�]|�[�-��-������-��-��������-�������������-��-��-��-���-��-��-��-��-�]|�[�-��-�]|�[�-��-�]|�[�-��-�]|�[�-�]|�[�-�]|�[�-�]/},Character={FromCodePoint:function(e){return\x20e<65536?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10))+String.fromCharCode(56320+(e-65536&1023))},IsWhiteSpace:function(e){return\x2032===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0},IsLineTerminator:function(e){return\x2010===e||13===e||8232===e||8233===e},IsIdentifierStart:function(e){return\x2036===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||12304===e||12305===e||e>=128&&Regex.NonAsciiIdentifierStart.test(Character.FromCodePoint(e))},IsIdentifierPart:function(e){return\x2036===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||35===e||12304===e||12305===e||e>=128&&Regex.NonAsciiIdentifierPart.test(Character.FromCodePoint(e))},IsDecimalDigit:function(e){return\x20e>=48&&e<=57},IsHexDigit:function(e){return\x20e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102},isOctalDigit:function(e){return\x20e>=48&&e<=55}},TOKEN_NAME={};function\x20JSComplierHelper(){}function\x20ErrorHandler(){this.Error=[],this.RecordError=function(e){this.Error.push(e)},this.ConstructError=function(e,t){let\x20a=new\x20Error(e);try{throw\x20a}catch(e){Object.create&&Object.defineProperties&&((a=Object.create(e)).Column=t)}return\x20a},this.CreateError=function(e,t,a,r,i){let\x20n=\x22Line\x20\x22+t+\x22:\x20\x22+r,s=this.ConstructError(n,a);return\x20s.Index=e,s.LineNumber=t,s.Description=r,s.Word=i,s},this.ThrowError=function(e,t,a,r,i){throw\x20this.CreateError(e,t,a,r,i)},this.ThrowDownloadJob=function(e,t,a,r,i){let\x20n=this.CreateError(e,t,a,r);throw\x20n.Job=i,n}}function\x20Scanner(e,t){this.Source=e,this.ErrorHandler=t,this.Length=e.length,this.Index=0,this.LineNumber=e.length>0?1:0,this.LineStart=0,this.CurlyStack=[],this.SaveState=function(){return{Index:this.Index,LineNumber:this.LineNumber,LineStart:this.LineStart}},this.RestoreState=function(e){this.Index=e.Index,this.LineNumber=e.LineNumber,this.LineStart=e.LineStart},this.IsEOF=function(){return\x20this.Index>=this.Length},this.IsKeyword=function(e){return!1},this.CodePointAt=function(e){let\x20t=this.Source.charCodeAt(e);if(t>=55296&&t<=56319){let\x20a=this.Source.charCodeAt(e+1);if(a>=56320&&a<=57343)t=1024*(t-55296)+a-56320+65536}return\x20t},this.Lex=function(){if(this.IsEOF())return{Type:2,Value:\x22\x22,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:this.Index,End:this.Index};let\x20e=this.Source.charCodeAt(this.Index);return\x20Character.IsIdentifierStart(e)?this.ScanIdentifier():40===e||41===e||59===e?this.ScanPunctuator():39===e||34===e?this.ScanStringLiteral():46==e?Character.IsDecimalDigit(this.Source.charCodeAt(this.Index+1))?this.ScanNumericLiteral():this.ScanPunctuator():Character.IsDecimalDigit(e)?this.ScanNumericLiteral():e>=55296&&e<57343&&Character.IsIdentifierStart(this.CodePointAt(this.Index))?this.ScanIdentifier():this.ScanPunctuator()},this.ScanIdentifier=function(){let\x20e,t=this.Index,a=92===this.Source.charCodeAt(t)?this.GetComplexIdentifier():this.GetIdentifier();if(3!=(e=a.length?3:this.IsKeyword(a)?4:null==a?5:\x22true\x22==a||\x22false\x22==a?1:3)&&t+a.length!=this.Index){this.Index;throw\x20this.Index=t,Messages.InvalidEscapedReservedWord}return\x22AND\x22!=a&&\x22OR\x22!=a||(e=7),{Type:e,Value:a,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:t,End:this.Index}},this.GetIdentifier=function(){let\x20e=this.Index++;for(;!this.IsEOF();){let\x20t=this.Source.charCodeAt(this.Index);if(92==t)return\x20this.Index=e,this.GetComplexIdentifier();if(t>=55296&&t<57343)return\x20this.Index=e,this.GetComplexIdentifier();if(!Character.IsIdentifierPart(t))break;++this.Index}return\x20this.Source.slice(e,this.Index)},this.ScanPunctuator=function(){let\x20e=this.Index,t=this.Source[this.Index];switch(t){case\x22(\x22:++this.Index;break;case\x22)\x22:case\x22;\x22:case\x22,\x22:case\x22.\x22:++this.Index;break;default:\x22AND\x22==(t=this.Source.substr(this.Index,3))?this.Index+=3:\x22&&\x22===(t=this.Source.substr(this.Index,2))||\x22||\x22===t||\x22==\x22===t||\x22!=\x22===t||\x22<=\x22===t||\x22>=\x22===t||\x22=>\x22===t||\x22:=\x22==t||\x22OR\x22==t||\x22<>\x22==t?this.Index+=2:(t=this.Source[this.Index],\x22<>=!+-*%&|^/:\x22.indexOf(t)>=0&&++this.Index)}return\x20this.Index==e&&this.ThrowUnecpectedToken(),{Type:7,Value:t,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:e,End:this.Index}},this.ScanStringLiteral=function(){let\x20e=this.Index,t=this.Source[this.Index];++this.Index;let\x20a=\x22\x22;for(;!this.IsEOF();){let\x20e=this.Source[this.Index++];if(e==t){t=\x22\x22;break}if(\x22\x22==e)throw\x22not\x20complete\x22;if(Character.IsLineTerminator(e.charCodeAt(0)))break;a+=e}return\x22\x22!=t&&(this.Index=e,this.ThrowUnecpectedToken()),{Type:8,Value:a,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:e,End:this.Index}},this.ScanNumericLiteral=function(){let\x20e=this.Index,t=this.Source[this.Index],a=\x22\x22;if(\x22.\x22!=t){if(a=this.Source[this.Index++],t=this.Source[this.Index],\x220\x22==a&&(\x22x\x22==t||\x22X\x22==t))return++this.Index,this.ScanHexLiteral(e);for(;Character.IsDecimalDigit(this.Source.charCodeAt(this.Index));)a+=this.Source[this.Index++];t=this.Source[this.Index]}if(\x22.\x22==t){for(a+=this.Source[this.Index++];Character.IsDecimalDigit(this.Source.charCodeAt(this.Index));)a+=this.Source[this.Index++];t=this.Source[this.Index]}if(\x22e\x22==t||\x22E\x22==t)if(a+=this.Source[this.Index++],\x22+\x22!=(t=this.Source[this.Index])&&\x22-\x22!=t||(a+=this.Source[this.Index]),Character.IsDecimalDigit(this.Source.charCodeAt(this.Index)))for(;Character.IsDecimalDigit(this.Source.charCodeAt(this.Index));)a+=this.Source[this.Index++];else\x20this.ThrowUnecpectedToken();return\x20Character.IsIdentifierStart(this.Source.charCodeAt(this.Index))&&this.ThrowUnecpectedToken(),{Type:6,Value:parseFloat(a),LineNumber:this.LineNumber,LineStart:this.LineStart,Start:e,End:this.Index}},this.ScanComments=function(){let\x20e=0==this.Index;for(;!this.IsEOF();){let\x20t=this.Source.charCodeAt(this.Index);if(Character.IsWhiteSpace(t))++this.Index;else\x20if(Character.IsLineTerminator(t))++this.Index,13==t&&10==this.Source.charCodeAt(this.Index)&&++this.Index,++this.LineNumber,this.LineStart=this.Index,e=!0;else\x20if(47==t){if(47!=(t=this.Source.charCodeAt(this.Index+1)))break;this.Index+=2;this.SkipSingleLineComment(2);e=!0}else{if(123!=t)break;this.Index+=1;this.SkipMultiLineComment()}}},this.SkipMultiLineComment=function(){for(var\x20e=[];!this.IsEOF();){var\x20t=this.Source.charCodeAt(this.Index);if(Character.IsLineTerminator(t))++this.LineNumber,++this.Index,this.LineStart=this.Index;else{if(125==t)return\x20this.Index+=1,e;++this.Index}}return\x20e},this.SkipSingleLineComment=function(e){let\x20t=[];for(;!this.IsEOF();){let\x20e=this.Source.charCodeAt(this.Index);if(++this.Index,Character.IsLineTerminator(e))return\x2013===e&&10===this.Source.charCodeAt(this.Index)&&++this.Index,++this.LineNumber,this.LineStart=this.Index,t}return\x20t},this.ThrowUnecpectedToken=function(e,t){return\x20e||(e=Messages.UnexpectedTokenIllegal),this.ErrorHandler.ThrowError(this.Index,this.LineNumber,this.Index-this.LineStart+1,e,t)}}function\x20Tokenizer(e){this.ErrorHandler=new\x20ErrorHandler,this.Scanner=new\x20Scanner(e,this.ErrorHandler),this.Buffer=[],this.GetNextToken=function(){if(0==this.Buffer.length){this.Scanner.ScanComments();if(!this.Scanner.IsEOF()){let\x20e=this.Scanner.Lex(),t={Type:TOKEN_NAME[e.Type],Value:this.Scanner.Source.slice(e.Start,e.End)};this.Buffer.push(t)}}return\x20this.Buffer.shift()}}TOKEN_NAME[1]=\x22Boolean\x22,TOKEN_NAME[2]=\x22<end>\x22,TOKEN_NAME[3]=\x22Identifier\x22,TOKEN_NAME[4]=\x22Keyword\x22,TOKEN_NAME[5]=\x22Null\x22,TOKEN_NAME[6]=\x22Numeric\x22,TOKEN_NAME[7]=\x22Punctuator\x22,TOKEN_NAME[8]=\x22String\x22,TOKEN_NAME[9]=\x22RegularExpression\x22,TOKEN_NAME[10]=\x22Template\x22,JSComplierHelper.GetPeriodInfo=function(e){const\x20t=[{Name:\x22MIN1\x22,Period:4,Order:1},{Name:\x22MIN5\x22,Period:5,Order:2},{Name:\x22MIN15\x22,Period:6,Order:3},{Name:\x22MIN30\x22,Period:7,Order:4},{Name:\x22MIN60\x22,Period:8,Order:5},{Name:\x22DAY\x22,Period:0,Order:1e3},{Name:\x22WEEK\x22,Period:1,Order:1001},{Name:\x22MONTH\x22,Period:2,Order:1002},{Name:\x22SEASON\x22,Period:9,Order:1003},{Name:\x22YEAR\x22,Period:3,Order:1004}];if(e.Name){for(var\x20a\x20in\x20t)if(e.Name&&t[a].Name==e.Name)return\x20t[a];return\x20null}if(IFrameSplitOperator.IsNumber(e.PeriodID)){for(var\x20a\x20in\x20t)if(t[a].Period==e.PeriodID)return\x20t[a];return\x20null}return\x20null},JSComplierHelper.GetConvertValueName=function(e){var\x20t;return\x22COVER_C\x22==e?t=\x22CLOSE\x22:\x22COVER_O\x22==e?t=\x22OPEN\x22:\x22COVER_H\x22==e?t=\x22HIGH\x22:\x22COVER_L\x22==e?t=\x22LOW\x22:\x22COVER_A\x22==e?t=\x22AMOUNT\x22:\x22COVER_V\x22==e&&(t=\x22VOL\x22),t};var\x20Syntax={AssignmentExpression:\x22AssignmentExpression\x22,AssignmentPattern:\x22AssignmentPattern\x22,ArrayExpression:\x22ArrayExpression\x22,ArrayPattern:\x22ArrayPattern\x22,ArrowFunctionExpression:\x22ArrowFunctionExpression\x22,AwaitExpression:\x22AwaitExpression\x22,BlockStatement:\x22BlockStatement\x22,BinaryExpression:\x22BinaryExpression\x22,BreakStatement:\x22BreakStatement\x22,CallExpression:\x22CallExpression\x22,CatchClause:\x22CatchClause\x22,ClassBody:\x22ClassBody\x22,ClassDeclaration:\x22ClassDeclaration\x22,ClassExpression:\x22ClassExpression\x22,ConditionalExpression:\x22ConditionalExpression\x22,ContinueStatement:\x22ContinueStatement\x22,DoWhileStatement:\x22DoWhileStatement\x22,DebuggerStatement:\x22DebuggerStatement\x22,EmptyStatement:\x22EmptyStatement\x22,ExportAllDeclaration:\x22ExportAllDeclaration\x22,ExportDefaultDeclaration:\x22ExportDefaultDeclaration\x22,ExportNamedDeclaration:\x22ExportNamedDeclaration\x22,ExportSpecifier:\x22ExportSpecifier\x22,ExpressionStatement:\x22ExpressionStatement\x22,ForStatement:\x22ForStatement\x22,ForOfStatement:\x22ForOfStatement\x22,ForInStatement:\x22ForInStatement\x22,FunctionDeclaration:\x22FunctionDeclaration\x22,FunctionExpression:\x22FunctionExpression\x22,Identifier:\x22Identifier\x22,IfStatement:\x22IfStatement\x22,ImportDeclaration:\x22ImportDeclaration\x22,ImportDefaultSpecifier:\x22ImportDefaultSpecifier\x22,ImportNamespaceSpecifier:\x22ImportNamespaceSpecifier\x22,ImportSpecifier:\x22ImportSpecifier\x22,Literal:\x22Literal\x22,LabeledStatement:\x22LabeledStatement\x22,LogicalExpression:\x22LogicalExpression\x22,MemberExpression:\x22MemberExpression\x22,MetaProperty:\x22MetaProperty\x22,MethodDefinition:\x22MethodDefinition\x22,NewExpression:\x22NewExpression\x22,ObjectExpression:\x22ObjectExpression\x22,ObjectPattern:\x22ObjectPattern\x22,Program:\x22Program\x22,Property:\x22Property\x22,RestElement:\x22RestElement\x22,ReturnStatement:\x22ReturnStatement\x22,SequenceExpression:\x22SequenceExpression\x22,SpreadElement:\x22SpreadElement\x22,Super:\x22Super\x22,SwitchCase:\x22SwitchCase\x22,SwitchStatement:\x22SwitchStatement\x22,TaggedTemplateExpression:\x22TaggedTemplateExpression\x22,TemplateElement:\x22TemplateElement\x22,TemplateLiteral:\x22TemplateLiteral\x22,ThisExpression:\x22ThisExpression\x22,ThrowStatement:\x22ThrowStatement\x22,TryStatement:\x22TryStatement\x22,UnaryExpression:\x22UnaryExpression\x22,UpdateExpression:\x22UpdateExpression\x22,VariableDeclaration:\x22VariableDeclaration\x22,VariableDeclarator:\x22VariableDeclarator\x22,WhileStatement:\x22WhileStatement\x22,WithStatement:\x22WithStatement\x22,YieldExpression:\x22YieldExpression\x22};function\x20Node(e){this.IsNeedIndexData=!1,this.IsNeedLatestIndexData=!1,this.IsNeedLatestData=!1,this.IsNeedSymbolData=!1,this.IsNeedMarginData=new\x20Set,this.IsNeedNewsAnalysisData=new\x20Set,this.NeedBlockIncreaseData=[],this.IsNeedSymbolExData=new\x20Set,this.NeedHK2SHSZData=[],this.IsNeedSectionFinance=new\x20Map,this.FunctionData=[],this.IsAPIData=[],this.ExecuteIndex=[],this.OtherSymbolData=[],this.PeriodSymbolData=[],this.ErrorHandler=e,this.GetDataJobList=function(){let\x20e=[];for(var\x20t\x20in\x20this.IsNeedSymbolData&&e.push({ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SYMBOL_DATA}),this.IsNeedIndexData&&e.push({ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_INDEX_DATA}),this.IsNeedLatestData&&e.push({ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SYMBOL_LATEST_DATA}),this.IsNeedLatestIndexData&&e.push({ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_LATEST_INDEX_DATA}),this.NeedBlockIncreaseData)e.push(this.NeedBlockIncreaseData[t]);for(var\x20a\x20of\x20this.IsNeedMarginData)e.push({ID:a});for(var\x20t\x20in\x20this.NeedHK2SHSZData)e.push(this.NeedHK2SHSZData[t]);for(var\x20a\x20of\x20this.IsNeedNewsAnalysisData)e.push({ID:a});for(var\x20a\x20of\x20this.IsNeedSymbolExData)e.push({ID:a});for(var\x20r\x20of\x20this.IsNeedSectionFinance)e.push({ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_SF,SF:r});for(var\x20t\x20in\x20this.IsAPIData){r=this.IsAPIData[t];e.push(r)}for(var\x20t\x20in\x20this.ExecuteIndex){r=this.ExecuteIndex[t];e.push(r)}for(var\x20t\x20in\x20this.OtherSymbolData){r=this.OtherSymbolData[t];e.push(r)}for(var\x20t\x20in\x20this.PeriodSymbolData){r=this.PeriodSymbolData[t];e.push(r)}for(var\x20t\x20in\x20this.FunctionData){r=this.FunctionData[t];e.push(r)}return\x20e},this.VerifySymbolVariable=function(e,t){if(new\x20Set([\x22INDEXA\x22,\x22INDEXC\x22,\x22INDEXH\x22,\x22INDEXL\x22,\x22INDEXO\x22,\x22INDEXV\x22,\x22INDEXDEC\x22,\x22INDEXADV\x22]).has(e))this.IsNeedIndexData=!0;else\x20if(new\x20Set([\x22CLOSE\x22,\x22C\x22,\x22VOL\x22,\x22V\x22,\x22OPEN\x22,\x22O\x22,\x22HIGH\x22,\x22H\x22,\x22LOW\x22,\x22L\x22,\x22AMOUNT\x22,\x22AMO\x22,\x22VOLINSTK\x22]).has(e))this.IsNeedSymbolData=!0;else{if(\x22VOLR\x22===e&&(this.IsNeedSymbolExData.has(JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_VOLR_DATA)||this.IsNeedSymbolExData.add(JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_VOLR_DATA)),\x22HYBLOCK\x22!=e&&\x22DYBLOCK\x22!=e&&\x22GNBLOCK\x22!=e||this.IsNeedSymbolExData.has(JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_GROUP_DATA)||this.IsNeedSymbolExData.add(JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_GROUP_DATA),new\x20Set([\x22CAPITAL\x22,\x22TOTALCAPITAL\x22,\x22EXCHANGE\x22]).has(e)){var\x20a={ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_VARIANT,VariantName:e};return\x20t&&(a.Token={Index:t.Start,Line:t.LineNumber}),void\x20this.FunctionData.push(a)}if(\x22FROMOPEN\x22!=e){if(\x22ADVANCE\x22==e||\x22DECLINE\x22==e){a={ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_INDEX_INCREASE_DATA,IsSelfSymbol:!0,FunctionName:e};return\x20t&&(a.Token={Index:t.Start,Line:t.LineNumber}),void\x20this.NeedBlockIncreaseData.push(a)}if(e.indexOf(\x22#\x22)>0){var\x20r=e.split(\x22#\x22);if(2!=r.length){var\x20i=`${e},\x20跨周期语法错误,\x20变量名#周期`;this.ThrowUnexpectedToken(t,i)}else{if([\x22C\x22,\x22CLOSE\x22,\x22O\x22,\x22OPEN\x22,\x22H\x22,\x22HIGH\x22,\x22L\x22,\x22LOW\x22,\x22AMOUNT\x22,\x22AMO\x22,\x22VOL\x22,\x22V\x22,\x22VOLINSTK\x22].indexOf(r[0])<0){i=`${e},\x20跨周期语法错误,\x20数据只支持\x27OPEN,HIGH,LOW,CLOSE,VOL,AMOUNT,VOLINSTK\x27`;this.ThrowUnexpectedToken(t,i)}if([\x22MIN1\x22,\x22MIN5\x22,\x22MIN15\x22,\x22MIN30\x22,\x22MIN60\x22,\x22DAY\x22,\x22WEEK\x22,\x22MONTH\x22,\x22SEASON\x22,\x22YEAR\x22].indexOf(r[1])<0){i=`${e},\x20跨周期语法错误，\x20周期只支持\x27MIN1,MIN5,MIN15,MIN30,MIN60,DAY,WEEK,MONTH,SEASON,YEAR\x27`;this.ThrowUnexpectedToken(t,i)}a={ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SYMBOL_PERIOD_DATA,VarName:e,ValueName:r[0],PeriodName:r[1]};t&&(a.Token={Index:t.Start,Line:t.LineNumber}),this.PeriodSymbolData.push(a)}}else\x20if(g_JSComplierResource.IsCustomVariant(e)){a={VariantName:e,ID:JS_EXECUTE_JOB_ID.JOB_CUSTOM_VARIANT_DATA};return\x20t&&(a.Token={Index:t.Start,Line:t.LineNumber}),void\x20this.FunctionData.push(a)}}else\x20this.IsNeedLatestIndexData=!0}},this.VerifySymbolLiteral=function(e,t){if(IFrameSplitOperator.IsString(e)&&e.indexOf(\x22$\x22)>0){if(2!=e.split(\x22$\x22).length)return;var\x20a={Literal:e,ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_OTHER_SYMBOL_DATA};t&&(a.Token={Index:t.Start,Line:t.LineNumber}),this.OtherSymbolData.push(a)}},this.VerifySymbolFunction=function(e,t,a){if(g_JSComplierResource.IsCustomFunction(e.Name)){var\x20r={FunctionName:e.Name,ID:JS_EXECUTE_JOB_ID.JOB_CUSTOM_FUNCTION_DATA,Args:t};return\x20a&&(r.Token={Index:a.Start,Line:a.LineNumber}),void\x20this.FunctionData.push(r)}if(\x22DYNAINFO\x22==e.Name)return\x20void(this.IsNeedLatestData=!0);if(\x22FINANCE\x22==e.Name){r={ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_FINANCE,Args:t,FunctionName:e.Name};return\x20a&&(r.Token={Index:a.Start,Line:a.LineNumber}),void\x20this.FunctionData.push(r)}if(\x22FINVALUE\x22==e.Name){r={ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_FINVALUE,Args:t,FunctionName:e.Name};return\x20a&&(r.Token={Index:a.Start,Line:a.LineNumber}),void\x20this.FunctionData.push(r)}if(\x22FINONE\x22==e.Name){r={ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_FINONE,Args:t,FunctionName:e.Name};return\x20a&&(r.Token={Index:a.Start,Line:a.LineNumber}),void\x20this.FunctionData.push(r)}if(\x22GPJYVALUE\x22==e.Name){r={ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_GPJYVALUE,Args:t,FunctionName:e.Name};return\x20a&&(r.Token={Index:a.Start,Line:a.LineNumber}),void\x20this.FunctionData.push(r)}if(\x22MARGIN\x22===e.Name){let\x20e=JS_EXECUTE_JOB_ID.GetMarginJobID(t[0].Value);return\x20void(e&&!this.IsNeedMarginData.has(e)&&this.IsNeedMarginData.add(e))}if(\x22NEWS\x22===e.Name){let\x20e=JS_EXECUTE_JOB_ID.GetNewsAnalysisID(t[0].Value);return\x20void(e&&!this.IsNeedNewsAnalysisData.has(e)&&this.IsNeedNewsAnalysisData.add(e))}if(\x22HK2SHSZ\x22===e.Name){r={ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_HK_TO_SHSZ,Args:t,FunctionName:e.Name};return\x20a&&(r.Token={Index:a.Start,Line:a.LineNumber}),void\x20this.NeedHK2SHSZData.push(r)}if(\x22COST\x22==e.Name||\x22WINNER\x22==e.Name||\x22PPART\x22==e.Name||\x22COSTEX\x22==e.Name||\x22LWINNER\x22==e.Name||\x22PWINNER\x22==e.Name){r={ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_FINANCE,Args:[7],FunctionName:\x22FINANCE\x22,FunctionName2:e.Name};return\x20a&&(r.Token={Index:a.Start,Line:a.LineNumber}),void\x20this.FunctionData.push(r)}if(\x22BETA\x22===e.Name)return\x20void(this.IsNeedIndexData=!0);if(\x22UPCOUNT\x22==e.Name||\x22DOWNCOUNT\x22==e.Name){r={ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_INDEX_INCREASE_DATA,Args:t,FunctionName:e.Name};return\x20a&&(r.Token={Index:a.Start,Line:a.LineNumber}),void\x20this.NeedBlockIncreaseData.push(r)}if(\x22STKINDI\x22==e.Name){r={ID:JS_EXECUTE_JOB_ID.JOB_EXECUTE_INDEX,Args:t,FunctionName:e.Name};return\x20a&&(r.Token={Index:a.Start,Line:a.LineNumber}),void\x20this.ExecuteIndex.push(r)}if(\x22COVER_C\x22==e.Name||\x22COVER_O\x22==e.Name||\x22COVER_H\x22==e.Name||\x22COVER_L\x22==e.Name||\x22COVER_A\x22==e.Name||\x22COVER_V\x22==e.Name){var\x20i=t[0].Value;if([\x22MIN1\x22,\x22MIN5\x22,\x22MIN15\x22,\x22MIN30\x22,\x22MIN60\x22,\x22DAY\x22,\x22WEEK\x22,\x22MONTH\x22,\x22SEASON\x22,\x22YEAR\x22].indexOf(i)<0){var\x20n=`${e.Name},\x20跨周期函数错误，\x20周期只支持\x27MIN1,MIN5,MIN15,MIN30,MIN60,DAY,WEEK,MONTH,SEASON,YEAR\x27`;this.ThrowUnexpectedToken(a,n)}var\x20s=JSComplierHelper.GetConvertValueName(e.Name);r={ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SYMBOL_PERIOD_DATA,FunctionName:e.Name,ValueName:s,PeriodName:i};return\x20a&&(r.Token={Index:a.Start,Line:a.LineNumber}),void\x20this.PeriodSymbolData.push(r)}if(\x22SF\x22==e.Name){let\x20e=JS_EXECUTE_JOB_ID.GetSectionReportPeriod(t[0].Value,t[1].Value);if(!e)return;let\x20a=JS_EXECUTE_JOB_ID.GetSectionFinanceID(t[2].Value);if(!a)return;var\x20u=e.Year+\x22-\x22+e.Quarter;if(this.IsNeedSectionFinance.has(u)){(o=this.IsNeedSectionFinance.get(u)).Fields.has(a)||o.Fields.add(a)}else{var\x20o={Period:e,Fields:new\x20Set([a])};this.IsNeedSectionFinance.set(u,o)}return}if(\x22LOADAPIDATA\x22==e.Name){r={Name:e.Name,ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_CUSTOM_API_DATA,Args:t};return\x20a&&(r.Token={Index:a.Start,Line:a.LineNumber}),void\x20this.IsAPIData.push(r)}if(new\x20Set([\x22CLOSE\x22,\x22C\x22,\x22VOL\x22,\x22V\x22,\x22OPEN\x22,\x22O\x22,\x22HIGH\x22,\x22H\x22,\x22LOW\x22,\x22L\x22,\x22AMOUNT\x22,\x22AMO\x22,\x22VOLINSTK\x22]).has(e.Name)){r={Name:e.Name,ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_OTHER_SYMBOL_DATA,Args:t};return\x20a&&(r.Token={Index:a.Start,Line:a.LineNumber}),void\x20this.OtherSymbolData.push(r)}},this.ExpressionStatement=function(e){return{Type:Syntax.ExpressionStatement,Expression:e}},this.Script=function(e){return{Type:Syntax.Program,Body:e,SourceType:\x22通达信脚本\x22}},this.SequenceExpression=function(e){return{Type:Syntax.SequenceExpression,Expression:e}},this.BinaryExpression=function(e,t,a){return{Type:\x22||\x22===e||\x22&&\x22===e||\x22AND\x22==e||\x22OR\x22==e?Syntax.LogicalExpression:Syntax.BinaryExpression,Operator:e,Left:t,Right:a}},this.Literal=function(e,t,a){return\x20this.VerifySymbolLiteral(e,a),{Type:Syntax.Literal,Value:e,Raw:t}},this.Identifier=function(e,t){return\x20this.VerifySymbolVariable(e,t),{Type:Syntax.Identifier,Name:e}},this.AssignmentExpression=function(e,t,a){return{Type:Syntax.AssignmentExpression,Operator:e,Left:t,Right:a}},this.UnaryExpression=function(e,t){return{Type:Syntax.UnaryExpression,Operator:e,Argument:t,Prefix:!0}},this.EmptyStatement=function(){return{Type:Syntax.EmptyStatement}},this.CallExpression=function(e,t,a){return\x20this.VerifySymbolFunction(e,t,a),{Type:Syntax.CallExpression,Callee:e,Arguments:t}},this.StaticMemberExpression=function(e,t){return{Type:Syntax.MemberExpression,Computed:!1,Object:e,Property:t}},this.Directive=function(e,t){return{Type:Syntax.ExpressionStatement,Expression:e,Directive:t}},this.ThrowUnexpectedToken=function(e,t){throw\x20this.UnexpectedTokenError(e,t)},this.UnexpectedTokenError=function(e,t){let\x20a=t||Messages.UnexpectedToken,r=\x22ILLEGAL\x22;if(e&&(r=e.Value),a=a.replace(\x22%0\x22,r),e&&\x22number\x22==typeof\x20e.LineNumber){let\x20t=e.Start,r=e.LineNumber,i=-1;return\x20this.ErrorHandler.CreateError(t,r,i,a)}}}function\x20JSParser(e){this.ErrorHandler=new\x20ErrorHandler,this.Scanner=new\x20Scanner(e,this.ErrorHandler),this.Node=new\x20Node(this.ErrorHandler),this.LookAhead={Type:2,Value:\x22\x22,LineNumber:this.Scanner.LineNumber,LineStart:0,Start:0,End:0},this.HasLineTerminator=!1,this.Context={IsModule:!1,await:!1,allowIn:!0,allowStrictDirective:!0,allowYield:!0,FirstCoverInitializedNameError:null,IsAssignmentTarget:!1,IsBindingElement:!1,InFunctionBody:!1,inIteration:!1,inSwitch:!1,labelSet:{},Strict:!1},this.PeratorPrecedence={\x22)\x22:0,\x22;\x22:0,\x22,\x22:0,\x22]\x22:0,\x22||\x22:1,OR:1,\x22&&\x22:2,AND:2,\x22|\x22:3,\x22^\x22:4,\x22&\x22:5,\x22==\x22:6,\x22=\x22:6,\x22!=\x22:6,\x22<>\x22:6,\x22===\x22:6,\x22!==\x22:6,\x22<\x22:7,\x22>\x22:7,\x22<=\x22:7,\x22>=\x22:7,\x22<<\x22:8,\x22>>\x22:8,\x22>>>\x22:8,\x22+\x22:9,\x22-\x22:9,\x22*\x22:11,\x22/\x22:11,\x22%\x22:11},this.StartMarker={Index:0,Line:this.Scanner.LineNumber,Column:0},this.LastMarker={Index:0,Line:this.Scanner.LineNumber,Column:0},this.Initialize=function(){this.NextToken(),this.LastMarker={Index:this.Scanner.Index,Line:this.Scanner.LineNumber,Column:this.Scanner.Index-this.Scanner.LineStart}},this.CreateNode=function(){return{Index:this.StartMarker.Index,Line:this.StartMarker.Line,Column:this.StartMarker.Column}},this.StartNode=function(e,t){null==t&&(t=0);let\x20a=e.Start-e.LineStart,r=e.LineNumber;return\x20a<0&&(a+=t,r--),{Index:e.Start,Line:r,Column:a}},this.Match=function(e){return\x207==this.LookAhead.Type&&this.LookAhead.Value==e},this.Expect=function(e){let\x20t=this.NextToken();7==t.Type&&t.Value==e||this.ThrowUnexpectedToken(t)},this.MatchAssign=function(){if(7!=this.LookAhead.Type)return!1;let\x20e=this.LookAhead.Value;return\x22:\x22==e||\x22:=\x22==e},this.GetTokenRaw=function(e){return\x20this.Scanner.Source.slice(e.Start,e.End)},this.NextToken=function(){let\x20e=this.LookAhead;this.LastMarker.Index=this.Scanner.Index,this.LastMarker.Line=this.Scanner.LineNumber,this.LastMarker.Column=this.Scanner.Index-this.Scanner.LineStart,this.CollectComments(),this.Scanner.Index!==this.StartMarker.Index&&(this.StartMarker.Index=this.Scanner.Index,this.StartMarker.Line=this.Scanner.LineNumber,this.StartMarker.Column=this.Scanner.Index-this.Scanner.LineStart);let\x20t=this.Scanner.Lex();return\x20this.HasLineTerminator=e.LineNumber!=t.LineNumber,t&&this.Context.Strict&&t.Type,this.LookAhead=t,e},this.CollectComments=function(){this.Scanner.ScanComments()},this.ParseScript=function(){let\x20e=this.CreateNode(),t=this.ParseDirectivePrologues();for(;2!=this.LookAhead.Type;)t.push(this.ParseStatementListItem());return\x20this.Finalize(e,this.Node.Script(t))},this.ParseDirective=function(){let\x20e=this.LookAhead,t=this.CreateNode(),a=this.ParseExpression(),r=a.Type===Syntax.Literal?this.GetTokenRaw(e).slice(1,-1):null;return\x20this.ConsumeSemicolon(),this.Finalize(t,r?this.Node.Directive(a,r):this.Node.ExpressionStatement(a))},this.ParseDirectivePrologues=function(){let\x20e=[];for(;;){if(8!=this.LookAhead.Type)break;let\x20t=this.ParseDirective();e.push(t)}return\x20e},this.ParseStatementListItem=function(){let\x20e;return\x20this.Context.IsAssignmentTarget=!0,this.Context.IsBindingElement=!0,4==this.LookAhead.Type||(e=this.ParseStatement()),e},this.ParseStatement=function(){let\x20e;switch(this.LookAhead.Type){case\x201:case\x205:case\x206:case\x208:case\x2010:case\x209:e=this.ParseExpressionStatement();break;case\x207:let\x20t=this.LookAhead.Value;e=\x22(\x22===t?this.ParseExpressionStatement():\x22;\x22===t?this.ParseEmptyStatement():this.ParseExpressionStatement();break;case\x203:e=this.ParseLabelledStatement();break;case\x204:break;default:e=\x22error\x22}return\x20e},this.ParseEmptyStatement=function(){let\x20e=this.CreateNode();return\x20this.Expect(\x22;\x22),this.Finalize(e,this.Node.EmptyStatement())},this.ParseLabelledStatement=function(){let\x20e=this.CreateNode(),t=this.ParseExpression();this.ConsumeSemicolon();let\x20a=new\x20this.Node.ExpressionStatement(t);return\x20this.Finalize(e,a)},this.ParseExpression=function(){let\x20e=this.LookAhead,t=this.IsolateCoverGrammar(this.ParseAssignmentExpression);if(this.Match(\x22,\x22)){let\x20a=[];for(a.push(t);2!=this.LookAhead.Type&&this.Match(\x22,\x22);)this.NextToken(),a.push(this.IsolateCoverGrammar(this.ParseAssignmentExpression));t=this.Finalize(this.StartNode(e),this.Node.SequenceExpression(a))}return\x20t},this.ParseAssignmentExpression=function(){let\x20e,t=this.LookAhead,a=t;if(e=this.ParseConditionalExpression(),this.MatchAssign()){if(!this.Context.IsAssignmentTarget){let\x20t=e.Marker;this.ThrowUnexpectedError(t.Index,t.Line,t.Column,Messages.InvalidLHSInAssignment)}this.Match(\x22=\x22)||this.Match(\x22:\x22)?this.ReinterpretExpressionAsPattern(e):(this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1);let\x20r=(a=this.NextToken()).Value,i=this.IsolateCoverGrammar(this.ParseAssignmentExpression);e=this.Finalize(this.StartNode(t),this.Node.AssignmentExpression(r,e,i)),this.Context.FirstCoverInitializedNameError=null}return\x20e},this.ParseConditionalExpression=function(){this.LookAhead;return\x20this.InheritCoverGrammar(this.ParseBinaryExpression)},this.ParseBinaryExpression=function(){let\x20e=this.LookAhead,t=this.InheritCoverGrammar(this.ParseExponentiationExpression),a=this.LookAhead;var\x20r=this.BinaryPrecedence(a);if(r>0){this.NextToken(),this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1;let\x20i=[e,this.LookAhead],n=t,s=this.IsolateCoverGrammar(this.ParseExponentiationExpression),u=[n,a.Value,s],o=[r];for(;!((r=this.BinaryPrecedence(this.LookAhead))<=0);){for(;u.length>2&&r<=o[o.length-1];){s=u.pop();let\x20e=u.pop();o.pop(),n=u.pop(),i.pop();let\x20t=this.StartNode(i[i.length-1]);u.push(this.Finalize(t,this.Node.BinaryExpression(e,n,s)))}u.push(this.NextToken().Value),o.push(r),i.push(this.LookAhead),u.push(this.IsolateCoverGrammar(this.ParseExponentiationExpression))}let\x20l=u.length-1;t=u[l];let\x20D=i.pop();for(;l>1;){let\x20e=i.pop(),a=D&&D.LineStart,r=this.StartNode(e,a),n=u[l-1];t=this.Finalize(r,this.Node.BinaryExpression(n,u[l-2],t)),l-=2,D=e}}return\x20t},this.ParseExponentiationExpression=function(){this.LookAhead;return\x20this.InheritCoverGrammar(this.ParseUnaryExpression)},this.ParseUnaryExpression=function(){let\x20e;if(this.Match(\x22+\x22)||this.Match(\x22-\x22)){let\x20t=this.StartNode(this.LookAhead),a=this.NextToken();e=this.InheritCoverGrammar(this.ParseUnaryExpression),e=this.Finalize(t,this.Node.UnaryExpression(a.Value,e)),this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1}else\x20e=this.ParseUpdateExpression();return\x20e},this.ParseUpdateExpression=function(){let\x20e;this.LookAhead;return\x20e=this.InheritCoverGrammar(this.ParseLeftHandSideExpressionAllowCall)},this.ParseLeftHandSideExpressionAllowCall=function(){let\x20e,t=this.LookAhead;for(e=this.InheritCoverGrammar(this.ParsePrimaryExpression);;)if(this.Match(\x22.\x22)){this.Context.IsBindingElement=!1,this.Context.IsAssignmentTarget=!0,this.Expect(\x22.\x22);const\x20a=this.ParseIdentifierName();e=this.Finalize(this.StartNode(t),this.Node.StaticMemberExpression(e,a))}else{if(!this.Match(\x22(\x22))break;this.Context.IsBindingElement=!1,this.Context.IsAssignmentTarget=!1;var\x20a=this.ParseArguments();e=this.Finalize(this.StartNode(t),this.Node.CallExpression(e,a,t))}return\x20e},this.IsIdentifierName=function(e){return\x203===e.Type||4===e.Type||1===e.Type||5===e.Type},this.ParseIdentifierName=function(){const\x20e=this.CreateNode(),t=this.NextToken();return\x20this.IsIdentifierName(t)||this.ThrowUnexpectedToken(t),this.Finalize(e,this.Node.Identifier(t.Value,t))},this.ParseArguments=function(){this.Expect(\x22(\x22);var\x20e=[];if(!this.Match(\x22)\x22))for(;;){let\x20t=this.IsolateCoverGrammar(this.ParseAssignmentExpression);if(e.push(t),this.Match(\x22)\x22))break;if(this.ExpectCommaSeparator(),this.Match(\x22)\x22))break}return\x20this.Expect(\x22)\x22),e},this.ExpectCommaSeparator=function(){this.Expect(\x22,\x22)},this.ParsePrimaryExpression=function(){let\x20e,t=this.CreateNode();var\x20a,r;switch(this.LookAhead.Type){case\x203:a=this.NextToken(),e=this.Finalize(t,this.Node.Identifier(a.Value,a));break;case\x206:case\x208:this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1,a=this.NextToken(),r=this.GetTokenRaw(a),e=this.Finalize(t,this.Node.Literal(a.Value,r,a));break;case\x207:switch(this.LookAhead.Value){case\x22(\x22:this.Context.IsBindingElement=!1,e=this.InheritCoverGrammar(this.ParseGroupExpression);break;default:e=this.ThrowUnexpectedToken(this.NextToken())}break;default:e=this.ThrowUnexpectedToken(this.NextToken())}return\x20e},this.ParseGroupExpression=function(){let\x20e;if(this.Expect(\x22(\x22),this.Match(\x22)\x22))this.NextToken();else{this.LookAhead;let\x20t=!1;if(this.Context.IsBindingElement=!0,e=this.InheritCoverGrammar(this.ParseAssignmentExpression),this.Match(\x22,\x22)){let\x20t=[];for(this.Context.IsAssignmentTarget=!1,t.push(e);2!=this.LookAhead.Type&&this.Match(\x22,\x22);)this.NextToken(),this.Match(\x22)\x22)}t||(this.Expect(\x22)\x22),this.Context.IsBindingElement=!1)}return\x20e},this.ParseExpressionStatement=function(){let\x20e=this.CreateNode(),t=this.ParseExpression();return\x20this.ConsumeSemicolon(),this.Finalize(e,this.Node.ExpressionStatement(t))},this.ConsumeSemicolon=function(){this.Match(\x22;\x22)?this.NextToken():this.HasLineTerminator||(this.LastMarker.Index=this.StartMarker.Index,this.LastMarker.Line=this.StartMarker.Line,this.LastMarker.Column=this.StartMarker.Column)},this.ReinterpretExpressionAsPattern=function(e){switch(e.Type){case\x20Syntax.Identifier:case\x20Syntax.MemberExpression:case\x20Syntax.AssignmentExpression:}},this.Finalize=function(e,t){return\x20t.Marker={Line:e.Line,Column:e.Column,Index:e.Index},t},this.BinaryPrecedence=function(e){let\x20t,a=e.Value;return\x20t=7===e.Type&&this.PeratorPrecedence[a]||0},this.IsolateCoverGrammar=function(e){let\x20t=this.Context.IsBindingElement,a=this.Context.IsAssignmentTarget,r=this.Context.FirstCoverInitializedNameError;this.Context.IsBindingElement=!0,this.Context.IsAssignmentTarget=!0,this.Context.FirstCoverInitializedNameError=null;let\x20i=e.call(this);return\x20this.Context.FirstCoverInitializedNameError,this.Context.IsBindingElement=t,this.Context.IsAssignmentTarget=a,this.Context.FirstCoverInitializedNameError=r,i},this.InheritCoverGrammar=function(e){let\x20t=this.Context.IsBindingElement,a=this.Context.IsAssignmentTarget,r=this.Context.FirstCoverInitializedNameError;this.Context.IsBindingElement=!0,this.Context.IsAssignmentTarget=!0,this.Context.FirstCoverInitializedNameError=null;let\x20i=e.call(this);return\x20this.Context.IsBindingElement=this.Context.IsBindingElement&&t,this.Context.IsAssignmentTarget=this.Context.IsAssignmentTarget&&a,this.Context.FirstCoverInitializedNameError=r||this.Context.FirstCoverInitializedNameError,i},this.ThrowUnexpectedToken=function(e,t){throw\x20this.UnexpectedTokenError(e,t)},this.ThrowUnexpectedError=function(e,t,a,r){let\x20i=r||\x22执行异常\x22;return\x20this.ErrorHandler.ThrowError(e,t,a,i)},this.UnexpectedTokenError=function(e,t){let\x20a=t||Messages.UnexpectedToken,r=\x22ILLEGAL\x22;if(e&&(r=e.Value),a=a.replace(\x22%0\x22,r),e&&\x22number\x22==typeof\x20e.LineNumber){let\x20t=e.Start,r=e.LineNumber,i=this.LastMarker.Index-this.LastMarker.Column,n=e.Start-i+1;return\x20this.ErrorHandler.CreateError(t,r,n,a)}{let\x20e=this.LastMarker.Index,t=this.LastMarker.Line,r=this.LastMarker.Column+1;return\x20this.ErrorHandler.CreateError(e,t,r,a)}}}function\x20JSAlgorithm(e,t){this.ErrorHandler=e,this.SymbolData=t,this.Add=function(e,t){let\x20a=\x22number\x22==typeof\x20e,r=\x22number\x22==typeof\x20t;if(a&&r)return\x20e+t;let\x20i,n,s=[];if(!a&&!r){let\x20a=Math.max(e.length,t.length);for(var\x20u=0;u<a;++u)s[u]=null,u<e.length&&u<t.length&&this.IsNumber(e[u])&&this.IsNumber(t[u])&&(s[u]=e[u]+t[u]);return\x20s}for(var\x20u\x20in\x20a?(i=e,n=t):(i=t,n=e),n)s[u]=null,this.IsNumber(n[u])&&this.IsNumber(i)&&(s[u]=i+n[u]);return\x20s},this.Subtract=function(e,t){let\x20a=\x22number\x22==typeof\x20e,r=\x22number\x22==typeof\x20t;if(a&&r)return\x20e-t;let\x20i=[];if(!a&&!r){let\x20a=Math.max(e.length,t.length);for(var\x20n=0;n<a;++n)i[n]=null,n<e.length&&n<t.length&&this.IsNumber(e[n])&&this.IsNumber(t[n])&&(i[n]=e[n]-t[n]);return\x20i}if(a)for(var\x20n\x20in\x20t)i[n]=null,this.IsNumber(e)&&this.IsNumber(t[n])&&(i[n]=e-t[n]);else\x20for(var\x20n\x20in\x20e)i[n]=null,this.IsNumber(e[n])&&this.IsNumber(t)&&(i[n]=e[n]-t);return\x20i},this.Multiply=function(e,t){let\x20a=\x22number\x22==typeof\x20e,r=\x22number\x22==typeof\x20t;if(a&&r)return\x20e*t;let\x20i,n,s=[];if(!a&&!r){let\x20a=Math.max(e.length,t.length);for(var\x20u=0;u<a;++u)s[u]=null,u<e.length&&u<t.length&&this.IsNumber(e[u])&&this.IsNumber(t[u])&&(s[u]=e[u]*t[u]);return\x20s}for(var\x20u\x20in\x20a?(i=e,n=t):(i=t,n=e),n)s[u]=null,this.IsNumber(n[u])&&this.IsNumber(i)&&(s[u]=i*n[u]);return\x20s},this.Divide=function(e,t){let\x20a=\x22number\x22==typeof\x20e,r=\x22number\x22==typeof\x20t;if(a&&r)return\x200==t?null:e/t;let\x20i=[];if(!a&&!r){let\x20a=Math.max(e.length,t.length);for(var\x20n=0;n<a;++n)i[n]=null,n<e.length&&n<t.length&&this.IsNumber(e[n])&&this.IsDivideNumber(t[n])&&(i[n]=e[n]/t[n]);return\x20i}if(a)for(var\x20n\x20in\x20t)i[n]=null,this.IsNumber(e)&&this.IsDivideNumber(t[n])&&(i[n]=e/t[n]);else\x20for(var\x20n\x20in\x20e)i[n]=null,this.IsNumber(e[n])&&this.IsDivideNumber(t)&&(i[n]=e[n]/t);return\x20i},this.GT=function(e,t){let\x20a=\x22number\x22==typeof\x20e,r=\x22number\x22==typeof\x20t;if(a&&r)return\x20e>t?1:0;let\x20i=[];if(!a&&!r){let\x20a=Math.max(e.length,t.length);for(var\x20n=0;n<a;++n)i[n]=null,n<e.length&&n<t.length&&(isNaN(e[n])||isNaN(t[n])||(i[n]=e[n]>t[n]?1:0));return\x20i}if(a)for(var\x20n\x20in\x20t)i[n]=null,isNaN(e)||isNaN(t[n])||(i[n]=e>t[n]?1:0);else\x20for(var\x20n\x20in\x20e)i[n]=null,isNaN(e[n])||isNaN(t)||(i[n]=e[n]>t?1:0);return\x20i},this.GTE=function(e,t){let\x20a=\x22number\x22==typeof\x20e,r=\x22number\x22==typeof\x20t;if(a&&r)return\x20e>=t?1:0;let\x20i=[];if(!a&&!r){let\x20a=Math.max(e.length,t.length);for(var\x20n=0;n<a;++n)i[n]=null,n<e.length&&n<t.length&&(isNaN(e[n])||isNaN(t[n])||(i[n]=e[n]>=t[n]?1:0));return\x20i}if(a)for(var\x20n\x20in\x20t)i[n]=null,isNaN(e)||isNaN(t[n])||(i[n]=e>=t[n]?1:0);else\x20for(var\x20n\x20in\x20e)i[n]=null,isNaN(e[n])||isNaN(t)||(i[n]=e[n]>=t?1:0);return\x20i},this.LT=function(e,t){let\x20a=\x22number\x22==typeof\x20e,r=\x22number\x22==typeof\x20t;if(a&&r)return\x20e<t?1:0;let\x20i=[];if(!a&&!r){let\x20a=Math.max(e.length,t.length);for(var\x20n=0;n<a;++n)i[n]=null,n<e.length&&n<t.length&&(isNaN(e[n])||isNaN(t[n])||(i[n]=e[n]<t[n]?1:0));return\x20i}if(a)for(var\x20n\x20in\x20t)i[n]=null,isNaN(e)||isNaN(t[n])||(i[n]=e<t[n]?1:0);else\x20for(var\x20n\x20in\x20e)i[n]=null,isNaN(e[n])||isNaN(t)||(i[n]=e[n]<t?1:0);return\x20i},this.LTE=function(e,t){let\x20a=\x22number\x22==typeof\x20e,r=\x22number\x22==typeof\x20t;if(a&&r)return\x20e>=t?1:0;let\x20i=[];if(!a&&!r){let\x20a=Math.max(e.length,t.length);for(var\x20n=0;n<a;++n)i[n]=null,n<e.length&&n<t.length&&(isNaN(e[n])||isNaN(t[n])||(i[n]=e[n]<=t[n]?1:0));return\x20i}if(a)for(var\x20n\x20in\x20t)i[n]=null,isNaN(e)||isNaN(t[n])||(i[n]=e<=t[n]?1:0);else\x20for(var\x20n\x20in\x20e)i[n]=null,isNaN(e[n])||isNaN(t)||(i[n]=e[n]<=t?1:0);return\x20i},this.EQ=function(e,t){let\x20a=\x22number\x22==typeof\x20e,r=\x22number\x22==typeof\x20t;if(a&&r)return\x20e==t?1:0;let\x20i=[];if(!a&&!r){let\x20a=Math.max(e.length,t.length);for(var\x20n=0;n<a;++n)i[n]=null,n<e.length&&n<t.length&&(isNaN(e[n])||isNaN(t[n])||(i[n]=e[n]==t[n]?1:0));return\x20i}if(a)for(var\x20n\x20in\x20t)i[n]=null,isNaN(e)||isNaN(t[n])||(i[n]=e==t[n]?1:0);else\x20for(var\x20n\x20in\x20e)i[n]=null,isNaN(e[n])||isNaN(t)||(i[n]=e[n]==t?1:0);return\x20i},this.NEQ=function(e,t){let\x20a=\x22number\x22==typeof\x20e,r=\x22number\x22==typeof\x20t;if(a&&r)return\x20e!=t?1:0;let\x20i=[];if(!a&&!r){let\x20a=Math.max(e.length,t.length);for(var\x20n=0;n<a;++n)i[n]=null,n<e.length&&n<t.length&&(isNaN(e[n])||isNaN(t[n])||(i[n]=e[n]!=t[n]?1:0));return\x20i}if(a)for(var\x20n\x20in\x20t)i[n]=null,isNaN(e)||isNaN(t[n])||(i[n]=e!=t[n]?1:0);else\x20for(var\x20n\x20in\x20e)i[n]=null,isNaN(e[n])||isNaN(t)||(i[n]=e[n]!=t?1:0);return\x20i},this.And=function(e,t){let\x20a=\x22number\x22==typeof\x20e,r=\x22number\x22==typeof\x20t;if(a&&r)return\x20e&&t?1:0;let\x20i=[];if(!a&&!r){let\x20a=Math.max(e.length,t.length);for(var\x20n=0;n<a;++n)i[n]=null,n<e.length&&n<t.length&&(isNaN(e[n])||isNaN(t[n])||(i[n]=e[n]&&t[n]?1:0));return\x20i}if(a)for(var\x20n\x20in\x20t)i[n]=null,isNaN(e)||isNaN(t[n])||(i[n]=e&&t[n]?1:0);else\x20for(var\x20n\x20in\x20e)i[n]=null,isNaN(e[n])||isNaN(t)||(i[n]=e[n]&&t?1:0);return\x20i},this.Or=function(e,t){let\x20a=\x22number\x22==typeof\x20e,r=\x22number\x22==typeof\x20t;if(a&&r)return\x20e||t?1:0;let\x20i=[];if(!a&&!r){let\x20a=Math.max(e.length,t.length);for(var\x20n=0;n<a;++n)i[n]=null,n<e.length&&n<t.length&&(isNaN(e[n])||isNaN(t[n])||(i[n]=e[n]||t[n]?1:0));return\x20i}if(a)for(var\x20n\x20in\x20t)i[n]=null,isNaN(e)||isNaN(t[n])||(i[n]=e||t[n]?1:0);else\x20for(var\x20n\x20in\x20e)i[n]=null,isNaN(e[n])||isNaN(t)||(i[n]=e[n]||t?1:0);return\x20i},this.IF=function(e,t,a){let\x20r=this.IsNumber(e),i=this.IsNumber(t),n=this.IsNumber(a);var\x20s=Array.isArray(t),u=Array.isArray(a);if(r)return\x20e?t:a;let\x20o=[];for(var\x20l\x20in\x20e)e[l]?o[l]=i?t:s?t[l]:null:o[l]=n?a:u?a[l]:null;return\x20o},this.IFN=function(e,t,a){return\x20this.IF(e,a,t)},this.REF=function(e,t){let\x20a=[];if(\x22number\x22==typeof\x20t){if(e.length<=0)return\x20a;if(t>=e.length)return\x20a;a=e.slice(0,e.length-t);for(var\x20r=e[0],i=0;i<t;++i)a.unshift(r)}else\x20for(i=0;i<e.length;++i)if(a[i]=null,!(i>=t.length)){var\x20n=t[i];a[i]=n>=0&&n<=i?e[i-n]:i?a[i-1]:e[i]}return\x20a},this.REFV=function(e,t){let\x20a=[];if(\x22number\x22==typeof\x20t){if(e.length<=0)return\x20a;if(t>=e.length)return\x20a;a=e.slice(0,e.length-t);for(var\x20r=0;r<t;++r)a.unshift(null)}else\x20for(r=0;r<e.length;++r)if(a[r]=null,!(r>=t.length)){var\x20i=t[r];i>=0&&i<=r&&(a[r]=e[r-i])}return\x20a},this.REFX=function(e,t){let\x20a=[];if(\x22number\x22==typeof\x20t){if(e.length<=0)return\x20a;if(t>=e.length)return\x20a;a=e.slice(t,e.length);for(var\x20r=e[e.length-1],i=0;i<t;++i)a.push(r)}else{var\x20n=e.length;for(i=0;i<e.length;++i)if(a[i]=null,!(i>=t.length)){var\x20s=t[i];a[i]=s>=0&&s+i<n?e[i+s]:i?a[i-1]:e[i]}}return\x20a},this.REFXV=function(e,t){let\x20a=[];if(\x22number\x22==typeof\x20t){if(e.length<=0)return\x20a;if(t>=e.length)return\x20a;a=e.slice(t,e.length);for(var\x20r=0;r<t;++r)a.push(null)}else{var\x20i=e.length;for(r=0;r<e.length;++r)if(a[r]=null,!(r>=t.length)){var\x20n=t[r];n>=0&&n+r<i&&(a[r]=e[r+n])}}return\x20a},this.MAX=function(e,t){if(0==e.length&&this.ThrowUnexpectedNode(t,\x22MAX()\x20Error:\x20参数个数不能为0\x22),1==e.length)return\x20e[0];var\x20a=[],r=[];for(var\x20i\x20in\x20e){var\x20n=e[i];IFrameSplitOperator.IsNumber(n)?r.push(n):Array.isArray(n)&&a.push(n)}var\x20s=null;if(r.length>0){s=r[0];for(i=1;i<r.length;++i)s=Math.max(s,r[i])}var\x20u=null;if(a.length>0){u=a[0].slice(0);for(i=1;i<a.length;++i){var\x20o=a[i];for(var\x20l\x20in\x20o){var\x20D=u[l];n=o[l];IFrameSplitOperator.IsNumber(D)&&(IFrameSplitOperator.IsNumber(n)?u[l]=Math.max(D,n):u[l]=null)}}}if(null==u&&null!=s)return\x20s;if(u&&null==s)return\x20u;for(var\x20i\x20in\x20u)IFrameSplitOperator.IsNumber(u[i])&&(u[i]=Math.max(u[i],s));return\x20u},this.MIN=function(e,t){if(0==e.length&&this.ThrowUnexpectedNode(t,\x22MIN()\x20Error:\x20参数个数不能为0\x22),1==e.length)return\x20e[0];var\x20a=[],r=[];for(var\x20i\x20in\x20e){var\x20n=e[i];IFrameSplitOperator.IsNumber(n)?r.push(n):Array.isArray(n)&&a.push(n)}var\x20s=null;if(r.length>0){s=r[0];for(i=1;i<r.length;++i)s=Math.min(s,r[i])}var\x20u=null;if(a.length>0){u=a[0].slice(0);for(i=1;i<a.length;++i){var\x20o=a[i];for(var\x20l\x20in\x20o){var\x20D=u[l];n=o[l];IFrameSplitOperator.IsNumber(D)&&(IFrameSplitOperator.IsNumber(n)?u[l]=Math.min(D,n):u[l]=null)}}}if(null==u&&null!=s)return\x20s;if(u&&null==s)return\x20u;for(var\x20i\x20in\x20u)IFrameSplitOperator.IsNumber(u[i])&&(u[i]=Math.min(u[i],s));return\x20u},this.ABS=function(e){let\x20t=[];for(var\x20a\x20in\x20e)t[a]=null,isNaN(e[a])||(t[a]=Math.abs(e[a]));return\x20t},this.MA=function(e,t){let\x20a=[];if(t<=0)return\x20a;if(Array.isArray(t)){for(u=0;u<e.length;++u)if(a[u]=null,!(u>=t.length)){var\x20r=t[u];if(this.IsNumber(r)&&!(r<=0)){for(var\x20i=0,n=0,s=(l=u,0);l>=0&&s<r;--l,++s)i+=e[l],++n;n>0&&(a[u]=i/n)}}}else{if(t<=0&&(t=1),!e||!e.length)return\x20a;for(var\x20u=0;u<e.length&&(a[u]=null,!this.IsNumber(e[u]));++u);e=e.slice(0);for(var\x20o=0;u<e.length;++u,++o){if(o<t-1){a[u]=null;continue}let\x20r=e[u-(t-1)],i=0;for(var\x20l=t-1;l>=0;--l){var\x20D=e[u-l];this.IsNumber(D)?r=D:(D=r,e[u-l]=D),i+=D}a[u]=i/t}}return\x20a},this.EMA=function(e,t){var\x20a=[];if(e.length<=0)return\x20a;if(Array.isArray(t))for(var\x20r=0;r<t.length;++r){var\x20i=t[r];if(this.IsNumber(i)&&!((i=parseInt(i))<=0)){i>r+1&&(i=r+1);for(var\x20n=[2/(i+1),(i-1)/(i+1)],s=null,u=null,o=0;o<i;++o){var\x20l=e[r-(i-o-1)];this.IsNumber(l)||coninue,u=s=null==u?l:n[0]*l+n[1]*u}a[r]=s}}else{for(var\x20D=0;D<e.length&&(null==e[D]||isNaN(e[D]));++D);var\x20h=D,c=D+1;a[h]=e[h];for(r=D+1;r<e.length;++r,++h,++c)a[c]=(2*e[c]+(t-1)*a[h])/(t+1)}return\x20a},this.XMA=function(e,t){for(var\x20a=[],r=0;r<e.length&&!this.IsNumber(e[r]);++r);for(var\x20i=parseInt((t-2)/2),n=0,s=0,u=0,o=r,l=0;o<e.length;++o){for(u=o+(t-i)-1,l=o-i-1;l<u;++l)l>=0&&l<e.length&&this.IsNumber(e[l])&&(n+=e[l],++s);a[o]=0!=s?n/s:null,n=0,s=0}return\x20a},this.SMA=function(e,t,a){var\x20r=[];if(Array.isArray(t))for(var\x20i=0;i<t.length;++i){var\x20n=t[i];if(this.IsNumber(n)&&!((n=parseInt(n))<=0)){n>i+1&&(n=i+1);for(var\x20s=null,u=null,o=0;o<n;++o){var\x20l=e[i-(n-o-1)];this.IsNumber(l)&&(null==s?(s=l,u=l):s=u=(a*l+(n-a)*s)/n)}r[i]=u}}else{i=0;for(var\x20D=null;i<e.length;++i)if(null!=e[i]&&!isNaN(e[i])){D=e[i],r[i]=D;break}for(++i;i<e.length;++i)r[i]=(a*e[i]+(t-a)*D)/t,D=r[i]}return\x20r},this.DMA=function(e,t){var\x20a=[];if(e.length<0||e.length!=t.length)return\x20a;for(var\x20r=0;r<e.length;++r)if(null!=e[r]&&!isNaN(e[r])&&null!=t[r]&&!isNaN(t[r])){a[r]=e[r];break}for(r+=1;r<e.length;++r)null==e[r]||null==t[r]?a[r]=null:t[r]<1?a[r]=t[r]*e[r]+(1-t[r])*a[r-1]:a[r]=e[r];return\x20a},this.WMA=function(e,t){let\x20a=[];if(!e||!e.length)return\x20a;if(Array.isArray(t)){for(h=0;h<t.length&&h<e.length;++h){a[h]=null;var\x20r=t[h];if(!(r<=0)){for(var\x20i=0,n=0,s=0,u=0;u<r;++u)if(n=e[h-(r-u-1)],i=u,this.IsNumber(n)){s=n;break}if(!(i>=r)){for(var\x20o=0,l=0,D=(u=i,1);u<r;++u,++D)n=e[h-(r-u-1)],this.IsNumber(n)?s=n:n=s,l+=D,o+=n*D;a[h]=o/l}}}return\x20a}if(t<=0)return[];var\x20h=0;for(h=0;h<e.length&&!this.IsNumber(e[h]);++h)a[h]=null;e=e.slice(0);for(var\x20c=0;h<e.length;++h,++c)if(c<t-1)a[h]=null;else{for(s=e[h-(t-1)],o=0,l=0,u=t-1;u>=0;--u){n=e[h-u];this.IsNumber(n)?s=n:(n=s,e[h-u]=n),l+=t-u,o+=n*(t-u)}a[h]=o/l}return\x20a},this.MEMA=function(e,t){let\x20a=[];if(!e||!e.length)return\x20a;var\x20r=0,i=0;for(i=0;i<e.length&&!this.IsNumber(e[i]);++i)a[i]=null;if(r=i,t<1||r+t>=e.length)return\x20a;var\x20n=0;for(e=e.slice(0);r<i+t;++r)a[r]=null,!this.IsNumber(e[r])&&r-1>=0&&(e[r]=e[r-1]),n+=e[r];for(a[r-1]=n/t;r<e.length;++r)this.IsNumber(a[r-1])&&this.IsNumber(e[r])?a[r]=(e[r]+a[r-1]*(t-1))/t:r-1>-1&&this.IsNumber(a[r-1])?a[r]=a[r-1]:a[r]=null;return\x20a},this.EXPMA=function(e,t){let\x20a=[];if(t>=e.length)return\x20a;let\x20r=t;for(;r<e.length;++r)if(null!=e[r]){a[r]=e[r];break}for(r+=1;r<e.length;++r)null!=a[r-1]&&null!=e[r]?a[r]=(2*e[r]+(t-1)*a[r-1])/(t+1):null!=a[r-1]&&(a[r]=a[r-1]);return\x20a},this.EXPMEMA=function(e,t){var\x20a=[];if(t>=e.length)return\x20a;for(var\x20r=0;r<e.length&&(!e[r]||isNaN(e[r]));++r);for(var\x20i=0,n=0;r<e.length&&n<t;++n,++r)e[r]&&!isNaN(e[r])?i+=e[r]:i+=e[r-1];for(a[r-1]=i/t;r<e.length;++r)null!=a[r-1]&&null!=e[r]?a[r]=(2*e[r]+(t-1)*a[r-1])/(t+1):null!=a[r-1]&&(a[r]=a[r-1]);return\x20a},this.SUMBARS=function(e,t){var\x20a=[];if(!(e&&e.length&&t&&t.length))return\x20a;for(var\x20r=0,i=0,n=0;r<e.length&&!this.IsNumber(e[r]);++r)a[r]=null;for(i=e.length-1;i>=r;--i){var\x20s=0;for(n=i,s=0;n>=r&&s<t[i];--n)s+=e[n];a[i]=n<r?null:i-n}for(i=r+1;i<e.length;++i)null==a[i]&&(a[i]=a[i-1]);return\x20a},this.REVERSE=function(e){for(var\x20t=[],a=0;a<e.length&&!this.isNumber(e[a]);++a)t[a]=null;for(;a<e.length;++a)this.isNumber(e[a])?t[a]=0-e[a]:t[a]=null;return\x20t},this.COUNT=function(e,t){if(Array.isArray(t)){for(var\x20a=null,r=e.length,i=0;i<r;++i)if(this.IsNumber(e[i])){a=i;break}if(null==a)return[];var\x20n=[],s=0;for(i=0;i<t.length;++i){var\x20u=t[i];if(IFrameSplitOperator.IsNumber(u)){u<1&&(u=i+1),s=0;for(var\x20o=i,l=0;o>=0&&l<u;--o,++l)e[o]&&++s;n[i]=s}}return\x20n}for(u=t,r=e.length,u=u<1?r:u,i=0,o=0;i<r&&!this.IsNumber(e[i]);++i);n=[];for(var\x20D=0;i<r&&o<u;++i,++o)D=e[i]?D+1:D,n[i]=D;for(;i<r;++i)e[i-u]&&D&&D--,D=e[i]?D+1:D,n[i]=D;return\x20n},this.HHV=function(e,t){let\x20a=[];if(Array.isArray(t)){for(var\x20r=null,i=0,n=0;i<e.length;++i)if(a[i]=null,!(i>=t.length)){r=null;var\x20s=t[i];if(s>0&&s<=i)for(n=i-s;n<=i;++n)(null==r||r<e[n])&&(r=e[n]);else\x20for(s=i,n=0;n<=i;++n)(null==r||r<e[n])&&(r=e[n]);a[i]=r}}else{if(t>e.length)return\x20a;t<=0&&(t=e.length-1);var\x20u=0;for(u=0;u<e.length&&!this.IsNumber(e[u]);++u);u<e.length&&(a[u]=e[u]);for(i=u+1,n=2;i<e.length&&n<t;++i,++n)e[i]>=e[u]&&(u=i),a[i]=e[u];for(;i<e.length;++i){if(i-u<t)u=e[i]<e[u]?u:i;else\x20for(n=u=i-t+1;n<=i;++n)u=e[n]<e[u]?u:n;a[i]=e[u]}}return\x20a},this.LLV=function(e,t){var\x20a=[];if(Array.isArray(t)){for(var\x20r=0;r<e.length;++r)if(a[r]=null,!(r>=t.length)){var\x20i=null,n=t[r];if(n>0&&n<=r)for(var\x20s=r-n;s<=r;++s)(null==i||i>e[s])&&(i=e[s]);else{n=r;for(s=0;s<=r;++s)(null==i||i>e[s])&&(i=e[s])}a[r]=i}}else{if(t>e.length)return\x20a;t<=0&&(t=e.length-1);for(i=null,r=t;r<e.length;++r,++s){if(null==i||r<t+i)i=e[r]>e[i]?i:r;else\x20for(s=1+(i=r-t+1);s<=r;++s)e[s]<e[i]&&(i=s);a[r]=e[i]}}return\x20a},this.STD=function(e,t){for(var\x20a=[],r=0,i=[],n=t-1;n<e.length;++n){r=0;for(var\x20s=0;s<t;++s)r+=e[n-s];i[n]=r/t}for(n=t-1;n<e.length;++n){r=0;for(s=0;s<t;++s)r+=Math.pow(e[n-s]-i[n],2);a[n]=Math.sqrt(r/t)}return\x20a},this.AVEDEV=function(e,t){for(var\x20a=[],r=0,i=[],n=t-1;n<e.length;++n){r=0;for(var\x20s=0;s<t;++s)r+=e[n-s];i[n]=r/t}for(n=t-1;n<e.length;++n){r=0;for(s=0;s<t;++s)r+=Math.abs(e[n-s]-i[n]);a[n]=r/t}return\x20a},this.CROSS=function(e,t){var\x20a=[];if(Array.isArray(e)&&Array.isArray(t)){if(e.length!=t.length)return[];for(var\x20r=0;r<e.length&&(!this.IsNumber(e[r])||!this.IsNumber(t[r]));++r);for(++r;r<e.length;++r)a[r]=e[r]>t[r]&&e[r-1]<t[r-1]?1:0}else\x20if(Array.isArray(e)&&\x22number\x22==typeof\x20t){for(r=0;r<e.length&&!this.IsNumber(e[r]);++r);for(++r;r<e.length;++r)a[r]=e[r]>t&&e[r-1]<t?1:0}else\x20if(\x22number\x22==typeof\x20e&&Array.isArray(t)){for(r=0;r<t.length&&!this.IsNumber(t[r]);++r);for(++r;r<t.length;++r)a[r]=t[r]<e&&t[r-1]>e?1:0}return\x20a},this.MULAR=function(e,t){var\x20a=[];if(Array.isArray(t))for(n=0;n<e.length;++n){a[n]=null;var\x20r=t[n];if(this.IsNumber(r)&&!((r=parseInt(r))<0))for(s=n,u=0;s>=0&&u<r;--s,++u)0==u?a[n]=e[s]:a[n]*=e[s]}else{if(e.length<t)return\x20a;if(0==t){for(var\x20i=t;i<e.length;++i)if(this.IsNumber(e[i])){a[i]=e[i];break}for(++i;i<e.length;++i)a[i]=a[i-1]*e[i]}else\x20for(var\x20n=t-1,s=0;n<e.length;++n,++s)for(var\x20u=0;u<t;++u)0==u?a[n]=e[u+s]:a[n]*=e[u+s]}return\x20a},this.SUM=function(e,t){var\x20a=[];if(Array.isArray(t))for(i=0;i<e.length;++i){a[i]=null;var\x20r=t[i];if(r>0)for(n=i,s=0;n>=0&&s<r;--n,++s)0==s?a[i]=e[n]:a[i]+=e[n]}else\x20if(0==t){a[0]=e[0];for(var\x20i=1;i<e.length;++i)a[i]=a[i-1]+e[i]}else\x20for(var\x20i=t-1,n=0;i<e.length;++i,++n)for(var\x20s=0;s<t;++s)0==s?a[i]=e[s+n]:a[i]+=e[s+n];return\x20a},this.BARSCOUNT=function(e){let\x20t=[],a=null;for(var\x20r\x20in\x20e){if(t[r]=0,null==a){if(!this.IsNumber(e[r]))continue;a=0}t[r]=a,++a}return\x20t},this.DEVSQ=function(e,t){var\x20a=[];\x22number\x22!=typeof\x20t&&(t=parseInt(t));var\x20r=t,i=e.length,n=0,s=0,u=0,o=0,l=0;for(n=0;n<i&&!this.isNumber(e[n]);++n)a[n]=null;if(r<1||n+r>i)return\x20a;for(o=0;n<i&&s<r;++n,++s)o+=e[n]/r;if(s==r){for(l=0,n--;u<r;u++)l+=(e[n-u]-o)*(e[n-u]-o);a[n]=l,n++}for(;n<i;++n){for(o+=(e[n]-e[n-r])/r,l=0,u=0;u<r;++u)l+=(e[n-u]-o)*(e[n-u]-o);a[n]=l}return\x20a},this.NOT=function(e){if(\x22number\x22==typeof\x20e)return\x20e?0:1;let\x20t=[];for(var\x20a\x20in\x20e)t[a]=null,this.IsNumber(e[a])&&(t[a]=e[a]?0:1);return\x20t},this.FORCAST=function(e,t){var\x20a=[];\x22number\x22!=typeof\x20t&&(t=parseInt(t));var\x20r=t,i=e.length;if(r<1||r>=i)return\x20a;var\x20n,s,u,o,l,D=0,h=0,c=0,C=0;for(o=0;o<i&&!this.IsNumber(e[o]);++o)a[o]=null;for(u=o+r-1;u<i;++u){for(D=h=c=C=0,o=0,l=r;o<r&&o<=u;++o,--l)D+=l,h+=e[u-o];for(D/=r,h/=r,o=0,l=r;o<r&&o<=u;++o,--l)c+=(l-D)*(e[u-o]-h),C+=(l-D)*(l-D);n=h-D*(s=c/C),a[u]=s*r+n}return\x20a},this.SLOPE=function(e,t){let\x20a=[];if(\x22number\x22!=typeof\x20t&&(t=parseInt(t)),t<1||!e.length)return\x20a;if(t>=e.length)return\x20a;let\x20r,i,n,s,u=0;for(var\x20o=0;o<e.length&&(a[o]=null,!this.IsNumber(e[o]));++o,++u);for(o=u+t-1;o<e.length;++o){a[o]=null,r=i=n=s=0;for(var\x20l=0;l<t&&l<=o;++l)r+=o-l,i+=e[o-l];for(r/=t,i/=t,l=0;l<t&&l<=o;++l)n+=(o-l-r)*(e[o-l]-i),s+=(o-l-r)*(o-l-r);s?a[o]=n/s:o&&(a[o]=a[o-1])}return\x20a},this.STDP=function(e,t){var\x20a=[];\x22number\x22!=typeof\x20t&&(t=parseInt(t));var\x20r=t,i=e.length;if(r<1||r>=i)return\x20a;var\x20n=0,s=0;for(n=0;n<i&&!this.IsNumber(e[n]);++n)a[n]=null;for(var\x20u,o=0,l=0;n<i&&s<r;++n,++s)o+=e[n]*e[n],l+=e[n];for(s==r&&(u=r*o-l*l,a[n-1]=Math.sqrt(u)/r);n<i;++n)u=r*(o+=e[n]*e[n]-e[n-r]*e[n-r])-(l+=e[n]-e[n-r])*l,a[n]=Math.sqrt(u)/r;return\x20a},this.VAR=function(e,t){var\x20a=[];\x22number\x22!=typeof\x20t&&(t=parseInt(t));var\x20r,i,n,s,u=t,o=e.length;if(u<=1||u>=o)return\x20a;for(r=0;r<o&&!this.IsNumber(e[r]);++r)a[r]=null;for(i=0,r=r+u-1;r<o;++r){for(n=s=0,i=0;i<u&&i<=r;++i)n+=e[r-i]*e[r-i],s+=e[r-i];a[r]=(u*n-s*s)/u*(u-1)}return\x20a},this.VARP=function(e,t){var\x20a=[];\x22number\x22!=typeof\x20t&&(t=parseInt(t));var\x20r=t,i=e.length;if(r<1||r>=i)return\x20a;var\x20n=0,s=0;for(n=0;n<i&&!this.IsNumber(e[n]);++n)a[n]=null;for(var\x20u=0,o=0;n<i&&s<r;++n,++s)u+=e[n]*e[n],o+=e[n];for(s==r&&(a[n-1]=(r*u-o*o)/(r*r));n<i;++n)u+=e[n]*e[n]-e[n-r]*e[n-r],o+=e[n]-e[n-r],a[n]=(r*u-o*o)/(r*r);return\x20a},this.RANGE=function(e,t,a){let\x20r=\x22number\x22==typeof\x20t,i=\x22number\x22==typeof\x20a;if(\x22number\x22==typeof\x20e&&r&&i)return\x20e>Math.min(t,a)&&e<Math.max(t,a)?1:0;let\x20n,s,u=[];for(var\x20o=0;o<e.length;++o)if(u[o]=null,n=e[o],this.IsNumber(n)){if(r)s=t;else{if(o>=t.length)continue;s=t[o]}if(this.IsNumber(s)){if(i)rangeValue2=a;else{if(o>=a.length)continue;rangeValue2=a[o]}this.IsNumber(rangeValue2)&&(u[o]=n>Math.min(s,rangeValue2)&&n<Math.max(s,rangeValue2)?1:0)}}return\x20u},this.EXIST=function(e,t){if(\x22number\x22==typeof\x20e)return\x200;if(Array.isArray(t)){var\x20a=[];if(e.length<=0)return\x20a;for(var\x20r\x20in\x20e)a[r]=0;for(r=0;r<t.length&&r<e.length;++r){var\x20i=t[r];if(this.IsNumber(i)&&!((i=parseInt(i))<=0)){i>r+1&&(i=r+1);for(var\x20n=!1,s=0,u=0;u<i;++u)if(r-(i-u-1),s=e[r],this.IsNumber(s)&&s>0){n=!0;break}a[r]=n?1:0}}return\x20a}t=parseInt(t);var\x20o=null;for(a=[],r=0;r<e.length;++r)a[r]=null,s=e[r],this.IsNumber(s)&&s>0&&(o=r),a[r]=null!=o&&r-o<t?1:0;return\x20a},this.TFILTER=function(e,t,a){a=parseInt(a);let\x20r=Math.max(e.length,t.length);for(var\x20i=0;i<r;++i);return[]},this.FILTER=function(e,t){for(var\x20a=[],r=0,i=0;r<e.length;++r)if(e[r]){for(a[r]=1,i=0;i<t&&i+r+1<e.length;++i)a[i+r+1]=0;r+=t}else\x20a[r]=0;return\x20a},this.BARSLAST=function(e){var\x20t=[];if(!e)return\x20t;let\x20a=null;for(var\x20r=0;r<e.length;++r)t[r]=null,e[r]>0?a=0:null!=a&&++a,null!=a&&(t[r]=a);return\x20t},this.BARSSINCEN=function(e,t){for(var\x20a=[],r=null,i=0;i<e.length;++i)a[i]=null,null==r?e[i]&&(r=0):e[i]?r+1<t&&++r:r=null,r&&(a[i]=r);return\x20a},this.BARSSINCE=function(e){for(var\x20t=[],a=null,r=0;r<e.length;++r)t[r]=null,null==a?e[r]&&(a=0):++a,a&&(t[r]=a);return\x20t},this.Trigonometric=function(e,t){if(Array.isArray(e)){var\x20a=[];for(var\x20r\x20in\x20e){var\x20i=e[r];this.IsNumber(i)?a[r]=t(i):a[r]=null}return\x20a}return\x20this.IsNumber(e)?t(e):null},this.ASIN=function(e){if(Array.isArray(e)){var\x20t=[];for(var\x20a\x20in\x20e){var\x20r=e[a];if(t[a]=null,this.IsNumber(r))if(r>=-1&&r<=1)t[a]=Math.asin(r);else\x20if(a-1>=0){var\x20i=t[a-1];this.IsNumber(i)&&(t[a]=i)}}return\x20t}return\x20this.IsNumber(e)?Math.acos(e):null},this.ACOS=function(e){if(Array.isArray(e)){var\x20t=[];for(var\x20a\x20in\x20e){var\x20r=e[a];if(t[a]=null,this.IsNumber(r))if(r>=-1&&r<=1)t[a]=Math.acos(r);else\x20if(a-1>=0){var\x20i=t[a-1];this.IsNumber(i)&&(t[a]=i)}}return\x20t}return\x20this.IsNumber(e)?Math.acos(e):null},this.LAST=function(e,t,a){if(!Array.isArray(e))return[];for(var\x20r=[],i=e.length,n=t,s=a,u=0,o=0,l=0,D=0;u<i&&!e[u];++u);for(o=u,D=u-s+1;o<i;++o,++D){for(l=0==n?u:Math.max(u,o-n);l<D&&!(e[l]<=0);++l);r[o]=l<D?0:1}return\x20r},this.ZIG=function(e,t){var\x20a=this.SymbolData.Data;if(\x22number\x22==typeof\x20e)switch(e){case\x200:e=a.GetOpen();break;case\x201:e=a.GetHigh();break;case\x202:e=a.GetLow();break;case\x203:e=a.GetClose();break;default:return[]}return\x20this.ZIG_Calculate(e,t)},this.GetFirstVaildIndex=function(e){for(var\x20t=0;t<e.length;++t)if(this.IsNumber(e[t]))return\x20t;return\x20e.length},this.ZIG_Calculate=function(e,t){var\x20a=[],r=e.length,i=this.GetFirstVaildIndex(e),n=0,s=0,u=0,o=0,l=0;for(n=i+1,s=u=i;n<r-1&&u==i;++n)u=100*Math.abs(e[n]-e[i])>=t*e[i]?e[n]>e[i]?n:-n:i;for(;n<r-1;++n)if(e[n]>=e[n-1]&&e[n]>=e[n+1])if(u<0){if(100*(e[n]-e[-u])<t*e[-u])continue;for(l=(e[s]-e[o=-u])/(-u-s),a[o--]=e[-u];o>=s;o--)a[o]=e[-u]+(-u-o)*l;s=-u,u=n}else\x20e[n]>e[u]&&(u=n);else\x20if(e[n]<=e[n-1]&&e[n]<=e[n+1])if(u>0){if(100*(e[u]-e[n])<t*e[u])continue;for(l=(e[u]-e[o=s])/(u-s),a[o++]=e[s];o<=u;++o)a[o]=e[s]+(o-s)*l;s=u,u=-n}else\x20e[n]<e[-u]&&(u=-n);if(Math.abs(u)>=r-2&&(u>0&&e[r-1]>=e[u]&&(u=r-1),u<0&&e[r-1]<=e[-u]&&(u=1-r)),u>0)for(l=(e[u]-e[o=s])/(u-s),a[o++]=e[s];o<=u;++o)a[o]=e[s]+(o-s)*l;else\x20for(l=(e[s]-e[o=-u])/(-u-s),a[o--]=e[-u];o>=s;o--)a[o]=e[-u]+(-u-o)*l;if((u=Math.abs(u))<r-1)if(e[r-1]>=e[u])for(l=(e[r-1]-e[o=u])/(r-u),a[o++]=e[u];o<r;++o)a[o]=e[u]+(o-u)*l;else\x20for(l=(e[u]-e[o=r-1])/(r-u),a[o--]=e[r-1];o>=u;o--)a[o]=e[r-1]+(r-o)*l;return\x20a},this.JSDraw=null,this.CalculateZIGLine=function(e,t,a,r,i){null==this.JSDraw&&(this.JSDraw=new\x20JSDraw(this.ErrorHandler));var\x20n=e;if(t.Up)for(var\x20s=e.ID+1;s<a.ID;++s){var\x20u=r[s];this.IsNumber(u)&&(n.Value<u&&(n={ID:s,Value:u}))}else\x20for(s=e.ID+1;s<a.ID;++s){u=r[s];this.IsNumber(u)&&(n.Value>u&&(n={ID:s,Value:u}))}t.Value=n.Value,t.ID=n.ID;var\x20o={Start:{ID:e.ID,Value:e.Value},End:{ID:t.ID,Value:t.Value}},l=this.JSDraw.CalculateDrawLine(o);for(var\x20s\x20in\x20l){i[(D=l[s]).ID]=D.Value}if(a.ID==r.length-1)for(var\x20s\x20in\x20o={Start:{ID:t.ID,Value:t.Value},End:{ID:a.ID,Value:a.Value}},l=this.JSDraw.CalculateDrawLine(o)){var\x20D;i[(D=l[s]).ID]=D.Value}else\x20e.ID=t.ID,e.Value=t.Value,t.ID=a.ID,t.Value=a.Value,t.Up=e.Value<t.Value},this.TROUGHBARS=function(e,t,a){var\x20r=this.ZIG(e,t),i=[],n=a;if(n<1)return\x20i;for(var\x20s=r.length,u=[],o=0;o<n;++o)u[o]=0;var\x20l=0;o=this.GetFirstVaildIndex(r)+1;for(n--;o<s&&r[o]>r[o-1];++o);for(;o<s&&r[o]<r[o-1];++o);for(u[0]=--o;o<s-1;++o){if(r[o]<r[o+1]){if(l){if(n)for(var\x20D=u.slice(0),h=0;h<n;++h)u[h+1]=D[h];u[l=0]=o}}else\x20l=1;u[n]&&(i[o]=o-u[n])}return\x20u[n]&&(i[o]=o-u[n]),i},this.TROUGH=function(e,t,a){var\x20r=this.ZIG(e,t),i=[],n=a;if(n<1)return\x20i;for(var\x20s=r.length,u=[],o=0;o<n;++o)u[o]=0;o=1;var\x20l=0;o=this.GetFirstVaildIndex(r)+1;for(n--;o<s&&r[o]>r[o-1];++o);for(;o<s&&r[o]<r[o-1];++o);for(u[0]=--o;o<s-1;++o){if(r[o]<r[o+1]){if(l){if(n)for(var\x20D=u.slice(0),h=0;h<n;++h)u[h+1]=D[h];u[l=0]=o}}else\x20l=1;u[n]&&(i[o]=r[u[n]])}return\x20u[n]&&(i[o]=r[u[n]]),i},this.PEAKBARS=function(e,t,a){var\x20r=this.ZIG(e,t),i=[],n=r.length,s=a;if(s<1)return\x20i;for(var\x20u=[],o=0;o<s;++o)u[o]=0;var\x20l=0;o=this.GetFirstVaildIndex(r)+1;for(s--;o<n&&r[o]<r[o-1];++o);for(;o<n&&r[o]>r[o-1];++o);for(u[0]=--o;o<n-1;++o){if(r[o]>r[o+1]){if(l){if(s)for(var\x20D=u.slice(0),h=0;h<s;++h)u[h+1]=D[h];u[l=0]=o}}else\x20l=1;u[s]&&(i[o]=o-u[s])}return\x20u[s]&&(i[o]=o-u[s]),i},this.PEAK=function(e,t,a){var\x20r=this.ZIG(e,t),i=[],n=r.length,s=a;if(s<1)return\x20i;for(var\x20u=0,o=[],l=0;l<s;++l)o[l]=0;l=this.GetFirstVaildIndex(r)+1;for(s--;l<n&&r[l]<r[l-1];++l);for(;l<n&&r[l]>r[l-1];++l);for(o[0]=--l;l<n-1;++l){if(r[l]>r[l+1]){if(u){if(s)for(var\x20D=o.slice(0),h=0;h<s;++h)o[h+1]=D[h];o[u=0]=l}}else\x20u=1;o[s]&&(i[l]=r[o[s]])}return\x20o[s]&&(i[l]=r[o[s]]),i},this.EVERY=function(e,t){var\x20a=[];if(t<1)return\x20a;for(var\x20r=0;r<e.length&&(a[r]=null,!this.IsNumber(e[r]));++r);for(var\x20i=0;r<e.length;++r)e[r]?i+=1:i=0,i==t?(a[r]=1,--i):a[r]=0;return\x20a},this.COST=function(e,t){var\x20a=[],r=e/100;if(r<1e-6||r>1)return\x20a;var\x20i=this.SymbolData.Data.Data;if(!i||i.length<=0)return\x20a;for(var\x20n=this.SymbolData.GetStockCacheData({FunctionName:\x22FINANCE\x22,Args:[7],ArgCount:1,Node:t}),s=i[0].High,u=i[0].Low,o=0;o<i.length;++o){var\x20l=i[o];u=Math.min(u,l.Low),s=Math.max(s,l.High)}(u>2e3||u<0||s>2e3||u<0)&&this.ThrowUnexpectedNode(t,\x22COST()\x20历史K线最大最小值错误,\x20超出(0,1000)范围\x22);var\x20D=parseInt(100*s+1),h=parseInt(100*u-1),c=0,C=0,E=0;s=D/100,u=h/100;var\x20m=D-h+1;if(m<1)return\x20a;var\x20A=[],N=[];for(o=0;o<m;++o)A[o]=0,N[o]=0;var\x20I=0,S=0,f=0,O=0;for(o=0;o<i.length;++o)if(!(o>=n.length)){if(n[o]>1){var\x20d=i[o];I=d.Vol/n[o];for(var\x20p=0;p<m;p++)A[p]*=1-I;c=parseInt(Math.min(D,Math.max(h,100*d.Low)))-h,C=parseInt(Math.min(D,Math.max(h,100*d.High)))-h,E=parseInt(Math.min(D,Math.max(h,100*d.Close)))-h;for(p=0;p<m;++p)N[p]=0;var\x20_=parseInt((c+C+2*E)/4);if(_==C||_==c)N[_]+=d.Vol;else{for(var\x20T=d.Vol/(_-c),y=c;y<_;++y)N[y]+=T/(_-c)*(y-c);for(;y<=C;++y)N[y]+=T/(_-C)*(y-C)}for(S=0,p=c;p<=C;p++)A[p]+=N[p];for(p=0;p<m;p++)S+=A[p];for(p=0,O=f=0;p<m;++p)if((f+=A[p])>=S*r){O=(s-u)*p/m+u;break}}a[o]=O}return\x20a},this.WINNER=function(e,t){var\x20a=[],r=this.SymbolData.Data.Data;if(!r||r.length<=0)return\x20a;for(var\x20i=this.SymbolData.GetStockCacheData({FunctionName:\x22FINANCE\x22,Args:[7],ArgCount:1,Node:t}),n=r[0].High,s=r[0].Low,u=0;u<r.length;++u){var\x20o=r[u];s=Math.min(s,o.Low),n=Math.max(n,o.High)}(s>1e3||s<0||n>1e3||s<0)&&this.ThrowUnexpectedNode(t,\x22WINNER()\x20历史K线最大最小值错误,\x20超出(0,1000)范围\x22);var\x20l=parseInt(100*n+1),D=parseInt(100*s-1),h=0,c=0,C=0;n=l/100,s=D/100;var\x20E=l-D+1;if(E<1)return\x20a;var\x20m=[],A=[];for(u=0;u<E;++u)m[u]=0,A[u]=0;var\x20N=0,I=0,S=0;for(u=0;u<r.length;++u)if(!(u>=i.length)&&i[u]>1){var\x20f=r[u];N=f.Vol/i[u];for(var\x20O=0;O<E;O++)m[O]*=1-N;h=parseInt(Math.min(l,Math.max(D,100*f.Low)))-D,c=parseInt(Math.min(l,Math.max(D,100*f.High)))-D,C=parseInt(Math.min(l,Math.max(D,100*f.Close)))-D;for(O=0;O<E;++O)A[O]=0;var\x20d=parseInt((h+c+2*C)/4);if(d==c||d==h)A[d]+=f.Vol;else{for(var\x20p=f.Vol/(d-h),_=h;_<d;++_)A[_]+=p/(d-h)*(_-h);for(;_<=c;++_)A[_]+=p/(d-c)*(_-c)}for(I=0,O=h;O<=c;O++)m[O]+=A[O];for(O=0;O<E;O++)I+=m[O];c=Array.isArray(e)?parseInt(Math.min(100*e[u]-D,E-1)):parseInt(Math.min(100*e-D,E-1));for(O=0,S=0;O<=c;O++)S+=m[O];I>0?a[u]=S/I:u-1>=0&&(a[u]=a[u-1])}return\x20a},this.COSTEX=function(e,t,a){var\x20r=[],i=this.SymbolData.Data.Data;if(!i||i.length<=0)return\x20r;for(var\x20n=this.SymbolData.GetStockCacheData({FunctionName:\x22FINANCE\x22,Args:[7],ArgCount:1,Node:a}),s=i[0].High,u=i[0].Low,o=0;o<i.length;++o){var\x20l=i[o];u=Math.min(u,l.Low),s=Math.max(s,l.High)}(u>1e3||u<0||s>1e3||u<0)&&this.ThrowUnexpectedNode(a,\x22COSTEX()\x20历史K线最大最小值错误,\x20超出(0,1000)范围\x22);var\x20D=parseInt(100*s+1),h=parseInt(100*u-1),c=0,C=0,E=0;s=D/100,u=h/100;var\x20m=D-h+1;if(m<1)return\x20r;var\x20A=[],N=[];for(o=0;o<m;++o)A[o]=0,N[o]=0;for(var\x20I=0,S=0,f=0,O=0,d=0,p=0,_=(o=0,0);o<i.length;++o)if(!(o>=n.length)&&n[o]>1){var\x20T=i[o];I=T.Vol/n[o];for(_=0;_<m;_++)A[_]*=1-I;c=parseInt(Math.min(D,Math.max(h,100*T.Low)))-h,C=parseInt(Math.min(D,Math.max(h,100*T.High)))-h,E=parseInt(Math.min(D,Math.max(h,100*T.Close)))-h;for(_=0;_<m;++_)N[_]=0;var\x20y=parseInt((c+C+2*E)/4);if(y==C||y==c)N[y]+=T.Vol;else{for(var\x20L=T.Vol/(y-c),F=c;F<y;++F)N[F]+=L/(y-c)*(F-c);for(;F<=C;++F)N[F]+=L/(y-C)*(F-C)}0;for(_=c;_<=C;_++)A[_]+=N[_];for(_=0;_<m;_++)A[_];for(C=Array.isArray(e)?parseInt(Math.min(100*e[o]-h,m-1)):parseInt(Math.min(100*e-h,m-1)),_=0,f=0,O=0;_<=C;_++)f+=A[_],O+=.01*(_+h)*A[_];for(C=Array.isArray(t)?parseInt(Math.min(100*t[o]-h,m-1)):parseInt(Math.min(100*t-h,m-1)),_=0,d=0,p=0;_<=C;_++)d+=A[_],p+=.01*(_+h)*A[_];S=f-d,dPerVolRange=O-p,Math.abs(dPerVolRange)>.001&&0!=S?r[o]=dPerVolRange/S:o-1>=0&&(r[o]=r[o-1])}return\x20r},this.PPART=function(e,t){var\x20a=[],r=e;if(r<0)return\x20a;var\x20i=this.SymbolData.Data.Data;if(!i||i.length<=0)return\x20a;for(var\x20n=this.SymbolData.GetStockCacheData({FunctionName:\x22FINANCE\x22,Args:[7],ArgCount:1,Node:t}),s=r,u=0;s<i.length;++s){var\x20o=s-r;if(!(o<0)){var\x20l=0;for(u=0;u<r;++u){l+=i[u+o].Vol}if(s<n.length&&n[s]>0){var\x20D=1-l/n[s];a[s]=D}}}return\x20a},this.LWINNER=function(e,t,a){var\x20r=e;r<=0&&this.ThrowUnexpectedNode(a,\x22LWINNER()\x20第1个参数错误\x22);var\x20i=[],n=this.SymbolData.Data.Data;if(!n||n.length<=0)return\x20i;for(var\x20s=this.SymbolData.GetStockCacheData({FunctionName:\x22FINANCE\x22,Args:[7],ArgCount:1,Node:a}),u=0,o=0,l=r-1,D=0,h=0;l<n.length;++l){var\x20c=l-r+1,C=n[c].High,E=n[c].Low;for(D=0;D<r;++D){var\x20m=n[c+D];E=Math.min(E,m.Low),C=Math.max(C,m.High)}(E>1e3||E<0||C>1e3||E<0)&&this.ThrowUnexpectedNode(a,\x22LWINNER()\x20历史K线最大最小值错误,\x20超出(0,1000)范围\x22);var\x20A=parseInt(100*C+1),N=parseInt(100*E-1),I=0,S=0,f=0;C=A/100,E=N/100;var\x20O=A-N+1;if(O<1)return\x20i;var\x20d=[],p=[];for(D=0;D<O;++D)d[D]=0,p[D]=0;for(D=0;D<r;++D){var\x20_=s[c+D];if(!(_<1)){var\x20T=n[c+D],y=T.Vol/_;for(h=0;h<O;h++)d[h]*=1-y;I=parseInt(Math.min(A,Math.max(N,100*T.Low)))-N,S=parseInt(Math.min(A,Math.max(N,100*T.High)))-N,f=parseInt(Math.min(A,Math.max(N,100*T.Close)))-N;for(h=0;h<O;++h)p[h]=0;var\x20L=parseInt((I+S+2*f)/4);if(L==S||L==I)p[L]+=T.Vol;else{var\x20F=T.Vol/(L-I);for(let\x20e=I;e<L;++e)p[e]+=F/(L-I)*(e-I);for(let\x20e;e<=S;++e)p[e]+=F/(L-S)*(e-S)}u=0;for(h=I;h<=S;h++)d[h]+=p[h]}}for(D=0;D<O;D++)u+=d[D];for(S=Array.isArray(t)?parseInt(Math.min(100*t[l]-N,O-1)):parseInt(Math.min(100*t-N,O-1)),o=0,h=0;h<=S;h++)o+=d[h];u>0&&o>0&&o<=u?i[l]=o/u:l-1>=0&&(i[l]=i[l-1])}return\x20i},this.PWINNER=function(e,t,a){return[]},this.CalculateChip=function(e,t,a,r){for(var\x20i={Min:null,Max:null,Data:[]},n=1,s=null,u=null,o=e;o>=0;--o){let\x20D={};var\x20l=a[o];D.Vol=o==e?l.Vol*t[o]:l.Vol*n,D.Date=l.Date,D.High=l.High,D.Low=l.Low,null==s?s=D.High:s<D.High&&(s=D.High),null==u?u=D.Low:u<D.Low&&(u=D.Low),i.Data[o]=D,n*=1-t[o]/100*r}return\x20i.Max=s,i.Min=u,i},this.UPNDAY=function(e,t){var\x20a=[];if(t<1)return\x20a;if(null==e||t>e.length)return\x20a;for(var\x20r=0,i=0;i<e.length;++i)a[i]=0,i-1<0||(this.IsNumber(e[i])&&this.IsNumber(e[i-1])?(e[i]>e[i-1]?++r:r=0,r==t&&(a[i]=1,--r)):r=0);return\x20a},this.DOWNNDAY=function(e,t){var\x20a=[];if(t<1)return\x20a;if(null==e||t>e.length)return\x20a;for(var\x20r=0,i=0;i<e.length;++i)a[i]=0,i-1<0||(this.IsNumber(e[i])&&this.IsNumber(e[i-1])?(e[i]<e[i-1]?++r:r=0,r==t&&(a[i]=1,--r)):r=0);return\x20a},this.NDAY=function(e,t,a){var\x20r=[];if(a<1)return\x20r;if(!Array.isArray(e)&&!Array.isArray(t))return\x20r;if(null==e||null==t)return\x20r;if(Array.isArray(e)&&Array.isArray(t)){if(a>=e.length||a>=t.length)return\x20r;for(var\x20i=Math.max(e.length,t.length),n=0,s=0;s<i;++s)r[s]=0,s>=e.length||s>=t.length||(this.IsNumber(e[s])&&this.IsNumber(t[s])?(e[s]>t[s]?++n:n=0,n==a&&(r[s]=1,--n)):n=0)}else\x20if(Array.isArray(e)&&!Array.isArray(t)){if(a>=e.length||!this.IsNumber(t))return;n=0;for(var\x20s\x20in\x20e)r[s]=0,this.IsNumber(e[s])?(e[s]>t?++n:n=0,n==a&&(r[s]=1,--n)):n=0}else\x20if(!Array.isArray(e)&&Array.isArray(t)){if(a>=t.length||!this.IsNumber(e))return;n=0;for(var\x20s\x20in\x20t)r[s]=0,this.IsNumber(t[s])?(e>t[s]?++n:n=0,n==a&&(r[s]=1,--n)):n=0}return\x20r},this.LONGCROSS=function(e,t,a){for(var\x20r=[],i=Math.max(e.length,t.length),n=0;n<i;++n)r[n]=0,n-1<0||n>=e.length||n>=t.length||this.IsNumber(e[n])&&this.IsNumber(t[n])&&this.IsNumber(e[n-1])&&this.IsNumber(t[n-1])&&e[n]>t[n]&&e[n-1]<t[n-1]&&(r[n]=1);n=0;for(var\x20s=0;n<i;++n)if(r[n])for(s=1;s<=a&&n-s>=0;++s)if(e[n-s]>=t[n-s]){r[n]=0;break}return\x20r},this.EXISTR=function(e,t,a){var\x20r=[];if(!Array.isArray(e))return\x20r;if(t=parseInt(t),a=parseInt(a),t<=0&&(t=e.length),a<=0&&(a=1),a>t)return\x20r;r=[];for(var\x20i=0,n=0;i<e.length;++i)if(r[i]=null,!(i-t<0||i-a<0))for(r[i]=0,n=t;n>=a;--n){var\x20s=e[i-n];if(this.IsNumber(s)&&s){r[i]=1;break}}return\x20r},this.RELATE=function(e,t,a){var\x20r=[];if(a<1&&(a=1),!Array.isArray(e)||!Array.isArray(t))return\x20r;for(var\x20i=this.CalculateAverage(e,a),n=this.CalculateAverage(t,a),s=Math.max(e.length,t.length),u=0,o=0;u<s;++u)if(r[u]=null,!(u>=e.length||u>=t.length||u>=i.length||u>=n.length)){var\x20l=i[u],D=n[u],h=0,c=0,C=0;for(o=u-a+1;o<=u;++o)h+=(e[o]-l)*(t[o]-D),c+=Math.pow(e[o]-l,2),C+=Math.pow(t[o]-D,2);r[u]=h/a/(Math.sqrt(c/a)*Math.sqrt(C/a))}return\x20r},this.CalculateAverage=function(e,t){var\x20a=[];if(t<1)return\x20a;for(var\x20r=0,i=0;i<e.length&&!this.IsNumber(e[i]);++i);for(;i<e.length&&i<t;++i){a[i]=null;var\x20n=e[i];this.IsNumber(n)&&(r+=n)}for(a[i-1]=r/t;i<e.length;++i){n=e[i];var\x20s=e[i-t];this.IsNumber(n)||(n=0),this.IsNumber(s)||(s=0),r=r-s+n,a[i]=r/t}return\x20a},this.COVAR=function(e,t,a){var\x20r=[];if(a<1&&(a=1),!Array.isArray(e)||!Array.isArray(t))return\x20r;for(var\x20i=this.CalculateAverage(e,a),n=this.CalculateAverage(t,a),s=Math.max(e.length,t.length),u=(s=Math.max(e.length,t.length),0),o=0;u<s;++u)if(r[u]=null,!(u>=e.length||u>=t.length||u>=i.length||u>=n.length)){var\x20l=i[u],D=n[u],h=0;for(o=u-a+1;o<=u;++o)h+=(e[o]-l)*(t[o]-D);r[u]=h/a}return\x20r},this.HHVBARS=function(e,t){var\x20a=[];if(!Array.isArray(e))return\x20a;if(Array.isArray(t))for(var\x20r=0;r<t.length;++r){a[r]=null;var\x20i=t[r];if(this.IsNumber(i)){var\x20n=r-i;n<0&&(n=0);for(var\x20s=null,u=n;u<e.length;++u)if(this.IsNumber(e[u])){s=u;break}for(var\x20o=0;u<e.length&&o<i;++o,++u)e[u]>=e[s]&&(s=u);null!=s&&(a[r]=r-s)}}else{t<1&&(t=e.length);for(s=null,r=0;r<e.length;++r)if(a[r]=null,this.IsNumber(e[r])){s=r;break}u=0;for(r=s+1;r<e.length&&u<t;++r,++u)e[r]>=e[s]&&(s=r),t==e.length&&(a[r]=r-s);for(;r<e.length;++r){if(r-s<t)e[r]>=e[s]&&(s=r);else\x20for(u=s=r-t+1;u<=r;++u)e[u]>=e[s]&&(s=u);a[r]=r-s}}return\x20a},this.LLVBARS=function(e,t){var\x20a=[];if(!Array.isArray(e))return\x20a;if(Array.isArray(t))for(var\x20r=0;r<t.length;++r){a[r]=null;var\x20i=t[r];if(this.IsNumber(i)){var\x20n=r-i;n<0&&(n=0);for(var\x20s=null,u=n;u<e.length;++u)if(this.IsNumber(e[u])){s=u;break}for(var\x20o=0;u<e.length&&o<i;++o,++u)e[u]<=e[s]&&(s=u);null!=s&&(a[r]=r-s)}}else{t<1&&(t=e.length);for(s=null,r=0;r<e.length;++r)if(a[r]=null,this.IsNumber(e[r])){s=r;break}u=0;for(r=s+1;r<e.length&&u<t;++r,++u)e[r]<=e[s]&&(s=r),t==e.length&&(a[r]=r-s);for(;r<e.length;++r){if(r-s<t)e[r]<=e[s]&&(s=r);else\x20for(u=s=r-t+1;u<=r;++u)e[u]<=e[s]&&(s=u);a[r]=r-s}}return\x20a},this.BETA=function(e){var\x20t=[],a=this.SymbolData.Data,r=this.SymbolData.IndexData;e<=0&&(e=1);for(var\x20i=[],n=[],s=0;s<a.Data.length;++s){i[s]=0,n[s]=0;var\x20u=a.Data[s],o=r.Data[s];u.Close>0&&u.YClose>0&&(i[s]=(u.Close-u.YClose)/u.YClose),o.Close>0&&o.YClose>0&&(n[s]=(o.Close-o.YClose)/o.YClose)}for(var\x20l=this.CalculateAverage(i,e),D=this.CalculateAverage(n,e),h=(s=0,0);s<a.Data.length;++s)if(t[s]=null,!(s>=i.length||s>=n.length||s>=l.length||s>=D.length)){var\x20c=l[s],C=D[s],E=0,m=0;for(h=s-e+1;h<=s;++h){var\x20A=n[h]-C;E+=A*(i[h]-c),m+=A*A}this.IsDivideNumber(m)&&this.IsNumber(E)&&(t[s]=E/m)}return\x20t},this.BETA2=function(e,t,a){var\x20r=[];a<=0&&(a=1);for(var\x20i=[null],n=[null],s=Math.max(e.length,t.length),u={X:e[0],Y:t[0]},o=1;o<s;++o){i[o]=0,n[o]=0;var\x20l=e[o],D=t[o];u.X>0&&(i[o]=(l-u.X)/u.X),u.Y>0&&(n[o]=(D-u.Y)/u.Y),u={X:l,Y:D}}for(var\x20h=this.CalculateAverage(i,a),c=this.CalculateAverage(n,a),C=(o=0,0);o<s;++o)if(r[o]=null,!(o>=i.length||o>=n.length||o>=h.length||o>=c.length)){var\x20E=h[o],m=c[o],A=0,N=0;for(C=o-a+1;C<=o;++C){var\x20I=i[C]-E;A+=I*(n[C]-m),N+=I*I}this.IsDivideNumber(N)&&this.IsNumber(A)&&(r[o]=A/N)}return\x20r},this.SAR=function(e,t,a){var\x20r=[],i=this.SymbolData.Data;if(e>=i.Data.length)return\x20r;for(var\x20n=null,s=null,u=0;u<e;++u){var\x20o=i.Data[u];null==n?n=o.High:n<o.High&&(n=o.High),null==s?s=o.Low:s>o.Low&&(s=o.Low)}var\x20l=0;r[e-1]=s;var\x20D=s,h=i.Data[0].High,c=t/100;for(u=e;u<i.Data.length;++u){var\x20C=h,E=(o=i.Data[u],i.Data[u-1]);0==l?o.Low<r[u-1]?(l=1,h=o.Low,c=t/100,D=Math.max(o.High,E.High),D=Math.max(D,C+c*(h-C))):(l=0,o.High>C&&(h=o.High,c=Math.min(c+t/100,a/100)),D=Math.min(o.Low,E.Low),D=Math.min(D,r[u-1]+c*(h-r[u-1]))):1==l&&(o.High>r[u-1]?(l=0,h=o.High,c=t/100,D=Math.min(o.Low,E.Low),D=Math.min(D,r[u-1]+c*(h-C))):(l=1,o.Low<C&&(h=o.Low,c=Math.min(c+t/100,a/100)),D=Math.max(o.High,E.High),D=Math.max(D,r[u-1]+c*(h-r[u-1])))),r[u]=D}return\x20r},this.SARTURN=function(e,t,a){var\x20r=[],i=this.SAR(e,t,a),n=this.SymbolData.Data,s=0;for(s=0;s<i.length&&!this.IsNumber(i[s]);++s);var\x20u=0;s<n.Data.length&&(u=n.Data[s].Close>i[s]);for(var\x20o=s+1;o<n.Data.length;++o){var\x20l=n.Data[o];l.Close<i[o]&&u?r[o]=-1:r[o]=l.Close>i[o]&&!u?1:0,u=l.Close>i[o]}return\x20r},this.BACKSET=function(e,t){var\x20a=[];if(!e)return\x20a;var\x20r=e.length;if(!this.IsNumber(r)||r<=0)return\x20a;if(Array.isArray(t)){for(var\x20i=0;i<r;++i)a[i]=0;for(i=0;i<r;++i){var\x20n=e[i],s=t[i];if(this.IsNumber(n)&&n&&this.IsNumber(s))for(var\x20u=i,o=0;u>=0&&o<s;--u,++o)a[u]=1}}else{for(i=0;i<r;++i)a[i]=0;for(var\x20l=0;l<r&&!this.IsNumber(e[l]);++l);if(l==r)return\x20a;var\x20D=Math.min(r-l,Math.max(t,1));for(i=r-1,u=0;i>=0;--i){n=e[i];if(this.IsNumber(n)&&n)for(u=i;u>i-D;--u)a[u]=1}if(e[i])for(u=i;u>=l;--u)a[u]=1}return\x20a},this.BETWEEN=function(e,t,a){var\x20r=[],i=\x22number\x22==typeof\x20t,n=\x22number\x22==typeof\x20a;if(\x22number\x22==typeof\x20e&&i&&n)return\x20e>=t&&e<=a?1:0;for(var\x20s\x20in\x20e){r[s]=0;var\x20u=e[s],o=null,l=null;i?o=t:s<t.length-1&&(o=t[s]),n?l=a:s<a.length-1&&(l=a[s]),null!=o&&null!=l&&(o>l?u>=l&&u<=o&&(r[s]=1):u<=l&&u>=o&&(r[s]=1))}return\x20r},this.STRCAT=function(e,t){var\x20a=[];return\x20IFrameSplitOperator.IsString(e)&&IFrameSplitOperator.IsString(t)&&(a=e+t),a},this.VARCAT=function(e,t){var\x20a=[];if(Array.isArray(e)&&Array.isArray(t))for(var\x20r=Math.max(e.length,t.length),i=\x22\x22,n=0;n<r;++n){if(a[n]=null,i=\x22\x22,n<e.length){var\x20s=e[n];IFrameSplitOperator.IsString(s)&&(i+=s)}if(n<t.length){s=t[n];IFrameSplitOperator.IsString(s)&&(i+=s)}\x22\x22!=i&&(a[n]=i)}else\x20if(IFrameSplitOperator.IsString(e)&&Array.isArray(t))for(n=0;n<t.length;++n){a[n]=null;s=t[n];IFrameSplitOperator.IsString(s)&&(a[n]=e+s)}else\x20if(Array.isArray(e)&&IFrameSplitOperator.IsString(t))for(n=0;n<e.length;++n){a[n]=null;s=e[n];IFrameSplitOperator.IsString(s)&&(a[n]=s+t)}else\x20IFrameSplitOperator.IsString(e)&&IFrameSplitOperator.IsString(t)&&(a=e+t);return\x20a},this.STRSPACE=function(e){var\x20t=[];if(Array.isArray(e))for(var\x20a=0;a<e.length;++a){t[a]=null;var\x20r=e[a];IFrameSplitOperator.IsString(r)&&(t[a]=r+\x22\x20\x22)}else\x20IFrameSplitOperator.IsString(e)&&(t=e+\x22\x20\x22);return\x20t},this.CON2STR=function(e,t){var\x20a=[];if(Array.isArray(e))for(var\x20r=e.length-1;r>=0;--r){var\x20i=e[r];if(this.IsNumber(i))return\x20a=i.toFixed(t)}else\x20this.IsNumber(e)&&(a=e.toFixed(t));return\x20a},this.VAR2STR=function(e,t){var\x20a=[];if(Array.isArray(e))for(var\x20r=0;r<e.length;++r){a[r]=null;var\x20i=e[r];this.IsNumber(i)&&(a[r]=i.toFixed(t))}else\x20this.IsNumber(e)&&(a=e.toFixed(t));return\x20a},this.MOD=function(e,t){var\x20a=[];let\x20r=\x22number\x22==typeof\x20e,i=\x22number\x22==typeof\x20t;if(r&&i)return\x20JSAlgorithm.MOD(e,t);if(!r&&!i){let\x20r=Math.max(e.length,t.length);for(var\x20n=0;n<r;++n)a[n]=null,n<e.length&&n<t.length&&this.IsNumber(e[n])&&this.IsNumber(t[n])&&(a[n]=JSAlgorithm.MOD(e[n],t[n]));return\x20a}if(r&&!i){for(var\x20n\x20in\x20t)a[n]=null,this.IsNumber(e)&&this.IsNumber(t[n])&&(a[n]=JSAlgorithm.MOD(e,t[n]));return\x20a}if(!r&&i){for(var\x20n\x20in\x20e)a[n]=null,this.IsNumber(e[n])&&this.IsNumber(t)&&(a[n]=JSAlgorithm.MOD(e[n],t));return\x20a}return\x20a},this.POW=function(e,t){var\x20a=[];if(!IFrameSplitOperator.IsNumber(t))return\x20a;if(\x22number\x22==typeof\x20e)return\x20Math.pow(e,t);for(var\x20r\x20in\x20e){var\x20i=e[r];this.IsNumber(i)?a[r]=Math.pow(i,t):a[r]=null}return\x20a},this.CEILING=function(e){if(\x22number\x22==typeof\x20e)return\x20parseInt(e);var\x20t=[];for(var\x20a\x20in\x20e){var\x20r=e[a];this.IsNumber(r)?t[a]=parseInt(r):t[a]=null}return\x20t},this.FLOOR=function(e){if(\x22number\x22==typeof\x20e)return\x20parseInt(e-1);var\x20t=[];for(var\x20a\x20in\x20e){var\x20r=e[a];this.IsNumber(r)?t[a]=parseInt(r-1):t[a]=null}return\x20t},this.ZTPRICE=function(e,t){if(!this.IsNumber(t))return\x20null;if(Array.isArray(e)){var\x20a=[];for(var\x20r\x20in\x20e){var\x20i=e[r];this.IsNumber(i)?a[r]=(1+t)*i:a[r]=null}return\x20a}return\x20this.IsNumber(e)?a=(1+t)*e:void\x200},this.DTPRICE=function(e,t){if(!this.IsNumber(t))return\x20null;if(Array.isArray(e)){var\x20a=[];for(var\x20r\x20in\x20e){var\x20i=e[r];this.IsNumber(i)?a[r]=(1-t)*i:a[r]=null}return\x20a}return\x20this.IsNumber(e)?a=(1-t)*e:void\x200},this.FRACPART=function(e){if(Array.isArray(e)){var\x20t=[],a=0;for(var\x20r\x20in\x20e){var\x20i=e[r];this.IsNumber(i)?(a=parseInt(i),t[r]=i-a):t[r]=null}return\x20t}if(this.IsNumber(e))return\x20t=e-(a=parseInt(e))},this.BARSLASTCOUNT=function(e){var\x20t=null;if(Array.isArray(e)){if(t=[],e.length>0)for(var\x20a=0,r=e.length-1;r>=0;--r){a=0;for(var\x20i=r;i>=0&&e[i];--i)++a;t[r]=a}}else\x20t=e?1:0;return\x20t},this.INTPART=function(e){var\x20t=null;if(Array.isArray(e))for(var\x20a\x20in\x20t=[],e){var\x20r=e[a];this.IsNumber(r)?t[a]=parseInt(r):t[a]=null}else\x20this.IsNumber(e)&&(t=parseInt(e));return\x20t},this.CONST=function(e){if(Array.isArray(e)){var\x20t=e.length;return\x20t>0?e[t-1]:null}return\x20e},this.TOPRANGE=function(e){if(this.IsNumber(e))return\x200;var\x20t=[];if(Array.isArray(e))for(var\x20a=e.length-1;a>=0;--a){t[a]=0;var\x20r=e[a];if(this.IsNumber(r)){for(var\x20i=0,n=a-1;n>=0&&!(e[n]>r);--n)++i;t[a]=i}}return\x20t},this.LOWRANGE=function(e){if(this.IsNumber(e))return\x200;var\x20t=[];if(Array.isArray(e))for(var\x20a=e.length-1;a>=0;--a){t[a]=0;var\x20r=e[a];if(this.IsNumber(r)){for(var\x20i=0,n=a-1;n>=0&&!(e[n]<r);--n)++i;t[a]=i}}return\x20t},this.FINDLOW=function(e,t,a,r){if(this.IsNumber(e))return\x20e;var\x20i=[];if(Array.isArray(e))for(var\x20n=e.length-1;n>=0;--n){i[n]=null;for(var\x20s=[],u=t;u<a;++u){var\x20o;if((o=n-u)<0)break;var\x20l=e[o];this.IsNumber(l)&&s.push(l)}if(s.length>0)s.sort(function(e,t){return\x20e-t}),(o=r-1)<0?o=0:o>=s.length&&(o=s.length-1),i[n]=s[o]}return\x20i},this.FINDHIGH=function(e,t,a,r){if(this.IsNumber(e))return\x20e;var\x20i=[];if(Array.isArray(e))for(var\x20n=e.length-1;n>=0;--n){i[n]=null;for(var\x20s=[],u=t;u<a;++u){var\x20o;if((o=n-u)<0)break;var\x20l=e[o];this.IsNumber(l)&&s.push(l)}if(s.length>0)s.sort(function(e,t){return\x20t-e}),(o=r-1)<0?o=0:o>=s.length&&(o=s.length-1),i[n]=s[o]}return\x20i},this.FINDHIGHBARS=function(e,t,a,r){if(this.IsNumber(e))return\x20a-t-r;var\x20i=[];if(Array.isArray(e))for(var\x20n=e.length-1;n>=0;--n){i[n]=null;for(var\x20s=[],u=t;u<a;++u){var\x20o;if((o=n-u)<0)break;var\x20l=e[o];this.IsNumber(l)&&s.push({Value:l,Period:u})}if(s.length>0)s.sort(function(e,t){return\x20t.Value-e.Value}),(o=r-1)<0?o=0:o>=s.length&&(o=s.length-1),i[n]=s[o].Period}return\x20i},this.FINDLOWBARS=function(e,t,a,r){if(this.IsNumber(e))return\x20a-t-r;var\x20i=[];if(Array.isArray(e))for(var\x20n=e.length-1;n>=0;--n){i[n]=null;for(var\x20s=[],u=t;u<a;++u){var\x20o;if((o=n-u)<0)break;var\x20l=e[o];this.IsNumber(l)&&s.push({Value:l,Period:u})}if(s.length>0)s.sort(function(e,t){return\x20e.Value-t.Value}),(o=r-1)<0?o=0:o>=s.length&&(o=s.length-1),i[n]=s[o].Period}return\x20i},this.HOD=function(e,t){var\x20a=[];if(IFrameSplitOperator.IsNumber(e))return\x201;if(Array.isArray(e))for(var\x20r=e.length-1;r>=0;--r){var\x20i=e[r];if(IFrameSplitOperator.IsNumber(i)){if(Array.isArray(t))var\x20n=parseInt(t[r]);else\x20n=parseInt(t);t<=0&&(n=r);for(var\x20s=1,u=r-1,o=1;u>=0&&o<n;--u,++o){var\x20l=e[u];IFrameSplitOperator.IsNumber(l)&&l>i&&++s}a[r]=s}}return\x20a},this.LOD=function(e,t){var\x20a=[];if(IFrameSplitOperator.IsNumber(e))return\x201;if(Array.isArray(e))for(var\x20r=e.length-1;r>=0;--r){var\x20i=e[r];if(IFrameSplitOperator.IsNumber(i)){if(Array.isArray(t))var\x20n=parseInt(t[r]);else\x20n=parseInt(t);t<=0&&(n=r);for(var\x20s=1,u=r-1,o=1;u>=0&&o<n;--u,++o){var\x20l=e[u];IFrameSplitOperator.IsNumber(l)&&l<i&&++s}a[r]=s}}return\x20a},this.BARSNEXT=function(e){if(!Array.isArray(e))return\x200;for(var\x20t=[],a=0;a<e.length;++a){t[a]=0;for(var\x20r=a,i=0;r<e.length;++r,++i){if(e[r]>0){t[a]=i;break}}}return\x20t},this.RAND=function(e){if(Array.isArray(e)){var\x20t=[];for(var\x20a\x20in\x20e){t[a]=null;var\x20r=e[a];(i=parseInt(r))<=0||(t[a]=Math.ceil(Math.random()*i))}return\x20t}var\x20i;if((i=parseInt(e))<=0)return\x20null;var\x20n=this.SymbolData.Data.Data.length;for(t=[],a=0;a<n;++a)t[a]=Math.ceil(Math.random()*i);return\x20t},this.AMA=function(e,t){var\x20a,r=[];if(Array.isArray(t)){for(var\x20i=e.length-1;i>=0;--i)if(this.IsNumber(t[i])){a=t[i];break}}else\x20a=t;if(this.IsNumber(a)){if(a>1)return\x20r;for(var\x20n=0,s=0;n<e.length;++n)if(r[n]=null,this.IsNumber(e[n])){s=e[n],r[n]=s;break}for(i=n+1;i<e.length;++i){var\x20u=e[i];r[i]=r[i-1]+a*(u-r[i-1])}}return\x20r},this.TMA=function(e,t,a){var\x20r=[];if(this.IsNumber(t)&&t<=1&&this.IsNumber(a)&&a<1){var\x20i=!1;for(var\x20n\x20in\x20e)if(r[n]=null,0==i){var\x20s=e[n];this.IsNumber(s)&&(r[n]=s,r[n],i=!0)}else{s=e[n];if(!this.IsNumber(s))continue;r[n]=t*r[n-1]+a*s,r[n]}}return\x20r},this.CallFunction=function(e,t,a,r){switch(e){case\x22MAX\x22:case\x22MAX6\x22:return\x20this.MAX(t,a);case\x22MIN\x22:case\x22MIN6\x22:return\x20this.MIN(t,a);case\x22REF\x22:return\x20this.REF(t[0],t[1]);case\x22REFV\x22:return\x20this.REFV(t[0],t[1]);case\x22REFX\x22:return\x20this.REFX(t[0],t[1]);case\x22REFXV\x22:return\x20this.REFXV(t[0],t[1]);case\x22ABS\x22:return\x20this.ABS(t[0]);case\x22MA\x22:return\x20this.MA(t[0],t[1]);case\x22EMA\x22:return\x20this.EMA(t[0],t[1]);case\x22SMA\x22:return\x20this.SMA(t[0],t[1],t[2]);case\x22DMA\x22:return\x20this.DMA(t[0],t[1]);case\x22XMA\x22:return\x20this.XMA(t[0],t[1]);case\x22EXPMA\x22:return\x20this.EXPMA(t[0],t[1]);case\x22EXPMEMA\x22:return\x20this.EXPMEMA(t[0],t[1]);case\x22COUNT\x22:return\x20this.COUNT(t[0],t[1]);case\x22LLV\x22:return\x20this.LLV(t[0],t[1]);case\x22LLVBARS\x22:return\x20this.LLVBARS(t[0],t[1]);case\x22HHV\x22:return\x20this.HHV(t[0],t[1]);case\x22HHVBARS\x22:return\x20this.HHVBARS(t[0],t[1]);case\x22MULAR\x22:return\x20this.MULAR(t[0],t[1]);case\x22CROSS\x22:return\x20this.CROSS(t[0],t[1]);case\x22LONGCROSS\x22:return\x20this.LONGCROSS(t[0],t[1],t[2]);case\x22AVEDEV\x22:return\x20this.AVEDEV(t[0],t[1]);case\x22STD\x22:return\x20this.STD(t[0],t[1]);case\x22IF\x22:case\x22IFF\x22:return\x20this.IF(t[0],t[1],t[2]);case\x22IFN\x22:return\x20this.IFN(t[0],t[1],t[2]);case\x22NOT\x22:return\x20this.NOT(t[0]);case\x22SUM\x22:return\x20this.SUM(t[0],t[1]);case\x22RANGE\x22:return\x20this.RANGE(t[0],t[1],t[2]);case\x22EXIST\x22:return\x20this.EXIST(t[0],t[1]);case\x22EXISTR\x22:return\x20this.EXISTR(t[0],t[1],t[2]);case\x22FILTER\x22:return\x20this.FILTER(t[0],t[1]);case\x22TFILTER\x22:return\x20this.TFILTER(t[0],t[1],t[2]);case\x22SLOPE\x22:return\x20this.SLOPE(t[0],t[1]);case\x22BARSLAST\x22:return\x20this.BARSLAST(t[0]);case\x22BARSCOUNT\x22:return\x20this.BARSCOUNT(t[0]);case\x22BARSSINCEN\x22:return\x20this.BARSSINCEN(t[0],t[1]);case\x22BARSSINCE\x22:return\x20this.BARSSINCE(t[0]);case\x22LAST\x22:return\x20this.LAST(t[0],t[1],t[2]);case\x22EVERY\x22:return\x20this.EVERY(t[0],t[1]);case\x22DEVSQ\x22:return\x20this.DEVSQ(t[0],t[1]);case\x22ZIG\x22:return\x20this.ZIG(t[0],t[1]);case\x22TROUGHBARS\x22:return\x20this.TROUGHBARS(t[0],t[1],t[2]);case\x22TROUGH\x22:return\x20this.TROUGH(t[0],t[1],t[2]);case\x22PEAKBARS\x22:return\x20this.PEAKBARS(t[0],t[1],t[2]);case\x22PEAK\x22:return\x20this.PEAK(t[0],t[1],t[2]);case\x22COST\x22:return\x20this.COST(t[0]);case\x22WINNER\x22:return\x20this.WINNER(t[0],a);case\x22PPART\x22:return\x20this.PPART(t[0],a);case\x22COSTEX\x22:return\x20this.COSTEX(t[0],t[1],a);case\x22LWINNER\x22:return\x20this.LWINNER(t[0],t[1],a);case\x22PWINNER\x22:return\x20this.PWINNER(t[0],t[1],a);case\x22FORCAST\x22:return\x20this.FORCAST(t[0],t[1]);case\x22STDP\x22:return\x20this.STDP(t[0],t[1]);case\x22VAR\x22:return\x20this.VAR(t[0],t[1]);case\x22VARP\x22:return\x20this.VARP(t[0],t[1]);case\x22UPNDAY\x22:return\x20this.UPNDAY(t[0],t[1]);case\x22DOWNNDAY\x22:return\x20this.DOWNNDAY(t[0],t[1]);case\x22NDAY\x22:return\x20this.NDAY(t[0],t[1],t[2]);case\x22RELATE\x22:return\x20this.RELATE(t[0],t[1],t[2]);case\x22COVAR\x22:return\x20this.COVAR(t[0],t[1],t[2]);case\x22BETA\x22:return\x20this.BETA(t[0]);case\x22BETA2\x22:return\x20this.BETA2(t[0],t[1],t[2]);case\x22WMA\x22:return\x20this.WMA(t[0],t[1]);case\x22MEMA\x22:return\x20this.MEMA(t[0],t[1]);case\x22SUMBARS\x22:return\x20this.SUMBARS(t[0],t[1]);case\x22REVERSE\x22:return\x20this.REVERSE(t[0]);case\x22SAR\x22:return\x20this.SAR(t[0],t[1],t[2]);case\x22SARTURN\x22:return\x20this.SARTURN(t[0],t[1],t[2]);case\x22BACKSET\x22:return\x20this.BACKSET(t[0],t[1]);case\x22BETWEEN\x22:return\x20this.BETWEEN(t[0],t[1],t[2]);case\x22STRCAT\x22:return\x20this.STRCAT(t[0],t[1]);case\x22CON2STR\x22:return\x20this.CON2STR(t[0],t[1]);case\x22VAR2STR\x22:return\x20this.VAR2STR(t[0],t[1]);case\x22VARCAT\x22:return\x20this.VARCAT(t[0],t[1]);case\x22STRSPACE\x22:return\x20this.STRSPACE(t[0]);case\x22DTPRICE\x22:return\x20this.DTPRICE(t[0],t[1]);case\x22ZTPRICE\x22:return\x20this.ZTPRICE(t[0],t[1]);case\x22MOD\x22:return\x20this.MOD(t[0],t[1]);case\x22POW\x22:return\x20this.POW(t[0],t[1]);case\x22CEILING\x22:return\x20this.CEILING(t[0]);case\x22FLOOR\x22:return\x20this.FLOOR(t[0]);case\x22FRACPART\x22:return\x20this.FRACPART(t[0]);case\x22BARSLASTCOUNT\x22:return\x20this.BARSLASTCOUNT(t[0]);case\x22INTPART\x22:return\x20this.INTPART(t[0]);case\x22CONST\x22:return\x20this.CONST(t[0]);case\x22TOPRANGE\x22:return\x20this.TOPRANGE(t[0]);case\x22LOWRANGE\x22:return\x20this.LOWRANGE(t[0]);case\x22FINDLOW\x22:return\x20this.FINDLOW(t[0],t[1],t[2],t[3]);case\x22FINDLOWBARS\x22:return\x20this.FINDLOWBARS(t[0],t[1],t[2],t[3]);case\x22FINDHIGH\x22:return\x20this.FINDHIGH(t[0],t[1],t[2],t[3]);case\x22FINDHIGHBARS\x22:return\x20this.FINDHIGHBARS(t[0],t[1],t[2],t[3]);case\x22BARSNEXT\x22:return\x20this.BARSNEXT(t[0]);case\x22HOD\x22:return\x20this.HOD(t[0],t[1]);case\x22LOD\x22:return\x20this.LOD(t[0],t[1]);case\x22AMA\x22:return\x20this.AMA(t[0],t[1]);case\x22TMA\x22:return\x20this.TMA(t[0],t[1],t[2]);case\x22ATAN\x22:return\x20this.Trigonometric(t[0],Math.atan);case\x22ACOS\x22:return\x20this.ACOS(t[0]);case\x22ASIN\x22:return\x20this.ASIN(t[0]);case\x22COS\x22:return\x20this.Trigonometric(t[0],Math.cos);case\x22SIN\x22:return\x20this.Trigonometric(t[0],Math.sin);case\x22TAN\x22:return\x20this.Trigonometric(t[0],Math.tan);case\x22LN\x22:return\x20this.Trigonometric(t[0],Math.log);case\x22LOG\x22:return\x20this.Trigonometric(t[0],Math.log10);case\x22EXP\x22:return\x20this.Trigonometric(t[0],Math.exp);case\x22SQRT\x22:return\x20this.Trigonometric(t[0],Math.sqrt);case\x22RAND\x22:return\x20this.RAND(t[0]);default:this.ThrowUnexpectedNode(a,\x22函数\x22+e+\x22不存在\x22,e)}},this.CallCustomFunction=function(e,t,a,r){var\x20i=g_JSComplierResource.CustomFunction.Data.get(e),n=a.GetStockCacheData({CustomName:e,Node:r});if(!i.Invoke)return{Out:n};JSConsole.Complier.Log(\x22[JSAlgorithm::CallCustomFunction]\x20call\x20custom\x20function\x20functionInfo=\x22,i);var\x20s=this,u={Name:e,Args:t,Symbol:a.Symbol,Period:a.Period,Right:a.Right,KData:a.Data,DownloadData:n,ThrowError:function(e){s.ThrowUnexpectedNode(r,e)}};return\x20i.Invoke(u)},this.ThrowUnexpectedNode=function(e,t,a){let\x20r=e.Marker,i=t||\x22执行异常\x22;return\x20this.ErrorHandler.ThrowError(r.Index,r.Line,r.Column,i,a)}}function\x20JSDraw(e,t){this.ErrorHandler=e,this.SymbolData=t,this.DRAWTEXT=function(e,t,a){let\x20r=[],i={DrawData:r,DrawType:\x22DRAWTEXT\x22,Text:a};if(Array.isArray(e)){if(e.length<=0)return\x20i;var\x20n=this.IsNumber(t);for(var\x20s\x20in\x20e)r[s]=null,!isNaN(e[s])&&e[s]&&(n?r[s]=t:this.IsNumber(t[s])&&(r[s]=t[s]))}else\x20if(this.IsNumber(e)&&e)for(n=this.IsNumber(t),s=0;s<this.SymbolData.Data.Data.length;++s)n?r[s]=t:this.IsNumber(t[s])&&(r[s]=t[s]);return\x20i},this.DRAWTEXT_FIX=function(e,t,a,r,i){var\x20n={Value:[],Text:[]},s={DrawData:n,DrawType:\x22DRAWTEXT_FIX\x22,Text:null,Position:{X:t,Y:a,Type:r}};if(e.length<=0)return\x20s;if(Array.isArray(e))for(var\x20u\x20in\x20e)n.Text[u]=null,n.Value[u]=0,!isNaN(e[u])&&e[u]&&(n.Value[u]=1,n.Text[u]=i);else\x20if(e)for(u=0;u<this.SymbolData.Data.Data.length;++u)n.Text[u]=i,n.Value[u]=1;return\x20s},this.SUPERDRAWTEXT=function(e,t,a,r,i){let\x20n=[],s={DrawData:n,DrawType:\x22SUPERDRAWTEXT\x22,Text:a,YOffset:i,Direction:r,TextAlign:\x22center\x22};if(e.length<=0)return\x20s;var\x20u=\x22number\x22==typeof\x20t;for(var\x20o\x20in\x20e)n[o]=null,!isNaN(e[o])&&e[o]&&(u?n[o]=t:this.IsNumber(t[o])&&(n[o]=t[o]));return\x20s},this.STICKLINE=function(e,t,a,r,i){let\x20n=[],s={DrawData:n,DrawType:\x22STICKLINE\x22,Width:r,Type:i};if(s.Width<0&&(s.Width=3),e.length<=0)return\x20s;var\x20u=\x22number\x22==typeof\x20t,o=\x22number\x22==typeof\x20a;for(var\x20l\x20in\x20e)if(n[l]=null,!isNaN(e[l])&&e[l])if(u&&o)n[l]={Value:t,Value2:a};else\x20if(u&&!o){if(isNaN(a[l]))continue;n[l]={Value:t,Value2:a[l]}}else\x20if(!u&&o){if(isNaN(t[l]))continue;n[l]={Value:t[l],Value2:a}}else{if(isNaN(t[l])||isNaN(a[l]))continue;n[l]={Value:t[l],Value2:a[l]}}return\x20s},this.DRAWLINE=function(e,t,a,r,i){let\x20n=[],s={DrawData:n,DrawType:\x22DRAWLINE\x22,Expand:i};if(e.length<=0)return\x20s;let\x20u=Math.max(e.length,a.length),o=!1,l=!1,D={Start:{},End:{},List:new\x20Array};for(var\x20h=0;h<u;++h){if(n[h]=null,h<e.length&&h<a.length)if(0==o&&0==l){if(null==e[h]||!e[h])continue;o=!0,D.Start={ID:h,Value:t[h]}}else\x20if(1==o&&0==l){if(!(c=null!=a[h]&&a[h])){e[h]&&(D.Start={ID:h,Value:t[h]});continue}c&&(l=!0,D.End={ID:h,Value:r[h]})}else\x20if(1==o&&1==l){var\x20c;if(c=null!=a[h]&&a[h])D.End={ID:h,Value:r[h]};else\x20if(e[h]){let\x20e=this.CalculateDrawLine(D);for(var\x20C\x20in\x20e){let\x20t=e[C];n[t.ID]=t.Value}1==i&&this.CalculateDrawDataExtendLine(n,D.Start.ID-2),o=l=!1,o=!0,l=!1,(D={Start:{},End:{}}).Start={ID:h,Value:t[h]}}}if(1==o&&1==l){let\x20e=this.CalculateDrawLine(D);for(var\x20C\x20in\x20e){let\x20t=e[C];n[t.ID]=t.Value}}}return\x201==i&&this.CalculateDrawDataExtendLine(n),s},this.DRAWBAND=function(e,t,a,r){let\x20i=[],n={DrawData:i,DrawType:\x22DRAWBAND\x22,Color:[t.toLowerCase(),r.toLowerCase()]},s=Math.max(e.length,a.length);for(var\x20u=0;u<s;++u){let\x20t={Value:null,Value2:null};u<e.length&&(t.Value=e[u]),u<a.length&&(t.Value2=a[u]),i.push(t)}return\x20n},this.GetDataByIndex=function(e,t){var\x20a={Result:!1,Data:null};return\x20this.IsNumber(e)?(a.Result=!0,a.Data=e):t<e.length?(a.Result=!0,a.Data=e[t]):a.Result=!1,a},this.FILLRGN=function(e,t,a){let\x20r=[],i={DrawData:r,DrawType:\x22FILLRGN\x22};this.IsNumber(t),this.IsNumber(a);if(Array.isArray(e))for(var\x20n\x20in\x20e){if(r[n]=null,e[n])if((u=this.GetDataByIndex(t,n)).Result)if((o=this.GetDataByIndex(a,n)).Result){var\x20s={Value:u.Data,Value2:o.Data};r[n]=s}}else\x20if(e)for(n=0;n<this.SymbolData.Data.Data.length;++n){var\x20u,o;if(r[n]=null,(u=this.GetDataByIndex(t,n)).Result)if((o=this.GetDataByIndex(a,n)).Result){s={Value:u.Data,Value2:o.Data};r[n]=s}}return\x20i},this.DRAWKLINE=function(e,t,a,r){let\x20i=[],n={DrawData:i,DrawType:\x22DRAWKLINE\x22},s=Math.max(e.length,t.length,a.length,r.length);for(var\x20u=0;u<s;++u){let\x20n={Open:null,High:null,Low:null,Close:null};u<e.length&&u<t.length&&u<a.length&&u<r.length&&(n.Open=t[u],n.High=e[u],n.Low=a[u],n.Close=r[u]),i[u]=n}return\x20n},this.DRAWKLINE_IF=function(e,t,a,r,i){let\x20n=[],s={DrawData:n,DrawType:\x22DRAWKLINE_IF\x22},u=Math.max(e.length,t.length,a.length,r.length,i.length);for(var\x20o=0;o<u;++o){let\x20s={Open:null,High:null,Low:null,Close:null};o<t.length&&o<a.length&&o<r.length&&o<i.length&&o<e.length&&e[o]&&(s.Open=a[o],s.High=t[o],s.Low=r[o],s.Close=i[o]),n[o]=s}return\x20s},this.POLYLINE=function(e,t){let\x20a=[],r={DrawData:a,DrawType:\x22POLYLINE\x22},i=!1;if(\x22number\x22==typeof\x20t)if(this.IsNumber(e)){if(e)for(var\x20n=this.SymbolData.Data.Data.length,s=0;s<n;++s)a[s]=t}else{var\x20u=!1;for(var\x20s\x20in\x20e)if(a[s]=null,u)a[s]=t;else{if(!e[s])continue;u=!0,a[s]=t}}else{let\x20r={Start:{},End:{},List:new\x20Array};for(var\x20s\x20in\x20e)if(a[s]=null,0==i){if(null==e[s]||!e[s])continue;if(s>=t.length||!this.IsNumber(t[s]))continue;i=!0,r.Start={ID:parseInt(s),Value:t[s]}}else\x20if(1==i){if(null==e[s]||!e[s])continue;if(s>=t.length||!this.IsNumber(t[s]))continue;r.End={ID:parseInt(s),Value:t[s]};let\x20i=this.CalculateDrawLine(r);for(var\x20o\x20in\x20i){let\x20e=i[o];a[e.ID]=e.Value}r={Start:{ID:r.End.ID,Value:r.End.Value},End:{}}}this.CalculateDrawDataExtendLine(a)}return\x20r},this.CalculateDrawDataExtendLine=function(e,t){if(!(t<0)){var\x20a=null,r=e.length;this.IsNumber(t)&&t<r&&(r=t);for(var\x20i=r-1;i>=0;--i)if(this.IsNumber(e[i])){a=i;break}if(null!=a&&a-1>=0){var\x20n=a-1;for(i=a+1;i<r;++i){var\x20s=e[n],u=(s-e[a])*(i-n)/(a-n);if(s-u<0)break;e[i]=s-u}}}},this.DRAWNUMBER=function(e,t,a){let\x20r,i={Value:new\x20Array,Text:new\x20Array},n={DrawData:i,DrawType:\x22DRAWNUMBER\x22},s=\x22number\x22==typeof\x20a;for(var\x20u\x20in\x20s&&(r=IFrameSplitOperator.IsInteger(a)?a.toString():a.toFixed(2)),e)if(i.Value[u]=null,e[u]&&!(u>=t.length)&&this.IsNumber(t[u]))if(s)i.Value[u]=t[u],i.Text[u]=r;else{if(u>=a.length||!a[u])continue;i.Value[u]=t[u],\x22number\x22==typeof\x20a[u]?i.Text[u]=a[u].toFixed(2):i.Text[u]=a[u].toString()}return\x20n},this.DRAWNUMBER_FIX=function(e,t,a,r,i){var\x20n={Value:[],Text:[]},s={DrawData:n,DrawType:\x22DRAWNUMBER_FIX\x22,Position:{X:t,Y:a,Type:r}},u=IFrameSplitOperator.IsNumber(i);if(Array.isArray(e)){for(var\x20o\x20in\x20e)if(n.Text[o]=null,n.Value[o]=null,e[o])if(u)n.Text[o]=this.RemoveZero(i.toFixed(2)),n.Value[o]=i;else{if(o>=i.length||!IFrameSplitOperator.IsNumber(i[o]))continue;var\x20l=i[o];n.Text[o]=this.RemoveZero(l.toFixed(2)),n.Value[o]=l}}else\x20if(e)for(o=0;o<this.SymbolData.Data.Data.length;++o)if(u)n.Text[o]=this.RemoveZero(i.toFixed(2)),n.Value[o]=i;else{if(o>=i.length||!IFrameSplitOperator.IsNumber(i[o]))continue;l=i[o];n.Text[o]=this.RemoveZero(l.toFixed(2)),n.Value[o]=l}else;return\x20s},this.DRAWICON=function(e,t,a){var\x20r=g_JSComplierResource.GetDrawIcon(a);r||g_JSComplierResource.GetDrawTextIcon(a),r||(r={Symbol:\x22🚩\x22});let\x20i=[],n={DrawData:i,DrawType:\x22DRAWICON\x22,Icon:r};if(e.length<=0)return\x20n;var\x20s=\x22number\x22==typeof\x20t;if(\x22number\x22==typeof\x20e){if(!e)return\x20n;for(var\x20u=0;u<this.SymbolData.Data.Data.length;++u)s?i[u]=t:u<t.length&&this.IsNumber(t[u])?i[u]=t[u]:i[u]=null;return\x20n}for(var\x20u\x20in\x20e)i[u]=null,e[u]&&(s?i[u]=t:this.IsNumber(t[u])&&(i[u]=t[u]));return\x20n},this.DRAWCHANNEL=function(e,t,a,r,i,n,s){let\x20u=[],o={DrawData:u,DrawType:\x22DRAWCHANNEL\x22,Border:{}};if(e.length<=0)return\x20o;if(r&&(o.Border.Color=r),s&&(o.AreaColor=s),i>0&&(o.Border.Width=i),n){let\x20e=n.split(\x22,\x22);for(var\x20l\x20in\x20o.Border.Dotted=[],e){if(e[l]){var\x20D=parseInt(e[l]);D<=0||o.Border.Dotted.push(D)}}o.Border.Dotted.length<=0&&(o.Border.Dotted=null)}var\x20h=\x22number\x22==typeof\x20t,c=\x22number\x22==typeof\x20a;if(\x22number\x22==typeof\x20e){if(!e)return\x20o;for(l=0;l<this.SymbolData.Data.Data.length;++l)if(u[l]=null,h&&c)u[l]={Value:t,Value2:a};else\x20if(h&&!c){if(isNaN(a[l]))continue;u[l]={Value:t,Value2:a[l]}}else\x20if(!h&&c){if(isNaN(t[l]))continue;u[l]={Value:t[l],Value2:a}}else{if(isNaN(t[l])||isNaN(a[l]))continue;u[l]={Value:t[l],Value2:a[l]}}}else\x20for(l=0;l<e.length;++l)if(u[l]=null,!isNaN(e[l])&&e[l])if(h&&c)u[l]={Value:t,Value2:a};else\x20if(h&&!c){if(isNaN(a[l]))continue;u[l]={Value:t,Value2:a[l]}}else\x20if(!h&&c){if(isNaN(t[l]))continue;u[l]={Value:t[l],Value2:a}}else{if(isNaN(t[l])||isNaN(a[l]))continue;u[l]={Value:t[l],Value2:a[l]}}return\x20o},this.RGB=function(e,t,a){return`RGB(${e},${t},${a})`},this.RGBA=function(e,t,a,r){return`RGB(${e},${t},${a},${r})`},this.PARTLINE=function(e){let\x20t=[],a={DrawData:t,DrawType:\x22PARTLINE\x22};if(e.length<3)return\x20a;for(var\x20r=e[0],i=[],n=1;n<e.length&&n+1<e.length;n+=2)i.push({Cond:e[n],RGB:e[n+1]});for(var\x20n\x20in\x20r){var\x20s={Value:null,RGB:null};t[n]=s;var\x20u=r[n];if(this.IsNumber(u)){var\x20o=null;for(var\x20l\x20in\x20i){var\x20D=i[l];if(Array.isArray(D.Cond)){if(n<D.Cond.length&&D.Cond[n]){o=D.RGB;break}}else\x20if(this.IsNumber(D.Cond)&&D.Cond){o=D.RGB;break}}o&&(s.Value=u,s.RGB=o)}}return\x20a},this.FILLRGN2=function(e){let\x20t=[],a={DrawData:t,DrawType:\x22FILLRGN2\x22};if(e.length<4)return\x20a;for(var\x20r=e[0],i=e[1],n=[],s=2;s<e.length&&s+1<e.length;s+=2)n.push({Cond:e[s],Color:e[s+1]});for(s=0;s<this.SymbolData.Data.Data.length;++s){t[s]=null;var\x20u={Value:null,Value2:null,Color:null};for(var\x20o\x20in\x20n){var\x20l=n[o];if(Array.isArray(l.Cond)){if(s<l.Cond.length&&l.Cond[s]){u.Color=l.Color;break}}else\x20if(this.IsNumber(l.Cond)&&l.Cond){u.Color=l.Color;break}}if(u.Color){if(Array.isArray(r)){if(s>=r.length)continue;if(!this.IsNumber(r[s]))continue;u.Value=r[s]}else{if(!this.IsNumber(r))continue;u.Value=r}if(Array.isArray(i)){if(s>=i.length)continue;if(!this.IsNumber(i[s]))continue;u.Value2=i[s]}else{if(!this.IsNumber(i))continue;u.Value2=i}t[s]=u}}return\x20a},this.FLOATRGN=function(e){let\x20t=[],a={DrawData:t,DrawType:\x22FLOATRGN\x22};if(e.length<4)return\x20a;for(var\x20r=e[0],i=e[1],n=[],s=2;s<e.length&&s+1<e.length;s+=2)n.push({Cond:e[s],Color:e[s+1]});for(s=0;s<this.SymbolData.Data.Data.length;++s){t[s]=null;var\x20u={Value:null,Value2:null,Color:null};for(var\x20o\x20in\x20n){var\x20l=n[o];if(Array.isArray(l.Cond)){if(s<l.Cond.length&&l.Cond[s]){u.Color=l.Color;break}}else\x20if(this.IsNumber(l.Cond)&&l.Cond){u.Color=l.Color;break}}if(u.Color){if(Array.isArray(r)){if(s>=r.length)continue;if(!this.IsNumber(r[s]))continue;u.Value=r[s]}else{if(!this.IsNumber(r))continue;u.Value=r}if(Array.isArray(i)){if(s>=i.length)continue;if(!this.IsNumber(i[s]))continue;u.Value2=i[s]}else{if(!this.IsNumber(i))continue;u.Value2=i}t[s]=u}}return\x20a},this.FILLBGRGN=function(e,t){let\x20a=[],r={DrawData:a,DrawType:1==e?\x22FILLTOPRGN\x22:\x22FILLBOTTOMRGN\x22};if(t.length<3)return\x20r;for(var\x20i=t[0],n=[],s=1;s<t.length&&s+1<t.length;s+=2)n.push({Cond:t[s],Color:t[s+1]});for(s=0;s<this.SymbolData.Data.Data.length;++s){a[s]=null;var\x20u={Value:null,Color:null};for(var\x20o\x20in\x20n){var\x20l=n[o];if(Array.isArray(l.Cond)){if(s<l.Cond.length&&l.Cond[s]){u.Color=l.Color;break}}else\x20if(this.IsNumber(l.Cond)&&l.Cond){u.Color=l.Color;break}}if(u.Color){if(Array.isArray(i)){if(s>=i.length)continue;if(!this.IsNumber(i[s]))continue;u.Value=i[s]}else{if(!this.IsNumber(i))continue;u.Value=i}a[s]=u}}return\x20r},this.FILLVERTICALRGN=function(e){let\x20t=[],a={DrawData:t,DrawType:\x22FILLVERTICALRGN\x22};if(e.length<2)return\x20a;for(var\x20r=[],i=0;i<e.length&&i+1<e.length;i+=2)r.push({Cond:e[i],Color:e[i+1]});for(i=0;i<this.SymbolData.Data.Data.length;++i){t[i]=null;var\x20n={Color:null};for(var\x20s\x20in\x20r){var\x20u=r[s];if(Array.isArray(u.Cond)){if(i<u.Cond.length&&u.Cond[i]){n.Color=u.Color;break}}else\x20if(this.IsNumber(u.Cond)&&u.Cond){n.Color=u.Color;break}}n.Color&&(t[i]=n)}return\x20a},this.DRAWGBK=function(e,t,a,r){let\x20i={Color:[],Angle:r};t&&i.Color.push(t),a&&i.Color.push(a);let\x20n={DrawData:null,DrawType:\x22DRAWGBK\x22};if(Array.isArray(e))for(var\x20s\x20in\x20e){if(e[s]){n.DrawData=i;break}}else\x20e&&(n.DrawData=i);return\x20n},this.DRAWGBK2=function(e,t,a,r){let\x20i={Color:[],Angle:r};t&&i.Color.push(t),a&&i.Color.push(a);let\x20n={DrawData:null,DrawType:\x22DRAWGBK2\x22};if(Array.isArray(e)){for(var\x20s\x20in\x20i.Data=[],e){var\x20u=e[s];i.Data[s]=u?1:0}n.DrawData=i}else\x20e&&(n.DrawData=i,n.DrawType=\x22DRAWGBK\x22);return\x20n},this.DRAWTEXT_LINE=function(e,t,a,r,i,n,s){let\x20u={Text:{Title:a,Color:r},Line:{Type:n,Color:s}};i<=0&&(i=12),u.Text.Font=i*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22;let\x20o={DrawData:null,DrawType:\x22DRAWTEXT_LINE\x22};if(Array.isArray(e))for(var\x20l\x20in\x20e){if(e[l]){Array.isArray(t)?u.Price=t[l]:u.Price=t,o.DrawData=u;break}}else\x20e&&(Array.isArray(t)?u.Price=t[0]:u.Price=t,o.DrawData=u);return\x20o},this.DRAWRECTREL=function(e,t,a,r,i){let\x20n={Rect:{Left:e,Top:t,Right:a,Bottom:r},Color:i};return\x200==i&&(n.Color=null),{DrawData:n,DrawType:\x22DRAWRECTREL\x22}},this.DRAWOVERLAYLINE=function(e,t,a){let\x20r={Data:e,MainData:t};return\x20a&&\x22string\x22==typeof\x20a&&(r.Title=a),{DrawData:r,DrawType:\x22DRAWOVERLAYLINE\x22}},this.DRAWSL=function(e,t,a,r,i){let\x20n={Data:[],Option:[]},s={DrawData:n,DrawType:\x22DRAWSL\x22};var\x20u=this.IsNumber(t);if(Array.isArray(e))for(var\x20o\x20in\x20e)n[o]=null,e[o]&&(u?(n.Data[o]=t,n.Option[o]={Slope:a,Length:r,Direct:i}):o<t.length&&this.IsNumber(t[o])&&(n.Data[o]=t[o],n.Option[o]={Slope:a,Length:r,Direct:i}));else\x20if(e){var\x20l=this.SymbolData.Data.Data.length;for(o=0;o<l;++o)n[o]=null,u?(n.Data[o]=t,n.Option[o]={Slope:a,Length:r,Direct:i}):o<t.length&&this.IsNumber(t[o])&&(n.Data[o]=t[o],n.Option[o]={Slope:a,Length:r,Direct:i})}return\x20s}}JSAlgorithm.prototype.IsNumber=function(e){return\x20null!=e&&!isNaN(e)},JSAlgorithm.prototype.IsDivideNumber=function(e){return\x20null!=e&&(!isNaN(e)&&0!=e)},JSAlgorithm.MOD=function(e,t){if(e<0&&t<0||e>=0&&t>=0)return\x20parseInt(e)==e&&parseInt(t)==t?e%t:i=parseFloat((e-Math.floor(e/t)*t).toFixed(1));var\x20a=Math.abs(e),r=Math.abs(t),i=Math.abs(Math.abs(t)*(Math.floor(a/r)+1)-Math.abs(e));return\x20t<0&&(i=-i),i},JSDraw.prototype.CalculateDrawLine=function(e){e.List=[];for(var\x20t=e.Start.ID;t<=e.End.ID;++t)e.List.push(t);let\x20a=Math.abs(e.Start.Value-e.End.Value),r=e.List.length-1;var\x20i=[];if(i.push({ID:e.Start.ID,Value:e.Start.Value}),e.Start.Value>e.End.Value)for(t=1;t<e.List.length-1;++t){var\x20n=a*(e.List.length-1-t)/r+e.End.Value;i.push({ID:e.List[t],Value:n})}else\x20for(t=1;t<e.List.length-1;++t){n=a*t/r+e.Start.Value;i.push({ID:e.List[t],Value:n})}return\x20i.push({ID:e.End.ID,Value:e.End.Value}),i},JSDraw.prototype.IsNumber=function(e){return\x20null!=e&&!isNaN(e)},JSDraw.prototype.IsDrawFunction=function(e){return!!new\x20Set([\x22STICKLINE\x22,\x22DRAWTEXT\x22,\x22SUPERDRAWTEXT\x22,\x22DRAWLINE\x22,\x22DRAWBAND\x22,\x22DRAWKLINE\x22,\x22DRAWKLINE_IF\x22,\x22PLOYLINE\x22,\x22POLYLINE\x22,\x22DRAWNUMBER\x22,\x22DRAWNUMBER_FIX\x22,\x22DRAWICON\x22,\x22DRAWCHANNEL\x22,\x22PARTLINE\x22,\x22DRAWTEXT_FIX\x22,\x22DRAWGBK\x22,\x22DRAWTEXT_LINE\x22,\x22DRAWRECTREL\x22,\x22DRAWOVERLAYLINE\x22,\x22FILLRGN\x22,\x22FILLRGN2\x22,\x22FILLTOPRGN\x22,\x22FILLBOTTOMRGN\x22,\x22FILLVERTICALRGN\x22,\x22FLOATRGN\x22,\x22DRAWSL\x22,\x22DRAWGBK2\x22]).has(e)},JSDraw.prototype.RemoveZero=function(e){for(;e.length>0;){var\x20t=e.length-1,a=e[t];if(\x220\x22!=a){if(\x22.\x22==a){e=e.substr(0,t);break}break}e=e.substr(0,t)}return\x20e};var\x20DYNAINFO_ARGUMENT_ID={YCLOSE:3,OPEN:4,HIGH:5,LOW:6,CLOSE:7,VOL:8,AMOUNT:10,AMPLITUDE:13,INCREASE:14,EXCHANGERATE:37};function\x20JSSymbolData(e,t,a){this.AST=e,this.Execute=a,this.Symbol=\x22600000.sh\x22,this.Name,this.Data=null,this.PeriodData=new\x20Map,this.IsApiPeriod=!1,this.SourceData=null,this.MarketValue=null,this.Period=0,this.Right=0,this.DataType=0,this.IsBeforeData=!1,this.DayCount,this.Arguments=[],this.KLineApiUrl=g_JSComplierResource.Domain+\x22/API/KLine2\x22,this.MinuteKLineApiUrl=g_JSComplierResource.Domain+\x22/API/KLine3\x22,this.RealtimeApiUrl=g_JSComplierResource.Domain+\x22/API/stock\x22,this.HistoryMinuteApiUrl=g_JSChartResource.Domain+\x22/API/StockMinuteData\x22,this.StockHistoryDayApiUrl=g_JSComplierResource.Domain+\x22/API/StockHistoryDay\x22,this.StockHistoryDay3ApiUrl=g_JSComplierResource.Domain+\x22/API/StockHistoryDay3\x22,this.StockHistoryDay2ApiUrl=g_JSComplierResource.Domain+\x22/API/StockHistoryDay2\x22,this.StockNewsAnalysisApiUrl=g_JSComplierResource.CacheDomain+\x22/cache/newsanalyze\x22,this.HKToSHSZApiUrl=[g_JSComplierResource.CacheDomain+\x22/cache/historyday/all/hk2shsz.json\x22,g_JSComplierResource.CacheDomain+\x22/cache/analyze/hk2shsz/hk2shsz.json\x22,g_JSComplierResource.Domain+\x22/API/HKToSHSZMinuteData\x22,g_JSComplierResource.CacheDomain+\x22/cache/analyze/hk2szshanalyze\x22],this.MaxRequestDataCount=1e3,this.MaxRequestMinuteDayCount=5,this.KLineDateTimeRange,this.LatestData,this.IndexData,this.LatestIndexData,this.MarginData=new\x20Map,this.HKToSHSZData=new\x20Map,this.NewsAnalysisData=new\x20Map,this.ExtendData=new\x20Map,this.UserData=new\x20Map,this.CustomAPIData=new\x20Map,this.ScriptIndexOutData=new\x20Map,this.OtherSymbolData=new\x20Map,this.StockData=new\x20Map,this.SectionFinanceData=new\x20Map,this.ThrowSFPeirod=new\x20Set,this.NetworkFilter,t&&(t.HQDataType&&(this.DataType=t.HQDataType),t.Data&&(this.Data=t.Data,this.DataType!=HQ_DATA_TYPE.MINUTE_ID&&this.DataType!=HQ_DATA_TYPE.MULTIDAY_MINUTE_ID&&this.DataType!=HQ_DATA_TYPE.HISTORY_MINUTE_ID&&(this.Period=t.Data.Period,this.Right=t.Data.Right)),t.SourceData&&(this.SourceData=t.SourceData),t.Symbol&&(this.Symbol=t.Symbol),t.Name&&(this.Name=t.Name),t.MaxRequestDataCount>0&&(this.MaxRequestDataCount=t.MaxRequestDataCount),t.MaxRequestMinuteDayCount>0&&(this.MaxRequestMinuteDayCount=t.MaxRequestMinuteDayCount),t.KLineApiUrl&&(this.KLineApiUrl=t.KLineApiUrl),t.Right&&(this.Right=t.Right),t.Period&&(this.Period=t.Period),!0===t.IsBeforeData&&(this.IsBeforeData=t.IsBeforeData),t.NetworkFilter&&(this.NetworkFilter=t.NetworkFilter),t.DayCount>0&&(this.DayCount=t.DayCount),t.Arguments&&(this.Arguments=t.Arguments),t.KLineRange&&(this.KLineDateTimeRange=t.KLineRange),t.IsApiPeriod&&(this.IsApiPeriod=t.IsApiPeriod)),this.RecvError=function(e){throw\x20JSConsole.Complier.Log(\x22[JSSymbolData::RecvError]\x20ajax\x20error.\x22,e.status),{FunctionName:\x22RecvError\x22,Request:e}},this.GetLatestData=function(){if(this.LatestData)return\x20this.Execute.RunNextJob();var\x20e=this;if(this.NetworkFilter){var\x20t={Name:\x22JSSymbolData::GetLatestData\x22,Explain:\x22DYNAINFO()\x22,Request:{Url:e.RealtimeApiUrl,Type:\x22POST\x22,Data:{symbol:[this.Symbol],field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22,\x22amount\x22,\x22date\x22,\x22time\x22,\x22increase\x22,\x22exchangerate\x22,\x22amplitude\x22]}},Self:this,PreventDefault:!1};if(this.NetworkFilter(t,function(t){e.RecvLatestData(t),e.Execute.RunNextJob()}),1==t.PreventDefault)return}JSNetwork.HttpRequest({url:e.RealtimeApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22,\x22amount\x22,\x22date\x22,\x22time\x22,\x22increase\x22,\x22exchangerate\x22,\x22amplitude\x22],symbol:[this.Symbol]},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvLatestData(t),e.Execute.RunNextJob()},error:function(t){e.RecvError(t)}})},this.RecvLatestData=function(e){if(!e.stock||1!=e.stock.length)return;let\x20t=e.stock[0];this.LatestData={Symbol:t.symbol,Name:t.name,Date:t.date,Time:t.time,YClose:t.yclose,Price:t.price,Open:t.open,High:t.high,Low:t.low,Vol:t.vol,Amount:t.amount,Increase:t.increase,Exchangerate:t.exchangerate,Amplitude:t.amplitude},JSConsole.Complier.Log(\x22[JSSymbolData::RecvLatestData]\x22,this.LatestData)},this.GetLatestCacheData=function(e){if(!this.LatestData)return\x20null;switch(e){case\x20DYNAINFO_ARGUMENT_ID.YCLOSE:return\x20this.LatestData.YClose;case\x20DYNAINFO_ARGUMENT_ID.OPEN:return\x20this.LatestData.Open;case\x20DYNAINFO_ARGUMENT_ID.HIGH:return\x20this.LatestData.High;case\x20DYNAINFO_ARGUMENT_ID.LOW:return\x20this.LatestData.Low;case\x20DYNAINFO_ARGUMENT_ID.VOL:return\x20this.LatestData.Vol;case\x20DYNAINFO_ARGUMENT_ID.AMOUNT:return\x20this.LatestData.Amount;case\x20DYNAINFO_ARGUMENT_ID.INCREASE:return\x20this.LatestData.Increase;case\x20DYNAINFO_ARGUMENT_ID.EXCHANGERATE:return\x20this.LatestData.Exchangerate;case\x20DYNAINFO_ARGUMENT_ID.AMPLITUDE:return\x20this.LatestData.Amplitude;case\x20DYNAINFO_ARGUMENT_ID.CLOSE:return\x20this.LatestData.Price;default:return\x20null}},this.GetLatestIndexData=function(){if(this.LatestIndexData)return\x20this.Execute.RunNextJob();var\x20e=this;if(this.NetworkFilter){var\x20t={Name:\x22JSSymbolData::GetLatestIndexData\x22,Explain:\x22最新大盘数据\x22,Request:{Url:e.RealtimeApiUrl,Type:\x22POST\x22,Data:{symbol:[\x22000001.sh\x22],field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22,\x22amount\x22,\x22date\x22,\x22time\x22,\x22increase\x22,\x22amplitude\x22]}},Self:this,PreventDefault:!1};if(this.NetworkFilter(t,function(t){e.RecvLatestIndexData(t),e.Execute.RunNextJob()}),1==t.PreventDefault)return}JSNetwork.HttpRequest({url:e.RealtimeApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22,\x22amount\x22,\x22date\x22,\x22time\x22,\x22increase\x22,\x22amplitude\x22],symbol:[\x22000001.sh\x22]},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvLatestIndexData(t),e.Execute.RunNextJob()},error:function(t){e.RecvError(t)}})},this.RecvLatestIndexData=function(e){if(!e.stock||1!=e.stock.length)return;let\x20t=e.stock[0];this.LatestIndexData={Symbol:t.symbol,Name:t.name,Date:t.date,Time:t.time,YClose:t.yclose,Price:t.price,Open:t.open,High:t.high,Low:t.low,Vol:t.vol,Amount:t.amount,Increase:t.increase,Amplitude:t.amplitude},JSConsole.Complier.Log(\x22[JSSymbolData::RecvLatestIndexData]\x22,this.LatestIndexData)},this.GetLatestIndexCacheData=function(e){if(!this.LatestIndexData)return\x20null;switch(e){case\x22FROMOPEN\x22:var\x20t=parseInt(this.LatestIndexData.Time/100),a=60*parseInt(t/100)+t%100;return\x20a<=565?0:a<570?1:a<=690?a-570+1:a<780?121:a<=900?122+a-780:242;default:return\x20null}},this.GetVolRateData=function(e,t){var\x20a=e.ID.toString()+\x22-VolRate-\x22+this.Symbol;if(this.ExtendData.has(a))return\x20this.Execute.RunNextJob();var\x20r=this;JSNetwork.HttpRequest({url:r.RealtimeApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22avgvol5\x22,\x22date\x22],symbol:[this.Symbol]},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){r.RecvVolRateData(e,a),r.Execute.RunNextJob()},error:function(e){r.RecvError(e)}})},this.RecvVolRateData=function(e,t){if(e.stock&&1==e.stock.length){var\x20a={AvgVol5:e.stock[0].avgvol5,Date:e.stock[0].date};this.ExtendData.set(t,a),JSConsole.Complier.Log(\x22[JSSymbolData::RecvVolRateData]\x22,a)}},this.GetVolRateCacheData=function(e){var\x20t=JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_VOLR_DATA.toString()+\x22-VolRate-\x22+this.Symbol;t&&this.ExtendData.has(t)||this.Execute.ThrowUnexpectedNode(e,\x22不支持VOLR\x22);for(var\x20a=[],r=this.ExtendData.get(t),i=r.AvgVol5/241,n=0,s=0,u=0;s<this.Data.Data.length;++s){a[s]=null;var\x20o=this.Data.Data[s],l=o.DateTime;if(l){var\x20D=l.split(\x22\x20\x22);if(2==D.length)parseInt(D[0])==r.Date&&(n+=o.Vol,i>0&&(a[s]=n/(u+1)/i*100),++u)}}return\x20a},this.GetGroupData=function(e){var\x20t=e.ID.toString()+\x22-Group-\x22+this.Symbol;if(this.ExtendData.has(t))return\x20this.Execute.RunNextJob();var\x20a=this;if(this.NetworkFilter){var\x20r={Name:\x22JSSymbolData::GetGroupData\x22,Explain:\x22HYBLOCK|DYBLOCK\x22,Request:{Url:a.RealtimeApiUrl,Type:\x22POST\x22,Data:{symbol:[this.Symbol],field:[\x22name\x22,\x22symbol\x22,\x22industry\x22,\x22concept\x22,\x22region\x22]}},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,function(e){a.RecvGroupData(e,t),a.Execute.RunNextJob()}),1==r.PreventDefault)return}JSNetwork.HttpRequest({url:a.RealtimeApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22industry\x22,\x22concept\x22,\x22region\x22],symbol:[this.Symbol]},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){a.RecvGroupData(e,t),a.Execute.RunNextJob()},error:function(e){a.RecvError(e)}})},this.RecvGroupData=function(e,t){if(e.stock&&1==e.stock.length){var\x20a=e.stock[0],r=a.industry,i=a.concept,n=a.region,s={Industry:[],Concept:[],Region:[]};if(r)for(var\x20u\x20in\x20r){var\x20o=r[u];s.Industry.push({Name:o.name,Symbol:o.symbol})}if(i)for(var\x20u\x20in\x20i){o=i[u];s.Concept.push({Name:o.name,Symbol:o.symbol})}if(n)for(var\x20u\x20in\x20n){o=n[u];s.Region.push({Name:o.name,Symbol:o.symbol})}this.ExtendData.set(t,s)}},this.GetIndexData=function(){if(this.IndexData)return\x20this.Execute.RunNextJob();var\x20e=this;if(ChartData.IsDayPeriod(this.Period,!0)){if(this.NetworkFilter){var\x20t={Name:\x22JSSymbolData::GetIndexData\x22,Explain:\x22大盘数据\x22,Period:e.Period,Request:{Url:e.KLineApiUrl,Type:\x22POST\x22,Data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22,\x22up\x22,\x22down\x22,\x22stop\x22,\x22unchanged\x22],symbol:\x22000001.sh\x22,start:-1,count:e.MaxRequestDataCount+500}},Self:this,PreventDefault:!1};if(this.NetworkFilter(t,function(t){e.RecvIndexHistroyData(t),e.Execute.RunNextJob()}),1==t.PreventDefault)return}JSNetwork.HttpRequest({url:e.KLineApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22,\x22up\x22,\x22down\x22,\x22stop\x22,\x22unchanged\x22],symbol:\x22000001.sh\x22,start:-1,count:e.MaxRequestDataCount+500},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvIndexHistroyData(t),e.Execute.RunNextJob()},error:function(t){e.RecvError(t)}})}else\x20if(ChartData.IsMinutePeriod(this.Period,!0)){if(this.NetworkFilter){t={Name:\x22JSSymbolData::GetIndexData\x22,Explain:\x22大盘数据\x22,Period:e.Period,Request:{Url:e.MinuteKLineApiUrl,Type:\x22POST\x22,Data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],symbol:\x22000001.sh\x22,start:-1,count:e.MaxRequestDataCount+5}},Self:this,PreventDefault:!1};if(this.NetworkFilter(t,function(t){e.RecvIndexMinuteHistroyData(t),e.Execute.RunNextJob()}),1==t.PreventDefault)return}JSNetwork.HttpRequest({url:e.MinuteKLineApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],symbol:\x22000001.sh\x22,start:-1,count:e.MaxRequestMinuteDayCount+5},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvIndexMinuteHistroyData(t),e.Execute.RunNextJob()},error:function(t){e.RecvError(t)}})}},this.RecvIndexHistroyData=function(e){JSConsole.Complier.Log(\x22[JSSymbolData::RecvIndexHistroyData]\x20recv\x20data\x22,e);let\x20t=this.JsonDataToHistoryData(e);this.IndexData=new\x20ChartData,this.IndexData.DataType=0,this.IndexData.Data=t;var\x20a=this.SourceData.GetOverlayData(this.IndexData.Data);if(this.IndexData.Data=a,ChartData.IsDayPeriod(this.Period,!1)){let\x20e=this.IndexData.GetPeriodData(this.Period);this.IndexData.Data=e}},this.RecvIndexMinuteHistroyData=function(e){JSConsole.Complier.Log(\x22[JSSymbolData::RecvIndexMinuteHistroyData]\x20recv\x20data\x22,e);let\x20t=this.JsonDataToMinuteHistoryData(e);if(this.IndexData=new\x20ChartData,this.IndexData.DataType=1,this.IndexData.Data=t,ChartData.IsMinutePeriod(this.Period,!1)){let\x20e=this.IndexData.GetPeriodData(this.Period);this.IndexData.Data=e}},this.GetOtherSymbolParam=function(e){var\x20t=e.split(\x22$\x22);if(!new\x20Set([\x22CLOSE\x22,\x22C\x22,\x22VOL\x22,\x22V\x22,\x22OPEN\x22,\x22O\x22,\x22HIGH\x22,\x22H\x22,\x22LOW\x22,\x22L\x22,\x22AMOUNT\x22,\x22AMO\x22,\x22VOLINSTK\x22]).has(t[1]))return\x20null;var\x20a=t[0];if(6==a.length)\x226\x22==a[0]||\x225\x22==a[0]||\x228\x22==a[0]||\x229\x22==a[0]?a+=\x22.SH\x22:\x220\x22!=a[0]&&\x221\x22!=a[0]&&\x222\x22!=a[0]&&\x223\x22!=a[0]||(a+=\x22.SZ\x22);else\x20if(0==a.indexOf(\x22SZ\x22))a=a.substr(2)+\x22.SZ\x22;else\x20if(0==a.indexOf(\x22SH\x22))a=a.substr(2)+\x22.SH\x22;else{if(!(a.indexOf(\x22_\x22)>0))return\x20null;var\x20r=a.split(\x22_\x22);a=`${r[1]}.${r[0]}`}return{Symbol:a.toLowerCase(),DataName:t[1]}},this.GetOtherSymbolData=function(e){var\x20t=this.Symbol;if(e.Literal){if(!(r=this.GetOtherSymbolParam(e.Literal.toUpperCase()))){var\x20a=e.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,`${e.Literal}\x20Error.`)}t=r.Symbol}else{var\x20r;if((r=e.Args).length>0){var\x20i=r[0];if(i.Type==Syntax.Literal)t=i.Value;else\x20if(i.Type==Syntax.Identifier){var\x20n=!1;for(var\x20s\x20in\x20this.Arguments){const\x20e=this.Arguments[s];if(e.Name==i.Name){t=e.Value,n=!0;break}}if(!n){a=e.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,`${e.FunctionName}()\x20Error:\x20can\x27t\x20read\x20${i.Name}`)}}}}if(e.Symbol=t.toLowerCase(),e.Symbol==this.Symbol)return\x20this.Execute.RunNextJob();if(this.OtherSymbolData.has(e.Symbol))return\x20this.Execute.RunNextJob();var\x20u=this;if(this.DataType==HQ_DATA_TYPE.KLINE_ID&&ChartData.IsDayPeriod(this.Period,!0)){if(this.NetworkFilter){var\x20o=this.Data.GetDateRange(),l={Name:\x22JSSymbolData::GetOtherSymbolData\x22,Explain:\x22指定个股数据\x22,Request:{Data:{symbol:e.Symbol,right:u.Right,period:u.Period,dateRange:o}},Self:this,PreventDefault:!1};if(this.NetworkFilter(l,function(t){u.RecvOtherSymbolKData(t,e),u.Execute.RunNextJob()}),1==l.PreventDefault)return}JSNetwork.HttpRequest({url:u.KLineApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],symbol:e.Symbol,start:-1,count:u.MaxRequestDataCount+500},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){u.RecvOtherSymbolKDayData(t,e),u.Execute.RunNextJob()},error:function(e){u.RecvError(e)}})}else\x20if(ChartData.IsMinutePeriod(this.Period,!0)||this.DataType==HQ_DATA_TYPE.MINUTE_ID||this.DataType==HQ_DATA_TYPE.MULTIDAY_MINUTE_ID){if(this.NetworkFilter){o=this.Data.GetDateRange(),l={Name:\x22JSSymbolData::GetOtherSymbolData\x22,Explain:\x22指定个股数据\x22,Request:{Data:{symbol:e.Symbol,right:u.Right,period:u.Period,dateRange:o}},Self:this,PreventDefault:!1};if(this.NetworkFilter(l,function(t){u.RecvOtherSymbolKData(t,e),u.Execute.RunNextJob()}),1==l.PreventDefault)return}JSNetwork.HttpRequest({url:u.MinuteKLineApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],symbol:e.Symbol,start:-1,count:u.MaxRequestMinuteDayCount+5},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){u.RecvOtherSymbolKMinuteData(t,e),u.Execute.RunNextJob()},error:function(e){u.RecvError(e)}})}},this.RecvOtherSymbolKData=function(e,t){JSConsole.Complier.Log(\x22[JSSymbolData::RecvOtherSymbolKDayData2]\x20recv\x20data\x22,e);var\x20a=new\x20ChartData,r=null,i=this.Period;this.DataType==HQ_DATA_TYPE.KLINE_ID&&ChartData.IsDayPeriod(this.Period,!0)?(r=this.JsonDataToHistoryData(e),a.DataType=0):(r=this.JsonDataToMinuteHistoryData(e),a.DataType=1,this.DataType!=HQ_DATA_TYPE.MINUTE_ID&&this.DataType!=HQ_DATA_TYPE.MULTIDAY_MINUTE_ID||(i=4)),a.Period=this.Period,a.Right=this.Right,a.Data=this.Data.FixKData(r,i),this.OtherSymbolData.set(t.Symbol,a)},this.RecvOtherSymbolKDayData=function(e,t){JSConsole.Complier.Log(\x22[JSSymbolData::RecvOtherSymbolKDayData]\x20recv\x20data\x22,e);let\x20a=this.JsonDataToHistoryData(e);var\x20r=new\x20ChartData;r.DataType=0,r.Data=a;var\x20i=this.SourceData.GetOverlayData(r.Data);if(r.Data=i,ChartData.IsDayPeriod(this.Period,!1)){let\x20e=r.GetPeriodData(this.Period);r.Data=e}this.OtherSymbolData.set(t.Symbol,r)},this.RecvOtherSymbolKMinuteData=function(e,t){JSConsole.Complier.Log(\x22[JSSymbolData::RecvOtherSymbolKMinuteData]\x20recv\x20data\x22,e);let\x20a=this.JsonDataToMinuteHistoryData(e);var\x20r=new\x20ChartData;if(r.DataType=1,r.Data=a,ChartData.IsMinutePeriod(this.Period,!1)){let\x20e=r.GetPeriodData(this.Period);r.Data=e}this.OtherSymbolData.set(t.Symbol,r)},this.GetOtherSymolCacheData=function(e){var\x20t,a;if(e.FunctionName){if(a=e.FunctionName,(r=e.Args).length<=0)return\x20this.GetSymbolCacheData(a);t=r[0].toString().toLowerCase()}else\x20if(e.Literal){var\x20r;if(!(r=this.GetOtherSymbolParam(e.Literal.toUpperCase())))return[];t=r.Symbol,a=r.DataName}if(t==this.Symbol)return\x20this.GetSymbolCacheData(a);if(!this.OtherSymbolData.has(t))return[];var\x20i=this.OtherSymbolData.get(t);t.toUpperCase();switch(a){case\x22CLOSE\x22:case\x22C\x22:return\x20i.GetClose();case\x22VOL\x22:case\x22V\x22:return\x20i.GetVol();case\x22OPEN\x22:case\x22O\x22:return\x20i.GetOpen();case\x22HIGH\x22:case\x22H\x22:return\x20i.GetHigh();case\x22LOW\x22:case\x22L\x22:return\x20i.GetLow();case\x22AMOUNT\x22:case\x22AMO\x22:return\x20i.GetAmount();case\x22VOLINSTK\x22:return\x20i.GetPosition()}},this.GetIndexCacheData=function(e){if(!this.IndexData)return\x20new\x20Array;switch(e){case\x22INDEXA\x22:return\x20this.IndexData.GetAmount();case\x22INDEXC\x22:return\x20this.IndexData.GetClose();case\x22INDEXH\x22:return\x20this.IndexData.GetHigh();case\x22INDEXL\x22:return\x20this.IndexData.GetLow();case\x22INDEXO\x22:return\x20this.IndexData.GetOpen();case\x22INDEXV\x22:return\x20this.IndexData.GetVol();case\x22INDEXADV\x22:return\x20this.IndexData.GetUp();case\x22INDEXDEC\x22:return\x20this.IndexData.GetDown()}},this.GetBlockSymbol=function(e){const\x20t=new\x20Map([[\x22沪深A股\x22,\x22CNA.ci\x22],[\x22创业板\x22,\x22GEM.ci\x22],[\x22沪市A股\x22,\x22SHA.ci\x22],[\x22中小板\x22,\x22SME.ci\x22],[\x22深市A股\x22,\x22SZA.ci\x22]]);if(t.has(e))return\x20t.get(e);if(!e)return\x20null;var\x20a=null,r=e.toUpperCase();if(r.indexOf(\x22.SH\x22)>0||r.indexOf(\x22.SZ\x22)>0){if(!new\x20Set([\x22000001.SH\x22,\x22000003.SH\x22,\x22000016.SH\x22,\x22000300.SH\x22,\x22000905.SH\x22,\x22399001.SZ\x22,\x22\x20399005.SZ\x22,\x22399006.SZ\x22]).has(r))return\x20null;a=e.replace(\x22.SH\x22,\x22.sh\x22),a=e.replace(\x22.SZ\x22,\x22.sz\x22)}else\x20e.indexOf(\x22.CI\x22)>0&&(a=e.replace(\x22.CI\x22,\x22.ci\x22));return\x20a},this.GetIndexIncreaseData=function(e){var\x20t=null;if(e.IsSelfSymbol)t=this.Symbol;else{if(!e.Args||e.Args.length<=0){var\x20a=e.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,`${e.FunctionName}\x20Error:\x20参数不能为空`)}t=e.Args[0].Value}var\x20r=this.GetBlockSymbol(t);if(!r){a=e.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,`${e.FunctionName}\x20Error:\x20can\x27t\x20support\x20${t}`)}var\x20i=e.ID.toString()+\x22-UpCount-\x22+r,n=e.ID.toString()+\x22-DownCount-\x22+r;if(this.ExtendData.has(i)&&this.ExtendData.has(n))return\x20this.Execute.RunNextJob();var\x20s=this;if(this.DataType===HQ_DATA_TYPE.MINUTE_ID||this.DataType===HQ_DATA_TYPE.MULTIDAY_MINUTE_ID){var\x20u=g_JSComplierResource.CacheDomain+\x22/cache/analyze/increaseanalyze/\x22+r+\x22.json\x22;JSConsole.Complier.Log(\x22[JSSymbolData::GetIndexIncreaseData]\x20minute\x20Get\x20url=\x22,u),JSNetwork.HttpRequest({url:u,type:\x22get\x22,dataType:\x22json\x22,async:!0,success:function(e){s.RecvMinuteIncreaseData(e,{UpKey:i,DownKey:n}),s.Execute.RunNextJob()},error:function(e){s.RecvError(e)}})}else\x20this.DataType===HQ_DATA_TYPE.KLINE_ID&&ChartData.IsDayPeriod(this.Period,!0)?(JSConsole.Complier.Log(\x22[JSSymbolData::GetIndexIncreaseData]\x20K\x20day\x20Get\x20url=\x22,s.KLineApiUrl),JSNetwork.HttpRequest({url:s.KLineApiUrl,data:{symbol:r,start:-1,count:s.MaxRequestDataCount,field:[\x22up\x22,\x22down\x22]},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){s.RecvHistoryIncreaseData(e,{UpKey:i,DownKey:n}),s.Execute.RunNextJob()},error:function(e){s.RecvError(e)}})):this.Execute.RunNextJob()},this.RecvHistoryIncreaseData=function(e,t){JSConsole.Complier.Log(\x22[JSSymbolData::RecvHistoryIncreaseData]\x20recv\x20data\x22,e);var\x20a,r,i=[],n=[];for(var\x20s\x20in\x20e.data){var\x20u=e.data[s];let\x20t=new\x20SingleData,a=new\x20SingleData;t.Date=u[0],t.Value=u[8],i[s]=t,a.Date=u[0],a.Value=u[9],n[s]=a}a=this.SourceData?this.SourceData.GetFittingData(i):this.Data.GetFittingData(aryData),r=this.SourceData?this.SourceData.GetFittingData(n):this.Data.GetFittingData(aryData),this.ExtendData.set(t.UpKey,a),this.ExtendData.set(t.DownKey,r)},this.RecvMinuteIncreaseData=function(e,t){if(JSConsole.Complier.Log(\x22[JSSymbolData::RecvMinuteIncreaseData]\x20recv\x20data\x22,e),e.minute){var\x20a=e.minute;if(a.time&&a.up&&a.down){var\x20r=[],i=[];if(this.IsBeforeData)for(var\x20n=0,s=0;n<this.Data.Data.length;++n){if(r[n]=null,i[n]=null,!(u=this.Data.Data[n]).Before)if(o=u.DateTime)if(2==(l=o.split(\x22\x20\x22)).length)parseInt(l[0])==e.date&&(r[n]=a.up[s],i[n]=a.down[s],++s)}else\x20for(n=0,s=0;n<this.Data.Data.length;++n){var\x20u,o,l;if(r[n]=null,i[n]=null,o=(u=this.Data.Data[n]).DateTime)if(2==(l=o.split(\x22\x20\x22)).length)parseInt(l[0])==e.date&&(r[n]=a.up[s],i[n]=a.down[s],++s)}this.ExtendData.set(t.UpKey,r),this.ExtendData.set(t.DownKey,i)}}},this.GetIndexIncreaseCacheData=function(e,t,a){var\x20r,i=this.GetBlockSymbol(t);if(i||this.Execute.ThrowUnexpectedNode(a,\x22不支持函数\x22+e+\x22(\x22+t+\x22)\x22),\x22UPCOUNT\x22==e||\x22ADVANCE\x22==e?r=JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_INDEX_INCREASE_DATA.toString()+\x22-UpCount-\x22+i:\x22DOWNCOUNT\x22!=e&&\x22DECLINE\x22!=e||(r=JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_INDEX_INCREASE_DATA.toString()+\x22-DownCount-\x22+i),r&&this.ExtendData.has(r)||this.Execute.ThrowUnexpectedNode(a,\x22不支持函数\x22+e+\x22(\x22+t+\x22)\x22),this.DataType===HQ_DATA_TYPE.MINUTE_ID||this.DataType===HQ_DATA_TYPE.MULTIDAY_MINUTE_ID)return\x20this.ExtendData.get(r);if(this.DataType===HQ_DATA_TYPE.KLINE_ID&&ChartData.IsDayPeriod(this.Period,!0)){var\x20n=this.ExtendData.get(r),s=new\x20ChartData;if(s.Data=n,s.Period=this.Period,s.Period>0){var\x20u=s.GetPeriodSingleData(s.Period);s.Data=u}return\x20s.GetValue()}return\x20null},this.GetSymbolData=function(){if(this.Data)return\x20this.Execute.RunNextJob();let\x20e=this;if(this.DataType!==HQ_DATA_TYPE.MINUTE_ID)if(this.DataType!==HQ_DATA_TYPE.MULTIDAY_MINUTE_ID){if(ChartData.IsDayPeriod(this.Period,!0)){if(this.NetworkFilter){var\x20t={Name:\x22JSSymbolData::GetSymbolData\x22,Explain:\x22日线数据\x22,Request:{Url:e.RealtimeApiUrl,Type:\x22POST\x22,Data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],symbol:e.Symbol,start:-1,count:e.MaxRequestDataCount}},Self:this,PreventDefault:!1};if(this.KLineDateTimeRange&&(t.Request.KLineDataTimeRange={Start:{Date:this.KLineDateTimeRange.Start.Date},End:{Date:this.KLineDateTimeRange.End.Date}},this.IsNumber(this.KLineDateTimeRange.Start.Time)&&(t.Request.KLineDataTimeRange.Start.Time=this.KLineDateTimeRange.Start.Time),this.IsNumber(this.KLineDateTimeRange.End.Time)&&(t.Request.KLineDataTimeRange.End.Time=this.KLineDateTimeRange.End.Time)),this.NetworkFilter(t,function(t){e.RecvHistroyData(t),e.Execute.RunNextJob()}),1==t.PreventDefault)return}JSNetwork.HttpRequest({url:e.KLineApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],symbol:e.Symbol,start:-1,count:e.MaxRequestDataCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvHistroyData(t),e.Execute.RunNextJob()},error:function(t){e.RecvError(t)}})}else\x20if(ChartData.IsMinutePeriod(this.Period,!0)){if(this.NetworkFilter){t={Name:\x22JSSymbolData::GetSymbolData\x22,Explain:\x22分钟K线数据\x22,Request:{Url:e.MinuteKLineApiUrl,Type:\x22POST\x22,Data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],symbol:e.Symbol,start:-1,count:e.MaxRequestMinuteDayCount}},Self:this,PreventDefault:!1};if(this.KLineDateTimeRange&&(t.Request.KLineDataTimeRange={Start:{Date:this.KLineDateTimeRange.Start.Date},End:{Date:this.KLineDateTimeRange.End.Date}},this.IsNumber(this.KLineDateTimeRange.Start.Time)&&(t.Request.KLineDataTimeRange.Start.Time=this.KLineDateTimeRange.Start.Time),this.IsNumber(this.KLineDateTimeRange.End.Time)&&(t.Request.KLineDataTimeRange.End.Time=this.KLineDateTimeRange.End.Time)),this.NetworkFilter(t,function(t){e.RecvMinuteHistroyData(t),e.Execute.RunNextJob()}),1==t.PreventDefault)return}JSNetwork.HttpRequest({url:this.MinuteKLineApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],symbol:e.Symbol,start:-1,count:e.MaxRequestMinuteDayCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvMinuteHistroyData(t),e.Execute.RunNextJob()},error:function(t){e.RecvError(t)}})}}else\x20JSNetwork.HttpRequest({url:e.HistoryMinuteApiUrl,data:{symbol:e.Symbol,daycount:e.DayCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvMultiDayMinuteData(t),e.Execute.RunNextJob()}});else\x20JSNetwork.HttpRequest({url:e.RealtimeApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22,\x22amount\x22,\x22date\x22,\x22minute\x22,\x22time\x22,\x22minutecount\x22],symbol:[e.Symbol],start:-1},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvMinuteData(t),e.Execute.RunNextJob()}})},this.RecvHistroyData=function(e){JSConsole.Complier.Log(\x22[JSSymbolData::RecvHistroyData]\x20recv\x20data\x22,e);let\x20t=this.JsonDataToHistoryData(e);if(this.Data=new\x20ChartData,this.Data.DataType=0,this.Data.Data=t,this.SourceData=new\x20ChartData,this.SourceData.Data=t,this.Right>0){let\x20e=this.Data.GetRightDate(this.Right);this.Data.Data=e}if(ChartData.IsDayPeriod(this.Period,!1)){let\x20e=this.Data.GetPeriodData(this.Period);this.Data.Data=e}this.Data.Right=this.Right,this.Data.Period=this.Period,this.Name=e.name},this.RecvMinuteHistroyData=function(e){JSConsole.Complier.Log(\x22[JSSymbolData::RecvMinuteHistroyData]\x20recv\x20data\x22,e);let\x20t=this.JsonDataToMinuteHistoryData(e);if(this.Data=new\x20ChartData,this.Data.DataType=1,this.Data.Data=t,this.SourceData=new\x20ChartData,this.SourceData.Data=t,ChartData.IsMinutePeriod(this.Period,!1)){let\x20e=this.Data.GetPeriodData(this.Period);this.Data.Data=e}this.Data.Period=this.Period,this.Name=e.name},this.RecvMinuteData=function(e){JSConsole.Complier.Log(\x22[JSSymbolData::RecvMinuteData]\x20recv\x20data\x22,e);var\x20t=this.JsonDataToMinuteData(e);this.Data=new\x20ChartData,this.Data.DataType=2,this.Data.Data=t,this.Name=e.stock[0].name},this.RecvMultiDayMinuteData=function(e){var\x20t=this.JsonDataToMultiDayMinuteData(e);this.Data=new\x20ChartData,this.Data.DataType=2,this.Data.Data=t,this.Name=e.name},this.GetSymbolCacheData=function(e){if(!this.Data)return\x20new\x20Array;this.Symbol.toUpperCase();switch(e){case\x22CLOSE\x22:case\x22C\x22:return\x20this.Data.GetClose();case\x22VOL\x22:case\x22V\x22:return\x20this.Data.GetVol();case\x22OPEN\x22:case\x22O\x22:return\x20this.Data.GetOpen();case\x22HIGH\x22:case\x22H\x22:return\x20this.Data.GetHigh();case\x22LOW\x22:case\x22L\x22:return\x20this.Data.GetLow();case\x22AMOUNT\x22:case\x22AMO\x22:return\x20this.Data.GetAmount();case\x22VOLINSTK\x22:return\x20this.Data.GetPosition();case\x22ZSTJJ\x22:return\x20this.Data.GetAvPrice()}},this.GetSymbolPeriodData=function(e){var\x20t=JSComplierHelper.GetPeriodInfo({Name:e.PeriodName}).Period,a={PeriodID:t,PeriodName:e.PeriodName};if(t==this.Period&&this.Execute.RunNextJob(),this.IsApiPeriod){if(this.PeriodData.has(e.PeriodName))return\x20this.Execute.RunNextJob()}else\x20if(ChartData.IsDayPeriod(t,!0)){if(ChartData.IsDayPeriod(this.Period,!0))return\x20this.Execute.RunNextJob();a={PeriodID:0,PeriodName:\x22DAY\x22}}else{if(!ChartData.IsMinutePeriod(t,!0))return\x20this.Execute.RunNextJob();if(ChartData.IsMinutePeriod(this.Period,!0))return\x20this.Execute.RunNextJob();a={PeriodID:4,PeriodName:\x22MIN1\x22}}var\x20r=this;if(this.NetworkFilter){var\x20i={Name:\x22JSSymbolData::GetSymbolPeriodData\x22,Explain:\x22跨周期数据\x22,Request:{Data:{field:[\x22symbol\x22,\x22name\x22,e.ValueName],period:e.PeriodName,symbol:r.Symbol}},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,function(e){r.RecvSymbolPeriodData(e,a),r.Execute.RunNextJob()}),1==i.PreventDefault)return}if(ChartData.IsMinutePeriod(t,!0))JSNetwork.HttpRequest({url:this.MinuteKLineApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],symbol:r.Symbol,start:-1,count:r.MaxRequestMinuteDayCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){r.RecvSymbolPeriodData(e,a),r.Execute.RunNextJob()},error:function(e){r.RecvError(e)}});else{if(!ChartData.IsDayPeriod(t,!0))return\x20this.Execute.RunNextJob();JSNetwork.HttpRequest({url:r.KLineApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],symbol:r.Symbol,start:-1,count:r.MaxRequestDataCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){r.RecvSymbolPeriodData(e,a),r.Execute.RunNextJob()},error:function(e){r.RecvError(e)}})}},this.RecvSymbolPeriodData=function(e,t){if(JSConsole.Complier.Log(\x22[JSSymbolData::RecvSymbolPeriodData]\x20data,\x20periodInfo\x20\x22,e,t),ChartData.IsDayPeriod(t.PeriodID,!0)){var\x20a=this.JsonDataToHistoryData(e),r=new\x20ChartData;r.DataType=0,r.Data=a,r.Right=0,r.Period=t.PeriodID,this.PeriodData.set(t.PeriodName,r)}else\x20if(ChartData.IsMinutePeriod(t.PeriodID,!0)){a=this.JsonDataToMinuteHistoryData(e);var\x20i=new\x20ChartData;i.DataType=1,i.Data=a,i.Right=0,i.Period=t.PeriodID,this.PeriodData.set(t.PeriodName,i)}},this.GetSymbolPeriodCacheData=function(e,t){var\x20a=JSComplierHelper.GetPeriodInfo({Name:t});if(this.Period==a.Period)return\x20this.GetSymbolCacheData(e);var\x20r=null;if(this.IsApiPeriod){if(!(i=JSComplierHelper.GetPeriodInfo({PeriodID:this.Period})))return\x20null;if(i.Order>a.Order)return\x20null;if(!this.PeriodData.has(t))return\x20null;r=(r=this.PeriodData.get(t)).Data}else{var\x20i;if(!(i=JSComplierHelper.GetPeriodInfo({PeriodID:this.Period})))return\x20null;if(i.Order>a.Order)return\x20null;if(ChartData.IsDayPeriod(a.Period,!0)&&ChartData.IsMinutePeriod(this.Period,!0)){var\x20n=this.PeriodData.get(\x22DAY\x22);r=0==a.Period?n.Data:n.GetPeriodData(a.Period)}else{var\x20s=new\x20ChartData;if(s.Data=this.SourceData.Data,s.Period=this.Period,s.Right=this.Right,ChartData.IsDayPeriod(a.Period,!0)&&s.Right>0){var\x20u=s.GetRightData(s.Right);s.Data=u}r=s.GetPeriodData(a.Period)}}var\x20o=this.Data.ConverPeriod(r,this.Period,a.Period),l=new\x20ChartData;l.Data=o;this.Symbol.toUpperCase();switch(e){case\x22C\x22:case\x22CLOSE\x22:return\x20l.GetClose();case\x22O\x22:case\x22OPEN\x22:return\x20l.GetOpen();case\x22H\x22:case\x22HIGH\x22:return\x20l.GetHigh();case\x22L\x22:case\x22LOW\x22:return\x20l.GetLow();case\x22AMO\x22:case\x22AMOUNT\x22:return\x20l.GetAmount();case\x22V\x22:case\x22VOL\x22:return\x20l.GetVol();case\x22VOLINSTK\x22:return\x20l.GetPosition();default:return\x20null}},this.GetSymbolPeriodCacheData2=function(e,t,a){var\x20r=JSComplierHelper.GetPeriodInfo({Name:t});if(!r)return\x20null;var\x20i=JSComplierHelper.GetPeriodInfo({PeriodID:this.Period});if(!i)return\x20null;if(i.Order>r.Order)return\x20null;if(i.Period==r.Period)l=this.Data;else{var\x20n;if(this.IsApiPeriod){if(!this.PeriodData.has(t))return\x20null;n=this.PeriodData.get(t)}else\x20if(ChartData.IsMinutePeriod(i.Period,!0)&&ChartData.IsDayPeriod(r.Period,!0)){var\x20s=this.PeriodData.get(\x22DAY\x22);n=0==r.Period?s:s.GetPeriodData(r.Period)}else{var\x20u=new\x20ChartData;if(u.Data=this.SourceData.Data,u.Period=this.Period,u.Right=this.Right,ChartData.IsDayPeriod(r.Period,!0)&&u.Right>0){var\x20o=u.GetRightData(u.Right);u.Data=o}n=u.GetPeriodData(r.Period)}var\x20l,D=this.Data.ConverPeriod(n,this.Period,r.Period);(l=new\x20ChartData).Data=D}if(IFrameSplitOperator.IsPlusNumber(a)){var\x20h=new\x20ChartData;D=l.GetRef(a);h.Data=D,l=h}this.Symbol.toUpperCase();switch(e){case\x22C\x22:case\x22CLOSE\x22:return\x20l.GetClose();case\x22O\x22:case\x22OPEN\x22:return\x20l.GetOpen();case\x22H\x22:case\x22HIGH\x22:return\x20l.GetHigh();case\x22L\x22:case\x22LOW\x22:return\x20l.GetLow();case\x22AMO\x22:case\x22AMOUNT\x22:return\x20l.GetAmount();case\x22V\x22:case\x22VOL\x22:return\x20l.GetVol();case\x22VOLINSTK\x22:return\x20l.GetPosition();default:return\x20null}},this.GetCurrBarsCount=function(){let\x20e=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return\x20e;for(var\x20t=this.Data.Data.length-1;t>=0;--t)e.push(t+1);return\x20e},this.GetTotalTradeMinuteCount=function(){var\x20e=g_MinuteCoordinateData.GetCoordinateData(this.Symbol);return\x20e&&e.Count>0?e.Count-1:242},this.GetTotalBarsCount=function(){return\x20this.Data.Data.length},this.GetIsLastBar=function(){let\x20e=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return\x20e;let\x20t=this.Data.Data.length;for(var\x20a=0;a<t;++a)a==t-1?e.push(1):e.push(0);return\x20e},this.GetBarStatus=function(){let\x20e=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return\x20e;let\x20t=this.Data.Data.length;for(var\x20a=0;a<t;++a)e[a]=0==a?1:a==t-1?2:0;return\x20e},this.GetMarginCacheData=function(e,t){let\x20a=JS_EXECUTE_JOB_ID.GetMarginJobID(e);return\x20a||this.Execute.ThrowUnexpectedNode(t,\x22不支持MARGIN(\x22+e+\x22)\x22),this.MarginData.has(a)?this.MarginData.get(a):[]},this.GetMarginData=function(e){if(this.MarginData.has(e))return\x20this.Execute.RunNextJob();JSConsole.Complier.Log(\x22[JSSymbolData::GetMarginData]\x20jobID=\x22,e);var\x20t=this;let\x20a=[\x22name\x22,\x22date\x22,\x22symbol\x22];switch(e){case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BALANCE:a.push(\x22margin.balance\x22);break;case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_RATE:a.push(\x22margin.rate\x22);break;case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_NET:a.push(\x22margin.buy\x22);break;case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_NET:a.push(\x22margin.sell\x22)}JSNetwork.HttpRequest({url:this.StockHistoryDayApiUrl,data:{field:a,symbol:[this.Symbol],orderfield:\x22date\x22},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(a){t.RecvMarginData(a,e),t.Execute.RunNextJob()}})},this.RecvMarginData=function(e,t){if(JSConsole.Complier.Log(e),!e.stock||1!=e.stock.length)return;let\x20a=e.stock[0];var\x20r=new\x20Array,i=[],n=[],s=[];for(var\x20u\x20in\x20a.stockday){var\x20o=a.stockday[u],l=o.margin;if(!l)continue;let\x20e=new\x20SingleData;switch(e.Date=o.date,t){case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BALANCE:if(!this.IsNumber(l.balance))continue;e.Value=l.balance,r.push(e);break;case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_RATE:if(!this.IsNumber(l.rate))continue;e.Value=l.rate,r.push(e);break;case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_NET:var\x20D=l.buy;if(!D)continue;if(!(this.IsNumber(D.balance)&&this.IsNumber(D.amount)&&this.IsNumber(D.repay)&&this.IsNumber(D.net)))continue;e.Value=D.balance,(h=new\x20SingleData).Date=o.date,h.Value=D.amount,(c=new\x20SingleData).Date=o.date,c.Value=D.repay,(C=new\x20SingleData).Date=o.date,C.Value=D.net,r.push(e),i.push(h),n.push(c),s.push(C);break;case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_NET:var\x20h,c,C,E=l.sell;if(!E)continue;if(!(this.IsNumber(E.balance)&&this.IsNumber(E.volume)&&this.IsNumber(E.repay)&&this.IsNumber(E.net)))continue;e.Value=D.balance,(h=new\x20SingleData).Date=o.date,h.Value=D.volume,(c=new\x20SingleData).Date=o.date,c.Value=D.repay,(C=new\x20SingleData).Date=o.date,C.Value=D.net,r.push(e),i.push(h),n.push(c),s.push(C);break;default:continue}}var\x20m=[];for(var\x20u\x20in\x20t===JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BALANCE||t===JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_RATE?m.push({JobID:t,Data:r}):t===JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_BALANCE||t===JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT||t===JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_REPAY||t===JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_NET?(m.push({JobID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_BALANCE,Data:r}),m.push({JobID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT,Data:i}),m.push({JobID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_REPAY,Data:n}),m.push({JobID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_NET,Data:s})):t!==JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_BALANCE&&t!==JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_VOLUME&&t!==JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_REPAY&&t!==JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_NET||(m.push({JobID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_BALANCE,Data:r}),m.push({JobID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_VOLUME,Data:i}),m.push({JobID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_REPAY,Data:n}),m.push({JobID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_NET,Data:s})),m){let\x20e=this.SourceData.GetFittingData(m[u].Data);var\x20A=new\x20ChartData;if(A.Data=e,A.Period=this.Period,A.Period>0){var\x20N=A.GetPeriodSingleData(A.Period);A.Data=N}let\x20t=A.GetValue();this.MarginData.set(m[u].JobID,t)}},this.GetNewsAnalysisCacheData=function(e,t){let\x20a=JS_EXECUTE_JOB_ID.GetNewsAnalysisID(e);return\x20a||this.Execute.ThrowUnexpectedNode(t,\x22不支持NEWS(\x22+e+\x22)\x22),this.NewsAnalysisData.has(a)?this.NewsAnalysisData.get(a):[]},this.GetHKToSHSZData=function(e){var\x20t=e.Args,a=this.Symbol;if(t.length>0){var\x20r=t[0];if(r.Type==Syntax.Literal)a=r.Value;else\x20if(r.Type==Syntax.Identifier){var\x20i=!1;for(var\x20n\x20in\x20this.Arguments){const\x20e=this.Arguments[n];if(e.Name==r.Name){a=e.Value,i=!0;break}}if(!i){var\x20s=e.Token;this.Execute.ErrorHandler.ThrowError(s.Index,s.Line,0,`HK2SHSZ()\x20Error:\x20can\x27t\x20read\x20${r.Name}`)}}}e.Symbol=a,1==a||2==a||3==a?this.GetHKToSHSZMarketData(a,e):this.GetHKToSHSZStockData(a,e)},this.GetHKToSHSZStockData=function(e,t){if(this.HKToSHSZData.has(e))return\x20this.Execute.RunNextJob();var\x20a=e.toLowerCase(),r=this,i=`${this.HKToSHSZApiUrl[3]}/${a}.json`;JSNetwork.HttpRequest({url:i,type:\x22get\x22,dataType:\x22json\x22,async:!0,success:function(e){r.RecvHKToSHSZStockData(e,t),r.Execute.RunNextJob()},error:function(e){console.warn(`[JSSymbolData::GetHKToSHSZStockData]\x20request\x20url=${i}\x20failed.\x20error=${e.status}`),r.RecvHKToSHSZStockData(null,t),r.Execute.RunNextJob()}})},this.RecvHKToSHSZStockData=function(e,t){if(e){for(var\x20a=e.symbol.toUpperCase(),r=[],i=0;i<e.date.length;++i){var\x20n=new\x20SingleData;n.Date=e.date[i],n.Value=e.vol[i],r.push(n)}var\x20s=this.Data.GetFittingData(r),u=new\x20ChartData;if(u.Data=s,u.Period=this.Period,u.Period>0){var\x20o=u.GetPeriodSingleData(u.Period);u.Data=o}e=u.GetValue();this.HKToSHSZData.set(a,e)}},this.GetHKToSHSZMarketData=function(e,t){if(this.HKToSHSZData.has(e))return\x20this.Execute.RunNextJob();var\x20a,r=0;this.DataType===HQ_DATA_TYPE.MINUTE_ID?r=1:this.DataType==HQ_DATA_TYPE.MULTIDAY_MINUTE_ID?r=2:this.Period<=3&&(r=0),a=this.HKToSHSZApiUrl[r];var\x20i=this;JSConsole.Complier.Log(`[JSSymbolData::GetHKToSHSZMarketData]\x20code=${e}\x20url=${a},\x20dataType=${r}`),2===r?JSNetwork.HttpRequest({url:a,data:{symbol:this.Symbol,daycount:this.MaxRequestMinuteDayCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){i.RecvMulitMinuteHKToSHSZData(e,t),i.Execute.RunNextJob()}}):JSNetwork.HttpRequest({url:a,type:\x22get\x22,dataType:\x22json\x22,async:!0,success:function(e){0==r?i.RecvHKToSHSZData(e,t):1==r&&i.RecvMinuteHKToSHSZData(e,t),i.Execute.RunNextJob()}})},this.RecvMinuteHKToSHSZData=function(e,t){var\x20a=[],r=[],i=[];if(this.IsBeforeData){for(n\x20in\x20this.SourceData.Data){if(!(D=this.SourceData.Data[n]).Before)break;a.push(null),r.push(null),i.push(null)}for(var\x20n=0;n<e.time.length;++n){if(925!==e.time[n]){var\x20s=(u=e.hk2sh[n])+(o=e.hk2sz[n]);a.push(s),r.push(u),i.push(o)}}}else\x20for(n=0;n<e.time.length;++n){var\x20u,o;e.time[n],s=(u=e.hk2sh[n])+(o=e.hk2sz[n]);a.push(s),r.push(u),i.push(o)}var\x20l=[{Data:a,ID:1},{Data:r,ID:2},{Data:i,ID:3}];for(var\x20n\x20in\x20l){var\x20D=l[n];this.HKToSHSZData.set(D.ID,D.Data)}},this.RecvHKToSHSZData=function(e,t){for(var\x20a=[],r=[],i=[],n=0;n<e.date.length;++n){var\x20s=e.date[n],u=1e6*e.hk2sh[n],o=1e6*e.hk2sz[n],l=u+o;let\x20t=new\x20SingleData;t.Date=s,t.Value=l;let\x20D=new\x20SingleData;D.Date=s,D.Value=u;let\x20h=new\x20SingleData;h.Date=s,h.Value=o,a.push(t),r.push(D),i.push(h)}var\x20D=[{Data:a,ID:1},{Data:r,ID:2},{Data:i,ID:3}];for(var\x20n\x20in\x20D){let\x20e=this.Data.GetFittingData(D[n].Data);var\x20h=new\x20ChartData;if(h.Data=e,h.Period=this.Period,h.Period>0){var\x20c=h.GetPeriodSingleData(h.Period);h.Data=c}let\x20t=h.GetValue();this.HKToSHSZData.set(D[n].ID,t)}},this.RecvMulitMinuteHKToSHSZData=function(e,t){if(e.data&&!(e.data.length<=0)){for(var\x20a=[],r=[],i=[],n=0,s=0;n<this.Data.Data.length&&s<e.data.length;){a[n]=null,r[n]=null,i[n]=null;var\x20u=(N=this.Data.Data[n]).DateTime;if(u){var\x20o=u.split(\x22\x20\x22);if(2==o.length){var\x20l=parseInt(o[0]),D=e.data[s];if(!D.minute||D.minute.length<=0)++s;else\x20if(D.date>l)++n;else\x20if(D.date<l)++s;else{for(var\x20h\x20in\x20D.minute){var\x20c=D.minute[h],C=c[1],E=c[2],m=C+E;a[n]=m,r[n]=C,i[n]=E,++n}++s}}else++n}else++n}var\x20A=[{Data:a,ID:1},{Data:r,ID:2},{Data:i,ID:3}];for(var\x20n\x20in\x20A){var\x20N=A[n];this.HKToSHSZData.set(N.ID,N.Data)}}},this.GetHKToSHSZCacheData=function(e,t){return\x20e||(e=this.Symbol),\x22string\x22==typeof\x20e&&(e=e.toUpperCase()),this.HKToSHSZData.has(e)?this.HKToSHSZData.get(e):[]},this.GetNewsAnalysisData=function(e){if(this.NewsAnalysisData.has(e))return\x20this.Execute.RunNextJob();var\x20t=this,a=new\x20Map([[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE,\x22negative\x22],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH,\x22research\x22],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT,\x22interact\x22],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE,\x22holderchange\x22],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2,\x22holderchange\x22],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER,\x22trustholder\x22],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING,\x22Blocktrading\x22],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS,\x22companynews\x22],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS,\x22topmanagers\x22],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE,\x22Pledge\x22]]);if(a.has(e)){var\x20r=a.get(e),i=this.StockNewsAnalysisApiUrl+\x22/\x22+r+\x22/\x22+this.Symbol+\x22.json\x22;JSNetwork.HttpRequest({url:i,type:\x22get\x22,dataType:\x22json\x22,async:!0,success:function(a){t.RecvNewsAnalysisData(a,e),t.Execute.RunNextJob()},error:function(a,r){t.RecvNewsAnalysisDataError(a,r,e),t.Execute.RunNextJob()}})}else\x20this.Execute.RunNextJob()},this.RecvNewsAnalysisDataError=function(e,t,a){JSConsole.Complier.Log(\x22[JSSymbolData::RecvNewsAnalysisDataError]\x20ajax\x20error.\x22,e.status);for(var\x20r=[],i=0;i<this.Data.Data.length;++i){var\x20n=new\x20SingleData;n.Date=this.Data.Data[i].Date,n.Value=0,r.push(n)}var\x20s=new\x20ChartData;s.Data=r,this.NewsAnalysisData.set(a,s.GetValue())},this.RecvNewsAnalysisData=function(e,t){if(e.data&&e.date&&!(e.data.length<=0||e.data.length!=e.date.length))if(JSConsole.Complier.Log(\x22[JSSymbolData::RecvNewsAnalysisData]\x20jobID\x22,t,e.update),t==JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE||t==JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2){for(var\x20a=[],r=[],i=0;i<e.data.length;++i){(n=new\x20SingleData).Date=e.date[i],n.Value=e.data[i],this.IsNumber(n.Value)&&a.push(n),i<e.data2.length&&((n=new\x20SingleData).Date=e.date[i],n.Value=e.data2[i],this.IsNumber(n.Value)&&r.push(n))}let\x20t=this.Data.GetFittingData2(a,0);(s=new\x20ChartData).Data=t,this.NewsAnalysisData.set(JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE,s.GetValue()),t=this.Data.GetFittingData2(r,0),(s=new\x20ChartData).Data=t,this.NewsAnalysisData.set(JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2,s.GetValue())}else{for(a=[],i=0;i<e.data.length;++i){var\x20n;(n=new\x20SingleData).Date=e.date[i],n.Value=e.data[i],a.push(n)}let\x20r=this.Data.GetFittingData2(a,0);var\x20s;(s=new\x20ChartData).Data=r,this.NewsAnalysisData.set(t,s.GetValue())}},this.GetSectionFinanceData=function(e){var\x20t=e.SF[0],a=e.SF[1].Period;if(this.SectionFinanceData.has(t))return\x20this.Execute.RunNextJob();JSConsole.Complier.Log(`[JSSymbolData::GetSectionFinanceData]\x20${a.Year}-${a.Quarter}`);var\x20r=\x22announcement\x22+a.Quarter,i=this,n=[\x22name\x22,\x22date\x22,\x22symbol\x22,r,\x22finance\x22+a.Quarter],s=[r+\x22.year\x22,\x22int32\x22,\x22eq\x22,a.Year.toString()];JSNetwork.HttpRequest({url:this.StockHistoryDayApiUrl,data:{field:n,symbol:[this.Symbol],condition:[{item:s}]},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){i.RecvSectionFinanceData(t,e),i.Execute.RunNextJob()}})},this.RecvSectionFinanceData=function(e,t){if(e.stock&&1==e.stock.length){var\x20a=e.stock[0];if(a.stockday&&!(a.stockday.length<=0)){var\x20r=a.stockday[0],i=t.SF[1].Period,n=null;if(1===i.Quarter?n=r.finance1:2===i.Quarter?n=r.finance2:3===i.Quarter?n=r.finance3:4===i.Quarter&&(n=r.finance4),n){e=new\x20Map([[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_01,n.currentassets],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_02,n.monetaryfunds],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_03,n.inventory],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_04,n.currentliabilities],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_05,n.ncurrentliabilities],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_06,n.expenses3],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_07,n.investmentincome],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_08,n.pcnprofit],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_09,n.nnetprofit],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_10,n.npersearning],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_11,n.woewa],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_12,n.inprocess],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_13,n.accdepreciation],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_14,n.mholderprofit],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_15,n.lossexchange],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_16,n.baddebts],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_17,n.fixedassets],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_18,n.curdepreciation],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_19,n.orevenues],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_20,n.moprofit],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_21,n.oprofit],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_22,n.nprofit],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_23,n.areceivable],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_24,n.financialcost],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_25,n.ccfo],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_26,n.totalassets],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_27,n.totalliabilities],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_28,n.totalownersequity],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_29,n.grossmargin],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_30,n.percreserve],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_31,n.peruprofit],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_32,n.persearning],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_33,n.pernetasset],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_34,n.perccfo],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_38,n.alratio],[JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_39,n.profityoy]]);4===i.Quarter&&(e.set(JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_35,n.nnprofitincrease),e.set(JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_36,n.nnprofitspeed),e.set(JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_37,n.nprofitincrease));var\x20s=t.SF[0];this.SectionFinanceData.set(s,e)}}}},this.GetSectionFinanceCacheData=function(e,t,a,r){var\x20i=JS_EXECUTE_JOB_ID.GetSectionReportPeriod(e,t);i||this.Execute.ThrowUnexpectedNode(r,`不支持FS(${e},\x20${t},\x20\x27${a}\x27)\x20报告期错误`);var\x20n=JS_EXECUTE_JOB_ID.GetSectionFinanceID(a);n||this.Execute.ThrowUnexpectedNode(r,`不支持FS(${e},\x20${t},\x27${a}\x27)\x20财务数据字段名称错误`);var\x20s=i.Year+\x22-\x22+i.Quarter;if(!this.SectionFinanceData.has(s)&&!this.ThrowSFPeirod.has(s)){this.ThrowSFPeirod.add(s);var\x20u={ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_SF,SF:[s,{Period:i,Fields:new\x20Set([n])}]};this.Execute.ThrowDownloadSF(r,u,`FS(${e},\x20${t},\x20\x27${a}\x27)\x20动态下载`)}if(!this.SectionFinanceData.has(s))return\x20this.Execute.ThrowUnexpectedNode(r,`不支持FS(${e},\x20${t},\x20\x27${a}\x27)\x20没有这期财务数据`);var\x20o=this.SectionFinanceData.get(s);return\x20o.has(n)||this.Execute.ThrowUnexpectedNode(r,`不支持FS(${e},\x20${t},\x20\x27${a}\x27)\x20没有这期财务数据字段`),o.get(n)},this.GetFinOne=function(e){var\x20t=this.JobArgumentsToArray(e,3),a=this.GetStockDataKey(e,t);if(this.StockData.has(a))return\x20this.Execute.RunNextJob();var\x20r=this;if(this.NetworkFilter){var\x20i=this.Data.GetDateRange(),n={Name:\x22JSSymbolData::GetFinOne\x22,Explain:\x22财务数据FINONE(ID,Y,MMDD)\x22,JobID:e.ID,Request:{Url:r.StockHistoryDayApiUrl,Type:\x22POST\x22,Data:{Args:t,symbol:this.Symbol,daterange:i}},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,function(t){r.RecvStockValue(t,e,a,1),r.Execute.RunNextJob()}),1==n.PreventDefault)return}new\x20DownloadFinOneData({Job:e,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,Args:t,DataKey:a,Callback:function(e,t,a){r.RecvStockValue(e,t,a,1),r.Execute.RunNextJob()},ErrorCallback:function(e){r.AddStockValueError(a,e)}}).Download()},this.GetStockDataKey=function(e,t){var\x20a=e.FunctionName;if(t.length>0){a+=\x22(\x22;for(var\x20r=0;r<t.length;++r)r>0&&(a+=\x22,\x22),a+=t[r].toString();a+=\x22)\x22}return\x20a},this.GetFinValue=function(e){var\x20t=this.JobArgumentsToArray(e,1),a=t[0],r=this.GetStockDataKey(e,t);if(this.StockData.has(r))return\x20this.Execute.RunNextJob();var\x20i=this;if(this.NetworkFilter){var\x20n=this.Data.GetDateRange(),s={Name:\x22JSSymbolData::GetFinValue\x22,Explain:\x22财务数据FINVALUE(ID)\x22,JobID:e.ID,Request:{Url:i.StockHistoryDayApiUrl,Type:\x22POST\x22,Data:{id:a,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,function(t){i.RecvStockValue(t,e,r,0),i.Execute.RunNextJob()}),1==s.PreventDefault)return}new\x20DownloadFinValueData({Job:e,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,Args:t,DataKey:r,Callback:function(e,t,a){i.RecvStockValue(e,t,a,0),i.Execute.RunNextJob()},ErrorCallback:function(e){i.AddStockValueError(r,e)}}).Download()},this.GetFinance=function(e){var\x20t=this.JobArgumentsToArray(e,1),a=t[0],r=this.GetStockDataKey(e,t);if(this.StockData.has(r))return\x20this.Execute.RunNextJob();var\x20i=this;if(this.NetworkFilter){var\x20n=this.Data.GetDateRange(),s={Name:\x22JSSymbolData::GetFinance\x22,Explain:\x22财务数据FINANCE(ID)\x22,JobID:e.ID,Request:{Url:i.RealtimeApiUrl,Type:\x22POST\x22,Data:{id:a,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,function(t){i.RecvStockValue(t,e,r,0),i.Execute.RunNextJob()}),1==s.PreventDefault)return}new\x20DownloadFinanceData({Job:e,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,RealtimeUrl:this.RealtimeApiUrl,Args:t,DataKey:r,Callback:function(e,t,a){i.RecvStockValue(e,t,a,0),i.Execute.RunNextJob()},ErrorCallback:function(e){i.AddStockValueError(r,e)}}).Download()},this.GetGPJYValue=function(e){var\x20t=this.JobArgumentsToArray(e,3),a=this.GetStockDataKey(e,t);if(this.StockData.has(a))return\x20this.Execute.RunNextJob();var\x20r=this,i=1==t[2]?0:2;if(this.NetworkFilter){var\x20n=this.Data.GetDateRange(),s={Name:\x22JSSymbolData::GetGPJYValue\x22,Explain:\x22股票交易类数据GPJYVALUE(ID,N,TYPE)\x22,JobID:e.ID,Request:{Url:r.StockHistoryDayApiUrl,Type:\x22POST\x22,Data:{Args:t,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,function(t){r.RecvStockValue(t,e,a,i),r.Execute.RunNextJob()}),1==s.PreventDefault)return}new\x20DownloadGPJYValue({Job:e,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,Args:t,DataKey:a,Callback:function(e,t,a){r.RecvStockValue(e,t,a,i),r.Execute.RunNextJob()},ErrorCallback:function(e){r.AddStockValueError(a,e)}}).Download()},this.GetVariantData=function(e){var\x20t=e.VariantName;if(this.StockData.has(t))return\x20this.Execute.RunNextJob();var\x20a=this;if(this.NetworkFilter){var\x20r=this.Data.GetDateRange(),i={Name:\x22JSSymbolData::GetVariantData\x22,Explain:\x22变量数据下载\x22,JobID:e.ID,Request:{Url:\x22www.121287.com\x22,Type:\x22POST\x22,Data:{VariantName:e.VariantName,symbol:this.Symbol,daterange:r}},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,function(r){a.RecvStockValue(r,e,t,0),a.Execute.RunNextJob()}),1==i.PreventDefault)return}var\x20n;\x22CAPITAL\x22!=e.VariantName&&\x22TOTALCAPITAL\x22!=e.VariantName&&\x22EXCHANGE\x22!=e.VariantName||(n=new\x20DownloadFinanceData({Job:e,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,RealtimeUrl:this.RealtimeApiUrl,Args:[e.VariantName],DataKey:t,Callback:function(e,t,r){a.RecvStockValue(e,t,r,0),a.Execute.RunNextJob()},ErrorCallback:function(e){a.AddStockValueError(t,e)}})),n.Download()},this.GetCustomVariantData=function(e){var\x20t=e.VariantName;if(this.StockData.has(t))return\x20this.Execute.RunNextJob();var\x20a=g_JSComplierResource.CustomVariant.Data.get(t),r=this;if(this.NetworkFilter){var\x20i=this.Data.GetDateRange(),n={Name:\x22JSSymbolData::GetCustomVariantData\x22,Explain:\x22自定义变量数据下载\x22,JobID:e.ID,Request:{Url:\x22www.121287.com\x22,Type:\x22POST\x22,Data:{VariantName:e.VariantName,symbol:this.Symbol,daterange:i}},Self:this,VariantInfo:a,PreventDefault:!1};this.NetworkFilter(n,function(a){a.Error?r.AddStockValueError(t,a.Error):r.RecvStockValue(a.Data,e,t,a.DataType),r.Execute.RunNextJob()})}else\x20this.AddStockValueError(t,`自定义变量${t}下载失败`),this.Execute.RunNextJob()},this.GetCustomFunctionData=function(e){var\x20t=e.FunctionName,a=g_JSComplierResource.CustomFunction.Data.get(t);if(!a.IsDownload)return\x20this.Execute.RunNextJob();if(this.StockData.has(t))return\x20this.Execute.RunNextJob();var\x20r=this;if(this.NetworkFilter){var\x20i=this.Data.GetDateRange(),n={Name:\x22JSSymbolData::GetCustomFunctionData\x22,Explain:\x22自定义函数数据下载\x22,JobID:e.ID,Request:{Url:\x22www.121287.com\x22,Type:\x22POST\x22,Data:{FunctionName:e.FunctionName,symbol:this.Symbol,daterange:i,JobItem:e}},Self:this,FunctionInfo:a,PreventDefault:!1};this.NetworkFilter(n,function(a){a.Error?r.AddStockValueError(t,a.Error):r.RecvStockValue(a.Data,e,t,a.DataType),r.Execute.RunNextJob()})}else\x20this.AddStockValueError(t,`自定义函数${t}下载失败`),this.Execute.RunNextJob()},this.RecvStockValue=function(e,t,a,r){if(e){if(0==r)if(Array.isArray(e)){var\x20i=this.Data;if(ChartData.IsDayPeriod(this.Period,!0))o=i.GetFittingFinanceData(e);else{if(!ChartData.IsMinutePeriod(this.Period,!0))return;o=i.GetMinuteFittingFinanceData(e)}(l=new\x20ChartData).Data=o;var\x20n=l.GetValue();if(\x22EXCHANGE\x22==a)for(var\x20s\x20in\x20n){var\x20u=i.Data[s];IFrameSplitOperator.IsPlusNumber(n[s])&&(n[s]=u.Vol/n[s]*100)}this.StockData.set(a,{Data:n})}else\x20this.StockData.set(a,{Data:e.Value});else\x20if(1==r)this.StockData.set(a,{Data:e.Value});else\x20if(2==r){var\x20o,l;i=this.Data;if(ChartData.IsDayPeriod(this.Period,!0))o=i.GetFittingTradeData(e,0);else{if(!ChartData.IsMinutePeriod(this.Period,!0))return;o=i.GetMinuteFittingTradeData(e,0)}(l=new\x20ChartData).Data=o;n=l.GetValue();this.StockData.set(a,{Data:n})}}else\x20JSConsole.Complier.Log(`[JSSymbolData::RecvStockValue]\x20key=${a}\x20data\x20is\x20null`)},this.AddStockValueError=function(e,t){this.StockData.set(e,{Error:t})},this.GetStockCacheData=function(e){var\x20t;if(e.FunctionName)t=this.GetStockDataKey({FunctionName:e.FunctionName},e.Args);else\x20if(e.VariantName)t=e.VariantName;else{if(!e.CustomName)return\x20null;t=e.CustomName}if(!this.StockData.has(t))return\x20null;var\x20a=this.StockData.get(t);return\x20a.Error&&this.Execute.ThrowUnexpectedNode(e.Node,a.Error),a.Data},this.JobArgumentsToArray=function(e,t){var\x20a=e.Args;if(a.length!=t){var\x20r=e.Token;this.Execute.ErrorHandler.ThrowError(r.Index,r.Line,0,`${e.FunctionName}()\x20Error:\x20argument\x20count\x20error.`)}for(var\x20i=[],n=0;n<a.length;++n){var\x20s=a[n];if(IFrameSplitOperator.IsNumber(s))i.push(s);else\x20if(s.Type==Syntax.Literal)i.push(s.Value);else\x20if(s.Type==Syntax.Identifier){var\x20u=!1;for(var\x20o\x20in\x20this.Arguments){const\x20e=this.Arguments[o];if(e.Name==s.Name){i.push(e.Value),u=!0;break}}if(!u){r=e.Token;this.Execute.ErrorHandler.ThrowError(r.Index,r.Line,0,`${e.FunctionName}()\x20Error:\x20can\x27t\x20read\x20${s.Name}`)}}}return\x20i},this.DownloadCustomAPIData=function(e){if(!this.NetworkFilter)return\x20this.Execute.RunNextJob();var\x20t=[];for(var\x20a\x20in\x20e.Args){var\x20r=e.Args[a];if(r.Type==Syntax.Literal)t.push(r.Value);else{if(r.Type!=Syntax.Identifier)return\x20this.Execute.RunNextJob();var\x20i=!1;for(var\x20n\x20in\x20this.Arguments){const\x20e=this.Arguments[n];if(e.Name==r.Name){t.push(e.Value),i=!0;break}}if(!i){var\x20s=e.Token;this.Execute.ErrorHandler.ThrowError(s.Index,s.Line,0,`LoadAPIData()\x20Error:\x20can\x27t\x20read\x20${r.Name}`)}}}var\x20u=this,o={Name:\x22JSSymbolData::DownloadCustomAPIData\x22,Explain:\x22下载自定义api数据\x22,Period:this.Period,Right:this.Right,Symbol:this.Symbol,KData:this.Data,Cache:this.CustomAPIData,Args:t,Self:this,PreventDefault:!1};this.NetworkFilter(o,function(e){u.RecvCustomAPIData(e,t),u.Execute.RunNextJob()}),1!=o.PreventDefault&&this.Execute.RunNextJob()},this.RecvCustomAPIData=function(e,t){e&&(1==e.Type?this.RecvCustomAPISingleData(e,t):this.RecvCustomAPIGroupData(e,t))},this.RecvCustomAPIGroupData=function(e,t){if(e&&e.data){var\x20a=e.data,r=this.GenerateCustomAPIKey(t);if(ChartData.IsMinutePeriod(this.Period,!0)){if(!a.date||!a.time)return;var\x20i=a.date;a.time;for(var\x20n\x20in\x20a)if(\x22date\x22!=n&&\x22time\x22!=n)var\x20s=a[n]}else\x20if(ChartData.IsDayPeriod(this.Period,!0)){if(!a.date)return;i=a.date;var\x20u={__Type__:\x22Object\x22};for(var\x20n\x20in\x20a)if(\x22date\x22!=n){s=a[n];if(Array.isArray(s)){var\x20o=this.FittingCustomAPIArray(s,i);u[n]=o}else\x20this.IsNumber(s)&&(u[n]=s)}this.CustomAPIData.set(r,u)}}},this.RecvCustomAPISingleData=function(e,t){var\x20a=e.data,r=this.GenerateCustomAPIKey(t);if(ChartData.IsMinutePeriod(this.Period,!0)){if(!a.date||!a.time)return;var\x20i=a.date;a.time;for(var\x20n\x20in\x20a)if(\x22date\x22!=n&&\x22time\x22!=n)a[n]}else\x20if(ChartData.IsDayPeriod(this.Period,!0)){if(!a.date)return;i=a.date;var\x20s=a.value,u=null;u=Array.isArray(s)?1==e.DataType?this.FittingCustomAPIFinanceArray(s,i):this.FittingCustomAPIArray(s,i):s,this.CustomAPIData.set(r,u)}},this.FittingCustomAPIFinanceArray=function(e,t,a){var\x20r,i=this.Data,n=[];for(var\x20s\x20in\x20e){var\x20u=e[s],o=new\x20SingleData;o.Date=t[s],a&&s<a.length&&(o.Time=a[s]),o.Value=u,n.push(o)}if(ChartData.IsDayPeriod(this.Period,!0))r=i.GetFittingFinanceData(n);else{if(!ChartData.IsMinutePeriod(this.Period,!0))return\x20null;r=i.GetMinuteFittingFinanceData(n)}var\x20l=new\x20ChartData;return\x20l.Data=r,l.GetValue()},this.FittingCustomAPIArray=function(e,t,a){var\x20r,i=this.Data,n=[];for(var\x20s\x20in\x20e){var\x20u=e[s],o=new\x20SingleData;o.Date=t[s],a&&s<a.length&&(o.Time=a[s]),o.Value=u,n.push(o)}if(ChartData.IsDayPeriod(this.Period,!0))r=i.GetFittingData(n);else{if(!ChartData.IsMinutePeriod(this.Period,!0))return\x20null;r=i.GetMinuteFittingData(n)}var\x20l=new\x20ChartData;return\x20l.Data=r,l.GetValue()},this.GenerateCustomAPIKey=function(e){if(e.length<=0)return\x22__12_EMPTY_ARGS__\x22;var\x20t=\x22\x22;for(var\x20a\x20in\x20e)t.length>0&&(t+=\x22,\x22),t+=e[a];return\x20t},this.GetCustomApiData=function(e){var\x20t=this.GenerateCustomAPIKey(e);return\x20this.CustomAPIData.has(t)?this.CustomAPIData.get(t):(JSConsole.Complier.Log(`[JSSymbolData::GetCustomApiData]\x20can\x27t\x20find\x20api\x20data\x20key=[${t}]`),null)},this.ReadArgumentValue=function(e,t){if(t.Name=e.Name,e.Type==Syntax.Literal)return\x20t.Value=e.Value,!0;if(e.Type==Syntax.Identifier){var\x20a=!1;for(var\x20r\x20in\x20this.Arguments){const\x20i=this.Arguments[r];if(i.Name==e.Name)return\x20t.Value=i.Value,a=!0,!0}if(!a)return\x20t.Error=`can\x27t\x20read\x20${e.Name}`,!1}return\x20t.Error=`can\x27t\x20read\x20${e.Name},\x20type\x20error.`,!1},this.ReadIndexFunctionValue=function(e,t){var\x20a={};if(\x22object\x22==typeof\x20e){if(!this.ReadArgumentValue(e,a))return\x20t.Error=a.Error,!1}else\x20a.Value=e;var\x20r,i=a.Value.indexOf(\x22.\x22);-1!=i?(t.Name=a.Value.slice(0,i),-1!=(r=a.Value.indexOf(\x22#\x22,i+1))?(t.Out=a.Value.slice(i+1,r),t.Period=a.Value.slice(r+1)):t.Out=a.Value.slice(i+1)):-1!=(r=a.Value.indexOf(\x22#\x22))?(t.Name=a.Value.slice(0,r),t.Period=a.Value.slice(r+1)):t.Name=a.Value;const\x20n=new\x20Map([[\x22DAY\x22,0],[\x22WEEK\x22,1],[\x22MONTH\x22,2],[\x22SEASON\x22,9],[\x22YEAR\x22,3],[\x22MIN1\x22,4],[\x22MIN5\x22,5],[\x22MIN15\x22,6],[\x22MIN30\x22,7],[\x22MIN60\x22,8]]);if(t.Period){if(!n.has(t.Period))return\x20t.Error=`${t.Period},\x20周期错误`,!1;t.PeriodID=n.get(t.Period)}return!0},this.ReadSymbolArgumentValue=function(e,t){var\x20a={};if(\x22object\x22==typeof\x20e){if(!this.ReadArgumentValue(e,a))return\x20t.Error=a.Error,!1}else\x20a.Value=e;return\x22\x22==a.Value&&(a.Value=this.Symbol),a.Value.indexOf(\x22.SH\x22)>0?t.Symbol=a.Value.replace(\x22.SH\x22,\x22.sh\x22):a.Value.indexOf(\x22.SZ\x22)>0?t.Symbol=a.Value.replace(\x22.SZ\x22,\x22.sz\x22):t.Symbol=a.Value,!0},this.ReadIndexArgumentValue=function(e,t){for(var\x20a\x20in\x20t.Args=[],t.SytemIndex.Args){var\x20r=t.SytemIndex.Args[a];t.Args.push({Value:r.Value,Name:r.Name})}if(e.length>2&&t.SytemIndex.Args&&t.SytemIndex.Args.length>0){a=2;for(var\x20i=0;a<e.length&&i<t.SytemIndex.Args.length;++a,++i){var\x20n={};if(\x22object\x22==typeof(r=e[a])){if(!this.ReadArgumentValue(r,n))return\x20t.Error=n.Error,!1}else\x20n.Value=r;t.Args[i].Value=n.Value}}return!0},this.GenerateScriptIndexKey=function(e){var\x20t=\x22\x22,a=e.Args;for(var\x20r\x20in\x20a){t.length>0&&(t+=\x22,\x22),t+=a[r].Value.toString()}var\x20i=e.Out?e.Out:\x22ALL\x22;return`(${e.Symbol},${e.PeriodID}),\x20${e.Name}(${t})=>${i}`},this.CallScriptIndex=function(e){if(!(e.Args&&e.Args.length>=2)){var\x20t=e.Token;this.Execute.ErrorHandler.ThrowError(t.Index,t.Line,0,`CallScriptIndex()\x20Error:\x20${e.FunctionName}\x20参数错误`)}var\x20a={Job:e,PeriodID:this.Period};if(!this.ReadSymbolArgumentValue(e.Args[0],a)){t=e.Token;this.Execute.ErrorHandler.ThrowError(t.Index,t.Line,0,`CallScriptIndex()\x20Error:\x20${a.Error}`)}if(!this.ReadIndexFunctionValue(e.Args[1],a)){t=e.Token;this.Execute.ErrorHandler.ThrowError(t.Index,t.Line,0,`CallScriptIndex()\x20Error:\x20${a.Error}`)}var\x20r=(new\x20JSIndexScript).Get(a.Name);if(!r){t=e.Token;this.Execute.ErrorHandler.ThrowError(t.Index,t.Line,0,`CallScriptIndex()\x20${a.Name}\x20指标不存在`)}if(a.SytemIndex=r,!this.ReadIndexArgumentValue(e.Args,a)){t=e.Token;this.Execute.ErrorHandler.ThrowError(t.Index,t.Line,0,`CallScriptIndex()\x20${a.Name}\x20指标参数错误\x20:\x20${a.Error}\x20`)}JSConsole.Complier.Log(\x22[JSSymbolData::CallScriptIndex]\x20call\x20script\x20index\x22,a);var\x20i=null;if(this.Data&&this.Data.Data.length>0){var\x20n=this.Data.Data[0],s=this.Data.Data[this.Data.Data.length-1];i={Start:{Date:n.Date,Time:n.Time},End:{Date:s.Date,Time:s.Time}}}var\x20u={HQDataType:this.DataType,Symbol:a.Symbol,Name:\x22\x22,Right:this.Right,Period:a.PeriodID,Data:null,SourceData:null,Callback:(e,t,a)=>{this.RecvScriptIndexData(e,t,a),this.Execute.RunNextJob()},CallbackParam:a,Async:!0,MaxRequestDataCount:this.MaxRequestDataCount+60,MaxRequestMinuteDayCount:this.MaxRequestMinuteDayCount+2,Arguments:a.Args,IsBeforeData:this.IsBeforeData,NetworkFilter:this.NetworkFilter,KLineRange:i};JSComplier.Execute(a.SytemIndex.Script,u,(e,t)=>{this.ExecuteScriptIndexError(e,t)})},this.RecvScriptIndexData=function(e,t,a){var\x20r=this.GenerateScriptIndexKey(t);JSConsole.Complier.Log(\x22[JSSymbolData::RecvScriptIndexData]\x20\x22,e,t,a,r);var\x20i=a.Data.Data,n=e;if(t.Out){for(var\x20s\x20in\x20e){if((l=e[s]).Name==t.Out){n=[l];break}}var\x20u=this.Data.FitKLineIndex(i,n,this.Period,t.PeriodID);this.ScriptIndexOutData.set(r,u[0].Data)}else{u=this.Data.FitKLineIndex(i,n,this.Period,t.PeriodID);var\x20o={__Type__:\x22Object\x22};for(var\x20s\x20in\x20u){var\x20l;o[(l=u[s]).Name]=l.Data}this.ScriptIndexOutData.set(r,o)}},this.ExecuteScriptIndexError=function(e,t){var\x20a=t.Job.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,`CallScriptIndex()\x20${t.Name}\x20指标执行错误\x20:\x20${e}\x20`)},this.GetScriptIndexOutData=function(e,t){var\x20a={PeriodID:this.Period};this.ReadSymbolArgumentValue(e[0],a)||this.Execute.ThrowUnexpectedNode(t,`STKINDI()\x20股票代码错误:\x20${a.Error}`),this.ReadIndexFunctionValue(e[1],a)||this.Execute.ThrowUnexpectedNode(t,`STKINDI()\x20指标错误:\x20${a.Error}`);var\x20r=(new\x20JSIndexScript).Get(a.Name);r||this.Execute.ThrowUnexpectedNode(t,`STKINDI()\x20指标错误:\x20${a.Name}\x20指标不存在`),a.SytemIndex=r,this.ReadIndexArgumentValue(e,a)||this.Execute.ThrowUnexpectedNode(t,`STKINDI()\x20\x20指标参数错误:\x20${a.Error}`);var\x20i=this.GenerateScriptIndexKey(a);return\x20this.ScriptIndexOutData.has(i)?this.ScriptIndexOutData.get(i):null},this.JsonDataToHistoryData=function(e){for(var\x20t=e.data,a=new\x20Array,r=0;r<t.length;++r){var\x20i=new\x20HistoryData;i.Date=t[r][0],i.Open=t[r][2],i.YClose=t[r][1],i.Close=t[r][5],i.High=t[r][3],i.Low=t[r][4],i.Vol=t[r][6],i.Amount=t[r][7],t[r].length>8&&(i.Up=t[r][8]),t[r].length>9&&(i.Down=t[r][9]),t[r].length>10&&(i.Stop=t[r][10]),t[r].length>11&&(i.Unchanged=t[r][11]),isNaN(i.Open)||i.Open<=0||a.push(i)}return\x20a},this.JsonDataToMinuteHistoryData=function(e){for(var\x20t=e.data,a=new\x20Array,r=0;r<t.length;++r){let\x20e=new\x20HistoryData;e.Date=t[r][0],e.Open=t[r][2],e.YClose=t[r][1],e.Close=t[r][5],e.High=t[r][3],e.Low=t[r][4],e.Vol=t[r][6],e.Amount=t[r][7],e.Time=t[r][8],a.push(e)}for(r=0;r<a.length;++r){var\x20i=a[r];if(null==i&&coninue,isNaN(i.Open)||i.Open<=0||isNaN(i.High)||i.High<=0||isNaN(i.Low)||i.Low<=0||isNaN(i.Close)||i.Close<=0||isNaN(i.YClose)||i.YClose<=0)if(0==r)i.YClose>0&&(i.Open=i.YClose,i.High=i.YClose,i.Low=i.YClose,i.Close=i.YClose);else\x20for(var\x20n=r-1;n>=0;--n){var\x20s=a[n];if(null==s&&coninue,s.Open>0&&s.High>0&&s.Low>0&&s.Close>0){i.YClose<=0&&(i.YClose=s.Close),i.Open=s.Open,i.High=s.High,i.Low=s.Low,i.Close=s.Close;break}}}return\x20a},this.JsonDataToMinuteData=function(e){var\x20t=new\x20Array;for(var\x20a\x20in\x20e.stock[0].minute){var\x20r=e.stock[0].minute[a],i=new\x20MinuteData;i.Close=r.price,i.Open=r.open,i.High=r.high,i.Low=r.low,i.Vol=r.vol,i.Amount=r.amount,i.DateTime=0==a?e.stock[0].date.toString()+\x22\x200925\x22:e.stock[0].date.toString()+\x22\x20\x22+r.time.toString(),i.Date=e.stock[0].date,i.Time=r.time,i.Increase=r.increase,i.Risefall=r.risefall,i.AvPrice=r.avprice,t[a]=i}return\x20t},this.JsonDataToMultiDayMinuteData=function(e){var\x20t=e.symbol.toUpperCase(),a=MARKET_SUFFIX_NAME.IsSHSZ(t),r=(MARKET_SUFFIX_NAME.IsChinaFutures(t),[]);for(var\x20i\x20in\x20e.data){var\x20n=[],s=e.data[i],u=s.date,o=s.yclose,l=o,D=null;for(var\x20h\x20in\x20s.minute){var\x20c=s.minute[h];c[2]&&(l=c[2]),(E=new\x20MinuteData).Close=c[2],E.Open=c[1],E.High=c[3],E.Low=c[4],E.Vol=c[5]/100,E.Amount=c[6],7<c.length&&c[7]>0&&(E.AvPrice=c[7],D=c[7]),E.DateTime=u.toString()+\x22\x20\x22+c[0].toString(),E.Date=u,E.Time=c[0],E.Close||(E.Close=l,E.Open=E.High=E.Low=E.Close),!E.AvPrice&&D&&(E.AvPrice=D),E.Close&&o?E.Increase=(E.Close-o)/o*100:E.Increase=null,0==h&&(a&&(E.DateTime=u.toString()+\x22\x200925\x22),E.IsFristData=!0),E.Open<=0&&(E.Open=null),E.Close<=0&&(E.Close=null),E.AvPrice<=0&&(E.AvPrice=null),E.High<=0&&(E.High=null),E.Low<=0&&(E.Low=null),E.AvPrice<=0&&(E.AvPrice=null),n[h]=E}var\x20C=new\x20ChartData;C.Data=n,C.YClose=o,C.Close=s.close,C.Date=u,r.push(C)}for(n=[],i=r.length-1;i>=0;--i){var\x20E=r[i];for(var\x20h\x20in\x20E.Data)n.push(E.Data[h])}return\x20n},this.CODELIKE=function(e){return\x20this.Symbol&&0==this.Symbol.indexOf(e)?1:0},this.NAMELIKE=function(e){return\x20this.Name&&0==this.Name.indexOf(e)?1:0},this.SETCODE=function(){return\x20this.Symbol.indexOf(\x22.sh\x22)?1:(this.Symbol.indexOf(\x22.sz\x22),0)},this.GetSymbol=function(){return\x20this.Symbol},this.GetName=function(){return\x20this.Name},this.GetIndustry=function(){var\x20e=JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_GROUP_DATA.toString()+\x22-Group-\x22+this.Symbol;if(!this.ExtendData.has(e))return\x22\x22;var\x20t=this.ExtendData.get(e);if(!t.Industry||t.Industry.length<=0)return\x22\x22;var\x20a=\x22\x22;for(var\x20r\x20in\x20t.Industry){var\x20i=t.Industry[r];a.length>0&&(a+=\x22\x20\x22),a+=i.Name}return\x20a},this.GetRegion=function(){var\x20e=JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_GROUP_DATA.toString()+\x22-Group-\x22+this.Symbol;if(!this.ExtendData.has(e))return\x22\x22;var\x20t=this.ExtendData.get(e);if(!t.Region||t.Region.length<=0)return\x22\x22;var\x20a=\x22\x22;for(var\x20r\x20in\x20t.Region){var\x20i=t.Region[r];a.length>0&&(a+=\x22\x20\x22),a+=i.Name}return\x20a},this.GetConcept=function(){var\x20e=JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_GROUP_DATA.toString()+\x22-Group-\x22+this.Symbol;if(!this.ExtendData.has(e))return\x22\x22;var\x20t=this.ExtendData.get(e);if(!t.Concept||t.Concept.length<=0)return\x22\x22;var\x20a=\x22\x22;for(var\x20r\x20in\x20t.Concept){var\x20i=t.Concept[r];a.length>0&&(a+=\x22\x20\x22),a+=i.Name}return\x20a},this.DATE=function(){var\x20e=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return\x20e;for(var\x20t\x20in\x20this.Data.Data){var\x20a=this.Data.Data[t];e[t]=a.Date-19e6}return\x20e},this.YEAR=function(){var\x20e=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return\x20e;for(var\x20t\x20in\x20this.Data.Data){var\x20a=this.Data.Data[t];this.IsNumber(a.Date)?e[t]=parseInt(a.Date/1e4):e[t]=null}return\x20e},this.MONTH=function(){var\x20e=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return\x20e;for(var\x20t\x20in\x20this.Data.Data){var\x20a=this.Data.Data[t];this.IsNumber(a.Date)?e[t]=parseInt(a.Date%1e4/100):e[t]=null}return\x20e},this.TIME=function(){var\x20e=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return\x20e;for(var\x20t\x20in\x20this.Data.Data){var\x20a=this.Data.Data[t];this.IsNumber(a.Time)?e[t]=a.Time:e[t]=0}return\x20e},this.WEEK=function(){var\x20e=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return\x20e;var\x20t=new\x20Date;for(var\x20a\x20in\x20this.Data.Data){var\x20r=this.Data.Data[a];if(e[a]=null,this.IsNumber(r.Date)){var\x20i=parseInt(r.Date/1e4),n=parseInt(r.Date%1e4/100),s=r.Date%100;t.setFullYear(i),t.setMonth(n-1),t.setDate(s),e[a]=t.getDay()}}return\x20e},this.REFDATE=function(e,t){var\x20a=null;if(Array.isArray(t)?t.length>0&&(a=t[t.length-1]):this.IsNumber(t)&&(a=t),null==a)return\x20null;a<5e6&&(a+=19e6);var\x20r=null;for(var\x20i\x20in\x20this.Data.Data)if(this.Data.Data[i].Date==a){r=parseInt(i);break}return\x20null==r||r>=e.length?null:e[r]},this.PERIOD=function(){const\x20e=[5,6,7,11,0,1,2,3,4,5,9];return\x20this.Period>=0&&this.Period<=e.length-1?e[this.Period]:this.Period},this.GetDrawNull=function(){var\x20e=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return\x20e;for(var\x20t\x20in\x20this.Data.Data)e[t]=null;return\x20e}}JSSymbolData.prototype.IsNumber=function(e){return\x20null!=e&&!isNaN(e)},JSSymbolData.prototype.IsDivideNumber=function(e){return\x20null!=e&&(!isNaN(e)&&0!=e)},JSSymbolData.prototype.JsonDataToFinance=function(e){for(var\x20t,a=1;a<=4;++a){switch(a){case\x201:var\x20r=e.finance1,i=e.announcement1;break;case\x202:r=e.finance2,i=e.announcement2;break;case\x203:r=e.finance3,i=e.announcement3;break;case\x204:r=e.finance4,i=e.announcement4}r&&i&&this.IsNumber(i.year)&&this.IsNumber(i.quarter)&&(t?t.Announcement.year<i.year&&(t={Date:e.date,Finance:r,Announcement:i}):t={Date:e.date,Finance:r,Announcement:i})}return\x20t};var\x20JS_EXECUTE_DEBUG_LOG=!1,JS_EXECUTE_JOB_ID={JOB_DOWNLOAD_SYMBOL_DATA:1,JOB_DOWNLOAD_INDEX_DATA:2,JOB_DOWNLOAD_SYMBOL_LATEST_DATA:3,JOB_DOWNLOAD_INDEX_INCREASE_DATA:4,JOB_DOWNLOAD_VOLR_DATA:5,JOB_DOWNLOAD_GROUP_DATA:6,JOB_DOWNLOAD_LATEST_INDEX_DATA:8,JOB_DOWNLOAD_OTHER_SYMBOL_DATA:9,JOB_DOWNLOAD_SYMBOL_PERIOD_DATA:10,JOB_DOWNLOAD_FINVALUE:301,JOB_DOWNLOAD_FINONE:302,JOB_DOWNLOAD_FINANCE:303,JOB_DOWNLOAD_GPJYVALUE:304,JOB_DOWNLOAD_VARIANT:305,JOB_DOWNLOAD_MARGIN_BALANCE:1e3,JOB_DOWNLOAD_MARGIN_RATE:1001,JOB_DOWNLOAD_MARGIN_BUY_BALANCE:1010,JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:1011,JOB_DOWNLOAD_MARGIN_BUY_REPAY:1012,JOB_DOWNLOAD_MARGIN_BUY_NET:1013,JOB_DOWNLOAD_MARGIN_SELL_BALANCE:1020,JOB_DOWNLOAD_MARGIN_SELL_VOLUME:1021,JOB_DOWNLOAD_MARGIN_SELL_REPAY:1022,JOB_DOWNLOAD_MARGIN_SELL_NET:1023,JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE:2e3,JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH:2001,JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT:2002,JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE:2003,JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2:2004,JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER:2005,JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING:2006,JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS:2007,JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS:2008,JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE:2009,JOB_DOWNLOAD_HK_TO_SH:2050,JOB_DOWNLOAD_HK_TO_SZ:2051,JOB_DOWNLOAD_HK_TO_SH_SZ:2052,JOB_DOWNLOAD_HK_TO_SHSZ:2053,JOB_CUSTOM_FUNCTION_DATA:6e3,JOB_CUSTOM_VARIANT_DATA:6001,JOB_DOWNLOAD_SECTION_SF:2e4,JOB_DOWNLOAD_SECTION_F_01:20001,JOB_DOWNLOAD_SECTION_F_02:20002,JOB_DOWNLOAD_SECTION_F_03:20003,JOB_DOWNLOAD_SECTION_F_04:20004,JOB_DOWNLOAD_SECTION_F_05:20005,JOB_DOWNLOAD_SECTION_F_06:20006,JOB_DOWNLOAD_SECTION_F_07:20007,JOB_DOWNLOAD_SECTION_F_08:20008,JOB_DOWNLOAD_SECTION_F_09:20009,JOB_DOWNLOAD_SECTION_F_10:20010,JOB_DOWNLOAD_SECTION_F_11:20011,JOB_DOWNLOAD_SECTION_F_12:20012,JOB_DOWNLOAD_SECTION_F_13:20013,JOB_DOWNLOAD_SECTION_F_14:20014,JOB_DOWNLOAD_SECTION_F_15:20015,JOB_DOWNLOAD_SECTION_F_16:20016,JOB_DOWNLOAD_SECTION_F_17:20017,JOB_DOWNLOAD_SECTION_F_18:20018,JOB_DOWNLOAD_SECTION_F_19:20019,JOB_DOWNLOAD_SECTION_F_20:20020,JOB_DOWNLOAD_SECTION_F_21:20021,JOB_DOWNLOAD_SECTION_F_22:20022,JOB_DOWNLOAD_SECTION_F_23:20023,JOB_DOWNLOAD_SECTION_F_24:20024,JOB_DOWNLOAD_SECTION_F_25:20025,JOB_DOWNLOAD_SECTION_F_26:20026,JOB_DOWNLOAD_SECTION_F_27:20027,JOB_DOWNLOAD_SECTION_F_28:20028,JOB_DOWNLOAD_SECTION_F_29:20029,JOB_DOWNLOAD_SECTION_F_30:20030,JOB_DOWNLOAD_SECTION_F_31:20031,JOB_DOWNLOAD_SECTION_F_32:20032,JOB_DOWNLOAD_SECTION_F_33:20033,JOB_DOWNLOAD_SECTION_F_34:20034,JOB_DOWNLOAD_SECTION_F_35:20035,JOB_DOWNLOAD_SECTION_F_36:20036,JOB_DOWNLOAD_SECTION_F_37:20037,JOB_DOWNLOAD_SECTION_F_38:20038,JOB_DOWNLOAD_SECTION_F_39:20039,JOB_DOWNLOAD_CUSTOM_API_DATA:3e4,JOB_EXECUTE_INDEX:30010,JOB_RUN_SCRIPT:1e4,GetMarginJobID:function(e){let\x20t=new\x20Map([[1,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BALANCE],[2,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_RATE],[3,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_BALANCE],[4,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT],[5,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_REPAY],[6,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_NET],[7,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_BALANCE],[8,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_VOLUME],[9,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_REPAY],[10,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_NET]]);return\x20t.has(e)?t.get(e):null},GetNewsAnalysisID:function(e){let\x20t=new\x20Map([[1,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE],[2,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH],[3,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT],[4,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE],[5,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2],[6,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER],[7,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING],[8,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS],[9,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS],[10,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE]]);return\x20t.has(e)?t.get(e):null},GetSectionFinanceID:function(e){let\x20t=new\x20Map([[\x22流动资产\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_01],[\x22货币资金\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_02],[\x22存货\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_03],[\x22流动负债\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_04],[\x22非流动负债\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_05],[\x22三项费用\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_06],[\x22投资收益\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_07],[\x22归母净利润\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_08],[\x22扣非净利润\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_09],[\x22扣非每股收益\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_10],[\x22加权平均净资产收益\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_11],[\x22在建工程\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_12],[\x22累计折旧\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_13],[\x22少数股东利润\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_14],[\x22汇兑损益\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_15],[\x22坏账计提\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_16],[\x22固定资产\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_17],[\x22当期折旧\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_18],[\x22营业总收入\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_19],[\x22主营业务利润\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_20],[\x22营业利润\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_21],[\x22净利润\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_22],[\x22应收账款\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_23],[\x22财务费用\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_24],[\x22经营性现金流\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_25],[\x22资产总计\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_26],[\x22负债总计\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_27],[\x22所有者权益总计\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_28],[\x22毛利率\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_29],[\x22每股资本公积金\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_30],[\x22每股未分配利润\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_31],[\x22每股收益\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_32],[\x22每股净资产\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_33],[\x22每股经营性现金流\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_34],[\x22扣非净利润涨幅\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_35],[\x22扣非净利润涨速\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_36],[\x22净利润涨幅\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_37],[\x22资产负债率\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_38],[\x22利润同比\x22,JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_F_39]]);return\x20t.has(e)?t.get(e):null},GetSectionReportPeriod:function(e,t){return\x20e>=2e3&&t>=1&&t<=4?{Year:e,Quarter:t}:null}};function\x20JSExecute(e,t){this.AST=e,this.ErrorHandler=new\x20ErrorHandler,this.VarTable=new\x20Map,this.OutVarTable=[],this.Arguments=[],this.ErrorCallback,this.ConstVarTable=new\x20Map([[\x22CLOSE\x22,null],[\x22VOL\x22,null],[\x22OPEN\x22,null],[\x22HIGH\x22,null],[\x22LOW\x22,null],[\x22AMOUNT\x22,null],[\x22C\x22,null],[\x22V\x22,null],[\x22O\x22,null],[\x22H\x22,null],[\x22L\x22,null],[\x22AMO\x22,null],[\x22VOLR\x22,null],[\x22VOLINSTK\x22,null],[\x22ZSTJJ\x22,null],[\x22DATE\x22,null],[\x22YEAR\x22,null],[\x22MONTH\x22,null],[\x22PERIOD\x22,null],[\x22WEEK\x22,null],[\x22TIME\x22,null],[\x22INDEXA\x22,null],[\x22INDEXC\x22,null],[\x22INDEXH\x22,null],[\x22INDEXL\x22,null],[\x22INDEXO\x22,null],[\x22INDEXV\x22,null],[\x22INDEXADV\x22,null],[\x22INDEXDEC\x22,null],[\x22ADVANCE\x22,null],[\x22DECLINE\x22,null],[\x22FROMOPEN\x22,null],[\x22TOTALFZNUM\x22,null],[\x22CURRBARSCOUNT\x22,null],[\x22TOTALBARSCOUNT\x22,null],[\x22ISLASTBAR\x22,null],[\x22BARSTATUS\x22,null],[\x22CAPITAL\x22,null],[\x22TOTALCAPITAL\x22,null],[\x22EXCHANGE\x22,null],[\x22SETCODE\x22,null],[\x22CODE\x22,null],[\x22STKNAME\x22,null],[\x22TQFLAG\x22,null],[\x22HYBLOCK\x22,null],[\x22DYBLOCK\x22,null],[\x22GNBLOCK\x22,null],[\x22DRAWNULL\x22,null]]),this.SymbolData=new\x20JSSymbolData(this.AST,t,this),this.Algorithm=new\x20JSAlgorithm(this.ErrorHandler,this.SymbolData),this.Draw=new\x20JSDraw(this.ErrorHandler,this.SymbolData),this.JobList=[],this.UpdateUICallback=null,this.CallbackParam=null,this.IsSectionMode=!1,t&&(t.Callback&&(this.UpdateUICallback=t.Callback),t.CallbackParam&&(this.CallbackParam=t.CallbackParam),t.Arguments&&(this.Arguments=t.Arguments),t.IsSectionMode&&(this.IsSectionMode=t.IsSectionMode)),this.Execute=function(){for(var\x20e\x20in\x20JSConsole.Complier.Log(\x22[JSExecute::Execute]\x20Load\x20Arguments\x22,this.Arguments),this.Arguments){let\x20t=this.Arguments[e];this.VarTable.set(t.Name,t.Value)}this.RunNextJob()},this.RunNextJob=function(){if(!(this.JobList.length<=0)){JSConsole.Complier.Log(\x22[JSExecute::Execute]\x20JobList\x22,this.JobList);var\x20e=this.JobList.shift();switch(e.ID){case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SYMBOL_DATA:return\x20this.SymbolData.GetSymbolData();case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SYMBOL_PERIOD_DATA:return\x20this.SymbolData.GetSymbolPeriodData(e);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_INDEX_DATA:return\x20this.SymbolData.GetIndexData();case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_LATEST_INDEX_DATA:return\x20this.SymbolData.GetLatestIndexData();case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_INDEX_INCREASE_DATA:return\x20this.SymbolData.GetIndexIncreaseData(e);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SYMBOL_LATEST_DATA:return\x20this.SymbolData.GetLatestData();case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_VOLR_DATA:return\x20this.SymbolData.GetVolRateData(e);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_GROUP_DATA:return\x20this.SymbolData.GetGroupData(e);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_OTHER_SYMBOL_DATA:return\x20this.SymbolData.GetOtherSymbolData(e);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_RELEASE_DATE_DATA:return\x20this.SymbolData.GetCompanyReleaseDate(e.ID);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BALANCE:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_RATE:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_BUY_NET:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_MARGIN_SELL_NET:return\x20this.SymbolData.GetMarginData(e.ID);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS:case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE:return\x20this.SymbolData.GetNewsAnalysisData(e.ID);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_HK_TO_SHSZ:return\x20this.SymbolData.GetHKToSHSZData(e);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SECTION_SF:return\x20this.SymbolData.GetSectionFinanceData(e);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_FINONE:return\x20this.SymbolData.GetFinOne(e);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_FINVALUE:return\x20this.SymbolData.GetFinValue(e);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_FINANCE:return\x20this.SymbolData.GetFinance(e);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_GPJYVALUE:return\x20this.SymbolData.GetGPJYValue(e);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_VARIANT:return\x20this.SymbolData.GetVariantData(e);case\x20JS_EXECUTE_JOB_ID.JOB_CUSTOM_VARIANT_DATA:return\x20this.SymbolData.GetCustomVariantData(e);case\x20JS_EXECUTE_JOB_ID.JOB_CUSTOM_FUNCTION_DATA:return\x20this.SymbolData.GetCustomFunctionData(e);case\x20JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_CUSTOM_API_DATA:return\x20this.SymbolData.DownloadCustomAPIData(e);case\x20JS_EXECUTE_JOB_ID.JOB_EXECUTE_INDEX:return\x20this.SymbolData.CallScriptIndex(e);case\x20JS_EXECUTE_JOB_ID.JOB_RUN_SCRIPT:return\x20this.Run()}}},this.ReadSymbolData=function(e,t){switch(e){case\x22CLOSE\x22:case\x22C\x22:case\x22VOL\x22:case\x22V\x22:case\x22OPEN\x22:case\x22O\x22:case\x22HIGH\x22:case\x22H\x22:case\x22LOW\x22:case\x22L\x22:case\x22AMOUNT\x22:case\x22AMO\x22:case\x22VOLINSTK\x22:case\x22ZSTJJ\x22:return\x20this.SymbolData.GetSymbolCacheData(e);case\x22VOLR\x22:return\x20this.SymbolData.GetVolRateCacheData(t);case\x22INDEXA\x22:case\x22INDEXC\x22:case\x22INDEXH\x22:case\x22INDEXH\x22:case\x22INDEXO\x22:case\x22INDEXV\x22:case\x22INDEXL\x22:case\x22INDEXADV\x22:case\x22INDEXDEC\x22:return\x20this.SymbolData.GetIndexCacheData(e);case\x22CURRBARSCOUNT\x22:return\x20this.SymbolData.GetCurrBarsCount();case\x22TOTALBARSCOUNT\x22:return\x20this.SymbolData.GetTotalBarsCount();case\x22TOTALFZNUM\x22:return\x20this.SymbolData.GetTotalTradeMinuteCount();case\x22ISLASTBAR\x22:return\x20this.SymbolData.GetIsLastBar();case\x22BARSTATUS\x22:return\x20this.SymbolData.GetBarStatus();case\x22TOTALCAPITAL\x22:case\x22CAPITAL\x22:case\x22EXCHANGE\x22:return\x20this.SymbolData.GetStockCacheData({VariantName:e,Node:t});case\x22SETCODE\x22:return\x20this.SymbolData.SETCODE();case\x22CODE\x22:return\x20this.SymbolData.GetSymbol();case\x22STKNAME\x22:return\x20this.SymbolData.GetName();case\x22HYBLOCK\x22:return\x20this.SymbolData.GetIndustry();case\x22DYBLOCK\x22:return\x20this.SymbolData.GetRegion();case\x22GNBLOCK\x22:return\x20this.SymbolData.GetConcept();case\x22TIME\x22:return\x20this.SymbolData.TIME();case\x22DATE\x22:return\x20this.SymbolData.DATE();case\x22YEAR\x22:return\x20this.SymbolData.YEAR();case\x22MONTH\x22:return\x20this.SymbolData.MONTH();case\x22WEEK\x22:return\x20this.SymbolData.WEEK();case\x22PERIOD\x22:return\x20this.SymbolData.PERIOD();case\x22FROMOPEN\x22:return\x20this.SymbolData.GetLatestIndexCacheData(\x22FROMOPEN\x22);case\x22DRAWNULL\x22:return\x20this.SymbolData.GetDrawNull();case\x22ADVANCE\x22:case\x22DECLINE\x22:return\x20this.SymbolData.GetIndexIncreaseCacheData(e,this.SymbolData.Symbol,t);case\x22TQFLAG\x22:return\x20this.SymbolData.Right}},this.ReadCustomVariant=function(e,t){return\x20this.SymbolData.GetStockCacheData({VariantName:e,Node:t})},this.ReadVariable=function(e,t){if(this.ConstVarTable.has(e)){let\x20a=this.ConstVarTable.get(e);return\x20null==a&&(a=this.ReadSymbolData(e,t),this.ConstVarTable.set(e,a)),a}if(g_JSComplierResource.IsCustomVariant(e))return\x20this.ReadCustomVariant(e,t);if(this.VarTable.has(e))return\x20this.VarTable.get(e);if(e.indexOf(\x22#\x22)>0){var\x20a=e.split(\x22#\x22);return\x20this.SymbolData.GetSymbolPeriodCacheData(a[0],a[1])}return\x20this.ThrowUnexpectedNode(t,\x22变量\x22+e+\x22不存在\x22,e),null},this.ReadMemberVariable=function(e){var\x20t=e.Object,a=e.Property;let\x20r;if(!(r=t.Type==Syntax.BinaryExpression||t.Type==Syntax.LogicalExpression?this.VisitBinaryExpression(t):t.Type==Syntax.CallExpression?this.VisitCallExpression(t):this.GetNodeValue(t)))return\x20null;var\x20i=r[a.Name];return\x20i||null},this.SingleDataToArrayData=function(e){let\x20t=this.SymbolData.Data.Data.length,a=[];for(var\x20r=0;r<t;++r)a[r]=e;return\x20a},this.RunAST=function(){for(var\x20e\x20in\x20this.AST||this.ThrowError(),this.AST.Body||this.ThrowError(),this.AST.Body){let\x20u=this.AST.Body[e];if(this.VisitNode(u),u.Type==Syntax.ExpressionStatement&&u.Expression)if(u.Expression.Type==Syntax.AssignmentExpression){if(\x22:\x22==u.Expression.Operator&&u.Expression.Left){let\x20e=u.Expression.Left.Name,a=this.VarTable.get(e);var\x20t=0;a&&\x22object\x22==typeof\x20a&&\x22Object\x22==a.__Type__?t=1e3:this.IsSectionMode||Array.isArray(a)||(a=\x22string\x22==typeof\x20a?this.SingleDataToArrayData(parseFloat(a)):this.SingleDataToArrayData(a)),this.OutVarTable.push({Name:e,Data:a,Type:t})}}else\x20if(u.Expression.Type==Syntax.CallExpression){let\x20r=u.Expression;if(this.Draw.IsDrawFunction(r.Callee.Name)){let\x20e=r.Draw;e.Name=r.Callee.Name,this.OutVarTable.push({Name:e.Name,Draw:e,Type:1})}else{let\x20i=r.Out;a=`__temp_c_${r.Callee.Name}_${e}__`;t=0;Array.isArray(i)||(i=this.SingleDataToArrayData(i)),this.OutVarTable.push({Name:a,Data:i,Type:t,NoneName:!0})}}else\x20if(u.Expression.Type==Syntax.Identifier){let\x20a=u.Expression.Name,r=this.ReadVariable(a,u.Expression);t=0;r&&\x22object\x22==typeof\x20r&&\x22Object\x22==r.__Type__?t=1e3:this.IsSectionMode||Array.isArray(r)||(r=\x22string\x22==typeof\x20r?this.SingleDataToArrayData(parseFloat(r)):this.SingleDataToArrayData(r)),a=\x22__temp_i_\x22+e+\x22__\x22,this.OutVarTable.push({Name:a,Data:r,Type:t,NoneName:!0})}else\x20if(u.Expression.Type==Syntax.Literal){let\x20r=u.Expression.Value;IFrameSplitOperator.IsString(r)&&r.indexOf(\x22$\x22)>0&&(r=this.SymbolData.GetOtherSymolCacheData({Literal:r})),a=\x22__temp_li_\x22+e+\x22__\x22;t=0;this.OutVarTable.push({Name:a,Data:r,Type:t,NoneName:!0})}else\x20if(u.Expression.Type==Syntax.BinaryExpression){var\x20a=\x22__temp_b_\x22+e+\x22__\x22;let\x20r=u.Expression.Out;t=0;Array.isArray(r)||(r=this.SingleDataToArrayData(r)),this.OutVarTable.push({Name:a,Data:r,Type:t,NoneName:!0})}else\x20if(u.Expression.Type==Syntax.LogicalExpression){a=\x22__temp_l_\x22+e+\x22__\x22;let\x20r=u.Expression.Out;t=0;Array.isArray(r)||(r=this.SingleDataToArrayData(r)),this.OutVarTable.push({Name:a,Data:r,Type:t,NoneName:!0})}else\x20if(u.Expression.Type==Syntax.SequenceExpression){let\x20t,a,o,l,D=!1,h=!1,c=!1,C=!1,E=!1,m=!1,A=!0,N=!1,I=!1,S=!1;var\x20r=!1,i=!1;for(var\x20n\x20in\x20u.Expression.Expression){let\x20s=u.Expression.Expression[n];if(s.Type==Syntax.AssignmentExpression&&\x22:\x22==s.Operator&&s.Left){t=s.Left.Name;let\x20e=this.VarTable.get(t);Array.isArray(e)||(e=this.SingleDataToArrayData(e),this.VarTable.set(t,e))}else\x20if(s.Type==Syntax.Identifier){let\x20a=s.Name;if(\x22COLORSTICK\x22===a)D=!0;else\x20if(\x22POINTDOT\x22===a)h=!0;else\x20if(\x22CIRCLEDOT\x22===a)c=!0;else\x20if(\x22DOTLINE\x22===a)I=!0;else\x20if(\x22LINESTICK\x22===a)C=!0;else\x20if(\x22STICK\x22===a)E=!0;else\x20if(\x22VOLSTICK\x22===a)m=!0;else\x20if(\x22DRAWABOVE\x22===a)i=!0;else\x20if(0==a.indexOf(\x22COLOR\x22))o=a;else\x20if(0==a.indexOf(\x22LINETHICK\x22))l=a;else\x20if(0==a.indexOf(\x22NODRAW\x22))A=!1;else\x20if(0==a.indexOf(\x22EXDATA\x22))N=!0;else\x20if(0==a.indexOf(\x22LINEOVERLAY\x22))S=!0;else{t=s.Name;let\x20a=this.ReadVariable(t,s);Array.isArray(a)||(a=this.SingleDataToArrayData(a)),t=\x22__temp_si_\x22+e+\x22__\x22,r=!0,this.VarTable.set(t,a)}}else\x20if(s.Type==Syntax.Literal){let\x20e=this.SingleDataToArrayData(s.Value);t=s.Value.toString(),this.VarTable.set(t,e)}else\x20if(s.Type==Syntax.CallExpression)if(this.Draw.IsDrawFunction(s.Callee.Name))(a=s.Draw).Name=s.Callee.Name;else{let\x20a=s.Out;t=`__temp_sc_${s.Callee.Name}_${e}__`,r=!0,this.VarTable.set(t,a)}else\x20if(s.Type==Syntax.BinaryExpression){t=\x22__temp_sb_\x22+e+\x22__\x22;let\x20a=s.Out;r=!0,this.VarTable.set(t,a)}}if(h&&t){let\x20e=this.VarTable.get(t);Array.isArray(e)||(e=this.SingleDataToArrayData(e));let\x20a={Name:t,Data:e,Radius:2,Type:3};o&&(a.Color=o),l&&(a.LineWidth=l),this.OutVarTable.push(a)}else\x20if(c&&t){let\x20e=this.VarTable.get(t);Array.isArray(e)||(e=this.SingleDataToArrayData(e));let\x20a={Name:t,Data:e,Radius:1.3,Type:3};o&&(a.Color=o),l&&(a.LineWidth=l),this.OutVarTable.push(a)}else\x20if(C&&t){let\x20e={Name:t,Data:this.VarTable.get(t),Type:4};o&&(e.Color=o),l&&(e.LineWidth=l),this.OutVarTable.push(e)}else\x20if(E&&t){let\x20e={Name:t,Data:this.VarTable.get(t),Type:5};o&&(e.Color=o),l&&(e.LineWidth=l),this.OutVarTable.push(e)}else\x20if(m&&t){let\x20e={Name:t,Data:this.VarTable.get(t),Type:6};o&&(e.Color=o),this.OutVarTable.push(e)}else\x20if(t&&o){let\x20e=this.VarTable.get(t);Array.isArray(e)||(e=this.SingleDataToArrayData(e));let\x20a={Name:t,Data:e,Color:o,Type:0};l&&(a.LineWidth=l),0==A&&(a.IsShow=!1),1==N&&(a.IsExData=!0),1==I&&(a.IsDotLine=!0),1==S&&(a.IsOverlayLine=!0),1==r&&(a.NoneName=!0),this.OutVarTable.push(a)}else\x20if(a){var\x20s={Name:a.Name,Draw:a,Type:1};o&&(s.Color=o),1==I&&(s.IsDotLine=!0),l&&(s.LineWidth=l),i&&(s.IsDrawAbove=!0),this.OutVarTable.push(s)}else\x20if(D&&t){let\x20e={Name:t,Data:this.VarTable.get(t),Color:o,Type:2};l&&(e.LineWidth=l),this.OutVarTable.push(e)}else\x20if(t){let\x20e={Name:t,Data:this.VarTable.get(t),Type:0};o&&(e.Color=o),l&&(e.LineWidth=l),0==A&&(e.IsShow=!1),1==N&&(e.IsExData=!0),1==I&&(e.IsDotLine=!0),1==S&&(e.IsOverlayLine=!0),this.OutVarTable.push(e)}}}return\x20JSConsole.Complier.Log(\x22[JSExecute::Run]\x22,this.VarTable),this.OutVarTable},this.Run=function(){try{let\x20e=this.RunAST();JSConsole.Complier.Log(\x22[JSComplier.Run]\x20execute\x20finish\x22,e),this.UpdateUICallback&&(JSConsole.Complier.Log(\x22[JSComplier.Run]\x20invoke\x20UpdateUICallback.\x22),this.CallbackParam&&this.CallbackParam.Job&&this.CallbackParam.Job.ID==JS_EXECUTE_JOB_ID.JOB_EXECUTE_INDEX?this.UpdateUICallback(e,this.CallbackParam,this.SymbolData):(this.CallbackParam&&this.CallbackParam.Self&&\x22ScriptIndexConsole\x22===this.CallbackParam.Self.ClassName&&(this.CallbackParam.JSExecute=this),this.UpdateUICallback(e,this.CallbackParam)))}catch(e){JSConsole.Complier.Log(e),e.Job?(JSConsole.Complier.Log(\x22[JSComplier.Run]\x20download\x20job\x20and\x20reexectue\x22,e.Job),this.JobList.push(e.Job),this.JobList.push({ID:JS_EXECUTE_JOB_ID.JOB_RUN_SCRIPT}),this.Execute()):this.ErrorCallback&&this.ErrorCallback(e,this.CallbackParam)}},this.VisitNode=function(e){switch(e.Type){case\x20Syntax.SequenceExpression:this.VisitSequenceExpression(e);break;case\x20Syntax.ExpressionStatement:this.VisitNode(e.Expression);break;case\x20Syntax.AssignmentExpression:this.VisitAssignmentExpression(e);break;case\x20Syntax.BinaryExpression:case\x20Syntax.LogicalExpression:this.VisitBinaryExpression(e);break;case\x20Syntax.CallExpression:this.VisitCallExpression(e)}},this.VisitSequenceExpression=function(e){for(var\x20t\x20in\x20e.Expression){let\x20a=e.Expression[t];this.VisitNode(a)}},this.VisitCallExpression=function(e){let\x20t=e.Callee.Name,a=[];for(var\x20r\x20in\x20e.Arguments){let\x20t,i=e.Arguments[r];t=i.Type==Syntax.BinaryExpression||i.Type==Syntax.LogicalExpression?this.VisitBinaryExpression(i):i.Type==Syntax.CallExpression?this.VisitCallExpression(i):this.GetNodeValue(i),a.push(t)}if(g_JSComplierResource.IsCustomFunction(t)){var\x20i=this.Algorithm.CallCustomFunction(t,a,this.SymbolData,e);return\x20e.Out=[],e.Draw=null,i&&(i.Out&&(e.Out=i.Out),i.Draw&&(e.Draw=i.Draw)),e.Out}switch(t){case\x22DYNAINFO\x22:e.Out=this.SymbolData.GetLatestCacheData(a[0]);break;case\x22STICKLINE\x22:e.Draw=this.Draw.STICKLINE(a[0],a[1],a[2],a[3],a[4]),e.Out=[];break;case\x22DRAWTEXT\x22:e.Draw=this.Draw.DRAWTEXT(a[0],a[1],a[2]),e.Out=[];break;case\x22DRAWTEXT_FIX\x22:e.Draw=this.Draw.DRAWTEXT_FIX(a[0],a[1],a[2],a[3],a[4]),e.Out=[];break;case\x22SUPERDRAWTEXT\x22:e.Draw=this.Draw.SUPERDRAWTEXT(a[0],a[1],a[2],a[3],a[4]),e.Out=[];break;case\x22DRAWICON\x22:e.Draw=this.Draw.DRAWICON(a[0],a[1],a[2]),e.Out=[];break;case\x22DRAWLINE\x22:e.Draw=this.Draw.DRAWLINE(a[0],a[1],a[2],a[3],a[4]),e.Out=e.Draw.DrawData;break;case\x22DRAWBAND\x22:e.Draw=this.Draw.DRAWBAND(a[0],a[1],a[2],a[3]),e.Out=[];break;case\x22FILLRGN\x22:a.length>=4?e.Draw=this.Draw.FILLRGN2(a):e.Draw=this.Draw.FILLRGN(a[0],a[1],a[2]),e.Out=[];break;case\x22FLOATRGN\x22:e.Draw=this.Draw.FLOATRGN(a),e.Out=[];break;case\x22FILLTOPRGN\x22:e.Draw=this.Draw.FILLBGRGN(1,a),e.Out=[];break;case\x22FILLBOTTOMRGN\x22:e.Draw=this.Draw.FILLBGRGN(0,a),e.Out=[];break;case\x22FILLVERTICALRGN\x22:e.Draw=this.Draw.FILLVERTICALRGN(a),e.Out=[];break;case\x22DRAWKLINE\x22:e.Draw=this.Draw.DRAWKLINE(a[0],a[1],a[2],a[3]),e.Out=[];break;case\x22DRAWKLINE_IF\x22:e.Draw=this.Draw.DRAWKLINE_IF(a[0],a[1],a[2],a[3],a[4]),e.Out=[];break;case\x22PLOYLINE\x22:case\x22POLYLINE\x22:e.Draw=this.Draw.POLYLINE(a[0],a[1]),e.Out=e.Draw.DrawData;break;case\x22DRAWNUMBER\x22:e.Draw=this.Draw.DRAWNUMBER(a[0],a[1],a[2]),e.Out=e.Draw.DrawData.Value;break;case\x22DRAWNUMBER_FIX\x22:e.Draw=this.Draw.DRAWNUMBER_FIX(a[0],a[1],a[2],a[3],a[4]),e.Out=e.Draw.DrawData.Value;break;case\x22DRAWCHANNEL\x22:e.Draw=this.Draw.DRAWCHANNEL(a[0],a[1],a[2],a[3],a[4],a[5],a[6]),e.Out=[];break;case\x22RGB\x22:e.Out=this.Draw.RGB(a[0],a[1],a[2]);break;case\x22RGBA\x22:e.Out=this.Draw.RGBA(a[0],a[1],a[2],a[3]);break;case\x22PARTLINE\x22:e.Draw=this.Draw.PARTLINE(a),e.Out=[];break;case\x22DRAWGBK\x22:e.Draw=this.Draw.DRAWGBK(a[0],a[1],a[2],a[3]),e.Out=[];break;case\x22DRAWGBK2\x22:e.Draw=this.Draw.DRAWGBK2(a[0],a[1],a[2],a[3]),e.Out=[];break;case\x22DRAWTEXT_LINE\x22:e.Draw=this.Draw.DRAWTEXT_LINE(a[0],a[1],a[2],a[3],a[4],a[5],a[6]),e.Out=[];break;case\x22DRAWRECTREL\x22:e.Draw=this.Draw.DRAWRECTREL(a[0],a[1],a[2],a[3],a[4]),e.Out=[];break;case\x22DRAWOVERLAYLINE\x22:e.Draw=this.Draw.DRAWOVERLAYLINE(a[0],a[1],a[2]),e.Out=e.Draw.DrawData.Data;break;case\x22DRAWSL\x22:e.Draw=this.Draw.DRAWSL(a[0],a[1],a[2],a[3],a[4]),e.Out=[];break;case\x22CODELIKE\x22:e.Out=this.SymbolData.CODELIKE(a[0]);break;case\x22NAMELIKE\x22:case\x22NAMEINCLUDE\x22:e.Out=this.SymbolData.NAMELIKE(a[1]);break;case\x22REFDATE\x22:e.Out=this.SymbolData.REFDATE(a[0],a[1]);break;case\x22FINANCE\x22:case\x22FINVALUE\x22:e.Out=this.SymbolData.GetStockCacheData({FunctionName:t,Args:a,ArgCount:1,Node:e});break;case\x22FINONE\x22:case\x22GPJYVALUE\x22:e.Out=this.SymbolData.GetStockCacheData({FunctionName:t,Args:a,ArgCount:3,Node:e});break;case\x22MARGIN\x22:e.Out=this.SymbolData.GetMarginCacheData(a[0],e);break;case\x22HK2SHSZ\x22:e.Out=this.SymbolData.GetHKToSHSZCacheData(a[0],e);break;case\x22NEWS\x22:e.Out=this.SymbolData.GetNewsAnalysisCacheData(a[0],e);break;case\x22UPCOUNT\x22:case\x22DOWNCOUNT\x22:e.Out=this.SymbolData.GetIndexIncreaseCacheData(t,a[0],e);break;case\x22SF\x22:e.Out=this.SymbolData.GetSectionFinanceCacheData(a[0],a[1],a[2],e);break;case\x22LOADAPIDATA\x22:e.Out=this.SymbolData.GetCustomApiData(a);break;case\x22STKINDI\x22:e.Out=this.SymbolData.GetScriptIndexOutData(a,e);break;case\x22CLOSE\x22:case\x22C\x22:case\x22VOL\x22:case\x22V\x22:case\x22OPEN\x22:case\x22O\x22:case\x22HIGH\x22:case\x22H\x22:case\x22LOW\x22:case\x22L\x22:case\x22AMOUNT\x22:case\x22AMO\x22:e.Out=this.SymbolData.GetOtherSymolCacheData({FunctionName:t,Args:a});break;case\x22COVER_C\x22:case\x22COVER_O\x22:case\x22COVER_H\x22:case\x22COVER_L\x22:case\x22COVER_A\x22:case\x22COVER_V\x22:return\x202==a.length?this.SymbolData.GetSymbolPeriodCacheData2(JSComplierHelper.GetConvertValueName(t),a[0],a[1]):this.SymbolData.GetSymbolPeriodCacheData(JSComplierHelper.GetConvertValueName(t),a[0]);default:return\x20this.Algorithm.CallFunction(t,a,e,this.SymbolData)}return\x20e.Out},this.VisitAssignmentExpression=function(e){let\x20t=e.Left;t.Type!=Syntax.Identifier&&this.ThrowUnexpectedNode(e);let\x20a=t.Name,r=e.Right,i=null;if(r.Type==Syntax.BinaryExpression||r.Type==Syntax.LogicalExpression)i=this.VisitBinaryExpression(r);else\x20if(r.Type==Syntax.CallExpression)i=this.VisitCallExpression(r);else\x20if(r.Type==Syntax.Literal)i=r.Value,IFrameSplitOperator.IsString(i)&&r.Value.indexOf(\x22$\x22)>0&&(i=this.SymbolData.GetOtherSymolCacheData({Literal:i}));else\x20if(r.Type==Syntax.Identifier)i=this.ReadVariable(r.Name,r);else\x20if(r.Type==Syntax.MemberExpression)i=this.ReadMemberVariable(r);else\x20if(r.Type==Syntax.UnaryExpression)if(\x22-\x22==r.Operator){var\x20n=this.GetNodeValue(r.Argument);i=this.Algorithm.Subtract(0,n)}else\x20i=r.Argument.Value;JS_EXECUTE_DEBUG_LOG&&JSConsole.Complier.Log(\x22[JSExecute::VisitAssignmentExpression]\x22,a,\x22\x20=\x20\x22,i),this.VarTable.set(a,i)},this.VisitBinaryExpression=function(e){let\x20t=[];t.push(e);let\x20a=null;for(;0!=t.length;)if((a=t[t.length-1]).Left&&e!=a.Left&&e!=a.Right)t.push(a.Left);else\x20if(a.Right&&e!=a.Right)t.push(a.Right);else{let\x20r=t.pop();if(r.Type==Syntax.BinaryExpression){let\x20e=this.GetNodeValue(r.Left),t=this.GetNodeValue(r.Right);switch(JS_EXECUTE_DEBUG_LOG&&JSConsole.Complier.Log(\x22[JSExecute::VisitBinaryExpression]\x20BinaryExpression\x22,r,e,t),r.Out=null,r.Operator){case\x22-\x22:r.Out=this.Algorithm.Subtract(e,t);break;case\x22*\x22:r.Out=this.Algorithm.Multiply(e,t);break;case\x22/\x22:r.Out=this.Algorithm.Divide(e,t);break;case\x22+\x22:r.Out=this.Algorithm.Add(e,t);break;case\x22>\x22:r.Out=this.Algorithm.GT(e,t);break;case\x22>=\x22:r.Out=this.Algorithm.GTE(e,t);break;case\x22<\x22:r.Out=this.Algorithm.LT(e,t);break;case\x22<=\x22:r.Out=this.Algorithm.LTE(e,t);break;case\x22==\x22:case\x22=\x22:r.Out=this.Algorithm.EQ(e,t);break;case\x22!=\x22:case\x22<>\x22:r.Out=this.Algorithm.NEQ(e,t)}JS_EXECUTE_DEBUG_LOG&&JSConsole.Complier.Log(\x22[JSExecute::VisitBinaryExpression]\x20BinaryExpression\x22,r)}else\x20if(r.Type==Syntax.LogicalExpression){let\x20e=this.GetNodeValue(r.Left),t=this.GetNodeValue(r.Right);switch(JS_EXECUTE_DEBUG_LOG&&JSConsole.Complier.Log(\x22[JSExecute::VisitBinaryExpression]\x20LogicalExpression\x22,r,e,t),r.Out=null,r.Operator){case\x22&&\x22:case\x22AND\x22:r.Out=this.Algorithm.And(e,t);break;case\x22||\x22:case\x22OR\x22:r.Out=this.Algorithm.Or(e,t)}JS_EXECUTE_DEBUG_LOG&&JSConsole.Complier.Log(\x22[JSExecute::VisitBinaryExpression]\x20LogicalExpression\x22,r)}e=a}return\x20e.Out},this.GetNodeValue=function(e){switch(e.Type){case\x20Syntax.Literal:return\x20e.Value;case\x20Syntax.UnaryExpression:if(\x22-\x22==e.Operator){let\x20t=this.GetNodeValue(e.Argument);return\x20this.Algorithm.Subtract(0,t)}return\x20e.Argument.Value;case\x20Syntax.Identifier:return\x20this.ReadVariable(e.Name,e);case\x20Syntax.BinaryExpression:case\x20Syntax.LogicalExpression:return\x20e.Out;case\x20Syntax.CallExpression:return\x20this.VisitCallExpression(e);default:this.ThrowUnexpectedNode(e)}},this.ThrowUnexpectedNode=function(e,t,a){let\x20r=e.Marker,i=t||\x22执行异常\x22;return\x20this.ErrorHandler.ThrowError(r.Index,r.Line,r.Column,i,a)},this.ThrowDownloadSF=function(e,t,a){let\x20r=e.Marker,i=a;return\x20this.ErrorHandler.ThrowDownloadJob(r.Index,r.Line,r.Column,i,t)},this.ThrowError=function(){}}function\x20JSExplainer(e,t){this.AST=e,this.ErrorHandler=new\x20ErrorHandler,this.ErrorCallback,this.UpdateUICallback,this.CallbackParam,this.JobList=[],this.VarTable=new\x20Map,this.OutVarTable=[],this.ConstVarTable=new\x20Map([[\x22CLOSE\x22,\x22收盘价\x22],[\x22VOL\x22,\x22成交量\x22],[\x22OPEN\x22,\x22开盘价\x22],[\x22HIGH\x22,\x22最高价\x22],[\x22LOW\x22,\x22最低价\x22],[\x22AMOUNT\x22,\x22成交量\x22],[\x22C\x22,\x22收盘价\x22],[\x22V\x22,\x22成交量\x22],[\x22O\x22,\x22开盘价\x22],[\x22H\x22,\x22最高价\x22],[\x22L\x22,\x22最低价\x22],[\x22AMO\x22,\x22成交量\x22],[\x22VOLR\x22,\x22量比\x22],[\x22VOLINSTK\x22,\x22持仓量\x22],[\x22ZSTJJ\x22,\x22均价\x22],[\x22DATE\x22,\x22日期\x22],[\x22YEAR\x22,\x22年份\x22],[\x22MONTH\x22,\x22月份\x22],[\x22PERIOD\x22,\x22周期\x22],[\x22WEEK\x22,\x22星期\x22],[\x22TIME\x22,\x22时间\x22],[\x22INDEXA\x22,\x22大盘成交额\x22],[\x22INDEXC\x22,\x22大盘收盘价\x22],[\x22INDEXH\x22,\x22大盘最高价\x22],[\x22INDEXL\x22,\x22大盘最低价\x22],[\x22INDEXO\x22,\x22大盘开盘价\x22],[\x22INDEXV\x22,\x22大盘成交量\x22],[\x22INDEXADV\x22,\x22大盘上涨家数\x22],[\x22INDEXDEC\x22,\x22´大盘下跌家数\x22],[\x22ADVANCE\x22,\x22上涨家数\x22],[\x22DECLINE\x22,\x22下跌家数\x22],[\x22FROMOPEN\x22,\x22当前离开盘分钟数\x22],[\x22TOTALFZNUM\x22,\x22总分钟数\x22],[\x22CURRBARSCOUNT\x22,\x22到最后交易的周期\x22],[\x22TOTALBARSCOUNT\x22,\x22总的周期数\x22],[\x22ISLASTBAR\x22,\x22是否是最后一个周期\x22],[\x22BARSTATUS\x22,\x22数据位置状态\x22],[\x22CAPITAL\x22,\x22当前流通股本(手)\x22],[\x22TOTALCAPITAL\x22,\x22当前总股本(手)\x22],[\x22EXCHANGE\x22,\x22换手率\x22],[\x22SETCODE\x22,\x22市场类型\x22],[\x22CODE\x22,\x22品种代码\x22],[\x22STKNAME\x22,\x22品种名称\x22],[\x22TQFLAG\x22,\x22当前复权状态\x22],[\x22HYBLOCK\x22,\x22所属行业(字串)\x22],[\x22DYBLOCK\x22,\x22所属地域(字串)\x22],[\x22GNBLOCK\x22,\x22所属概念(字串)\x22],[\x22DRAWNULL\x22,\x22无效数据\x22]]),t&&(t.Callback&&(this.UpdateUICallback=t.Callback),t.CallbackParam&&(this.CallbackParam=t.CallbackParam),t.Arguments&&(this.Arguments=t.Arguments)),this.Run=function(){try{let\x20e=this.RunAST();JSConsole.Complier.Log(\x22[JSExplainer.Run]\x20explain\x20finish\x22,e),this.UpdateUICallback&&(JSConsole.Complier.Log(\x22[JSExplainer.Run]\x20invoke\x20UpdateUICallback.\x22),this.UpdateUICallback(e))}catch(e){JSConsole.Complier.Log(\x22[JSExplainer.Run]\x20throw\x20error\x20\x22,e),this.ErrorCallback&&this.ErrorCallback(e,this.OutVarTable)}},this.RunAST=function(){for(var\x20e\x20in\x20this.AST||this.ThrowError(),this.AST.Body||this.ThrowError(),this.AST.Body){let\x20o=this.AST.Body[e];if(this.VisitNode(o),o.Type==Syntax.ExpressionStatement&&o.Expression)if(o.Expression.Type==Syntax.AssignmentExpression){if(\x22:\x22==o.Expression.Operator&&o.Expression.Left){let\x20e=o.Expression.Left.Name,t=`输出${e}:\x20${this.VarTable.get(e)}`;this.OutVarTable.push({Name:e,Data:t,Type:0})}else\x20if(\x22:=\x22==o.Expression.Operator&&o.Expression.Left){let\x20e=o.Expression.Left.Name,t=`赋值${e}:\x20${this.VarTable.get(e)}`;this.OutVarTable.push({Name:e,Data:t,Type:0,IsOut:!1})}}else\x20if(o.Expression.Type==Syntax.CallExpression){let\x20r=o.Expression;if(this.IsDrawFunction(r.Callee.Name)){let\x20e=r.Out;var\x20t=r.Callee.Name;this.OutVarTable.push({Name:t,Draw:`输出:\x20${e}`,Type:1})}else{let\x20t=r.Out;a=`__temp_c_${r.Callee.Name}_${e}__`,this.OutVarTable.push({Name:a,Data:`输出:\x20${t}`,Type:0,NoneName:!0})}}else\x20if(o.Expression.Type==Syntax.Identifier){let\x20t=o.Expression.Name,a=this.ReadVariable(t,o.Expression);t=\x22__temp_i_\x22+e+\x22__\x22,this.OutVarTable.push({Name:t,Data:`输出:\x20${a}`,Type:0,NoneName:!0})}else\x20if(o.Expression.Type==Syntax.Literal){let\x20t=o.Expression.Value;IFrameSplitOperator.IsString(t)&&t.indexOf(\x22$\x22)>0&&(t=this.GetOtherSymbolExplain({Literal:t},o)),a=\x22__temp_li_\x22+e+\x22__\x22;this.OutVarTable.push({Name:a,Data:`输出:\x20${t}`,Type:0,NoneName:!0})}else\x20if(o.Expression.Type==Syntax.BinaryExpression){var\x20a=\x22__temp_b_\x22+e+\x22__\x22;let\x20t=o.Expression.Out;this.OutVarTable.push({Name:a,Data:`输出:\x20${t}`,Type:0,NoneName:!0})}else\x20if(o.Expression.Type==Syntax.LogicalExpression){a=\x22__temp_l_\x22+e+\x22__\x22;let\x20t=o.Expression.Out;this.OutVarTable.push({Name:a,Data:`输出:\x20${t}`,Type:0,NoneName:!0})}else\x20if(o.Expression.Type==Syntax.SequenceExpression){let\x20t,a,l,D,h,c=!1,C=!1,E=!1,m=!1,A=!1,N=!1,I=!0,S=!1,f=!1,O=!1;var\x20r,i=!1,n=!1;for(var\x20s\x20in\x20o.Expression.Expression){let\x20r=o.Expression.Expression[s];if(r.Type==Syntax.AssignmentExpression&&\x22:\x22==r.Operator&&r.Left){t=r.Left.Name;let\x20e=this.VarTable.get(t);this.VarTable.set(t,e)}else\x20if(r.Type==Syntax.Identifier){let\x20a=r.Name;if(\x22COLORSTICK\x22===a)c=!0;else\x20if(\x22POINTDOT\x22===a)C=!0;else\x20if(\x22CIRCLEDOT\x22===a)E=!0;else\x20if(\x22DOTLINE\x22===a)f=!0;else\x20if(\x22LINESTICK\x22===a)m=!0;else\x20if(\x22STICK\x22===a)A=!0;else\x20if(\x22VOLSTICK\x22===a)N=!0;else\x20if(\x22DRAWABOVE\x22===a)n=!0;else\x20if(0==a.indexOf(\x22COLOR\x22))D=a;else\x20if(0==a.indexOf(\x22LINETHICK\x22))h=a;else\x20if(0==a.indexOf(\x22NODRAW\x22))I=!1;else\x20if(0==a.indexOf(\x22EXDATA\x22))S=!0;else\x20if(0==a.indexOf(\x22LINEOVERLAY\x22))O=!0;else{t=r.Name;let\x20a=this.ReadVariable(t,r);t=\x22__temp_si_\x22+e+\x22__\x22,i=!0,this.VarTable.set(t,a)}}else\x20if(r.Type==Syntax.Literal){let\x20e=r.Value;t=r.Value.toString(),i=!0,this.VarTable.set(t,e)}else\x20if(r.Type==Syntax.CallExpression)if(this.IsDrawFunction(r.Callee.Name))l=r.Out,a=r.Callee.Name;else{let\x20a=r.Out;t=`__temp_sc_${r.Callee.Name}_${e}__`,i=!0,this.VarTable.set(t,a)}else\x20if(r.Type==Syntax.BinaryExpression){t=\x22__temp_sb_\x22+e+\x22__\x22;let\x20a=r.Out;i=!0,this.VarTable.set(t,a)}}if(r=l?`输出:\x20${l}`:i?`输出:\x20${this.VarTable.get(t)}`:`输出${t}:\x20${this.VarTable.get(t)}`,D&&(r+=`,颜色${this.GetColorExplain(D)}`),h&&(r+=`,线段粗细${this.GetLineWidthExplain(h)}`),0==I&&(r+=\x22,不显示\x22),1==f&&(r+=\x22,画虚线\x22),1==n&&(r+=\x22,显示在位置之上\x22),C&&t){let\x20e={Name:t,Data:r+=\x22,画小圆点线\x22,Radius:2,Type:3};this.OutVarTable.push(e)}else\x20if(E&&t){let\x20e={Name:t,Data:r+=\x22,画小圆圈线\x22,Radius:1.3,Type:3};this.OutVarTable.push(e)}else\x20if(m&&t){let\x20e={Name:t,Data:r+=\x22,画出柱状线和指标线\x22,Type:4};this.OutVarTable.push(e)}else\x20if(A&&t){let\x20e={Name:t,Data:r+=\x22,画柱状线\x22,Type:5};this.OutVarTable.push(e)}else\x20if(N&&t){let\x20e={Name:t,Data:r+=\x22,画成交量柱状线\x22,Type:6};this.OutVarTable.push(e)}else\x20if(t&&D){let\x20e={Name:t,Data:r,Color:D,Type:0};this.OutVarTable.push(e)}else\x20if(l){var\x20u={Name:a,Data:r,Type:1};this.OutVarTable.push(u)}else\x20if(c&&t){let\x20e={Name:t,Data:r+=\x22,画彩色柱状线\x22,Color:D,Type:2};this.OutVarTable.push(e)}else\x20if(t){let\x20e={Name:t,Data:r,Type:0};this.OutVarTable.push(e)}}}return\x20JSConsole.Complier.Log(\x22[JSExplainer::Run]\x22,this.VarTable),this.OutVarTable},this.VisitNode=function(e){switch(e.Type){case\x20Syntax.SequenceExpression:this.VisitSequenceExpression(e);break;case\x20Syntax.ExpressionStatement:this.VisitNode(e.Expression);break;case\x20Syntax.AssignmentExpression:this.VisitAssignmentExpression(e);break;case\x20Syntax.BinaryExpression:case\x20Syntax.LogicalExpression:this.VisitBinaryExpression(e);break;case\x20Syntax.CallExpression:this.VisitCallExpression(e)}},this.VisitSequenceExpression=function(e){for(var\x20t\x20in\x20e.Expression){let\x20a=e.Expression[t];this.VisitNode(a)}},this.VisitCallExpression=function(e){let\x20t=e.Callee.Name,a=[];for(var\x20r\x20in\x20e.Arguments){let\x20t,i=e.Arguments[r];t=i.Type==Syntax.BinaryExpression||i.Type==Syntax.LogicalExpression?this.VisitBinaryExpression(i):i.Type==Syntax.CallExpression?this.VisitCallExpression(i):this.GetNodeValue(i),a.push(t)}if(JSConsole.Complier.Log(\x22[JSExplainer::VisitCallExpression]\x22,t,\x22(\x22,a.toString(),\x22)\x22),g_JSComplierResource.IsCustomFunction(t)){var\x20i=this.Algorithm.CallCustomFunction(t,a,this.SymbolData,e);return\x20e.Out=[],e.Draw=null,i&&(i.Out&&(e.Out=i.Out),i.Draw&&(e.Draw=i.Draw)),e.Out}return\x20e.Out=this.CallFunctionExplain(t,a,e),e.Out},this.CallFunctionExplain=function(e,t,a){switch(e){case\x22REF\x22:return`${t[1]}日前的${t[0]}`;case\x22REFX\x22:return`${t[1]}日后的${t[0]}`;case\x22REFV\x22:return`${t[1]}日前的(未作平滑处理)${t[0]}`;case\x22REFXV\x22:return`${t[1]}日后的(未作平滑处理)${t[0]}`;case\x22REFDATE\x22:return`${t[1]}日${t[0]}`;case\x22COUNT\x22:return`统计${t[1]}日中满足${t[0]}的天数`;case\x22BARSLASTCOUNT\x22:return`条件${t[0]}连续成立次数`;case\x22BARSCOUNT\x22:return`${t[0]}有效数据周期数`;case\x22BARSLAST\x22:return`上次${t[0]}不为0距今天数`;case\x22BARSNEXT\x22:return`下次${t[0]}不为0距今天数`;case\x22BARSSINCEN\x22:return`在${t[1]}周期内首次${t[0]}距今天数`;case\x22BARSSINCE\x22:return`首次${t[0]}距今天数`;case\x22HHV\x22:return`${t[1]}日内${t[0]}的最高值`;case\x22LLV\x22:return`${t[1]}日内${t[0]}的最低值`;case\x22HHVBARS\x22:return\x200==arg[1]?`历史${t[0]}新高距今天数`:`${t[1]}日内${t[0]}新高距今天数`;case\x22LLVBARS\x22:return\x200==arg[1]?`历史${t[0]}新低距今天数`:`${t[1]}日内${t[0]}新低距今天数`;case\x22HOD\x22:return`${t[1]}日内${t[0]}的高值名次`;case\x22LOD\x22:return`${t[1]}日内${t[0]}的低值名次`;case\x22REVERSE\x22:return`${t[0]}的相反数`;case\x22CALCSTOCKINDEX\x22:return`引用${t[0]}的${t[1]}指标第${t[2]}个输出值`;case\x22FILTER\x22:return`${t[0]}的${t[1]}日过滤`;case\x22FILTERX\x22:return`${t[0]}的${t[1]}日反向过滤`;case\x22SUMBARS\x22:return`${t[0]}累加至${t[1]}的天数`;case\x22MA\x22:return`${t[0]}的${t[1]}日简单移动平均`;case\x22SMA\x22:return`${t[0]}的${t[1]}日[${t[2]}日权重]移动平均`;case\x22MEMA\x22:return`${t[0]}的${t[1]}日平滑移动平均`;case\x22EMA\x22:case\x22EXPMA\x22:return`${t[0]}的${t[1]}日指数移动平均`;case\x22EXPMEMA\x22:return`${t[0]}的${t[1]}日指数平滑移动平均`;case\x22WMA\x22:return`${t[0]}的${t[1]}日加权移动平均`;case\x22DMA\x22:return`以${t[1]}为权重${t[0]}的动态移动平均`;case\x22XMA\x22:return`${t[0]}的${t[1]}日偏移移动平均`;case\x22RANGE\x22:return`${t[0]}位于${t[1]}和${t[2]}之间`;case\x22CONST\x22:return`${t[0]}的最后一日值`;case\x22TOPRANGE\x22:return`当前值是近${t[0]}周期的最大值`;case\x22LOWRANGE\x22:return`当前值是近${t[0]}周期的最小值`;case\x22FINDHIGH\x22:return`${t[0]}在${t[1]}日前的${t[2]}天内第${t[3]}个最高价`;case\x22FINDHIGHBARS\x22:return`${t[0]}在${t[1]}日前的${t[2]}天内第${t[3]}个最高价到当前周期的周期数`;case\x22FINDLOW\x22:return`${t[0]}在${t[1]}日前的${t[2]}天内第${t[3]}个最低价`;case\x22FINDLOWBARS\x22:return`${t[0]}在${t[1]}日前的${t[2]}天内第${t[3]}个最低价到当前周期的周期数`;case\x22SUM\x22:return`${t[0]}${t[1]}日累加`;case\x22MULAR\x22:return`${t[0]}和${t[1]}日累乘`;case\x22AMA\x22:return`以${t[1]}为权重${t[0]}的自适应均线`;case\x22TMA\x22:return`${t[0]}的${t[1]}日[${t[2]}日权重]移动平均`;case\x22CROSS\x22:return`${t[0]}上穿${t[1]}`;case\x22LONGCROSS\x22:return`${t[0]}小于${t[1]}保持${t[2]}个交易日后交叉上穿`;case\x22UPNDAY\x22:return`最近${t[1]}日${t[0]}连涨`;case\x22DOWNNDAY\x22:return`最近${t[1]}日${t[0]}连跌`;case\x22NDAY\x22:return`最近${t[2]}日${t[0]}一直大于${t[1]}`;case\x22EXIST\x22:return`最近${t[1]}日存在${t[0]}`;case\x22EXISTR\x22:return`从前${t[1]}日到前${t[2]}日存在${t[0]}`;case\x22EVERY\x22:return`最近${t[1]}日一直存在${t[0]}`;case\x22LAST\x22:return`从前${t[1]}日到前${t[2]}日持续${t[0]}`;case\x22NOT\x22:return`${t[0]}取反`;case\x22IF\x22:case\x22IFF\x22:case\x22IFN\x22:return`如果${t[0]},返回${t[1]},否则返回${t[2]}`;case\x22MAX\x22:return`${t[0]}和${t[1]}的较大值`;case\x22MIN\x22:return`${t[0]}和${t[1]}的较小值`;case\x22ACOS\x22:return`${t[0]}的反余弦`;case\x22ASIN\x22:return`${t[0]}的反正弦`;case\x22ATAN\x22:return`${t[0]}的反正切`;case\x22COS\x22:return`${t[0]}的余弦`;case\x22SIN\x22:return`${t[0]}的正弦`;case\x22TAN\x22:return`${t[0]}的正切`;case\x22EXP\x22:return`${t[0]}的指数`;case\x22LN\x22:return`${t[0]}的自然对数`;case\x22LOG\x22:return`${t[0]}的对数`;case\x22SQRT\x22:return`${t[0]}的开方`;case\x22ABS\x22:return`${t[0]}的绝对值`;case\x22POW\x22:return`${t[0]}的${t[1]}乘幂`;case\x22CEILING\x22:return`${t[0]}的向上舍入`;case\x22FLOOR\x22:return`${t[0]}的向下舍入`;case\x22INTPART\x22:return`${t[0]}的整数部分`;case\x22BETWEEN\x22:return`${t[0]}位于${t[1]}和${t[2]}之间`;case\x22FRACPART\x22:return`${t[0]}的小数部分`;case\x22ROUND\x22:case\x22ROUND2\x22:return`对${t[0]}(进行)四舍五入`;case\x22SIGN\x22:return`${t[0]}的符号`;case\x22MOD\x22:return`${t[0]}关于${t[1]}的模`;case\x22RAND\x22:return\x22随机正整数\x22;case\x22AVEDEV\x22:return`${t[0]}的${t[1]}日平均绝对偏差`;case\x22DEVSQ\x22:return`${t[0]}的${t[1]}日数据偏差平方和`;case\x22FORCAST\x22:return`${t[0]}的${t[1]}日线性回归预测值`;case\x22SLOPE\x22:return`${t[0]}的${t[1]}日线性回归斜率`;case\x22STD\x22:return`${t[0]}的${t[1]}日估算标准差`;case\x22STDP\x22:return`${t[0]}的${t[1]}日总体标准差`;case\x22STDDEV\x22:return`${t[0]}的${t[1]}日标准偏差`;case\x22VAR\x22:return`${t[0]}的${t[1]}日估算样本方差`;case\x22VARP\x22:return`${t[0]}的${t[1]}日总体样本方差`;case\x22COVAR\x22:return`${t[0]}和${t[1]}的${t[2]}周期的协方差`;case\x22RELATE\x22:return`${t[0]}和${t[1]}的${t[0]}周期的相关系数`;case\x22BETA\x22:return\x22β(Beta)系数\x22;case\x22BETAEX\x22:return`${t[0]}和${t[1]}的${t[2]}周期的相关放大系数`;case\x22COST\x22:return`获利盘为${t[0]}%的成本分布`;case\x22WINNER\x22:return`以${t[0]}计算的获利盘比例`;case\x22LWINNER\x22:return`最近${t[0]}日那部分成本以${t[1]}价格卖出的获利盘比例`;case\x22PWINNER\x22:return`${t[0]}日前那部分成本以${t[1]}价格卖出的获利盘比例`;case\x22COSTEX\x22:return`位于价格${t[0]}和${t[1]}间的成本`;case\x22PPART\x22:return`${t[0]}日前那部分成本占总成本的比例`;case\x22PEAK\x22:case\x22PEAKBARS\x22:case\x22ZIG\x22:case\x22ZIGA\x22:case\x22TROUGH\x22:case\x22TROUGHBARS\x22:return\x20this.GetZIGExplain(e,t);case\x22SAR\x22:return`步长为${t[1]}极限值为${t[0]}的${t[2]}日抛物转向`;case\x22SARTURN\x22:return`步长为${t[1]}极限值为${t[0]}的${t[2]}日抛物转向点`;case\x22FINANCE\x22:return\x20this.GetFinanceExplain(t);case\x22DYNAINFO\x22:return\x20this.GetDynainfoExplain(t);case\x22CLOSE\x22:case\x22C\x22:case\x22VOL\x22:case\x22V\x22:case\x22OPEN\x22:case\x22O\x22:case\x22HIGH\x22:case\x22H\x22:case\x22LOW\x22:case\x22L\x22:case\x22AMOUNT\x22:case\x22AMO\x22:return\x20this.GetOtherSymbolExplain({FunctionName:e,Args:t},a);case\x22PLOYLINE\x22:return`当满足条件${t[0]}时以${t[1]}位置为顶点画折线连接`;case\x22DRAWLINE\x22:return`当满足条件${t[0]}时,在${t[1]}位置画直线起点，当满足条件${t[2]}时,在${t[3]}位置画直线终点,${t[4]}表示是否延长`;case\x22DRAWSL\x22:return`当满足条件${t[0]}时,在${t[1]}位置画斜线线性回归,${t[2]}斜率,${t[3]}长度,${t[4]}方向`;case\x22DRAWKLINE\x22:return\x22K线\x22;case\x22DRAWICON\x22:return`当满足条件${t[0]}时,在${t[1]}位置画${t[2]}号图标`;case\x22DRAWTEXT\x22:return`当满足条件${t[0]}时,在${t[1]}位置书写文字`;case\x22DRAWTEXT_FIX\x22:return`当满足条件${t[0]}时,在横轴${t[1]}纵轴${t[2]}位置书写文字`;case\x22DRAWNUMBER\x22:return`当满足条件${t[0]}时,在${t[1]}位置书写数字`;case\x22DRAWNUMBER_FIX\x22:return`当满足条件${t[0]}时,在横轴${t[1]}纵轴${t[2]}位置书写数字`;case\x22RGB\x22:return`自定色[${t[0]},${t[1]},${t[2]}]`;case\x22DRAWBAND\x22:return\x22画带状线\x22}},this.GetDynainfoExplain=function(e){const\x20t=new\x20Map([[3,\x22前收盘价\x22],[4,\x22开盘价\x22],[5,\x22最高价\x22],[6,\x22最低价\x22],[7,\x22现价\x22],[8,\x22总量\x22],[9,\x22现量\x22],[10,\x22总金额\x22],[11,\x22均价\x22],[12,\x22日涨跌\x22],[13,\x22振幅\x22],[14,\x22涨幅\x22],[15,\x22开盘时的成交金额\x22],[16,\x22前5日每分钟均量\x22],[17,\x22量比\x22],[18,\x22上涨家数\x22],[19,\x22下跌家数\x22]]);var\x20a=e[0];return\x20t.has(a)?t.get(a):`即时行情[${a}]`},this.GetFinanceExplain=function(e){const\x20t=new\x20Map([[1,\x22总股本\x22],[2,\x22市场类型\x22],[3,\x22沪深品种类型\x22],[4,\x22沪深行业代码\x22],[5,\x22B股\x22],[6,\x22H股\x22],[7,\x22流通股本[股]\x22],[8,\x22股东人数[户]\x22],[9,\x22资产负债率%\x22],[10,\x22总资产\x22],[11,\x22流动资产\x22],[12,\x22固定资产\x22],[13,\x22无形资产\x22],[15,\x22流动负债\x22],[16,\x22少数股东权益\x22]]);var\x20a=e[0];return\x20t.has(a)?t.get(a):`财务数据[${a}]`},this.GetZIGExplain=function(e,t){var\x20a=t[0];switch(0==a?a=\x22开盘价\x22:1==a?a=\x22最高价\x22:2==a?a=\x22最低价\x22:3==a&&(a=\x22收盘价\x22),e){case\x22PEAK\x22:return`${a}的${t[1]}%之字转向的前${t[2]}个波峰值`;case\x22PEAKBARS\x22:return`${a}的${t[1]}5%之字转向的前${t[2]}个波峰位置`;case\x22ZIG\x22:return`${a}的${t[1]}的之字转向`;case\x22ZIGA\x22:return`${a}变化${t[1]}的之字转向`;case\x22TROUGH\x22:return`${a}的${t[1]}%之字转向的前${t[2]}个波谷值`;case\x22TROUGHBARS\x22:return`${a}的${t[1]}%之字转向的前${t[2]}个波谷位置`}},this.GetColorExplain=function(e){const\x20t=new\x20Map([[\x22COLORBLACK\x22,\x22黑色\x22],[\x22COLORBLUE\x22,\x22蓝色\x22],[\x22COLORGREEN\x22,\x22绿色\x22],[\x22COLORCYAN\x22,\x22青色\x22],[\x22COLORRED\x22,\x22红色\x22],[\x22COLORMAGENTA\x22,\x22洋红色\x22],[\x22COLORBROWN\x22,\x22棕色\x22],[\x22COLORLIGRAY\x22,\x22淡灰色\x22],[\x22COLORGRAY\x22,\x22深灰色\x22],[\x22COLORLIBLUE\x22,\x22淡蓝色\x22],[\x22COLORLIGREEN\x22,\x22淡绿色\x22],[\x22COLORLICYAN\x22,\x22淡青色\x22],[\x22COLORLIRED\x22,\x22淡红色\x22],[\x22COLORLIMAGENTA\x22,\x22淡洋红色\x22],[\x22COLORWHITE\x22,\x22白色\x22],[\x22COLORYELLOW\x22,\x22黄色\x22]]);return\x20t.has(e)?t.get(e):0==e.indexOf(\x22COLOR\x22)?\x22#\x22+e.substr(5):\x22rgb(30,144,255)\x22},this.GetLineWidthExplain=function(e){var\x20t=parseInt(e.replace(\x22LINETHICK\x22,\x22\x22));return\x20IFrameSplitOperator.IsPlusNumber(t)?t:1},this.SymbolPeriodExplain=function(e,t){const\x20a=new\x20Map([[\x22CLOSE\x22,\x22收盘价\x22],[\x22C\x22,\x22收盘价\x22],[\x22VOL\x22,\x22成交量\x22],[\x22V\x22,\x22成交量\x22],[\x22OPEN\x22,\x22开盘价\x22],[\x22O\x22,\x22开盘价\x22],[\x22HIGH\x22,\x22最高价\x22],[\x22H\x22,\x22最高价\x22],[\x22LOW\x22,\x22最低价\x22],[\x22L\x22,\x22最低价\x22],[\x22AMOUNT\x22,\x22成交金额\x22],[\x22AMO\x22,\x22成交金额\x22],[\x22VOLINSTK\x22,\x22持仓量\x22]]),r=new\x20Map([[\x22MIN1\x22,\x221分钟\x22],[\x22MIN5\x22,\x225分钟\x22],[\x22MIN15\x22,\x2215分钟\x22],[\x22MIN30\x22,\x2230分钟\x22],[\x22MIN60\x22,\x2260分钟\x22],[\x22DAY\x22,\x22日\x22],[\x22WEEK\x22,\x22周\x22],[\x22MONTH\x22,\x22月\x22],[\x22SEASON\x22,\x22季\x22],[\x22YEAR\x22,\x22年\x22]]);var\x20i=e;a.has(e)&&(i=a.get(e));var\x20n=t;return\x20r.has(t)&&(n=r.get(t)),`${i}[取${n}数据]`},this.GetOtherSymbolExplain=function(e,t){const\x20a=new\x20Map([[\x22CLOSE\x22,\x22收盘价\x22],[\x22C\x22,\x22收盘价\x22],[\x22VOL\x22,\x22成交量\x22],[\x22V\x22,\x22成交量\x22],[\x22OPEN\x22,\x22开盘价\x22],[\x22O\x22,\x22开盘价\x22],[\x22HIGH\x22,\x22最高价\x22],[\x22H\x22,\x22最高价\x22],[\x22LOW\x22,\x22最低价\x22],[\x22L\x22,\x22最低价\x22],[\x22AMOUNT\x22,\x22成交金额\x22],[\x22AMO\x22,\x22成交金额\x22],[\x22VOLINSTK\x22,\x22持仓量\x22]]);if(e.FunctionName){var\x20r=e.Args,i=a.get(e.FunctionName);return`[${r[0]}]${i}`}if(e.Literal){r=e.Literal.toUpperCase().split(\x22$\x22);return\x20a.has(r[1])?`[${r[0]}]${i=a.get(r[1])}`:\x22\x22}},this.IsDrawFunction=function(e){return!!new\x20Set([\x22STICKLINE\x22,\x22DRAWTEXT\x22,\x22SUPERDRAWTEXT\x22,\x22DRAWLINE\x22,\x22DRAWBAND\x22,\x22DRAWKLINE\x22,\x22DRAWKLINE_IF\x22,\x22PLOYLINE\x22,\x22POLYLINE\x22,\x22DRAWNUMBER\x22,\x22DRAWNUMBER_FIX\x22,\x22DRAWICON\x22,\x22DRAWCHANNEL\x22,\x22PARTLINE\x22,\x22DRAWTEXT_FIX\x22,\x22DRAWGBK\x22,\x22DRAWTEXT_LINE\x22,\x22DRAWRECTREL\x22,\x22DRAWOVERLAYLINE\x22,\x22FILLRGN\x22,\x22FILLRGN2\x22,\x22FILLTOPRGN\x22,\x22FILLBOTTOMRGN\x22,\x22FILLVERTICALRGN\x22,\x22FLOATRGN\x22,\x22DRAWSL\x22,\x22DRAWGBK2\x22]).has(e)},this.VisitAssignmentExpression=function(e){let\x20t=e.Left;t.Type!=Syntax.Identifier&&this.ThrowUnexpectedNode(e);let\x20a=t.Name,r=e.Right,i=null;if(r.Type==Syntax.BinaryExpression||r.Type==Syntax.LogicalExpression)i=this.VisitBinaryExpression(r);else\x20if(r.Type==Syntax.CallExpression)i=this.VisitCallExpression(r);else\x20if(r.Type==Syntax.Literal)i=r.Value,IFrameSplitOperator.IsString(i)&&r.Value.indexOf(\x22$\x22)>0&&(i=this.GetOtherSymbolExplain({Literal:i},e));else\x20if(r.Type==Syntax.Identifier)i=this.ReadVariable(r.Name,r);else\x20if(r.Type==Syntax.MemberExpression)i=this.ReadMemberVariable(r);else\x20if(r.Type==Syntax.UnaryExpression){if(\x22-\x22==r.Operator)i=\x22-\x22+this.GetNodeValue(r.Argument);else\x20i=r.Argument.Value}JSConsole.Complier.Log(\x22[JSExplainer::VisitAssignmentExpression]\x22,a,\x22\x20=\x20\x22,i),this.VarTable.set(a,i)},this.VisitBinaryExpression=function(e){let\x20t=[];t.push(e);let\x20a=null;for(;0!=t.length;)if((a=t[t.length-1]).Left&&e!=a.Left&&e!=a.Right)t.push(a.Left);else\x20if(a.Right&&e!=a.Right)t.push(a.Right);else{let\x20r=t.pop();if(r.Type==Syntax.BinaryExpression){let\x20e=this.GetNodeValue(r.Left),t=this.GetNodeValue(r.Right);JSConsole.Complier.Log(\x22[JSExplainer::VisitBinaryExpression]\x20BinaryExpression\x22,r,e,t),r.Out=null,r.Out=`(${e}\x20${r.Operator}\x20${t})`,\x22收盘价\x22==e&&\x22开盘价\x22==t?\x22>\x22==r.Operator?r.Out=\x22(收阳线)\x22:\x22<\x22==r.Operator?r.Out=\x22(收阴线)\x22:\x22=\x22==r.Operator&&(r.Out=\x22(平盘)\x22):\x22开盘价\x22==e&&\x22收盘价\x22==t&&(\x22<\x22==r.Operator?r.Out=\x22(收阳线)\x22:\x22>\x22==r.Operator?r.Out=\x22(收阴线)\x22:\x22=\x22==r.Operator&&(r.Out=\x22(平盘)\x22)),JSConsole.Complier.Log(\x22[JSExplainer::VisitBinaryExpression]\x20BinaryExpression\x22,r)}else\x20if(r.Type==Syntax.LogicalExpression){let\x20e=this.GetNodeValue(r.Left),t=this.GetNodeValue(r.Right);switch(JSConsole.Complier.Log(\x22[JSExecute::VisitBinaryExpression]\x20LogicalExpression\x22,r,e,t),r.Out=null,r.Operator){case\x22&&\x22:case\x22AND\x22:r.Out=`(${e}\x20并且\x20${t})`;break;case\x22||\x22:case\x22OR\x22:r.Out=`(${e}\x20或者\x20${t})`}JSConsole.Complier.Log(\x22[JSExplainer::VisitBinaryExpression]\x20LogicalExpression\x22,r)}e=a}return\x20e.Out},this.GetNodeValue=function(e){switch(e.Type){case\x20Syntax.Literal:return\x20e.Value;case\x20Syntax.UnaryExpression:if(\x22-\x22==e.Operator){return\x22-\x22+this.GetNodeValue(e.Argument)}return\x20e.Argument.Value;case\x20Syntax.Identifier:return\x20this.ReadVariable(e.Name,e);case\x20Syntax.BinaryExpression:case\x20Syntax.LogicalExpression:return\x20e.Out;case\x20Syntax.CallExpression:return\x20this.VisitCallExpression(e);default:this.ThrowUnexpectedNode(e)}},this.ReadVariable=function(e,t){if(this.ConstVarTable.has(e)){return\x20this.ConstVarTable.get(e)}if(g_JSComplierResource.IsCustomVariant(e))return\x20this.ReadCustomVariant(e,t);if(this.VarTable.has(e))return\x20this.VarTable.get(e);if(e.indexOf(\x22#\x22)>0){var\x20a=e.split(\x22#\x22);return\x20this.SymbolPeriodExplain(a[0],a[1])}return\x20e},this.ThrowUnexpectedNode=function(e,t){let\x20a=e.Marker,r=t||\x22执行异常\x22;return\x20this.ErrorHandler.ThrowError(a.Index,a.Line,a.Column,r)},this.ThrowError=function(){}}function\x20JSComplier(){}function\x20timeout(e){return\x20new\x20Promise(t=>{setTimeout(t,e)})}JSComplier.Tokenize=function(e){JSConsole.Complier.Log(\x22[JSComplier.Tokenize]\x22,e);let\x20t=new\x20Tokenizer(e),a=[];try{for(;;){let\x20e=t.GetNextToken();if(!e)break;a.push(e)}}catch(e){}return\x20a},JSComplier.Parse=function(e){JSConsole.Complier.Log(\x22[JSComplier.Parse]\x22,e);let\x20t=new\x20JSParser(e);return\x20t.Initialize(),t.ParseScript()},JSComplier.Execute=function(e,t,a){!function(){try{JSConsole.Complier.Log(\x22[JSComplier.Execute]\x22,e,t),JSConsole.Complier.Log(\x22[JSComplier.Execute]\x20parser\x20.....\x22);let\x20i=new\x20JSParser(e);i.Initialize();let\x20n=i.ParseScript();JSConsole.Complier.Log(\x22[JSComplier.Execute]\x20parser\x20finish.\x22,n),JSConsole.Complier.Log(\x22[JSComplier.Execute]\x20execute\x20.....\x22);let\x20s=new\x20JSExecute(n,t);s.ErrorCallback=a,s.JobList=i.Node.GetDataJobList(),\x22ScriptIndexConsole\x22==t.ClassName&&s.JobList.unshift({ID:JS_EXECUTE_JOB_ID.JOB_DOWNLOAD_SYMBOL_DATA}),s.JobList.push({ID:JS_EXECUTE_JOB_ID.JOB_RUN_SCRIPT}),s.Execute(),s.VarTable.clear(),s.ConstVarTable.clear();for(var\x20r=0;r<s.OutVarTable.length;r++)s.OutVarTable[r].Data=[];delete\x20s.SymbolData.Execute,delete\x20s.SymbolData.Data,delete\x20s.SymbolData.SourceData,delete\x20s.SymbolData,delete\x20s.OutVarTable,i=n=s={}}catch(e){JSConsole.Complier.Log(e),a&&a(e,t.CallbackParam)}}(),JSConsole.Complier.Log(\x22[JSComplier.Execute]\x20async\x20execute.\x22)},JSComplier.Explain=function(e,t,a){!function(){try{JSConsole.Complier.Log(\x22[JSComplier.Explain]\x22,e,t),JSConsole.Complier.Log(\x22[JSComplier.Explain]\x20parser\x20.....\x22);let\x20r=new\x20JSParser(e);r.Initialize();let\x20i=r.ParseScript();JSConsole.Complier.Log(\x22[JSComplier.Explain]\x20parser\x20finish.\x22,i),JSConsole.Complier.Log(\x22[JSComplier.Explain]\x20explain\x20.....\x22);let\x20n=new\x20JSExplainer(i,t);n.ErrorCallback=a,n.JobList=r.Node.GetDataJobList(),n.JobList.push({ID:JS_EXECUTE_JOB_ID.JOB_RUN_SCRIPT}),n.Run()}catch(e){JSConsole.Complier.Log(e),a&&a(e,t.CallbackParam)}}(),JSConsole.Complier.Log(\x22[JSComplier.Explain]\x20async\x20explain.\x22)},JSComplier.SetDomain=function(e,t){e&&(g_JSComplierResource.Domain=e),t&&(g_JSComplierResource.CacheDomain=t)},JSComplier.AddIcon=function(e){g_JSComplierResource.CustomDrawIcon.Data.set(e.ID,e)},JSComplier.AddFunction=function(e){if(e&&e.Name){var\x20t=e.Name.toUpperCase();g_JSComplierResource.CustomFunction.Data.set(t,e)}},JSComplier.AddVariant=function(e){if(e&&e.Name){var\x20t=e.Name.toUpperCase();g_JSComplierResource.CustomVariant.Data.set(t,e)}};var\x20HQ_DATA_TYPE={KLINE_ID:0,MINUTE_ID:2,HISTORY_MINUTE_ID:3,MULTIDAY_MINUTE_ID:4};function\x20ScriptIndex(e,t,a,r){this.newMethod=BaseIndex,this.newMethod(e),delete\x20this.newMethod,this.Script=t,this.Arguments=[],this.OutVar=[],this.ID,this.FloatPrecision=2,this.StringFormat,this.KLineType=null,this.InstructionType,this.YSpecificMaxMin=null,this.YSplitScale=null,this.Condition=null,this.OutName=null,this.IsLocked=!1,this.LockCallback=null,this.LockID=null,this.LockBG=null,this.LockTextColor=null,this.LockText=null,this.LockFont=null,this.LockCount=20,this.LockMinWidth=null,this.TitleFont=g_JSChartResource.TitleFont,this.IsShortTitle=!1,r&&(r.FloatPrecision>=0&&(this.FloatPrecision=r.FloatPrecision),r.StringFormat>0&&(this.StringFormat=r.StringFormat),r.ID&&(this.ID=r.ID),(r.KLineType>=0||-1===r.KLineType)&&(this.KLineType=r.KLineType),r.InstructionType&&(this.InstructionType=r.InstructionType),r.YSpecificMaxMin&&(this.YSpecificMaxMin=r.YSpecificMaxMin),r.YSplitScale&&(this.YSplitScale=r.YSplitScale),r.Condition&&(this.Condition=r.Condition),r.TitleFont&&(this.TitleFont=r.TitleFont),r.IsShortTitle&&(this.IsShortTitle=r.IsShortTitle),r.OutName&&(this.OutName=r.OutName)),r&&r.Lock&&(1==r.Lock.IsLocked&&(this.IsLocked=!0),r.Lock.Callback&&(this.LockCallback=r.Lock.Callback),r.Lock.ID&&(this.LockID=r.Lock.ID),r.Lock.BG&&(this.LockBG=r.Lock.BG),r.Lock.TextColor&&(this.LockTextColor=r.Lock.TextColor),r.Lock.Text&&(this.LockText=r.Lock.Text),r.Lock.Font&&(this.LockFont=r.Lock.Font),r.Lock.Count&&(this.LockCount=r.Lock.Count),r.Lock.MinWidth&&(this.LockMinWidth=r.Lock.MinWidth*GetDevicePixelRatio())),a&&(this.Arguments=a),this.SetLock=function(e){1==e.IsLocked?(this.IsLocked=!0,e.Callback&&(this.LockCallback=e.Callback),e.ID&&(this.LockID=e.ID),e.BG&&(this.LockBG=e.BG),e.TextColor&&(this.LockTextColor=e.TextColor),e.Text&&(this.LockText=e.Text),e.Font&&(this.LockFont=e.Font),e.Count&&(this.LockCount=e.Count),e.MinWidth&&(this.LockMinWidth=e.MinWidth*GetDevicePixelRatio())):(this.IsLocked=!1,this.LockCallback=null,this.LockID=null,this.LockBG=null,this.LockTextColor=null,this.LockText=null,this.LockFont=null,this.LockCount=20)},this.ExecuteScript=function(e,t,a){this.OutVar=[];let\x20r={HQChart:e,WindowIndex:t,HistoryData:a,Self:this},i=HQ_DATA_TYPE.KLINE_ID;\x22MinuteChartContainer\x22===e.ClassName||\x22MinuteChartHScreenContainer\x22===e.ClassName?i=e.DayCount>1?HQ_DATA_TYPE.MULTIDAY_MINUTE_ID:HQ_DATA_TYPE.MINUTE_ID:\x22HistoryMinuteChartContainer\x22===e.ClassName&&(i=HQ_DATA_TYPE.HISTORY_MINUTE_ID);let\x20n={HQDataType:i,Symbol:e.Symbol,Name:e.Name,Data:a,SourceData:e.SourceData,Callback:this.RecvResultData,CallbackParam:r,Async:!0,MaxRequestDataCount:e.MaxReqeustDataCount,MaxRequestMinuteDayCount:e.MaxRequestMinuteDayCount,Arguments:this.Arguments,Condition:this.Condition,IsBeforeData:e.IsBeforeData,IsApiPeriod:e.IsApiPeriod};if(i===HQ_DATA_TYPE.HISTORY_MINUTE_ID&&(n.TrateDate=e.TradeDate),i===HQ_DATA_TYPE.MULTIDAY_MINUTE_ID&&(n.DayCount=e.DayCount),e.NetworkFilter&&(n.NetworkFilter=e.NetworkFilter),this.Condition&&!this.IsMeetCondition(r,n))return\x20void\x20this.ShowConditionError(r);let\x20s=this.Script;JSComplier.Execute(s,n,e.ScriptErrorCallback)},this.IsMeetCondition=function(e,t){if(JSConsole.Complier.Log(\x22[ScriptIndex::IsMeetCondition]\x20\x22,this.Condition),this.Condition.Period){if(!this.IsMeetPeriodCondition(e,t))return!1;if(!this.IsMeetIncludeCondition(e,t))return!1}return!0},this.IsMeetPeriodCondition=function(e,t){if(!this.Condition.Period)return!0;for(var\x20a\x20in\x20this.Condition.Period){var\x20r=this.Condition.Period[a];switch(r){case\x20CONDITION_PERIOD.MINUTE_ID:if(t.HQDataType==HQ_DATA_TYPE.MINUTE_ID)return!0;break;case\x20CONDITION_PERIOD.MULTIDAY_MINUTE_ID:if(t.HQDataType==HQ_DATA_TYPE.MULTIDAY_MINUTE_ID)return!0;break;case\x20CONDITION_PERIOD.KLINE_DAY_ID:case\x20CONDITION_PERIOD.KLINE_WEEK_ID:case\x20CONDITION_PERIOD.KLINE_MONTH_ID:case\x20CONDITION_PERIOD.KLINE_YEAR_ID:case\x20CONDITION_PERIOD.KLINE_TWOWEEK_ID:case\x20CONDITION_PERIOD.KLINE_QUARTER_ID:case\x20CONDITION_PERIOD.KLINE_MINUTE_ID:case\x20CONDITION_PERIOD.KLINE_5_MINUTE_ID:case\x20CONDITION_PERIOD.KLINE_15_MINUTE_ID:case\x20CONDITION_PERIOD.KLINE_30_MINUTE_ID:case\x20CONDITION_PERIOD.KLINE_60_MINUTE_ID:if(e.HQChart.Period==r)return!0}}return!1},this.IsMeetIncludeCondition=function(e,t){if(!this.Condition.Include||this.Condition.Include.length<=0)return!0;var\x20a=e.HQChart.Symbol;for(var\x20r\x20in\x20a&&(a=a.toUpperCase()),this.Condition.Include){if(a==this.Condition.Include[r])return!0}return!1},this.ShowConditionError=function(e){var\x20t=e.HQChart,a=e.WindowIndex;t.DeleteIndexPaint(a),0==a&&t.ShowKLine(!0);let\x20r=new\x20ChartLine;r.Canvas=t.Canvas,r.ChartBorder=t.Frame.SubFrame[a].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[a].Frame,r.NotSupportMessage=\x22指标不支持当前品种或周期\x22,t.ChartPaint.push(r),t.Draw()},this.RecvResultData=function(e,t){let\x20a=t.HQChart,r=t.WindowIndex,i=t.HistoryData;if(t.Self.OutVar=e,t.Self.BindData(a,r,i),0==t.Self.IsLocked)t.HQChart.Frame.SubFrame[r].Frame.SetLock(null);else{let\x20e={IsLocked:!0,Callback:t.Self.LockCallback,IndexName:t.Self.Name,ID:t.Self.LockID,BG:t.Self.LockBG,Text:t.Self.LockText,TextColor:t.Self.LockTextColor,Font:t.Self.LockFont,Count:t.Self.LockCount,MinWidth:t.Self.LockMinWidth};t.HQChart.Frame.SubFrame[r].Frame.SetLock(e)}if(t.HQChart.UpdataDataoffset(),t.HQChart.UpdateFrameMaxMin(),t.HQChart.Draw(),a.GetIndexEvent){var\x20n=a.GetIndexEvent();if(n){var\x20s=t.Self,u={OutVar:s.OutVar,WindowIndex:r,Name:s.Name,Arguments:s.Arguments,HistoryData:i,Stock:{Symbol:a.Symbol,Name:a.Name}};n.Callback(n,u,s)}}},this.CreateLine=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartLine;if(i.Canvas=e.Canvas,i.DrawType=1,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.Color?i.Color=this.GetColor(a.Color):i.Color=this.GetDefaultColor(r),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(i.LineWidth=e)}a.IsDotLine&&(i.IsDotLine=!0),0==a.IsShow&&(i.IsShow=!1);let\x20n=t+1;i.Data.Data=a.Data,a.NoneName?e.TitlePaint[n].Data[r]=new\x20DynamicTitleData(i.Data,null,i.Color):e.TitlePaint[n].Data[r]=new\x20DynamicTitleData(i.Data,a.Name,i.Color),e.ChartPaint.push(i)},this.CreateOverlayLine=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartSubLine;if(i.Canvas=e.Canvas,i.DrawType=1,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.Color?i.Color=this.GetColor(a.Color):i.Color=this.GetDefaultColor(r),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(i.LineWidth=e)}a.IsDotLine&&(i.IsDotLine=!0),0==a.IsShow&&(i.IsShow=!1);let\x20n=t+1;i.Data.Data=a.Data,e.TitlePaint[n].Data[r]=new\x20DynamicTitleData(i.Data,a.Name,i.Color),e.ChartPaint.push(i)},this.CreateBar=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartStickLine;i.Canvas=e.Canvas,a.Draw.Width>0?i.Width=a.Draw.Width:i.Width=0,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.Color?i.Color=this.GetColor(a.Color):i.Color=this.GetDefaultColor(r);i.Data.Data=a.Draw.DrawData,i.BarType=a.Draw.Type,e.ChartPaint.push(i)},this.CreateText=function(e,t,a,r,i){let\x20n=oldChart(e,a)||new\x20ChartSingleText;n.Canvas=e.Canvas,n.Name=a.Name,n.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,n.ChartFrame=e.Frame.SubFrame[t].Frame,n.ReloadResource(),a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(r);a.Draw.Position&&(n.Position=a.Draw.Position),a.Draw.DrawData&&(n.Data.Data=a.Draw.DrawData),n.Text=a.Draw.Text,a.Draw.Direction>0&&(n.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(n.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(n.TextAlign=a.Draw.TextAlign),e.ChartPaint.push(n)},this.CreateMACD=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartMACD;if(i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.LineWidth){var\x20n=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(n)&&n>0&&(i.LineWidth=n)}let\x20s=t+1;i.Data.Data=a.Data,e.TitlePaint[s].Data[r]=new\x20DynamicTitleData(i.Data,a.Name,this.GetDefaultColor(r)),e.ChartPaint.push(i)},this.CreatePointDot=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartPointDot;if(i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.Color?i.Color=this.GetColor(a.Color):i.Color=this.GetDefaultColor(r),a.Radius&&(i.Radius=a.Radius),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(i.Radius=e)}let\x20n=t+1;i.Data.Data=a.Data,e.TitlePaint[n].Data[r]=new\x20DynamicTitleData(i.Data,a.Name,i.Color),e.ChartPaint.push(i)},this.CreateStick=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartStick;if(i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.Color?i.Color=this.GetColor(a.Color):i.Color=this.GetDefaultColor(r),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(i.LineWidth=e)}let\x20n=t+1;i.Data.Data=a.Data,e.TitlePaint[n].Data[r]=new\x20DynamicTitleData(i.Data,a.Name,i.Color),e.ChartPaint.push(i)},this.CreateLineStick=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartLineStick;if(i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.Color?i.Color=this.GetColor(a.Color):i.Color=this.GetDefaultColor(r),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(i.LineWidth=e)}let\x20n=t+1;i.Data.Data=a.Data,e.TitlePaint[n].Data[r]=new\x20DynamicTitleData(i.Data,a.Name,i.Color),e.ChartPaint.push(i)},this.CreateStraightLine=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartLine;if(i.DrawType=1,i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.Color?i.Color=this.GetColor(a.Color):i.Color=this.GetDefaultColor(r),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(i.LineWidth=e)}let\x20n=t+1;i.Data.Data=a.Draw.DrawData,\x22DRAWLINE\x22==a.Name&&(e.TitlePaint[n].Data[r]=new\x20DynamicTitleData(i.Data,null,i.Color)),e.ChartPaint.push(i)},this.CreateVolStick=function(e,t,a,r,i){let\x20n=oldChart(e,a)||new\x20ChartVolStick;n.Canvas=e.Canvas,n.Name=a.Name,n.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,n.ChartFrame=e.Frame.SubFrame[t].Frame,n.KLineDrawType=e.KLineDrawType,a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(r);let\x20s=t+1;n.Data.Data=a.Data,n.HistoryData=i,e.TitlePaint[s].Data[r]=new\x20DynamicTitleData(n.Data,a.Name,n.Color),e.ChartPaint.push(n)},this.CreateBand=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartBand;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.FirstColor=a.Draw.Color[0],i.SecondColor=a.Draw.Color[1],i.Data.Data=a.Draw.DrawData,e.ChartPaint.push(i)},this.CreateFillRGN=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartLineArea;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.Data.Data=a.Draw.DrawData,a.Color?i.Color=this.GetColor(a.Color):i.Color=this.GetDefaultColor(r),e.ChartPaint.push(i)},this.CreateFillRGN2=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartFillRGN;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.Data.Data=a.Draw.DrawData,e.ChartPaint.push(i)},this.CreateFillBGRGN=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartFillBGRGN;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.Data.Data=a.Draw.DrawData,e.ChartPaint.push(i)},this.CreateFLOATRGN=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartFLOATRGN;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.Data.Data=a.Draw.DrawData,e.ChartPaint.push(i)},this.CreateKLine=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartKLine;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.Data.Data=a.Draw.DrawData,i.IsShowMaxMinPrice=!1,i.IsShowKTooltip=!1,a.Color&&(i.UnchagneColor=i.DownColor=i.UpColor=this.GetColor(a.Color)),e.ChartPaint.push(i)},this.CreatePolyLine=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartLine;if(i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.Color?i.Color=this.GetColor(a.Color):i.Color=this.GetDefaultColor(r),a.IsDotLine&&(i.IsDotLine=!0),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(i.LineWidth=e)}let\x20n=t+1;i.Data.Data=a.Draw.DrawData,e.TitlePaint[n].Data[r]=new\x20DynamicTitleData(i.Data,\x22\x20\x22,i.Color),e.ChartPaint.push(i)},this.CreateChartSlopeLine=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartSlopeLine;if(i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.Color?i.Color=this.GetColor(a.Color):i.Color=this.GetDefaultColor(r),a.IsDotLine&&(i.IsDotLine=!0),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(i.LineWidth=e)}let\x20n=t+1;i.Data.Data=a.Draw.DrawData.Data,i.Option=a.Draw.DrawData.Option,e.TitlePaint[n].Data[r]=new\x20DynamicTitleData(i.Data,null,i.Color),e.ChartPaint.push(i)},this.CreateBackgroud=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartBackground;if(i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.Draw&&a.Draw.DrawData){var\x20n=a.Draw.DrawData;i.Color=n.Color,i.ColorAngle=n.Angle,n.Data&&(i.Data.Data=n.Data)}e.ChartPaint.push(i)},this.CreateTextLine=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartTextLine;if(i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.Draw&&a.Draw.DrawData){var\x20n=a.Draw.DrawData;i.Text=n.Text,i.Line=n.Line,i.Price=n.Price}e.ChartPaint.push(i)},this.CreateNumberText=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartSingleText;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.TextAlign=\x22center\x22,a.Color?i.Color=this.GetColor(a.Color):i.Color=this.GetDefaultColor(r),a.IsDrawAbove?i.Direction=1:i.Direction=2,a.Draw.Position&&(i.Position=a.Draw.Position);i.Data.Data=a.Draw.DrawData.Value,i.Text=a.Draw.DrawData.Text,e.ChartPaint.push(i)},this.CreateIcon=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartSingleText;i.Canvas=e.Canvas,i.TextAlign=\x22center\x22,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame;i.Data.Data=a.Draw.DrawData;var\x20n=a.Draw.Icon;1==n.IconFont?i.IconFont={Family:n.Family,Text:n.Symbol,Color:n.Color}:(i.Text=n.Symbol,a.Color?i.Color=this.GetColor(a.Color):n.Color?i.Color=n.Color:i.Color=\x22rgb(0,0,0)\x22),e.ChartPaint.push(i)},this.CreateChannel=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartChannel;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.Draw.AreaColor?i.AreaColor=a.Draw.AreaColor:a.Color?i.AreaColor=this.GetColor(a.Color):i.AreaColor=this.GetDefaultColor(r),a.Draw.Border.Color?i.LineColor=a.Draw.Border.Color:i.LineColor=null,a.Draw.Border.Dotted&&(i.LineDotted=a.Draw.Border.Dotted),a.Draw.Border.Width>0&&(i.LineWidth=a.Draw.Border.Width),i.Data.Data=a.Draw.DrawData,e.ChartPaint.push(i)},this.CreatePartLine=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartPartLine;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.Data.Data=a.Draw.DrawData,e.ChartPaint.push(i)},this.CreateMultiLine=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartMultiLine;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.Data=e.ChartPaint[0].Data,i.Lines=a.Draw.DrawData,a.Draw.LineDash&&(i.LineDash=a.Draw.LineDash),e.ChartPaint.push(i)},this.CreateMultiBar=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartMultiBar;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.Data=e.ChartPaint[0].Data,i.Bars=a.Draw.DrawData,e.ChartPaint.push(i)},this.CreateMultiText=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartMultiText;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.Data=e.ChartPaint[0].Data,i.Texts=a.Draw.DrawData,e.ChartPaint.push(i)},this.CreateMultiSVGIcon=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartMultiSVGIcon;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.Data=e.ChartPaint[0].Data,i.Family=a.Draw.DrawData.Family,i.Icon=a.Draw.DrawData.Icon,e.ChartPaint.push(i)},this.CreateColorKLine=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartColorKLine;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.Data=e.ChartPaint[0].Data,i.KLineColor=a.Draw.DrawData.KLine,a.Color&&(i.Color=a.Color),e.ChartPaint.push(i)},this.CreateRectangle=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartRectangle;i.Canvas=e.Canvas,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,i.Color=[a.Draw.DrawData.Color],i.Rect=a.Draw.DrawData.Rect,a.Color&&(i.BorderColor=this.GetColor(a.Color)),e.ChartPaint.push(i)},this.CreateScriptOverlayLine=function(e,t,a,r){let\x20i=oldChart(e,a)||new\x20ChartOverlayLine;if(i.Canvas=e.Canvas,i.DrawType=1,i.Name=a.Name,i.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,i.ChartFrame=e.Frame.SubFrame[t].Frame,a.Color?i.Color=this.GetColor(a.Color):i.Color=this.GetDefaultColor(r),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(i.LineWidth=e)}a.IsDotLine&&(i.IsDotLine=!0),0==a.IsShow&&(i.IsShow=!1);let\x20n=t+1;i.Data.Data=a.Draw.DrawData.Data,i.MainData.Data=a.Draw.DrawData.MainData,a.Draw.DrawData.Title&&(e.TitlePaint[n].Data[r]=new\x20DynamicTitleData(i.Data,a.Draw.DrawData.Title,i.Color)),e.ChartPaint.push(i)},this.CreateSelfKLine=function(e,t,a){let\x20r=oldChart(e,\x22Self\x20Kline\x22)||new\x20ChartKLine;r.Canvas=e.Canvas,r.Name=\x22Self\x20Kline\x22,r.ChartBorder=e.Frame.SubFrame[t].Frame.ChartBorder,r.ChartFrame=e.Frame.SubFrame[t].Frame,r.Data=a,r.IsShowMaxMinPrice=!1,r.IsShowKTooltip=!1,r.DrawType=this.KLineType,e.ChartPaint.push(r)},this.BindInstructionData=function(e,t,a){if(!(null==this.OutVar||this.OutVar.length<0)){var\x20r=\x22\x22;for(var\x20i\x20in\x20this.Arguments){let\x20e=this.Arguments[i];r.length>0&&(r+=\x22,\x22),r+=e.Value.toString()}if(r.length>0&&(r=\x22(\x22+r+\x22)\x22),2==this.InstructionType){let\x20t=this.OutVar[this.OutVar.length-1];return\x20e.SetInstructionData(this.InstructionType,{Data:t.Data,Name:this.Name,Param:r,ID:this.ID}),!0}if(1==this.InstructionType){var\x20n,s;for(var\x20i\x20in\x20this.OutVar){let\x20e=this.OutVar[i];\x22ENTERLONG\x22==e.Name?n=e.Data:\x22EXITLONG\x22==e.Name&&(s=e.Data)}return\x20e.SetInstructionData(this.InstructionType,{Buy:n,Sell:s,Name:this.Name,Param:r,ID:this.ID}),!0}}},this.BindData=function(e,t,a){if(0==t&&this.InstructionType)return\x20void\x20this.BindInstructionData(e,t,a);if(e.DeleteIndexPaint(t),0==t&&e.ShowKLine(!0),null==this.OutVar||this.OutVar.length<0)return;for(var\x20r\x20in\x20null!=this.KLineType&&(0===this.KLineType||1===this.KLineType||2===this.KLineType?this.CreateSelfKLine(e,t,a):-1===this.KLineType&&0==t&&e.ShowKLine(!1)),t>=1&&e.Frame&&(e.Frame.SubFrame[t].Frame.YSplitOperator.FloatPrecision=this.FloatPrecision,this.YSpecificMaxMin&&(e.Frame.SubFrame[t].Frame.YSpecificMaxMin=this.YSpecificMaxMin),this.YSplitScale&&(e.Frame.SubFrame[t].Frame.YSplitScale=this.YSplitScale)),this.OutVar){let\x20n=this.OutVar[r];if(!0!==n.IsExData&&1e3!=n.Type){if(0==n.Type)n.IsOverlayLine?this.CreateOverlayLine(e,t,n,r):this.CreateLine(e,t,n,r);else\x20if(1==n.Type)switch(n.Draw.DrawType){case\x22STICKLINE\x22:this.CreateBar(e,t,n,r);break;case\x22DRAWTEXT\x22:case\x22SUPERDRAWTEXT\x22:this.CreateText(e,t,n,r);break;case\x22DRAWLINE\x22:this.CreateStraightLine(e,t,n,r);break;case\x22DRAWBAND\x22:this.CreateBand(e,t,n,r);break;case\x22FILLRGN\x22:this.CreateFillRGN(e,t,n,r);break;case\x22FILLRGN2\x22:this.CreateFillRGN2(e,t,n,r);break;case\x22FILLTOPRGN\x22:case\x22FILLBOTTOMRGN\x22:case\x22FILLVERTICALRGN\x22:this.CreateFillBGRGN(e,t,n,r);break;case\x22FLOATRGN\x22:this.CreateFLOATRGN(e,t,n,r);break;case\x22DRAWKLINE\x22:case\x22DRAWKLINE_IF\x22:this.CreateKLine(e,t,n,r);break;case\x22POLYLINE\x22:this.CreatePolyLine(e,t,n,r);break;case\x22DRAWGBK\x22:case\x22DRAWGBK2\x22:this.CreateBackgroud(e,t,n,r);break;case\x22DRAWTEXT_LINE\x22:this.CreateTextLine(e,t,n,r);break;case\x22DRAWNUMBER\x22:case\x22DRAWNUMBER_FIX\x22:case\x22DRAWTEXT_FIX\x22:this.CreateNumberText(e,t,n,r);break;case\x22DRAWICON\x22:this.CreateIcon(e,t,n,r);break;case\x22DRAWCHANNEL\x22:this.CreateChannel(e,t,n,r);break;case\x22PARTLINE\x22:this.CreatePartLine(e,t,n,r);break;case\x22DRAWRECTREL\x22:this.CreateRectangle(e,t,n,r);break;case\x22DRAWOVERLAYLINE\x22:this.CreateScriptOverlayLine(e,t,n,r);break;case\x22DRAWSL\x22:this.CreateChartSlopeLine(e,t,n,r);break;case\x22MULTI_LINE\x22:this.CreateMultiLine(e,t,n,r);break;case\x22MULTI_BAR\x22:this.CreateMultiBar(e,t,n,r);break;case\x22MULTI_TEXT\x22:this.CreateMultiText(e,t,n,r);break;case\x22MULTI_SVGICON\x22:this.CreateMultiSVGIcon(e,t,n,r);break;case\x22COLOR_KLINE\x22:this.CreateColorKLine(e,t,n,r);break;case\x22KLINE_BG\x22:this.CreateBackgroud(e,t,n,r)}else\x202==n.Type?this.CreateMACD(e,t,n,r):3==n.Type?this.CreatePointDot(e,t,n,r):4==n.Type?this.CreateLineStick(e,t,n,r):5==n.Type?this.CreateStick(e,t,n,r):6==n.Type&&this.CreateVolStick(e,t,n,r,a);var\x20i=e.TitlePaint[t+1];i&&i.Data&&r<i.Data.length&&(this.StringFormat>0&&(i.Data[r].StringFormat=this.StringFormat),this.FloatPrecision>=0&&(i.Data[r].FloatPrecision=this.FloatPrecision),this.OutName&&this.OutName.length>0&&this.Arguments&&this.Arguments.length>0&&i.SetDynamicOutName(this.OutName,this.Arguments))}}let\x20n=t+1;if(e.TitlePaint[n].Title=this.Name,!this.IsShortTitle){let\x20t=\x22\x22;for(var\x20r\x20in\x20this.Arguments){let\x20e=this.Arguments[r];t.length>0&&(t+=\x22,\x22),t+=e.Value.toString()}t.length>0&&(e.TitlePaint[n].Title=this.Name+\x22(\x22+t+\x22)\x22)}return\x20this.TitleFont&&(e.TitlePaint[n].Font=this.TitleFont),!0},this.GetDefaultColor=function(e){let\x20t=null;return\x20g_JSChartResource&&g_JSChartResource.Index&&g_JSChartResource.Index.LineColor&&(t=g_JSChartResource.Index.LineColor),t&&Array.isArray(t)||(t=[\x22rgb(255,174,0)\x22,\x22rgb(25,199,255)\x22,\x22rgb(175,95,162)\x22,\x22rgb(236,105,65)\x22,\x22rgb(68,114,196)\x22,\x22rgb(229,0,79)\x22,\x22rgb(0,128,255)\x22,\x22rgb(252,96,154)\x22,\x22rgb(42,230,215)\x22,\x22rgb(24,71,178)\x22]),t[parseInt(e)%(t.length-1)]},this.GetColor=function(e){let\x20t=new\x20Map([[\x22COLORBLACK\x22,\x22rgb(0,0,0)\x22],[\x22COLORBLUE\x22,\x22rgb(18,95,216)\x22],[\x22COLORGREEN\x22,\x22rgb(25,158,0)\x22],[\x22COLORCYAN\x22,\x22rgb(0,255,198)\x22],[\x22COLORRED\x22,\x22rgb(238,21,21)\x22],[\x22COLORMAGENTA\x22,\x22rgb(255,0,222)\x22],[\x22COLORBROWN\x22,\x22rgb(149,94,15)\x22],[\x22COLORLIGRAY\x22,\x22rgb(218,218,218)\x22],[\x22COLORGRAY\x22,\x22rgb(133,133,133)\x22],[\x22COLORLIBLUE\x22,\x22rgb(94,204,255)\x22],[\x22COLORLIGREEN\x22,\x22rgb(183,255,190)\x22],[\x22COLORLICYAN\x22,\x22rgb(154,255,242)\x22],[\x22COLORLIRED\x22,\x22rgb(255,172,172)\x22],[\x22COLORLIMAGENTA\x22,\x22rgb(255,145,241)\x22],[\x22COLORWHITE\x22,\x22rgb(255,255,255)\x22],[\x22COLORYELLOW\x22,\x22rgb(255,198,0)\x22]]);return\x20t.has(e)?t.get(e):0==e.indexOf(\x22COLOR\x22)?\x22#\x22+e.substr(5):\x22rgb(30,144,255)\x22}}function\x20OverlayScriptIndex(e,t,a,r){this.newMethod=ScriptIndex,this.newMethod(e,t,a,r),delete\x20this.newMethod,this.OverlayIndex=null,this.BindData=function(e,t,a){if(!this.OverlayIndex||1!=this.OverlayIndex.IsOverlay)return;if(this.OverlayIndex.Frame.ChartPaint=[],null==this.OutVar||this.OutVar.length<0)return;var\x20r={Data:[],Title:this.Name};let\x20i=\x22\x22;for(var\x20n\x20in\x20this.Arguments){let\x20e=this.Arguments[n];i.length>0&&(i+=\x22,\x22),i+=e.Value.toString()}i.length>0&&(r.Title=this.Name+\x22(\x22+i+\x22)\x22);var\x20s=t+1,u=e.TitlePaint[s];for(var\x20n\x20in\x20u.OverlayIndex.set(this.OverlayIndex.Identify,r),this.OverlayIndex.Frame.Frame.Title=r.Title,this.OutVar){let\x20r=this.OutVar[n];if(!0!==r.IsExData)if(0==r.Type)this.CreateLine(e,t,r,n);else\x20if(1==r.Type)switch(r.Draw.DrawType){case\x22STICKLINE\x22:this.CreateBar(e,t,r,n);break;case\x22DRAWTEXT\x22:case\x22SUPERDRAWTEXT\x22:this.CreateText(e,t,r,n);break;case\x22DRAWLINE\x22:this.CreateStraightLine(e,t,r,n);break;case\x22DRAWBAND\x22:this.CreateBand(e,t,r,n);break;case\x22DRAWKLINE\x22:case\x22DRAWKLINE_IF\x22:this.CreateKLine(e,t,r,n);break;case\x22POLYLINE\x22:this.CreatePolyLine(e,t,r,n);break;case\x22DRAWNUMBER\x22:case\x22DRAWNUMBER_FIX\x22:case\x22DRAWTEXT_FIX\x22:this.CreateNumberText(e,t,r,n);break;case\x22DRAWICON\x22:this.CreateIcon(e,t,r,n);break;case\x22DRAWCHANNEL\x22:this.CreateChannel(e,t,r,n);break;case\x22DRAWTEXT_LINE\x22:this.CreateTextLine(e,t,r,n);break;case\x22MULTI_LINE\x22:this.CreateMultiLine(e,t,r,n);break;case\x22MULTI_BAR\x22:this.CreateMultiBar(e,t,r,n);break;case\x22MULTI_TEXT\x22:this.CreateMultiText(e,t,r,n);break;case\x22MULTI_SVGICON\x22:this.CreateMultiSVGIcon(e,t,r,n)}else\x202==r.Type?this.CreateMACD(e,t,r,n):3==r.Type?this.CreatePointDot(e,t,r,n):4==r.Type?this.CreateLineStick(e,t,r,n):5==r.Type?this.CreateStick(e,t,r,n):6==r.Type&&this.CreateVolStick(e,t,r,n,a)}return!0},this.RecvResultData=function(e,t){let\x20a=t.HQChart,r=t.WindowIndex,i=t.HistoryData;t.Self.OutVar=e,t.Self.BindData(a,r,i),t.HQChart.UpdataDataoffset(),t.HQChart.UpdateFrameMaxMin(),t.HQChart.Draw();var\x20n=a.GetOverlayIndexEvent();if(n){var\x20s=t.Self,u={OutVar:s.OutVar,WindowIndex:r,Name:s.Name,Arguments:s.Arguments,HistoryData:i,Identify:s.OverlayIndex.Identify,Stock:{Symbol:a.Symbol,Name:a.Name}};n.Callback(n,u,s)}},this.CreateLine=function(e,t,a,r){debug&&console.log(\x22CreateOverlayLine\x22);var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartLine;if(s.Canvas=e.Canvas,s.DrawType=1,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(r),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(line.LineWidth=e)}0==a.IsShow&&(line.IsShow=!1);let\x20u=t+1;s.Data.Data=a.Data,e.TitlePaint[u].OverlayIndex.get(i.Identify).Data[r]=new\x20DynamicTitleData(s.Data,a.Name,s.Color),n.ChartPaint.push(s)},this.CreateBar=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartStickLine;s.Canvas=e.Canvas,a.Draw.Width>0?s.Width=a.Draw.Width:s.Width=1,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(r);s.Data.Data=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateText=function(e,t,a,r,i){var\x20n=this.OverlayIndex,s=n.Frame;let\x20u=new\x20ChartSingleText;u.Canvas=e.Canvas,u.Name=a.Name,u.ChartBorder=s.Frame.ChartBorder,u.ChartFrame=s.Frame,u.Identify=n.Identify,u.ReloadResource(),a.Color?u.Color=this.GetColor(a.Color):u.Color=this.GetDefaultColor(r);a.Draw.Position&&(u.Position=a.Draw.Position),a.Draw.DrawData&&(u.Data.Data=a.Draw.DrawData),u.Text=a.Draw.Text,a.Draw.Direction>0&&(u.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(u.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(u.TextAlign=a.Draw.TextAlign),s.ChartPaint.push(u)},this.CreateMACD=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartMACD;s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify;let\x20u=t+1;s.Data.Data=a.Data,e.TitlePaint[u].OverlayIndex.get(i.Identify).Data[r]=new\x20DynamicTitleData(s.Data,a.Name,this.GetDefaultColor(r)),n.ChartPaint.push(s)},this.CreatePointDot=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartPointDot;if(s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(r),a.Radius&&(s.Radius=a.Radius),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(s.Radius=e)}let\x20u=t+1;s.Data.Data=a.Data,e.TitlePaint[u].OverlayIndex.get(i.Identify).Data[r]=new\x20DynamicTitleData(s.Data,a.Name,s.Color),n.ChartPaint.push(s)},this.CreateStick=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartStick;if(s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(r),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(s.LineWidth=e)}let\x20u=t+1;s.Data.Data=a.Data,e.TitlePaint[u].OverlayIndex.get(i.Identify).Data[r]=new\x20DynamicTitleData(s.Data,a.Name,s.Color),n.ChartPaint.push(s)},this.CreateLineStick=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartLineStick;if(s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(r),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(s.LineWidth=e)}let\x20u=t+1;s.Data.Data=a.Data,e.TitlePaint[u].OverlayIndex.get(i.Identify).Data[r]=new\x20DynamicTitleData(s.Data,a.Name,s.Color),n.ChartPaint.push(s)},this.CreateStraightLine=function(e,t,a,r){debug&&console.log(\x22CreateOverlayStraightLine\x22);var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartLine;if(s.DrawType=1,s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(r),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(s.LineWidth=e)}s.Data.Data=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateVolStick=function(e,t,a,r,i){var\x20n=this.OverlayIndex,s=n.Frame;let\x20u=new\x20ChartVolStick;u.Canvas=e.Canvas,u.Name=a.Name,u.ChartBorder=s.Frame.ChartBorder,u.ChartFrame=s.Frame,u.Identify=n.Identify,u.KLineDrawType=e.KLineDrawType,a.Color?u.Color=this.GetColor(a.Color):u.Color=this.GetDefaultColor(r);let\x20o=t+1;u.Data.Data=a.Data,u.HistoryData=i,e.TitlePaint[o].OverlayIndex.get(n.Identify).Data[r]=new\x20DynamicTitleData(u.Data,a.Name,u.Color),s.ChartPaint.push(u)},this.CreateBand=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartBand;s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,s.FirstColor=a.Draw.Color[0],s.SecondColor=a.Draw.Color[1],s.Data.Data=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateKLine=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartKLine;s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,s.Data.Data=a.Draw.DrawData,s.IsShowMaxMinPrice=!1,s.IsShowKTooltip=!1,a.Color&&(s.UnchagneColor=s.DownColor=s.UpColor=this.GetColor(a.Color)),n.ChartPaint.push(s)},this.CreatePolyLine=function(e,t,a,r){debug&&console.log(\x22CreateOverlayPolyLine\x22);var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartLine;if(s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(r),a.LineWidth){let\x20e=parseInt(a.LineWidth.replace(\x22LINETHICK\x22,\x22\x22));!isNaN(e)&&e>0&&(s.LineWidth=e)}let\x20u=t+1;s.Data.Data=a.Draw.DrawData,e.TitlePaint[u].OverlayIndex.get(i.Identify).Data[r]=new\x20DynamicTitleData(line.Data,\x22\x20\x22,line.Color),n.ChartPaint.push(s)},this.CreateNumberText=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartSingleText;s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,s.TextAlign=\x22center\x22,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(r),a.IsDrawAbove?s.Direction=1:s.Direction=2,a.Draw.Position&&(s.Position=a.Draw.Position);s.Data.Data=a.Draw.DrawData.Value,s.Text=a.Draw.DrawData.Text,n.ChartPaint.push(s)},this.CreateTextLine=function(e,t,a,r){var\x20i=this.OverlayIndex.Frame;let\x20n=new\x20ChartTextLine;if(n.Canvas=e.Canvas,n.Name=a.Name,n.ChartBorder=i.Frame.ChartBorder,n.ChartFrame=i.Frame,a.Draw&&a.Draw.DrawData){var\x20s=a.Draw.DrawData;n.Text=s.Text,n.Line=s.Line,n.Price=s.Price}e.ChartPaint.push(n)},this.CreateIcon=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartSingleText;s.Canvas=e.Canvas,s.TextAlign=\x22center\x22,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify;s.Data.Data=a.Draw.DrawData;var\x20u=a.Draw.Icon;1==u.IconFont?s.IconFont={Family:u.Family,Text:u.Symbol,Color:u.Color}:(s.Text=u.Symbol,a.Color?s.Color=this.GetColor(a.Color):u.Color?s.Color=u.Color:s.Color=\x22rgb(0,0,0)\x22),n.ChartPaint.push(s)},this.CreateChannel=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartChannel;s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,a.Draw.AreaColor?s.AreaColor=a.Draw.AreaColor:a.Color?s.AreaColor=this.GetColor(a.Color):s.AreaColor=this.GetDefaultColor(r),a.Draw.Border.Color?s.LineColor=a.Draw.Border.Color:s.LineColor=null,a.Draw.Border.Dotted&&(s.LineDotted=a.Draw.Border.Dotted),a.Draw.Border.Width>0&&(s.LineWidth=a.Draw.Border.Width),s.Data.Data=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreatePartLine=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartPartLine;s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,s.Data.Data=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateMultiLine=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartMultiLine;s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,s.Data=e.ChartPaint[0].Data,s.Lines=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateMultiBar=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartMultiBar;s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,s.Data=e.ChartPaint[0].Data,s.Bars=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateMultiText=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartMultiText;s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,s.Data=e.ChartPaint[0].Data,s.Texts=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateMultiSVGIcon=function(e,t,a,r){var\x20i=this.OverlayIndex,n=i.Frame;let\x20s=new\x20ChartMultiSVGIcon;s.Canvas=e.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=i.Identify,s.Data=e.ChartPaint[0].Data,s.Family=a.Draw.DrawData.Family,s.Icon=a.Draw.DrawData.Icon,n.ChartPaint.push(s)},this.CreateSelfKLine=function(e,t,a){var\x20r=this.OverlayIndex,i=r.Frame;let\x20n=new\x20ChartKLine;n.Canvas=e.Canvas,n.Name=\x22Self\x20Kline\x22,n.ChartBorder=i.Frame.ChartBorder,n.ChartFrame=i.Frame,n.Identify=r.Identify,n.Data=a,n.IsShowMaxMinPrice=!1,n.IsShowKTooltip=!1,n.DrawType=this.KLineType,i.ChartPaint.push(n)},this.GetDefaultColor=function(e){let\x20t=[\x22rgb(24,71,178)\x22,\x22rgb(42,230,215)\x22,\x22rgb(252,96,154)\x22,\x22rgb(0,128,255)\x22,\x22rgb(229,0,79)\x22,\x22rgb(68,114,196)\x22,\x22rgb(255,174,0)\x22,\x22rgb(25,199,255)\x22,\x22rgb(175,95,162)\x22,\x22rgb(236,105,65)\x22];return\x20t[parseInt(e)%(t.length-1)]}}function\x20APIScriptIndex(e,t,a,r,i){this.newMethod=i?OverlayScriptIndex:ScriptIndex,this.newMethod(e,t,a,r),delete\x20this.newMethod,this.IsOverlayIndex=1==i,this.ApiUrl,this.HQDataType,this.Version=1,r.API&&(r.API.Url&&(this.ApiUrl=r.API.Url),r.API.Name&&(this.Name=this.ID=r.API.Name),r.API.ID&&(this.ID=r.API.ID),r.API.Version>0&&(this.Version=r.API.Version)),this.ExecuteScript=function(e,t,a){JSConsole.Complier.Log(\x22[APIScriptIndex::ExecuteScript]\x20name,\x20Arguments\x20\x22,this.Name,this.Arguments);let\x20r=HQ_DATA_TYPE.KLINE_ID;var\x20i=null;\x22MinuteChartContainer\x22===e.ClassName||\x22MinuteChartHScreenContainer\x22===e.ClassName?r=e.DayCount>1?HQ_DATA_TYPE.MULTIDAY_MINUTE_ID:HQ_DATA_TYPE.MINUTE_ID:\x22HistoryMinuteChartContainer\x22===e.ClassName?r=HQ_DATA_TYPE.HISTORY_MINUTE_ID:i=a.GetDateRange();var\x20n,s=[];if(this.Arguments)for(var\x20u\x20in\x20this.Arguments){var\x20o=this.Arguments[u];s.push({name:o.Name,value:o.Value})}e.GetRequestDataCount&&(n=e.GetRequestDataCount());var\x20l=this,D={indexname:this.ID,symbol:e.Symbol,script:this.Script,args:s,period:e.Period,right:e.Right,hqdatatype:r};if(i&&(D.DateRange=i),n&&(D.maxdatacount=n.MaxRequestDataCount,D.maxminutedaycount=n.MaxRequestMinuteDayCount),r!=HQ_DATA_TYPE.MULTIDAY_MINUTE_ID&&r!=HQ_DATA_TYPE.MINUTE_ID||(D.daycount=e.DayCount),this.HQDataType=r,e.NetworkFilter){var\x20h={Name:\x22APIScriptIndex::ExecuteScript\x22,Explain:\x22指标计算\x22,Request:{Url:l.ApiUrl,Type:\x22POST\x22,Data:D},Self:this,HQChart:e,PreventDefault:!1};if(e.NetworkFilter(h,function(r){2==l.Version?l.RecvAPIData2(r,e,t,a):l.RecvAPIData(r,e,t,a)}),1==h.PreventDefault)return}JSNetwork.HttpRequest({url:l.ApiUrl,data:D,type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(r){l.RecvAPIData(r,e,t,a)},error:function(e){l.RecvError(e)}})},this.RecvAPIData2=function(e,t,a,r){if(JSConsole.Complier.Log(\x22[APIScriptIndex::RecvAPIData2]\x20recv\x20data\x20\x22,this.Name,e),this.HQDataType==HQ_DATA_TYPE.KLINE_ID&&(this.OutVar=this.ConvertToLocalData(e,t),JSConsole.Complier.Log(\x22[APIScriptIndex::RecvAPIData2]\x20conver\x20to\x20OutVar\x20\x22,this.OutVar)),this.BindData(t,a,r),t.UpdataDataoffset(),t.UpdateFrameMaxMin(),t.Draw(),t.GetIndexEvent){var\x20i=t.GetIndexEvent();if(i){e={OutVar:this.OutVar,WindowIndex:a,Name:this.Name,Arguments:this.Arguments,HistoryData:r,Stock:{Symbol:t.Symbol,Name:t.Name}};i.Callback(i,e,this)}}},this.ConvertToLocalData=function(e,t){var\x20a=e.OutVar,r=t.ChartPaint[0].Data;if(ChartData.IsDayPeriod(e.Period,!0))var\x20i=r.GetAPIDataIndex(e.Date);else\x20i=r.GetAPIDataIndex(e.Date,e.Time);var\x20n=[];for(var\x20s\x20in\x20a){var\x20u={Type:(E=a[s]).Type,Name:E.Name};if(0==E.Type){u.Data=[];for(var\x20o=0;o<i.length;++o){(p=i[o]).Index<0?u.Data[o]=null:u.Data[o]=E.Data[p.Index]}u.Name&&u.Name.indexOf(\x22@NODRAW@\x22)>=0&&(u.Name=u.Name.replace(\x22@NODRAW@\x22,\x22\x22))}else{if(1!=E.Type)continue;u.Name=E.DrawType,u.Draw={DrawType:E.DrawType};var\x20l=E.Draw;switch(E.DrawType){case\x22STICKLINE\x22:var\x20D=[];for(o=0;o<i.length;++o){if(D[o]=null,!((_=(p=i[o]).Index)<0)){var\x20h=l.Price[_],c=l.Price2[_];IFrameSplitOperator.IsNumber(h)&&IFrameSplitOperator.IsNumber(c)&&(D[o]={Value:h,Value2:c})}}u.Draw.DrawData=D,u.Draw.Width=l.Width,u.Draw.Type=l.Empty;break;case\x22DRAWTEXT\x22:D=[];var\x20C=[];for(o=0;o<i.length;++o){if(D[o]=null,!((_=(p=i[o]).Index)<0)){h=l.Price[_];if(IFrameSplitOperator.IsNumber(h)&&(D[o]=h),Array.isArray(l.Text)){var\x20E=l.Text[_];IFrameSplitOperator.IsString(E)&&(C[o]=E)}}}Array.isArray(l.Text)?u.Draw.Text=C:u.Draw.Text=l.Text,u.Draw.DrawData=D;break;case\x22DRAWNUMBER\x22:for(D={Value:[],Text:[]},o=0;o<i.length;++o){if(D.Value[o]=null,D.Text[o]=null,!((_=(p=i[o]).Index)<0)){h=l.Price[_];var\x20m=l.Number[_];IFrameSplitOperator.IsNumber(h)&&IFrameSplitOperator.IsNumber(m)&&(D.Value[o]=h,D.Text[o]=m.toFixed(2))}}u.Draw.DrawData=D;break;case\x22DRAWBAND\x22:for(D=[],o=0;o<i.length;++o){if(D[o]=null,!((_=(p=i[o]).Index)<0)){h=l.Val1[_],c=l.Val2[_];IFrameSplitOperator.IsNumber(h)&&IFrameSplitOperator.IsNumber(c)&&(D[o]={Value:h,Value2:c})}}u.Draw.DrawData=D,u.Draw.Color=[l.Color1.toLowerCase(),l.Color2.toLowerCase()];break;case\x22DRAWKLINE\x22:for(D=[],o=0;o<i.length;++o){E={Open:null,High:null,Low:null,Close:null};if(D[o]=E,!((_=(p=i[o]).Index)<0)){var\x20A=l.High[_],N=l.Low[_],I=l.Open[_],S=l.Close[_];IFrameSplitOperator.IsPlusNumber(A)&&IFrameSplitOperator.IsPlusNumber(N)&&IFrameSplitOperator.IsPlusNumber(I)&&IFrameSplitOperator.IsPlusNumber(S)&&(E.Open=I,E.Close=S,E.High=A,E.Low=N)}}u.Draw.DrawData=D;break;case\x22DRAWTEXT_FIX\x22:for(D={Value:[],Text:[]},o=0;o<i.length;++o){if(D.Value[o]=0,D.Text[o]=null,!((_=(p=i[o]).Index)<0))l.Cond[_]&&(D.Value[o]=1,D.Text[o]=l.Text)}u.Draw.DrawData=D,u.Draw.Position={X:l.X,Y:l.Y,Type:l.Type};break;case\x22DRAWNUMBER_FIX\x22:for(D={Value:[],Text:[]},o=0;o<i.length;++o){if(D.Value[o]=null,D.Text[o]=null,!((_=(p=i[o]).Index)<0)){var\x20f=l.Number[_];IFrameSplitOperator.IsNumber(f)&&(D.Value[o]=f,D.Text[o]=IFrameSplitOperator.RemoveZero(f.toFixed(2)))}}u.Draw.DrawData=D,u.Draw.Position={X:l.X,Y:l.Y,Type:l.Type};break;case\x22DRAWICON\x22:var\x20O=g_JSComplierResource.GetDrawIcon(l.Type);O||g_JSComplierResource.GetDrawTextIcon(l.Type),O||(O={Symbol:\x22🚩\x22}),u.Draw.Icon=O;for(D=[],o=0;o<i.length;++o){if(D[o]=null,!((_=(p=i[o]).Index)<0)){f=l.Price[_];IFrameSplitOperator.IsNumber(f)&&(D[o]=f)}}u.Draw.DrawData=D;break;case\x22PARTLINE\x22:for(D=[],o=0;o<i.length;++o){if(D[o]={Value:null,RGB:null},!((_=(p=i[o]).Index)<0)){var\x20d=l.Color[_];if(IFrameSplitOperator.IsString(d)){f=l.Price[_];IFrameSplitOperator.IsNumber(f)&&(D[o].Value=f,D[o].RGB=d)}}}u.Draw.DrawData=D;break;case\x22FILLRGN\x22:for(D=[],o=0;o<i.length;++o){var\x20p,_;if(D[o]=null,!((_=(p=i[o]).Index)<0)){d=l.Color[_];if(IFrameSplitOperator.IsString(d)){f=l.Price[_];if(IFrameSplitOperator.IsNumber(f)){var\x20T=l.Price2[_];IFrameSplitOperator.IsNumber(T)&&(D[o]={Value:f,Value2:T,Color:d})}}}}u.Draw.DrawData=D,u.Draw.DrawType=\x22FILLRGN2\x22;break;default:continue}}for(var\x20s\x20in\x20E.Attribute){var\x20y=E.Attribute[s];switch(y){case\x22COLORSTICK\x22:u.Type=2;break;case\x22POINTDOT\x22:u.Radius=2,u.Type=3;break;case\x22CIRCLEDOT\x22:u.Radius=1.3,u.Type=3;break;case\x22DOTLINE\x22:u.IsDotLine=!0;break;case\x22DRAWABOVE\x22:u.IsDrawAbove=!0;break;case\x22LINESTICK\x22:u.Type=4;break;case\x22STICK\x22:u.Type=5;break;case\x22VOLSTICK\x22:u.Type=6;break;case\x22NODRAW\x22:u.IsShow=!1;break;case\x22NONE_OUT_NAME\x22:u.NoneName=!0}0==y.indexOf(\x22COLOR\x22)?u.Color=y:0==y.indexOf(\x22LINETHICK\x22)&&(u.LineWidth=y)}n.push(u)}return\x20n},this.RecvAPIData=function(e,t,a,r){if(JSConsole.Complier.Log(\x22[APIScriptIndex::RecvAPIData]\x20recv\x20data\x20\x22,this.Name,e),0==e.code){if(e.outdata&&e.outdata.name&&(this.Name=e.outdata.name),e.outdata.args)for(var\x20i\x20in\x20this.Arguments=[],e.outdata.args){var\x20n=e.outdata.args[i];this.Arguments.push({Name:n.name,Value:n.value})}if(this.HQDataType==HQ_DATA_TYPE.KLINE_ID?(this.OutVar=this.FittingData(e.outdata,t),JSConsole.Complier.Log(\x22[APIScriptIndex::RecvAPIData]\x20conver\x20to\x20OutVar\x20\x22,this.OutVar)):this.OutVar=this.FittingMinuteData(e.outdata,t),this.BindData(t,a,r),0==this.IsLocked)t.Frame.SubFrame[a].Frame.SetLock(null);else{let\x20e={IsLocked:!0,Callback:this.LockCallback,IndexName:this.Name,ID:this.LockID,BG:this.LockBG,Text:this.LockText,TextColor:this.LockTextColor,Font:this.LockFont,Count:this.LockCount,MinWidth:this.LockMinWidth};t.Frame.SubFrame[a].Frame.SetLock(e)}if(t.UpdataDataoffset(),t.UpdateFrameMaxMin(),t.Draw(),t.GetIndexEvent){var\x20s=t.GetIndexEvent();if(s){e={OutVar:this.OutVar,WindowIndex:a,Name:this.Name,Arguments:this.Arguments,HistoryData:r,Stock:{Symbol:t.Symbol,Name:t.Name}};s.Callback(s,e,this)}}}},this.FittingArray=function(e,t,a,r,i){var\x20n,s=r.ChartPaint[0].Data,u=[];for(var\x20o\x20in\x20e){var\x20l=e[o],D=new\x20SingleData;D.Date=t[o],a&&o<a.length&&(D.Time=a[o]),D.Value=l,u.push(D)}n=ChartData.IsDayPeriod(r.Period,!0)?s.GetFittingData(u):s.GetMinuteFittingData(u);var\x20h=new\x20ChartData;return\x20h.Data=n,1==i?h.GetObject():h.GetValue()},this.FittingMultiLine=function(e,t,a,r){var\x20i=r.ChartPaint[0].Data;if(ChartData.IsDayPeriod(r.Period,!0)){var\x20n=[];for(var\x20s\x20in\x20e){var\x20u=e[s];for(var\x20o\x20in\x20u.Point){var\x20l=u.Point[o];n.push(l)}}return\x20n.sort(function(e,t){return\x20e.Date-t.Date}),i.GetDateIndex(n),e}if(ChartData.IsMinutePeriod(r.Period,!0)){n=[];for(var\x20s\x20in\x20e){u=e[s];for(var\x20o\x20in\x20u.Point){l=u.Point[o];n.push(l)}}return\x20n.sort(function(e,t){return\x20e.Date==t.Date?e.Time-t.Time:e.Date-t.Date}),i.GetDateTimeIndex(n),e}return\x20null},this.FittingMultiText=function(e,t,a,r){var\x20i=r.ChartPaint[0].Data;return\x20ChartData.IsDayPeriod(r.Period,!0)?(e.sort(function(e,t){return\x20e.Date-t.Date}),i.GetDateIndex(e),e):ChartData.IsMinutePeriod(r.Period,!0)?(e.sort(function(e,t){return\x20e.Date==t.Date?e.Time-t.Time:e.Date-t.Date}),i.GetDateTimeIndex(e),e):null},this.FittingData=function(e,t){var\x20a=e.outvar,r=e.date,i=e.time,n=(t.ChartPaint[0].Data,[]);for(var\x20s\x20in\x20a){var\x20u={Name:(c=a[s]).name,Type:c.type};if(c.color&&(u.Color=c.color),c.data)u.Data=this.FittingArray(c.data,r,i,t),c.color&&(u.Color=c.color),c.linewidth>=1&&(u.LineWidth=c.linewidth),0==c.isshow&&(u.IsShow=!1),1==c.isexdata&&(u.IsExData=!0),n.push(u);else\x20if(c.Draw){var\x20o=c.Draw,l={};if(\x22DRAWICON\x22==o.DrawType)l.Icon=o.Icon,l.Name=o.Name,l.DrawType=o.DrawType,l.DrawData=this.FittingArray(o.DrawData,r,i,t),u.Draw=l,n.push(u);else\x20if(\x22DRAWTEXT\x22==o.DrawType)l.Text=o.Text,l.Name=o.Name,l.DrawType=o.DrawType,l.DrawData=this.FittingArray(o.DrawData,r,i,t),u.Draw=l,n.push(u);else\x20if(\x22STICKLINE\x22==o.DrawType)l.Name=o.Name,l.Type=o.Type,l.Width=o.Width,l.DrawType=o.DrawType,l.DrawData=this.FittingArray(o.DrawData,r,i,t,1),u.Draw=l,n.push(u);else\x20if(\x22MULTI_LINE\x22==o.DrawType)l.Text=o.Text,l.Name=o.Name,l.DrawType=o.DrawType,l.DrawData=this.FittingMultiLine(o.DrawData,r,i,t),u.Draw=l,o.LineDash&&(l.LineDash=o.LineDash),n.push(u);else\x20if(\x22MULTI_BAR\x22==o.DrawType)l.Text=o.Text,l.Name=o.Name,l.DrawType=o.DrawType,l.DrawData=this.FittingMultiLine(o.DrawData,r,i,t),u.Draw=l,n.push(u);else\x20if(\x22MULTI_TEXT\x22==o.DrawType)l.Text=o.Text,l.Name=o.Name,l.DrawType=o.DrawType,l.DrawData=this.FittingMultiText(o.DrawData,r,i,t),u.Draw=l,n.push(u);else\x20if(\x22MULTI_SVGICON\x22==o.DrawType)l.Text=o.Text,l.Name=o.Name,l.DrawType=o.DrawType,l.DrawData={Icon:this.FittingMultiText(o.DrawData.Icon,r,i,t),Family:o.DrawData.Family},u.Draw=l,n.push(u);else\x20if(\x22COLOR_KLINE\x22==o.DrawType){l.Text=o.Text,l.Name=o.Name,l.DrawType=o.DrawType;var\x20D=this.FittingMultiText(o.DrawData.KLine,r,i,t),h=new\x20Map;for(var\x20s\x20in\x20D){var\x20c=D[s];h.set(c.Index,c)}l.DrawData={KLine:h},o.Color&&(u.Color=o.Color),u.Draw=l,n.push(u)}else\x22KLINE_BG\x22==o.DrawType&&(l.Name=o.Name,l.DrawType=o.DrawType,l.DrawData={},l.DrawData.Color=o.Color,l.DrawData.Angle=o.Angle,l.DrawData.Data=this.FittingKLineBG(o.DrawData,t),u.Draw=l,u.Name=o.DrawType,n.push(u))}}return\x20n},this.FittingKLineBG=function(e,t){var\x20a=t.ChartPaint[0].Data,r=[];if(ChartData.IsDayPeriod(t.Period,!0)){for(var\x20i=!1,n=0,s=0;n<a.Data.length;){r[n]=0;var\x20u=a.Data[n];if(s>=e.length)++n;else(o=e[s]).Date<u.Date?++s:o.Date>u.Date?++n:(i=!0,r[n]=1,++s,++n)}if(i)return\x20r}else\x20if(ChartData.IsMinutePeriod(t.Period,!0)){for(i=!1,n=0,s=0;n<a.Data.length;){r[n]=0;var\x20o;u=a.Data[n];if(s>=e.length)++n;else(o=e[s]).Date<u.Date||o.Date==u.Date&&o.Time<u.Time?++s:o.Date>u.Date||o.Date==u.Date&&o.Time>u.Time?++n:(i=!0,r[n]=1,++s,++n)}if(i)return\x20r}return\x20null},this.FittingMinuteData=function(e,t){var\x20a=e.outvar,r=e.date,i=e.time,n=[];for(var\x20s\x20in\x20a){item=a[s];var\x20u={Name:item.name,Type:item.type};item.data&&(u.Data=this.FittingMinuteArray(item.data,r,i,t),item.color&&(u.Color=item.color),item.linewidth>=1&&(u.LineWidth=item.linewidth),0==item.isshow&&(u.IsShow=!1),1==item.isexdata&&(u.IsExData=!0),n.push(u))}return\x20n},this.FittingMinuteArray=function(e,t,a,r){var\x20i=r.SourceData,n=[];for(var\x20s\x20in\x20e){var\x20u=e[s],o=new\x20SingleData;o.Date=t[s],a&&s<a.length&&(o.Time=a[s]),o.Value=u,n.push(o)}var\x20l=i.GetMinuteFittingData(n),D=new\x20ChartData;return\x20D.Data=l,D.GetValue()}}function\x20LocalJsonDataIndex(e,t,a){this.newMethod=ScriptIndex,this.newMethod(e,null,t,null),delete\x20this.newMethod,this.JsonData,a.JsonData&&(this.JsonData=a.JsonData),this.RequestData=function(e,t,a){if(!this.JsonData)return\x20console.warn(\x22[LocalJsonDataIndex::RequestData]\x20JsonData\x20is\x20null\x22),void(param.HQChart.ScriptErrorCallback&&param.HQChart.ScriptErrorCallback(\x22json\x20数据不能为空\x22));this.OutVar=this.FittingData(this.JsonData,a),this.BindData(e,t,a)},this.FittingData=function(e,t){for(i\x20in\x20outVar=e.OutVar,date=e.Date,time=e.Time,result=[],outVar)if(item=outVar[i],JSConsole.Complier.Log(\x22[LocalJsonDataIndex::FittingData]\x20item\x22,item),0==item.Type||3==item.Type){var\x20a=[];for(j\x20in\x20outVarItem={Name:item.Name,Type:item.Type},item.Data){var\x20r=new\x20SingleData;r.Date=date[j],time&&j<time.length&&(r.Time=time[j]),r.Value=item.Data[j],a.push(r)}if(t.Period<4)var\x20n=t.GetFittingData(a);else\x20n=t.GetMinuteFittingData(a);var\x20s=new\x20ChartData;s.Data=n,outVarItem.Data=s.GetValue(),result.push(outVarItem)}else\x20console.warn(\x22[LocalJsonDataIndex::FittingData]\x20can\x27t\x20support\x20\x22,item.Name,item.Type);return\x20result}}function\x20ScriptIndexConsole(e){this.ID,this.Name,this.Script,this.Arguments=[],this.ClassName=\x22ScriptIndexConsole\x22,this.ErrorCallback,this.FinishCallback,this.IsSectionMode=!1,e&&(e.Name&&(this.Name=e.Name),e.Script&&(this.Script=e.Script),e.ID&&(this.ID=e.ID),e.Args&&(this.Arguments=e.Args),e.ErrorCallback&&(this.ErrorCallback=e.ErrorCallback),e.FinishCallback&&(this.FinishCallback=e.FinishCallback),e.IsSectionMode&&(this.IsSectionMode=e.IsSectionMode)),this.ExecuteScript=function(e){this.OutVar=[];let\x20t={Self:this},a={HQDataType:e.HQDataType,Symbol:e.Stock.Symbol,Name:e.Stock.Name,Period:e.Period,Right:e.Right,Callback:this.RecvResultData,CallbackParam:t,Async:!0,MaxRequestDataCount:e.Request.MaxDataCount,MaxRequestMinuteDayCount:e.Request.MaxMinuteDayCount,Arguments:this.Arguments,IsSectionMode:this.IsSectionMode,ClassName:\x22ScriptIndexConsole\x22};e.HQDataType===HQ_DATA_TYPE.HISTORY_MINUTE_ID&&(a.TrateDate=e.Request.TradeDate),e.HQDataType==HQ_DATA_TYPE.MULTIDAY_MINUTE_ID&&(a.DayCount=e.DayCount);let\x20r=this.Script;JSComplier.Execute(r,a,this.ErrorCallback)},this.RecvResultData=function(e,t){var\x20a=t.Self,r=t.JSExecute,i=null;r.SymbolData.Data&&(i=r.SymbolData.Data.GetDate());var\x20n={Out:e,Date:i,Stock:{Name:r.SymbolData.Name,Symbol:r.SymbolData.Symbol},Index:{Name:a.Name,ID:a.ID}};r.SymbolData.DataType==HQ_DATA_TYPE.MULTIDAY_MINUTE_ID||r.SymbolData.DataType==HQ_DATA_TYPE.MINUTE_ID?n.Time=r.SymbolData.Data.GetTime():r.SymbolData.DataType==HQ_DATA_TYPE.KLINE_ID&&ChartData.IsMinutePeriod(r.SymbolData.Period,!0)&&(n.Time=r.SymbolData.Data.GetTime()),a.FinishCallback&&a.FinishCallback(n,t.JSExecute)}}function\x20DownloadFinValueData(e){this.Url=e.Url,this.Job=e.Job,this.Symbol=e.Symbol,this.Args=e.Args,this.DataKey=e.DataKey,this.RecvCallback=e.Callback,this.ErrorCallback=e.ErrorCallback,this.Download=function(){var\x20e=this,t=this.GetFieldList();if(!t)return\x20message=`${this.Job.FunctionName}(${this.Args[0]})\x20can\x27t\x20support.`,this.ErrorCallback(message),void\x20e.RecvCallback(null,e.Job,e.DataKey);JSNetwork.HttpRequest({url:this.Url,data:{field:t,symbol:[this.Symbol],condition:[{item:[\x22finance\x22,\x22doc\x22,\x22exists\x22,\x22true\x22]}],start:0,end:200},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){var\x20a=e.ToHQChartData(t);a&&a.sort(function(e,t){return\x20e.Date-t.Date}),e.RecvCallback(a,e.Job,e.DataKey)}})},this.ToHQChartData=function(e){if(!e.stock||1!=e.stock.length)return\x20null;var\x20t=[],a=new\x20Set,r=e.stock[0];for(var\x20i\x20in\x20r.stockday){var\x20n,s=r.stockday[i];if(s.announcement1)(n=this.ToHQChartItemData(s.announcement1,s.finance1,s))&&!a.has(n.Date)&&(t.push(n),a.add(n.Date));if(s.announcement2)(n=this.ToHQChartItemData(s.announcement2,s.finance2,s))&&!a.has(n.Date)&&(t.push(n),a.add(n.Date));if(s.announcement3)(n=this.ToHQChartItemData(s.announcement3,s.finance3,s))&&!a.has(n.Date)&&(t.push(n),a.add(n.Date));if(s.announcement4)(n=this.ToHQChartItemData(s.announcement4,s.finance4,s))&&!a.has(n.Date)&&(t.push(n),a.add(n.Date))}return\x20t},this.ToHQChartItemData=function(e,t,a){var\x20r=this.Args[0],i=1e4*e.year;switch(e.quarter){case\x201:i+=331;break;case\x202:i+=630;break;case\x203:i+=930;break;case\x204:i+=1231;break;default:return\x20null}var\x20n={Date:i,Value:0};switch(r){case\x200:n.Value=i%1e6;break;case\x201:n.Value=t.persearning;break;case\x203:n.Value=t.peruprofit;break;case\x204:n.Value=t.pernetasset;break;case\x205:n.Value=t.percreserve;break;case\x206:n.Value=t.woewa;break;case\x207:n.Value=t.perccfo;break;case\x208:n.Value=t.monetaryfunds;break;case\x2011:n.Value=t.areceivable}return\x20n},this.GetFieldList=function(){switch(this.Args[0]){case\x200:return[\x22finance.date\x22];case\x201:return[\x22finance.persearning\x22];case\x203:return[\x22finance.peruprofit\x22];case\x204:return[\x22finance.pernetasset\x22];case\x205:return[\x22finance.percreserve\x22];case\x206:return[\x22finance.woewa\x22];case\x207:return[\x22finance.perccfo\x22];case\x208:return[\x22finance.monetaryfunds\x22];case\x2011:return[\x22finance.areceivable\x22];default:return\x20null}}}function\x20DownloadFinOneData(e){this.newMethod=DownloadFinValueData,this.newMethod(e),delete\x20this.newMethod,this.Download=function(){var\x20e=this,t=this.GetFieldList();if(!t)return\x20message=`${this.Job.FunctionName}(${this.Args[0]},\x20${this.Args[1]},\x20${this.Args[2]})\x20can\x27t\x20support.`,this.ErrorCallback(message),void\x20e.RecvCallback(null,e.Job,e.DataKey);var\x20a=[{item:[\x22finance\x22,\x22doc\x22,\x22exists\x22,\x22true\x22]}],r=this.Args[1],i=this.Args[2],n=0,s=3,u=null;0==r&&0==i||(0==r&&i<300?(n=i,s=200):0==i&&r<1e3?u=r:r>1909&&(331==i?(a=[{item:[\x22announcement1.year\x22,\x22int32\x22,\x22eq\x22,r]},{item:[\x22finance1\x22,\x22doc\x22,\x22exists\x22,\x22true\x22]}],t.push(\x22announcement1.year\x22),t.push(\x22announcement1.quarter\x22)):630==i?(a=[{item:[\x22announcement2.year\x22,\x22int32\x22,\x22eq\x22,r]},{item:[\x22finance2\x22,\x22doc\x22,\x22exists\x22,\x22true\x22]}],t.push(\x22announcement2.year\x22),t.push(\x22announcement2.quarter\x22)):930==i?(a=[{item:[\x22announcement3.year\x22,\x22int32\x22,\x22eq\x22,r]},{item:[\x22finance3\x22,\x22doc\x22,\x22exists\x22,\x22true\x22]}],t.push(\x22announcement4.year\x22),t.push(\x22announcement4.quarter\x22)):(a=[{item:[\x22announcement4.year\x22,\x22int32\x22,\x22eq\x22,r]},{item:[\x22finance4\x22,\x22doc\x22,\x22exists\x22,\x22true\x22]}],t.push(\x22announcement4.year\x22),t.push(\x22announcement4.quarter\x22)))),JSNetwork.HttpRequest({url:this.Url,data:{field:t,symbol:[this.Symbol],condition:a,start:0,end:s},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){var\x20a=e.ToHQChartData(t),r=null;a&&a.length>0&&(a.sort(function(e,t){return\x20t.Date-e.Date}),r=null==u?a[n]:e.GetPreYearData(a,u)),e.RecvCallback(r,e.Job,e.DataKey)}})},this.GetPreYearData=function(e,t){if(331!=t&&630!=t&&930!=t&&1231!=t){for(var\x20a=e[0].Date%1e3,r=(i=1,0);i<e.length;++i){if((n=e[i]).Date%1e4==a&&++r==t)return\x20n}return\x20null}for(var\x20i\x20in\x20e){var\x20n;if((n=e[i]).Date%1e4==t)return\x20n}}}function\x20DownloadFinanceData(e){this.Url=e.Url,this.RealtimeUrl=e.RealtimeUrl,this.Job=e.Job,this.Symbol=e.Symbol,this.Args=e.Args,this.DataKey=e.DataKey,this.RecvCallback=e.Callback,this.ErrorCallback=e.ErrorCallback,this.Download=function(){var\x20e=this.Args[0];switch(e){case\x201:case\x207:case\x22EXCHANGE\x22:this.DownloadHistoryData(e);break;case\x209:case\x2018:case\x2030:case\x2032:case\x2033:case\x2034:case\x2038:case\x2040:case\x2041:case\x2042:case\x2043:case\x22CAPITAL\x22:case\x22TOTALCAPITAL\x22:case\x20100:default:this.DownloadRealtimeData(e)}},this.DownloadRealtimeData=function(e){var\x20t=this,a=this.GetFieldList();if(!a)return\x20this.Job.FunctionName2?message=`${this.Job.FunctionName2}\x20can\x27t\x20support.`:this.Job.FunctionName?message=`${this.Job.FunctionName}(${this.Args[0]})\x20can\x27t\x20support.`:message=`${this.Args[0]}\x20can\x27t\x20support.`,this.ErrorCallback(message),void\x20t.RecvCallback(null,t.Job,t.DataKey);JSNetwork.HttpRequest({url:this.RealtimeUrl,data:{field:a,symbol:[this.Symbol],condition:[],start:0,end:10},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){var\x20a=t.RealtimeDataToHQChartData(e);t.RecvCallback(a,t.Job,t.DataKey)}})},this.DownloadHistoryData=function(e){var\x20t=this,a=this.GetFieldList();if(!a)return\x20message=`${this.Job.FunctionName}(${this.Args[0]})\x20can\x27t\x20support.`,this.ErrorCallback(message),void\x20t.RecvCallback(null,t.Job,t.DataKey);JSNetwork.HttpRequest({url:this.Url,data:{field:a,symbol:[this.Symbol],condition:[],start:0,end:200},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){var\x20a=t.ToHQChartData(e);a&&a.sort(function(e,t){return\x20e.Date-t.Date}),t.RecvCallback(a,t.Job,t.DataKey)}})},this.GetFieldList=function(){switch(this.Args[0]){case\x201:return[\x22capital.total\x22,\x22capital.date\x22];case\x207:case\x22EXCHANGE\x22:return[\x22capital.a\x22,\x22capital.date\x22];case\x209:return[\x22finance.peruprofit\x22,\x22symbol\x22,\x22date\x22];case\x2018:return[\x22finance.percreserve\x22,\x22symbol\x22,\x22date\x22];case\x2030:return[\x22finance.nprofit\x22,\x22symbol\x22,\x22date\x22];case\x2032:return[\x22finance.peruprofit\x22,\x22symbol\x22,\x22date\x22];case\x2033:return[\x22finance.persearning\x22,\x22symbol\x22,\x22date\x22];case\x2034:return[\x22finance.pernetasset\x22,\x22symbol\x22,\x22date\x22];case\x2038:return[\x22finance.persearning\x22,\x22symbol\x22,\x22date\x22];case\x2040:return[\x22capital.a\x22,\x22capital.date\x22,\x22symbol\x22,\x22date\x22,\x22price\x22];case\x2041:return[\x22capital.total\x22,\x22capital.date\x22,\x22symbol\x22,\x22date\x22,\x22price\x22];case\x22CAPITAL\x22:return[\x22capital.a\x22,\x22capital.date\x22,\x22symbol\x22,\x22date\x22];case\x22TOTALCAPITAL\x22:return[\x22capital.total\x22,\x22capital.date\x22,\x22symbol\x22,\x22date\x22];case\x2042:return[\x22company.releasedate\x22,\x22symbol\x22,\x22date\x22];case\x2043:return[\x22dividendyield\x22,\x22symbol\x22,\x22date\x22];case\x20100:return[\x22shareholder\x22,\x22symbol\x22,\x22date\x22];default:return\x20null}},this.RealtimeDataToHQChartData=function(e,t){if(!e.stock||1!=e.stock.length)return\x20null;var\x20a=e.stock[0],r=(t=this.Args[0],a.date);switch(t){case\x209:return\x20a.finance?{Date:r,Value:a.finance.peruprofit}:null;case\x2018:return\x20a.finance?{Date:r,Value:a.finance.percreserve}:null;case\x2030:return\x20a.finance?{Date:r,Value:a.finance.nprofit}:null;case\x2032:return\x20a.finance?{Date:r,Value:a.finance.peruprofit}:null;case\x2033:return\x20a.finance?{Date:r,Value:a.finance.persearning}:null;case\x2034:return\x20a.finance?{Date:r,Value:a.finance.pernetasset}:null;case\x2038:return\x20a.finance?{Date:r,Value:a.finance.persearning}:null;case\x2040:return\x20a.capital?{Date:r,Value:a.capital.a*a.price}:null;case\x2041:return\x20a.capital?{Date:r,Value:a.capital.total*a.price}:null;case\x2042:if(!a.company)return\x20null;var\x20i=a.company.releasedate,n=parseInt(i/1e4),s=parseInt(i%1e4/100),u=new\x20Date(n,s-1,i%100),o=new\x20Date;return{Date:r,Value:parseInt((o.getTime()-u.getTime())/864e5)+1};case\x2043:return\x20a.dividendyield?{Date:r,Value:a.dividendyield.quarter4}:null;case\x20100:return\x20a.shareholder?{Date:r,Value:a.shareholder.count}:null;case\x22CAPITAL\x22:return\x20a.capital?{Date:r,Value:a.capital.a/100}:null;case\x22TOTALCAPITAL\x22:return\x20a.capital?{Date:r,Value:a.capital.total/100}:null}},this.ToHQChartData=function(e){if(!e.stock||1!=e.stock.length)return\x20null;var\x20t=[],a=new\x20Set,r=e.stock[0],i=this.Args[0];for(var\x20n\x20in\x20r.stockday){var\x20s=r.stockday[n],u=this.ToHQChartItemData(s,i);u&&!a.has(u.Date)&&(t.push(u),a.add(u.Date))}return\x20t},this.ToHQChartItemData=function(e,t){if(!e)return\x20null;var\x20a=e.date;switch(t){case\x201:return\x20e.capital?{Date:a,Value:e.capital.total}:null;case\x207:case\x22EXCHANGE\x22:return\x20e.capital?{Date:a,Value:e.capital.a}:null;default:return\x20null}}}function\x20DownloadGPJYValue(e){this.Url=e.Url,this.RealtimeUrl=e.RealtimeUrl,this.Job=e.Job,this.Symbol=e.Symbol,this.Args=e.Args,this.DataKey=e.DataKey,this.RecvCallback=e.Callback,this.ErrorCallback=e.ErrorCallback,this.Download=function(){var\x20e=this,t=this.GetFieldList();if(!t)return\x20message=`${this.Job.FunctionName}(${this.Args[0]},\x20${this.Args[1]},\x20${this.Args[2]})\x20can\x27t\x20support.`,this.ErrorCallback(message),void\x20e.RecvCallback(null,e.Job,e.DataKey,!0);JSNetwork.HttpRequest({url:this.Url,data:{field:t,symbol:[this.Symbol],orderfield:\x22date\x22,order:-1,start:0,end:5},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){var\x20a=e.ToHQChartData(t);a&&a.length>0&&a.sort(function(e,t){return\x20e.Date-t.Date}),e.RecvCallback(a,e.Job,e.DataKey)}})},this.GetFieldList=function(){switch(this.Args[0]){case\x201:return[\x22shareholder\x22,\x22date\x22,\x22symbol\x22];case\x202:return[\x22tradedetail.buy\x22,\x22tradedetail.sell\x22,\x22date\x22,\x22symbol\x22];case\x203:return[\x22margin\x22,\x22date\x22,\x22symbol\x22];case\x204:return[\x22blocktrading.amount\x22,\x22blocktrading.price\x22,\x22date\x22,\x22symbol\x22];default:return\x20null}},this.ToHQChartData=function(e){if(!e.stock||1!=e.stock.length)return\x20null;var\x20t=[],a=new\x20Set,r=e.stock[0],i=this.Args[0],n=this.Args[1];for(var\x20s\x20in\x20r.stockday){var\x20u=r.stockday[s],o=this.ToHQChartItemData(u,i,n);o&&!a.has(o.Date)&&(t.push(o),a.add(o.Date))}return\x20t},this.ToHQChartItemData=function(e,t,a){if(!e)return\x20null;var\x20r=e.date;switch(t){case\x201:return\x20e.shareholder?{Date:r,Value:e.shareholder.count}:null;case\x202:return!e.tradedetail&&e.tradedetail[0]?null:0==a?{Date:r,Value:e.tradedetail[0].buy}:{Date:r,Value:e.tradedetail[0].sell};case\x203:if(!e.margin)return\x20null;if(0==a){if(e.margin.buy)return{Date:r,Value:e.margin.buy.balance}}else\x20if(e.margin.sell)return{Date:r,Value:e.margin.sell.balance};return\x20null;case\x204:return\x20e.blocktrading?0==a?{Date:r,Value:e.blocktrading.price}:{Date:r,Value:e.blocktrading.amount}:null;default:return\x20null}}}ScriptIndexConsole.SetDomain=function(e,t){JSComplier.SetDomain(e,t)};var\x20enlargeminutechart=1;function\x20getlastminute(){return\x200==minutedata.length?0:minutedata[minutedata.length-1][0]}function\x20updatelastminute(t){if(minutedata.length>0)for(var\x20e=minutedata.length-1,a=e;a>=0;a--)if(minutedata[a][0]==t[0][0]){for(var\x20i=a;i<=e;i++)minutedata.pop();a=0}else\x20minutedata[a][0]<t[0][0]&&(a=0);return\x20Array.prototype.push.apply(minutedata,t),debug&&console.log(\x22minutedata\x22,minutedata),minutedata}function\x20datetime(t){var\x20e=new\x20Date(1e3*t),a=e.toTimeString(),i=e.getFullYear(),r=e.getMonth()+1,n=e.getDate();return\x20i.toString()+(r<10?\x220\x22+r:r)+(n<10?\x220\x22+n:n)+\x22\x20\x22+a.substr(0,2)+a.substr(3,2)}function\x20zoomup(t){var\x20e={};e.Index=parseInt(Math.abs(t.CursorIndex-.5).toFixed(0)),t.Frame.ZoomUp(e)&&(t.CursorIndex=e.Index,t.UpdatePointByCursorIndex(),t.UpdataDataoffset(),t.UpdateFrameMaxMin(),t.Draw(),t.ShowTooltipByKeyDown(),t.StopDragTimer())}function\x20zoomdown(t){var\x20e={};e.Index=parseInt(Math.abs(t.CursorIndex-.5).toFixed(0)),t.Frame.ZoomDown(e)&&(t.CursorIndex=e.Index,t.UpdatePointByCursorIndex(),t.UpdataDataoffset(),t.UpdateFrameMaxMin(),t.Draw(),t.ShowTooltipByKeyDown(),t.StopDragTimer())}function\x20pan(t,e,a){var\x20i=0;(i=t.Frame.XPointCount?t.Frame.XPointCount:t.Frame.SubFrame[0].Frame.XPointCount)||(i=50),(a&&t.DataMove(1e8,!0)||!a&&t.DataMove(.8*i,e))&&(t.UpdataDataoffset(),t.UpdatePointByCursorIndex(),t.UpdateFrameMaxMin(),t.ResetFrameXYSplit(),t.Draw())}if(window.minutedata=[],window.chartdata=[],!JSConsole)var\x20JSConsole={Chart:{Log:console.log},Complier:{Log:console.log}};function\x20JSChart(t,e){this.DivElement=t,this.DivToolElement=null,this.JSChartContainer,this.CanvasElement=document.createElement(\x22canvas\x22),this.CanvasElement.className=\x22jschart-drawing\x22,this.CanvasElement.id=Guid(),this.CanvasElement.setAttribute(\x22tabindex\x22,0),this.CanvasElement.style&&(this.CanvasElement.style.outline=\x22none\x22),t.hasChildNodes()&&JSConsole.Chart.Log(\x22[JSChart::JSChart]\x20divElement\x20hasChildNodes\x22,t.childNodes),t.appendChild(this.CanvasElement),this.OffscreenCanvasElement,1==e&&(this.OffscreenCanvasElement=document.createElement(\x22canvas\x22)),this.ModifyIndexDialog=new\x20ModifyIndexDialog(t),this.ChangeIndexDialog=new\x20ChangeIndexDialog(t),this.MinuteDialog=new\x20MinuteDialog(t),this.OnSize=function(t){var\x20e=parseInt(this.DivElement.style.height.replace(\x22px\x22,\x22\x22));this.ToolElement&&(e-=this.ToolElement.style.height.replace(\x22px\x22,\x22\x22)),this.CanvasElement.height=e,this.CanvasElement.width=parseInt(this.DivElement.style.width.replace(\x22px\x22,\x22\x22)),this.CanvasElement.style.width=this.CanvasElement.width+\x22px\x22,this.CanvasElement.style.height=this.CanvasElement.height+\x22px\x22;var\x20a=GetDevicePixelRatio();this.CanvasElement.height*=a,this.CanvasElement.width*=a,this.OffscreenCanvasElement&&(this.OffscreenCanvasElement.height=this.CanvasElement.height,this.OffscreenCanvasElement.width=this.CanvasElement.width),JSConsole.Chart.Log(`[JSChart::OnSize]\x20devicePixelRatio=${window.devicePixelRatio},\x20height=${this.CanvasElement.height},\x20width=${this.CanvasElement.width}`),this.JSChartContainer&&(this.JSChartContainer.OnSize&&t&&1==t.Type?this.JSChartContainer.OnSize():(this.JSChartContainer.Frame&&this.JSChartContainer.Frame.SetSizeChage(!0),this.JSChartContainer.Draw()))},this.AdjustChartBorder=function(t){var\x20e=GetDevicePixelRatio();t.Frame.ChartBorder.Left*=e,t.Frame.ChartBorder.Right*=e,t.Frame.ChartBorder.Top*=e,t.Frame.ChartBorder.Bottom*=e},this.AdjustTitleHeight=function(t){var\x20e=GetDevicePixelRatio();for(var\x20a\x20in\x20t.Frame.SubFrame)t.Frame.SubFrame[a].Frame.ChartBorder.TitleHeight*=e;t.ChartCorssCursor.TextHeight*=e},this.CreateKLineChartContainer=function(t){debug&&console.log(\x22CreateKLineChartContainer\x22,t);var\x20e=null;(e=\x22历史K线图横屏\x22===t.Type?new\x20KLineChartHScreenContainer(this.CanvasElement):new\x20KLineChartContainer(this.CanvasElement,this.OffscreenCanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),e.ModifyIndexDialog=this.ModifyIndexDialog,e.ChangeIndexDialog=this.ChangeIndexDialog,e.MinuteDialog=this.MinuteDialog,1==t.IsShowRightMenu&&(e.RightMenu=new\x20KLineRightMenu(this.DivElement)),t.ScriptError&&(e.ScriptErrorCallback=t.ScriptError),e.SelectRectRightMenu=new\x20KLineSelectRightMenu(this.DivElement),1==t.EnableScrollUpDown&&(e.EnableScrollUpDown=t.EnableScrollUpDown),1==t.DisableMouse&&(e.DisableMouse=t.DisableMouse),t.TouchMoveMinAngle&&(e.TouchMoveMinAngle=t.TouchMoveMinAngle),t.KLine&&(t.KLine.DragMode>=0&&(e.DragMode=t.KLine.DragMode),t.KLine.Right>=0&&(e.Right=t.KLine.Right),t.KLine.Period>=0&&(e.Period=t.KLine.Period),t.KLine.MaxReqeustDataCount>0&&(e.MaxReqeustDataCount=t.KLine.MaxReqeustDataCount),t.KLine.Info&&t.KLine.Info.length>0&&e.SetKLineInfo(t.KLine.Info,!1),t.KLine.IndexTreeApiUrl&&(e.ChangeIndexDialog.IndexTreeApiUrl=t.KLine.IndexTreeApiUrl),0==t.KLine.KLineDoubleClick&&(e.MinuteDialog=this.MinuteDialog=null),null!=t.KLine.IndexTreeApiUrl&&(e.ChangeIndexDialog.IndexTreeApiUrl=t.KLine.IndexTreeApiUrl),0==t.KLine.IsShowTooltip&&(e.IsShowTooltip=!1),t.KLine.MaxRequestMinuteDayCount>0&&(e.MaxRequestMinuteDayCount=t.KLine.MaxRequestMinuteDayCount),t.KLine.DrawType&&(e.KLineDrawType=t.KLine.DrawType),t.KLine.FirstShowDate>19910101&&(e.CustomShow={Date:t.KLine.FirstShowDate,PageSize:t.KLine.PageSize}),t.KLine.RightSpaceCount>0&&(e.RightSpaceCount=t.KLine.RightSpaceCount),t.KLine.ZoomType>0&&(e.ZoomType=t.KLine.ZoomType),t.KLine.DataWidth>=1&&(e.KLineSize={DataWidth:t.KLine.DataWidth})),t.EnableFlowCapital)&&(1==(i=t.EnableFlowCapital).BIT&&(e.EnableFlowCapital.BIT=i.BIT));if(IFrameSplitOperator.IsBool(t.EnableBorderDrag)&&(e.EnableBorderDrag=t.EnableBorderDrag),t.Page&&(t.Page.Day&&1==t.Page.Day.Enable&&(e.Page.Day.Enable=!0),t.Page.Minute&&1==t.Page.Minute.Enable&&(e.Page.Minute.Enable=!0)),t.DragDownload&&(t.DragDownload.Day&&1==t.DragDownload.Day.Enable&&(e.DragDownload.Day.Enable=!0),t.DragDownload.Minute&&1==t.DragDownload.Minute.Enable&&(e.DragDownload.Minute.Enable=!0)),t.Language&&(\x22CN\x22===t.Language?e.LanguageID=JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID:\x22EN\x22===t.Language&&(e.LanguageID=JSCHART_LANGUAGE_ID.LANGUAGE_ENGLISH_ID)),t.SourceDatatLimit&&e.SetSourceDatatLimit(t.SourceDatatLimit),t.DrawPicture&&t.DrawPicture.StorageKey&&e.ChartDrawStorage&&e.ChartDrawStorage.Load(t.DrawPicture.StorageKey),t.DrawTool&&t.DrawTool.StorageKey&&e.ChartDrawStorage&&e.ChartDrawStorage.Load(t.DrawTool.StorageKey),t.StepPixel>0&&(e.StepPixel=t.StepPixel),t.ZoomStepPixel>0&&(e.ZoomStepPixel=t.ZoomStepPixel),1==t.IsApiPeriod&&(e.IsApiPeriod=t.IsApiPeriod),!t.Windows||t.Windows.length<=0)return\x20null;if(e.Create(t.Windows.length,t.Listener),t.Border&&(IFrameSplitOperator.IsNumber(t.Border.Left)?e.Frame.ChartBorder.Left=t.Border.Left:t.Border.Left=e.Frame.ChartBorder.Left,IFrameSplitOperator.IsNumber(t.Border.Right)?e.Frame.ChartBorder.Right=t.Border.Right:t.Border.Right=e.Frame.ChartBorder.Right,IFrameSplitOperator.IsNumber(t.Border.Top)?e.Frame.ChartBorder.Top=t.Border.Top:t.Border.Top=e.Frame.ChartBorder.Top,IFrameSplitOperator.IsNumber(t.Border.Bottom)?e.Frame.ChartBorder.Bottom=t.Border.Bottom:t.Border.Bottom=e.Frame.ChartBorder.Bottom),this.AdjustChartBorder(e),t.KLine&&t.KLine.PageSize>0){let\x20a=e.GetMaxMinPageSize();a.Max>10&&a.Max<t.KLine.PageSize?e.PageSize=a.Max:a.Min>10&&a.Min>t.KLine.PageSize?e.PageSize=a.Min:e.PageSize=t.KLine.PageSize}if(!0===t.IsCorssOnlyDrawKLine&&(e.ChartCorssCursor.IsOnlyDrawKLine=t.IsCorssOnlyDrawKLine),!0===t.CorssCursorTouchEnd&&(e.CorssCursorTouchEnd=t.CorssCursorTouchEnd),1==t.IsClickShowCorssCursor&&(e.IsClickShowCorssCursor=t.IsClickShowCorssCursor),t.CorssCursorInfo&&(isNaN(t.CorssCursorInfo.Left)||(e.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(e.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(e.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(e.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),1==t.CorssCursorInfo.IsShowClose&&(e.ChartCorssCursor.IsShowClose=t.CorssCursorInfo.IsShowClose),t.CorssCursorInfo.PressTime&&(e.PressTime=t.CorssCursorInfo.PressTime),t.CorssCursorInfo.HPenType>0&&(e.ChartCorssCursor.HPenType=t.CorssCursorInfo.HPenType),t.CorssCursorInfo.VPenType>0&&(e.ChartCorssCursor.VPenType=t.CorssCursorInfo.VPenType),t.CorssCursorInfo.DateFormatType>0&&(e.ChartCorssCursor.StringFormatX.DateFormatType=t.CorssCursorInfo.DateFormatType)),t.CorssCursor={},t.CorssCursor.TitleHeight=e.ChartCorssCursor.TextHeight,IFrameSplitOperator.IsObjectExist(t.SplashTitle)&&(e.ChartSplashPaint.SplashTitle=t.SplashTitle),t.Frame)for(var\x20a\x20in\x20t.Frame){var\x20i=t.Frame[a];e.Frame.SubFrame[a]&&(i.SplitCount&&(e.Frame.SubFrame[a].Frame.YSplitOperator.SplitCount=i.SplitCount),i.StringFormat&&(e.Frame.SubFrame[a].Frame.YSplitOperator.StringFormat=i.StringFormat),IFrameSplitOperator.IsNumber(i.FloatPrecision)&&(e.Frame.SubFrame[a].Frame.YSplitOperator.FloatPrecision=i.FloatPrecision),i.Custom&&(e.Frame.SubFrame[a].Frame.YSplitOperator.Custom=i.Custom),IFrameSplitOperator.IsNumber(i.SplitType)&&(e.Frame.SubFrame[a].Frame.YSplitOperator.SplitType=i.SplitType),isNaN(i.Height)||(e.Frame.SubFrame[a].Height=i.Height),!1!==i.IsShowLeftText&&!0!==i.IsShowLeftText||(e.Frame.SubFrame[a].Frame.IsShowYText[0]=i.IsShowLeftText,e.Frame.SubFrame[a].Frame.YSplitOperator.IsShowLeftText=i.IsShowLeftText),!1!==i.IsShowRightText&&!0!==i.IsShowRightText||(e.Frame.SubFrame[a].Frame.IsShowYText[1]=i.IsShowRightText,e.Frame.SubFrame[a].Frame.YSplitOperator.IsShowRightText=i.IsShowRightText),i.TopSpace>=0&&(e.Frame.SubFrame[a].Frame.ChartBorder.TopSpace=i.TopSpace),i.BottomSpace>=0&&(e.Frame.SubFrame[a].Frame.ChartBorder.BottomSpace=i.BottomSpace),i.RightTextPosition>0&&(e.Frame.SubFrame[a].Frame.YTextPosition[1]=i.RightTextPosition),i.LeftTextPosition>0&&(e.Frame.SubFrame[a].Frame.YTextPosition[0]=i.LeftTextPosition),0==i.IsShowXLine&&(e.Frame.SubFrame[a].Frame.IsShowXLine=i.IsShowXLine),0==i.IsShowYLine&&(e.Frame.SubFrame[a].Frame.IsShowYLine=i.IsShowYLine),i.YCoordinateType>0&&(e.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=i.YCoordinateType),1==i.IsYReverse&&(e.Frame.SubFrame[0].Frame.CoordinateType=1),i.DefaultYMaxMin&&(e.Frame.SubFrame[a].Frame.YSplitOperator.DefaultYMaxMin=i.DefaultYMaxMin),IFrameSplitOperator.IsBool(i.EnableRemoveZero)&&(e.Frame.SubFrame[a].Frame.YSplitOperator.EnableRemoveZero=i.EnableRemoveZero),IFrameSplitOperator.IsPlusNumber(i.MinYDistance)&&(e.Frame.SubFrame[a].Frame.MinYDistance=i.MinYDistance),IFrameSplitOperator.IsNumber(i.BorderLine)&&(e.Frame.SubFrame[a].Frame.BorderLine=i.BorderLine))}if(t.KLine&&(0==t.KLine.ShowKLine&&(e.ChartPaint[0].IsShow=!1),t.KLine.InfoPosition>0&&(e.ChartPaint[0].InfoPosition=t.KLine.InfoPosition),0==t.KLine.IsShowMaxMinPrice&&(e.ChartPaint[0].IsShowMaxMinPrice=t.KLine.IsShowMaxMinPrice)),t.KLineTitle&&(0==t.KLineTitle.IsShowName&&(e.TitlePaint[0].IsShowName=!1),0==t.KLineTitle.IsShowSettingInfo&&(e.TitlePaint[0].IsShowSettingInfo=!1),0==t.KLineTitle.IsShow&&(e.TitlePaint[0].IsShow=!1)),t.Overlay)for(var\x20a\x20in\x20t.Overlay){i=t.Overlay[a];e.OverlaySymbol(i.Symbol,i)}if(t.ExtendChart)for(var\x20a\x20in\x20t.ExtendChart){i=t.ExtendChart[a];e.CreateExtendChart(i.Name,i)}let\x20r=new\x20JSIndexScript;if(t.ColorIndex){i=t.ColorIndex;let\x20a=r.Get(i.Index);a&&(a.ID=i.Index,e.ColorIndex=new\x20ScriptIndex(a.Name,a.Script,a.Args,a))}if(t.TradeIndex){i=t.TradeIndex;let\x20a=r.Get(i.Index);a&&(a.ID=i.Index,e.TradeIndex=new\x20ScriptIndex(a.Name,a.Script,a.Args,a))}for(var\x20a\x20in\x20t.Windows){if((i=t.Windows[a]).Script)e.WindowIndex[a]=new\x20ScriptIndex(i.Name,i.Script,i.Args,i);else\x20if(i.JsonData)e.WindowIndex[a]=new\x20JsonDataIndex(i.Name,i.Script,i.Args,i);else\x20if(i.Local&&i.Local.Data)e.WindowIndex[a]=new\x20LocalJsonDataIndex(i.Local.Name,i.Local.Args,{JsonData:i.Local.Data});else\x20if(i.API){var\x20n=i.API;e.WindowIndex[a]=new\x20APIScriptIndex(n.Name,n.Script,n.Args,i)}else{let\x20t=JSIndexMap.Get(i.Index);if(t)e.WindowIndex[a]=t.Create(),e.CreateWindowIndex(a);else{let\x20t=r.Get(i.Index);if(!t)continue;i.Lock&&(t.Lock=i.Lock),t.ID=i.Index;var\x20s=t.Args;i.Args&&(s=i.Args),i.IsShortTitle&&(t.IsShortTitle=i.IsShortTitle),i.TitleFont&&(t.TitleFont=i.TitleFont),e.WindowIndex[a]=new\x20ScriptIndex(t.Name,t.Script,s,t),i.StringFormat>0&&(e.WindowIndex[a].StringFormat=i.StringFormat),i.FloatPrecision>=0&&(e.WindowIndex[a].FloatPrecision=i.FloatPrecision)}}null!=i.Modify&&(e.Frame.SubFrame[a].Frame.ModifyIndex=i.Modify),null!=i.Change&&(e.Frame.SubFrame[a].Frame.ChangeIndex=i.Change),null!=i.Close&&(e.Frame.SubFrame[a].Frame.CloseIndex=i.Close),null!=i.Overlay&&(e.Frame.SubFrame[a].Frame.OverlayIndex=i.Overlay),1==i.IsDrawTitleBG&&(e.Frame.SubFrame[a].Frame.IsDrawTitleBG=i.IsDrawTitleBG),IFrameSplitOperator.IsNumber(i.TitleHeight)?e.Frame.SubFrame[a].Frame.ChartBorder.TitleHeight=i.TitleHeight:i.TitleHeight=e.Frame.SubFrame[a].Frame.ChartBorder.TitleHeight,0==i.IsShowTitleArraw&&(e.Frame.SubFrame[a].Frame.IsShowTitleArraw=!1),0==i.IsShowIndexName&&(e.Frame.SubFrame[a].Frame.IsShowIndexName=!1),i.IndexParamSpace>=0&&(e.Frame.SubFrame[a].Frame.IndexParamSpace=i.IndexParamSpace)}for(var\x20a\x20in\x20t.OverlayIndexFrameWidth>40&&(e.OverlayIndexFrameWidth=t.OverlayIndexFrameWidth),t.OverlayIndex){if(!((i=t.OverlayIndex[a]).Windows>=e.Frame.SubFrame.length)){var\x20o=JSON.stringify(i),h=JSON.parse(o);i.Index&&(h.IndexName=i.Index),i.Windows>=0&&(h.WindowIndex=i.Windows),e.CreateOverlayWindowsIndex(h)}}return\x20this.AdjustTitleHeight(e),e},this.CreateCustomKLineChartContainer=function(t){var\x20e=new\x20CustomKLineChartContainer(this.CanvasElement);if(e.ModifyIndexDialog=this.ModifyIndexDialog,e.ChangeIndexDialog=this.ChangeIndexDialog,e.MinuteDialog=this.MinuteDialog,1==t.IsShowRightMenu&&(e.RightMenu=new\x20KLineRightMenu(this.DivElement)),t.KLine&&(t.KLine.DragMode>=0&&(e.DragMode=t.KLine.DragMode),t.KLine.Right>=0&&(e.Right=t.KLine.Right),t.KLine.Period>=0&&(e.Period=t.KLine.Period),t.KLine.MaxReqeustDataCount>0&&(e.MaxReqeustDataCount=t.KLine.MaxReqeustDataCount),t.KLine.Info&&t.KLine.Info.length>0&&e.SetKLineInfo(t.KLine.Info,!1),t.KLine.IndexTreeApiUrl&&(e.ChangeIndexDialog.IndexTreeApiUrl=t.KLine.IndexTreeApiUrl),0==t.KLine.KLineDoubleClick&&(e.MinuteDialog=this.MinuteDialog=null),null!=t.KLine.IndexTreeApiUrl&&(e.ChangeIndexDialog.IndexTreeApiUrl=t.KLine.IndexTreeApiUrl),t.KLine.PageSize>0&&(e.PageSize=t.KLine.PageSize),0==t.KLine.IsShowTooltip&&(e.IsShowTooltip=!1)),t.CustomStock&&(e.CustomStock=t.CustomStock),t.QueryDate&&(e.QueryDate=t.QueryDate),!t.Windows||t.Windows.length<=0)return\x20null;if(e.Create(t.Windows.length),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top)),0==t.IsShowCorssCursorInfo&&(e.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),t.Frame)for(var\x20a\x20in\x20t.Frame){(r=t.Frame[a]).SplitCount&&(e.Frame.SubFrame[a].Frame.YSplitOperator.SplitCount=r.SplitCount),r.StringFormat&&(e.Frame.SubFrame[a].Frame.YSplitOperator.StringFormat=r.StringFormat)}t.KLineTitle&&(0==t.KLineTitle.IsShowName&&(e.TitlePaint[0].IsShowName=!1),0==t.KLineTitle.IsShowSettingInfo&&(e.TitlePaint[0].IsShowSettingInfo=!1));let\x20i=new\x20JSIndexScript;for(var\x20a\x20in\x20t.Windows){var\x20r;if((r=t.Windows[a]).Script)e.WindowIndex[a]=new\x20ScriptIndex(r.Name,r.Script,r.Args,r);else{let\x20t=JSIndexMap.Get(r.Index);if(t)e.WindowIndex[a]=t.Create(),e.CreateWindowIndex(a);else{let\x20t=i.Get(r.Index);if(!t)continue;r.Lock&&(t.Lock=r.Lock),e.WindowIndex[a]=new\x20ScriptIndex(t.Name,t.Script,t.Args,t)}}null!=r.Modify&&(e.Frame.SubFrame[a].Frame.ModifyIndex=r.Modify),null!=r.Change&&(e.Frame.SubFrame[a].Frame.ChangeIndex=r.Change),isNaN(r.TitleHeight)||(e.Frame.SubFrame[a].Frame.ChartBorder.TitleHeight=r.TitleHeight)}return\x20e},this.CreateMinuteChartContainer=function(t){var\x20e=null;e=\x22分钟走势图横屏\x22===t.Type?new\x20MinuteChartHScreenContainer(this.CanvasElement):new\x20MinuteChartContainer(this.CanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),e.ModifyIndexDialog=this.ModifyIndexDialog,e.ChangeIndexDialog=this.ChangeIndexDialog;var\x20a=2;if(t.Windows&&t.Windows.length>0&&(a+=t.Windows.length),1==t.EnableScrollUpDown&&(e.EnableScrollUpDown=t.EnableScrollUpDown),1==t.DisableMouse&&(e.DisableMouse=t.DisableMouse),t.ScriptError&&(e.ScriptErrorCallback=t.ScriptError),t.Minute&&0==t.Minute.IsShowTooltip&&(e.IsShowTooltip=!1),t.Language&&(\x22CN\x22===t.Language?e.LanguageID=JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID:\x22EN\x22===t.Language&&(e.LanguageID=JSCHART_LANGUAGE_ID.LANGUAGE_ENGLISH_ID)),t.Info&&t.Info.length>0&&e.SetMinuteInfo(t.Info,!1),t.DrawTool&&t.DrawTool.StorageKey&&e.ChartDrawStorage&&e.ChartDrawStorage.Load(t.DrawTool.StorageKey),e.Create(a,t.Listener),t.CorssCursorInfo&&(isNaN(t.CorssCursorInfo.Left)||(e.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(e.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(e.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(e.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),t.CorssCursorInfo.RightTextFormat>0&&(e.ChartCorssCursor.TextFormat.Right=t.CorssCursorInfo.RightTextFormat),1==t.CorssCursorInfo.IsOnlyDrawMinute&&(e.ChartCorssCursor.IsOnlyDrawMinute=t.CorssCursorInfo.IsOnlyDrawMinute)),t.MinuteInfo&&e.CreateMinuteInfo(t.MinuteInfo),1==t.IsShowRightMenu&&(e.RightMenu=new\x20MinuteRightMenu(this.DivElement)),t.DayCount>1&&(e.DayCount=t.DayCount),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(e.Frame.ChartBorder.Bottom=t.Border.Bottom)),t.SplashTitle&&(e.ChartSplashPaint.SplashTitle=t.SplashTitle),IFrameSplitOperator.IsBool(t.EnableBorderDrag)&&(e.EnableBorderDrag=t.EnableBorderDrag),this.AdjustChartBorder(e),t.Frame){for(var\x20i\x20in\x20t.Frame){var\x20r=t.Frame[i];e.Frame.SubFrame[i]&&(r.SplitCount&&(e.Frame.SubFrame[i].Frame.YSplitOperator.SplitCount=r.SplitCount),r.StringFormat&&(e.Frame.SubFrame[i].Frame.YSplitOperator.StringFormat=r.StringFormat),0==r.IsShowLeftText&&(e.Frame.SubFrame[i].Frame.IsShowYText[0]=r.IsShowLeftText,e.Frame.SubFrame[i].Frame.YSplitOperator.IsShowLeftText=r.IsShowLeftText),0==r.IsShowRightText&&(e.Frame.SubFrame[i].Frame.IsShowYText[1]=r.IsShowRightText,e.Frame.SubFrame[i].Frame.YSplitOperator.IsShowRightText=r.IsShowRightText),r.Height>=0&&(e.Frame.SubFrame[i].Height=r.Height),r.Custom&&(e.Frame.SubFrame[i].Frame.YSplitOperator.Custom=r.Custom),r.RightTextFormat>0&&(e.Frame.SubFrame[i].Frame.YSplitOperator.RightTextFormat=r.RightTextFormat),IFrameSplitOperator.IsNumber(r.BorderLine)&&(e.Frame.SubFrame[i].Frame.BorderLine=r.BorderLine))}e.UpdateXShowText()}if(t.ExtendChart)for(var\x20i\x20in\x20t.ExtendChart){r=t.ExtendChart[i];e.CreateExtendChart(r.Name,r)}if(t.Overlay)for(var\x20i\x20in\x20t.Overlay){r=t.Overlay[i];e.OverlaySymbol(r.Symbol,r)}if(t.MinuteLine&&(0==t.MinuteLine.IsDrawAreaPrice&&(e.ChartPaint[0].IsDrawArea=!1),0==t.MinuteLine.IsShowLead&&(e.IsShowLead=!1),0==t.MinuteLine.IsShowAveragePrice&&(e.ChartPaint[1].IsShow=!1,e.TitlePaint[0].IsShowAveragePrice=!1),t.MinuteLine.SplitType>0&&(e.Frame.SubFrame[0].Frame.YSplitOperator.SplitType=t.MinuteLine.SplitType)),t.MinuteTitle){r=t.MinuteTitle;IFrameSplitOperator.IsBool(r.IsShowName)&&(e.TitlePaint[0].IsShowName=r.IsShowName),IFrameSplitOperator.IsBool(r.IsShowDate)&&(e.TitlePaint[0].IsShowDate=r.IsShowDate),IFrameSplitOperator.IsBool(r.IsShowTime)&&(e.TitlePaint[0].IsShowTime=r.IsShowTime)}!0===t.CorssCursorTouchEnd&&(e.CorssCursorTouchEnd=t.CorssCursorTouchEnd),!0===t.IsShowBeforeData&&(e.IsShowBeforeData=t.IsShowBeforeData);let\x20n=new\x20JSIndexScript;for(var\x20i\x20in\x20t.Windows){var\x20s=2+parseInt(i);if((r=t.Windows[i]).Script)e.WindowIndex[s]=new\x20ScriptIndex(r.Name,r.Script,r.Args);else\x20if(r.API){var\x20o=r.API;e.WindowIndex[s]=new\x20APIScriptIndex(o.Name,o.Script,o.Args,r)}else{var\x20h=JSIndexMap.Get(r.Index);if(h)e.WindowIndex[s]=h.Create(),e.CreateWindowIndex(s);else{let\x20t=n.Get(r.Index);if(!t)continue;t.ID=r.Index;var\x20l=t.Args;r.Args&&(l=r.Args),e.WindowIndex[s]=new\x20ScriptIndex(t.Name,t.Script,l,t),r.StringFormat>0&&(e.WindowIndex[s].StringFormat=r.StringFormat),r.FloatPrecision>=0&&(e.WindowIndex[s].FloatPrecision=r.FloatPrecision)}}null!=r.Modify&&(e.Frame.SubFrame[s].Frame.ModifyIndex=r.Modify),null!=r.Change&&(e.Frame.SubFrame[s].Frame.ChangeIndex=r.Change),null!=r.Close&&(e.Frame.SubFrame[s].Frame.CloseIndex=r.Close),isNaN(r.TitleHeight)||(e.Frame.SubFrame[s].Frame.ChartBorder.TitleHeight=r.TitleHeight)}if(this.AdjustTitleHeight(e),t.Function){var\x20C=t.Function;C.RequestMinuteData&&(e.RequestMinuteData=C.RequestMinuteData),C.RecvMinuteData&&(e.RecvMinuteData=C.RecvMinuteData)}return\x20e},this.CreateHistoryMinuteChartContainer=function(t){var\x20e=new\x20HistoryMinuteChartContainer(this.CanvasElement),a=2;t.Windows&&t.Windows.length>0&&(a+=t.Windows.length),e.Create(a),0==t.IsShowCorssCursorInfo&&(e.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(e.Frame.ChartBorder.Bottom=t.Border.Bottom));let\x20i=new\x20JSIndexScript;for(var\x20r\x20in\x20t.Windows){var\x20n=t.Windows[r];if(n.Script)e.WindowIndex[2+parseInt(r)]=new\x20ScriptIndex(n.Name,n.Script,n.Args);else{var\x20s=JSIndexMap.Get(n.Index);if(s)e.WindowIndex[2+parseInt(r)]=s.Create(),e.CreateWindowIndex(2+parseInt(r));else{let\x20t=i.Get(n.Index);if(!t)continue;e.WindowIndex[2+parseInt(r)]=new\x20ScriptIndex(t.Name,t.Script,t.Args)}}isNaN(n.TitleHeight)||(e.Frame.SubFrame[2+parseInt(r)].Frame.ChartBorder.TitleHeight=n.TitleHeight)}return\x20e.TradeDate=20181009,t.HistoryMinute.TradeDate&&(e.TradeDate=t.HistoryMinute.TradeDate),null!=t.HistoryMinute.IsShowName&&(e.TitlePaint[0].IsShowName=t.HistoryMinute.IsShowName),null!=t.HistoryMinute.IsShowDate&&(e.TitlePaint[0].IsShowDate=t.HistoryMinute.IsShowDate),e},this.CreateKLineTrainChartContainer=function(t){var\x20e=\x22K线训练横屏\x22==t.Type,a=new\x20KLineTrainChartContainer(this.CanvasElement,e);if(t.NetworkFilter&&(a.NetworkFilter=t.NetworkFilter),1==t.IsApiPeriod&&(a.IsApiPeriod=t.IsApiPeriod),a.ModifyIndexDialog=this.ModifyIndexDialog,a.ChangeIndexDialog=this.ChangeIndexDialog,t.ScriptError&&(a.ScriptErrorCallback=t.ScriptError),t.KLine&&(t.KLine.Right>=0&&(a.Right=t.KLine.Right),t.KLine.Period>=0&&(a.Period=t.KLine.Period),t.KLine.MaxReqeustDataCount>0&&(a.MaxReqeustDataCount=t.KLine.MaxReqeustDataCount),t.KLine.Info&&t.KLine.Info.length>0&&a.SetKLineInfo(t.KLine.Info,!1),t.KLine.PageSize>0&&(a.PageSize=t.KLine.PageSize),0==t.KLine.IsShowTooltip&&(a.IsShowTooltip=!1),t.KLine.MaxRequestMinuteDayCount>0&&(a.MaxRequestMinuteDayCount=t.KLine.MaxRequestMinuteDayCount),t.KLine.DrawType&&(a.KLineDrawType=t.KLine.DrawType),t.KLine.RightSpaceCount>0&&(a.RightSpaceCount=t.KLine.RightSpaceCount)),t.Train&&(t.Train.DataCount&&(a.TrainDataCount=t.Train.DataCount),t.Train.Callback&&(a.TrainCallback=t.Train.Callback),t.Train.StartDate&&(a.TrainStartDate=t.Train.StartDate)),!t.Windows||t.Windows.length<=0)return\x20null;if(a.Create(t.Windows.length),t.Border&&(isNaN(t.Border.Left)||(a.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(a.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(a.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(a.Frame.ChartBorder.Bottom=t.Border.Bottom)),this.AdjustChartBorder(a),0==t.IsShowCorssCursorInfo&&(a.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),!0===t.IsCorssOnlyDrawKLine&&(a.ChartCorssCursor.IsOnlyDrawKLine=t.IsCorssOnlyDrawKLine),!0===t.CorssCursorTouchEnd&&(a.CorssCursorTouchEnd=t.CorssCursorTouchEnd),1==t.IsClickShowCorssCursor&&(a.IsClickShowCorssCursor=t.IsClickShowCorssCursor),t.CorssCursorInfo&&(isNaN(t.CorssCursorInfo.Left)||(a.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(a.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(a.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(a.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),1==t.CorssCursorInfo.IsShowClose&&(a.ChartCorssCursor.IsShowClose=t.CorssCursorInfo.IsShowClose),t.CorssCursorInfo.PressTime&&(a.PressTime=t.CorssCursorInfo.PressTime),t.CorssCursorInfo.HPenType>0&&(a.ChartCorssCursor.HPenType=t.CorssCursorInfo.HPenType),t.CorssCursorInfo.VPenType>0&&(a.ChartCorssCursor.VPenType=t.CorssCursorInfo.VPenType)),t.CorssCursor={},t.CorssCursor.TitleHeight=a.ChartCorssCursor.TextHeight,t.Frame)for(var\x20i\x20in\x20t.Frame){var\x20r=t.Frame[i];a.Frame.SubFrame[i]&&(r.SplitCount&&(a.Frame.SubFrame[i].Frame.YSplitOperator.SplitCount=r.SplitCount),r.StringFormat&&(a.Frame.SubFrame[i].Frame.YSplitOperator.StringFormat=r.StringFormat),IFrameSplitOperator.IsNumber(r.FloatPrecision)&&(a.Frame.SubFrame[i].Frame.YSplitOperator.FloatPrecision=r.FloatPrecision),r.Custom&&(a.Frame.SubFrame[i].Frame.YSplitOperator.Custom=r.Custom),IFrameSplitOperator.IsNumber(r.SplitType)&&(a.Frame.SubFrame[i].Frame.YSplitOperator.SplitType=r.SplitType),r.Height>0&&(a.Frame.SubFrame[i].Height=r.Height),0==r.IsShowLeftText&&(a.Frame.SubFrame[i].Frame.YSplitOperator.IsShowLeftText=r.IsShowLeftText),0==r.IsShowRightText&&(a.Frame.SubFrame[i].Frame.YSplitOperator.IsShowRightText=r.IsShowRightText))}if(t.KLine&&(0==t.KLine.ShowKLine&&(a.ChartPaint[0].IsShow=!1),t.KLine.InfoPosition>0&&(a.ChartPaint[0].InfoPosition=t.KLine.InfoPosition),0==t.KLine.IsShowMaxMinPrice&&(a.ChartPaint[0].IsShowMaxMinPrice=t.KLine.IsShowMaxMinPrice)),t.KLineTitle&&(0==t.KLineTitle.IsShowName&&(a.TitlePaint[0].IsShowName=!1),0==t.KLineTitle.IsShowSettingInfo&&(a.TitlePaint[0].IsShowSettingInfo=!1),0==t.KLineTitle.IsShow&&(a.TitlePaint[0].IsShow=!1)),t.ExtendChart)for(var\x20i\x20in\x20t.ExtendChart){r=t.ExtendChart[i];a.CreateExtendChart(r.Name,r)}let\x20n=new\x20JSIndexScript;for(var\x20i\x20in\x20t.Windows){if((r=t.Windows[i]).Script)a.WindowIndex[i]=new\x20ScriptIndex(r.Name,r.Script,r.Args,r);else{let\x20t=JSIndexMap.Get(r.Index);if(t)a.WindowIndex[i]=t.Create(),a.CreateWindowIndex(i);else{let\x20t=n.Get(r.Index);if(!t)continue;r.Lock&&(t.Lock=r.Lock),a.WindowIndex[i]=new\x20ScriptIndex(t.Name,t.Script,t.Args,t)}}null!=r.Modify&&(a.Frame.SubFrame[i].Frame.ModifyIndex=r.Modify),null!=r.Change&&(a.Frame.SubFrame[i].Frame.ChangeIndex=r.Change),null!=r.Close&&(a.Frame.SubFrame[i].Frame.CloseIndex=r.Close),isNaN(r.TitleHeight)||(a.Frame.SubFrame[i].Frame.ChartBorder.TitleHeight=r.TitleHeight)}return\x20this.AdjustTitleHeight(a),a},this.SetOption=function(t){debug&&console.log(\x22------------------------------------------SetOption-------------------------------\x22,t);var\x20e=null;switch(t.Type){case\x22历史K线图\x22:case\x22历史K线图横屏\x22:e=this.CreateKLineChartContainer(t),window.chartdata.Kchart=e;break;case\x22自定义指数历史K线图\x22:e=this.CreateCustomKLineChartContainer(t);break;case\x22分钟走势图\x22:case\x22分钟走势图横屏\x22:e=this.CreateMinuteChartContainer(t),window.chartdata.Mchart=e;break;case\x22历史分钟走势图\x22:e=this.CreateHistoryMinuteChartContainer(t);break;case\x22K线训练\x22:case\x22K线训练横屏\x22:e=this.CreateKLineTrainChartContainer(t);break;case\x22简单图形\x22:return\x20this.CreateSimpleChart(t);case\x22饼图\x22:case\x22雷达图\x22:return\x20this.CreatePieChart(t);case\x22地图\x22:return\x20this.CreateMapChart(t);default:return!1}if(!e)return!1;for(var\x20a\x20in\x20null!=t.IsAutoUpdate&&(e.IsAutoUpdate=t.IsAutoUpdate),t.AutoUpdateFrequency>0&&(e.AutoUpdateFrequency=t.AutoUpdateFrequency),t.EventCallback){var\x20i=t.EventCallback[a];e.AddEventCallback(i)}t.Symbol?(e.Draw(),e.ChangeSymbol(t.Symbol),this.JSChartContainer=e,this.DivElement.JSChart=this,this.JSChartContainer.Draw()):(e.DrawEmpty(),this.JSChartContainer=e,this.DivElement.JSChart=this)},this.CreateSimpleChart=function(t){var\x20e=new\x20SimlpleChartContainer(this.CanvasElement);t.MainDataControl&&(e.MainDataControl=t.MainDataControl),e.Create(),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top)),e.Draw(),e.RequestData(),this.JSChartContainer=e,this.DivElement.JSChart=this,this.JSChartContainer.Draw()},this.CreatePieChart=function(t){var\x20e=new\x20PieChartContainer(this.CanvasElement);t.MainDataControl&&(e.MainDataControl=t.MainDataControl),t.Radius&&(e.Radius=t.Radius),e.Create(),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top)),this.AdjustChartBorder(e),t.Frame&&0==t.Frame[0].IsShowBorder&&(e.Frame.IsShowBorder=t.Frame[0].IsShowBorder),e.Draw(),e.RequestData(),this.JSChartContainer=e,this.DivElement.JSChart=this,this.JSChartContainer.Draw()},this.CreateMapChart=function(t){var\x20e=new\x20MapChartContainer(this.CanvasElement);t.MainDataControl&&(e.MainDataControl=t.MainDataControl),e.Create(),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top)),e.Draw(),e.RequestData(),this.JSChartContainer=e,this.DivElement.JSChart=this,this.JSChartContainer.Draw()},this.CreateToolbar=function(t){},this.CreateSettingDiv=function(t){},this.Focus=function(){this.CanvasElement&&this.CanvasElement.focus()},this.ChangeSymbol=function(t){this.JSChartContainer&&this.JSChartContainer.ChangeSymbol(t)},this.ChangeIndex=function(t,e,a){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ChangeIndex&&this.JSChartContainer.ChangeIndex(t,e,a)},this.ChangeScriptIndex=function(t,e,a){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ChangeScriptIndex&&this.JSChartContainer.ChangeScriptIndex(t,e,a)},this.ChangePyScriptIndex=function(t,e){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ChangePyScriptIndex&&this.JSChartContainer.ChangePyScriptIndex(t,e)},this.GetIndexInfo=function(){return\x20this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.GetIndexInfo?this.JSChartContainer.GetIndexInfo():[]},this.ChangeInstructionIndex=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ChangeInstructionIndex&&this.JSChartContainer.ChangeInstructionIndex(t)},this.ChangeInstructionScriptIndex=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ChangeInstructionIndex&&this.JSChartContainer.ChangeInstructionScriptIndex(t)},this.CancelInstructionIndex=function(){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.CancelInstructionIndex&&this.JSChartContainer.CancelInstructionIndex()},this.ChangePeriod=function(t,e){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ChangePeriod&&this.JSChartContainer.ChangePeriod(t,e)},this.ChangeRight=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ChangeRight&&this.JSChartContainer.ChangeRight(t)},this.OverlaySymbol=function(t,e){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.OverlaySymbol&&this.JSChartContainer.OverlaySymbol(t,e)},this.DeleteOverlaySymbol=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.DeleteOverlaySymbol&&this.JSChartContainer.DeleteOverlaySymbol(t)},this.SetFirstShowDate=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.SetFirstShowDate&&this.JSChartContainer.SetFirstShowDate(t)},this.ChangeKLineDrawType=function(t,e){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ChangeKLineDrawType&&this.JSChartContainer.ChangeKLineDrawType(t,e)},this.ChangeIndexWindowCount=function(t,e){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ChangeIndexWindowCount&&this.JSChartContainer.ChangeIndexWindowCount(t,e)},this.ClearOverlaySymbol=function(){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ClearOverlaySymbol&&this.JSChartContainer.ClearOverlaySymbol()},this.DeleteKLineInfo=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.DeleteKLineInfo&&this.JSChartContainer.DeleteKLineInfo(t)},this.ClearKLineInfo=function(){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ClearKLineInfo&&this.JSChartContainer.ClearKLineInfo()},this.AddKLineInfo=function(t,e){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.AddKLineInfo&&this.JSChartContainer.AddKLineInfo(t,e)},this.ChangMainDataControl=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.SetMainDataConotrl&&this.JSChartContainer.SetMainDataConotrl(t)},this.AddOverlayIndex=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.AddOverlayIndex&&this.JSChartContainer.AddOverlayIndex(t)},this.DeleteOverlayWindowsIndex=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.DeleteOverlayWindowsIndex&&this.JSChartContainer.DeleteOverlayWindowsIndex(t)},this.StopAutoUpdate=function(){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.StopAutoUpdate&&this.JSChartContainer.StopAutoUpdate()},this.SetDepthMapData=function(t,e){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.SetDepthMapData&&this.JSChartContainer.SetDepthMapData(t,e)},this.ForceLandscape=function(t){this.JSChartContainer&&(JSConsole.Chart.Log(\x22[JSChart::ForceLandscape]\x20bForceLandscape=\x22+t),this.JSChartContainer.IsForceLandscape=t)},this.LockIndex=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.LockIndex&&(JSConsole.Chart.Log(\x22[JSChart:LockIndex]\x20lockData\x22,t),this.JSChartContainer.LockIndex(t))},this.ChangeTradeDate=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ChangeTradeDate&&(JSConsole.Chart.Log(\x22[JSChart:ChangeTradeDate]\x20date\x22,t),this.JSChartContainer.ChangeTradeDate(t))},this.ChangeDayCount=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ChangeDayCount&&(JSConsole.Chart.Log(\x22[JSChart:ChangeDayCount]\x20count\x22,t),this.JSChartContainer.ChangeDayCount(t))},this.StartAnimation=function(t){if(this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.StartAnimation)return\x20JSConsole.Chart.Log(\x22[JSChart:StartAnimation]\x20start.\x22),this.JSChartContainer.StartAnimation(t)},this.StopAnimation=function(){if(this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.StopAnimation)return\x20JSConsole.Chart.Log(\x22[JSChart:StopAnimation]\x20start.\x22),this.JSChartContainer.StopAnimation()},this.SaveToImage=function(t,e){if(this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.SaveToImage)return\x20this.JSChartContainer.SaveToImage(t,e)},this.SaveToImageUrl=function(t,e){if(this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.SaveToImageUrl)return\x20this.JSChartContainer.SaveToImageUrl(t,e)},this.AddEventCallback=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.AddEventCallback&&(JSConsole.Chart.Log(\x22[JSChart:AddEventCallback]\x20\x22,t),this.JSChartContainer.AddEventCallback(t))},this.SetLanguage=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.SetLanguage&&(JSConsole.Chart.Log(\x22[JSChart:SetLanguage]\x20\x22,t),this.JSChartContainer.SetLanguage(t))},this.ChangeIndexTemplate=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ChangeIndexTemplate&&(JSConsole.Chart.Log(\x22[JSChart:ChangeIndexTemplate]\x20\x22,t),this.JSChartContainer.ChangeIndexTemplate(t))},this.SetChartDrawOption=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.SetChartDrawOption&&(JSConsole.Chart.Log(\x22[JSChart:SetChartDrawOption]\x20\x22,t),this.JSChartContainer.SetChartDrawOption(t))},this.CreateChartDrawPicture=function(t,e){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.CreateChartDrawPicture&&(JSConsole.Chart.Log(\x22[JSChart:CreateChartDrawPicture]\x20\x22,t),this.JSChartContainer.CreateChartDrawPicture(t,e))},this.ClearChartDrawPicture=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ClearChartDrawPicture&&this.JSChartContainer.ClearChartDrawPicture(t)},this.ReloadResource=function(t){this.JSChartContainer&&\x22function\x22==typeof\x20this.JSChartContainer.ReloadResource&&(JSConsole.Chart.Log(\x22[JSChart:ReloadResource]\x20\x22),this.JSChartContainer.ReloadResource(t))}}JSChart.Init=function(t){var\x20e=new\x20JSChart(t);return\x20e.OnSize(),e},JSChart.SetDomain=function(t,e){t&&(g_JSChartResource.Domain=t),e&&(g_JSChartResource.CacheDomain=e)},JSChart.SetPyIndexDomain=function(t){t&&(g_JSChartResource.PyIndexDomain=t)},JSChart.SetStyle=function(t){t&&g_JSChartResource.SetStyle(t)},JSChart.SetTextResource=function(t,e){g_JSChartLocalization.SetTextResource(t,e)},JSChart.GetLocalization=function(){return\x20g_JSChartLocalization},JSChart.GetDevicePixelRatio=function(){return\x20GetDevicePixelRatio()},JSChart.CreateGuid=function(){return\x20Guid()},JSChart.GetResource=function(){return\x20g_JSChartResource},JSChart.GetMinuteTimeStringData=function(){return\x20g_MinuteTimeStringData},JSChart.GetMinuteCoordinateData=function(){return\x20g_MinuteCoordinateData},JSChart.GetKLineZoom=function(){return\x20ZOOM_SEED},JSChart.GetDivTooltipDataFormat=function(){return\x20g_DivTooltipDataForamt},JSChart.SetUSATimeType=function(t){g_NYMEXTimeData.TimeType=t,g_COMEXTimeData.TimeType=t,g_NYBOTTimeData.TimeType=t,g_CBOTTimeData.TimeType=t},JSChart.GetChinaFuturesTimeData=function(){return\x20g_FuturesTimeData},JSChart.AddPeriodCallback=function(t){g_DataPlus.AddPeriodCallback(t)},JSChart.RemovePeriodCallback=function(t){g_DataPlus.RemovePeriodCallback(t)},JSChart.RegisterDrawPicture=function(t){return\x20IChartDrawPicture.RegisterDrawPicture(t)},JSChart.RegisterDrawPictureIonFont=function(t){return\x20IChartDrawPicture.RegisterIonFont(t)};var\x20JSCHART_EVENT_ID={RECV_KLINE_MATCH:1,RECV_INDEX_DATA:2,RECV_HISTROY_DATA:3,RECV_TRAIN_MOVE_STEP:4,CHART_STATUS:5,BARRAGE_PLAY_END:6,RECV_OVERLAY_INDEX_DATA:7,DBCLICK_KLINE:8,RECV_START_AUTOUPDATE:9,RECV_STOP_AUTOUPDATE:10,ON_CONTEXT_MENU:11,ON_TITLE_DRAW:12,ON_SELECT_RECT:13,RECV_MINUTE_DATA:14,ON_CLICK_INDEXTITLE:15,RECV_KLINE_UPDATE_DATA:16,ON_CLICK_DRAWPICTURE:17,ON_FINISH_DRAWPICTURE:18,ON_INDEXTITLE_DRAW:19,ON_CUSTOM_VERTICAL_DRAW:20,RECV_KLINE_MANUAL_UPDATE_DATA:21,ON_ENABLE_SPLASH_DRAW:22,ON_CLICK_CHART_PAINT:23,ON_DRAW_MINUTE_LAST_POINT:24},JSCHART_OPERATOR_ID={OP_SCROLL_LEFT:1,OP_SCROLL_RIGHT:2,OP_ZOOM_OUT:3,OP_ZOOM_IN:4,OP_GOTO_HOME:5,OP_GOTO_END:6,OP_LEFT_ZOOM_OUT:7,OP_LEFT_ZOOM_IN:8,OP_RIGHT_ZOOM_OUT:9,OP_RIGHT_ZOOM_IN:10},JSCHART_DRAG_ID={DISABLE_DRAG_ID:0,CLICK_TOUCH_MODE_ID:3};function\x20JSChartContainer(t,e){this.ClassName=\x22JSChartContainer\x22;this.Frame,this.ChartPaint=new\x20Array,this.ChartPaintEx=[],this.ChartInfo=new\x20Array,this.ChartInfoPaint,this.ExtendChartPaint=new\x20Array,this.TitlePaint=new\x20Array,this.OverlayChartPaint=new\x20Array,this.ChartDrawPicture=new\x20Array,this.ChartDrawStorage,this.ChartDrawOption={IsLockScreen:!1,Zoom:5},this.CurrentChartDrawPicture=null,this.SelectChartDrawPicture=null,this.ChartPictureMenu,this.ChartCorssCursor,this.IsClickShowCorssCursor=!1,this.ChartSplashPaint=null,e?(this.Canvas=e.getContext(\x222d\x22),this.OffscreenCanvasElement=e,this.ShowCanvas=t.getContext(\x222d\x22)):(this.Canvas=t.getContext(\x222d\x22),this.ShowCanvas=null),this.UIElement=t,this.MouseDrag,this.DragMode=1,this.EnableBorderDrag=!0,this.BorderDrag,this.TouchStatus={CorssCursorShow:!1},this.DragTimer,this.EnableScrollUpDown=!1,this.CursorIndex=0,this.LastPoint=new\x20Point,this.IsForceLandscape=!1,this.CorssCursorTouchEnd=!1,this.StepPixel=4,this.ZoomStepPixel=5,this.TouchMoveMinAngle=70,this.EnableAnimation=!1,this.Tooltip=document.createElement(\x22div\x22),this.Tooltip.className=\x22jschart-tooltip\x22,this.Tooltip.style.background=g_JSChartResource.TooltipBGColor,this.Tooltip.style.opacity=g_JSChartResource.TooltipAlpha,this.Tooltip.id=Guid(),t.parentNode.appendChild(this.Tooltip),this.IsShowTooltip=!0,this.SelectRect=document.createElement(\x22div\x22),this.SelectRect.className=\x22jschart-selectrect\x22,this.SelectRect.style.background=g_JSChartResource.SelectRectBGColor,this.SelectRect.id=Guid(),this.SelectRect.oncontextmenu=function(){return!1},t.parentNode.appendChild(this.SelectRect),this.SelectRectRightMenu,this.FrameSplitData=new\x20Map,this.FrameSplitData.set(\x22double\x22,new\x20SplitData),this.FrameSplitData.set(\x22price\x22,new\x20PriceSplitData),this.mapEvent=new\x20Map,this.IsOnTouch=!1,this.TouchDrawCount=0,this.DisableMouse=!1,this.LanguageID=JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.PressTime=500,this.NetworkFilter,this.LastMouseStatus={},this.ClickDownPoint,this.AddEventCallback=function(t){if(t&&t.event&&t.callback){var\x20e={Callback:t.callback,Source:t};this.mapEvent.set(t.event,e)}},this.RemoveEventCallback=function(t){this.mapEvent.has(t)&&this.mapEvent.delete(t)},this.GetEventCallback=function(t){return\x20this.mapEvent.has(t)?this.mapEvent.get(t):null},this.GetIndexEvent=function(){return\x20this.GetEventCallback(JSCHART_EVENT_ID.RECV_INDEX_DATA)},this.GetOverlayIndexEvent=function(){return\x20this.GetEventCallback(JSCHART_EVENT_ID.RECV_OVERLAY_INDEX_DATA)},t.onmousemove=(t=>{this.UIOnMouseMove(t)}),t.oncontextmenu=(t=>this.UIOnContextMenu(t)),t.ondblclick=(t=>{this.UIOnDblClick(t)}),t.onmousedown=(t=>{this.UIOnMouseDown(t)}),t.onmouseout=(t=>{this.UIOnMounseOut(t)}),this.UIOnMouseMove=function(t){var\x20e=GetDevicePixelRatio(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e;if(!(this.ChartSplashPaint&&1==this.ChartSplashPaint.IsEnableSplash||1==this.DisableMouse||this.BorderDrag)){var\x20r={X:a,Y:i,IsInClient:this.IsMouseOnClient(a,i)};this.LastMouseStatus.OnMouseMove=r,this.OnMouseMove(a,i,t)}},this.IsMouseOnClient=function(t,e){return\x20this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),this.Canvas.isPointInPath(t,e)},this.UIOnContextMenu=function(t){var\x20e=t.clientX-this.UIElement.getBoundingClientRect().left,a=t.clientY-this.UIElement.getBoundingClientRect().top;return\x22function\x22==typeof\x20this.OnRightMenu&&this.OnRightMenu(e,a,t),!1},this.UIOnDblClick=function(t){var\x20e=t.clientX-this.UIElement.getBoundingClientRect().left,a=t.clientY-this.UIElement.getBoundingClientRect().top;this.OnDoubleClick(e,a,t)},this.UIOnMouseDown=function(t){if(this.ClickDownPoint={X:t.clientX,Y:t.clientY},this.IsOnTouch=!0,this.BorderDrag=null,this.TryClickLock){var\x20e=GetDevicePixelRatio(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e;if(this.TryClickLock(a,i))return}if(this.HideSelectRect(),this.SelectRectRightMenu&&this.SelectRectRightMenu.Hide(),this.ChartPictureMenu&&this.ChartPictureMenu.Hide(),this.EnableBorderDrag&&this.Frame){e=GetDevicePixelRatio(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e;var\x20r=this.Frame.PtInFrameBorder(a,i);r&&r.Index>=0&&(this.UIElement.style.cursor=\x22n-resize\x22,this.BorderDrag={Index:r.Index},JSConsole.Chart.Log(\x22[JSChartContainer::UIOnMouseDown]\x20DragBorder\x20\x22,r))}if(0!=this.DragMode){var\x20n={Click:{},LastMove:{}};if(n.Click.X=t.clientX,n.Click.Y=t.clientY,n.LastMove.X=t.clientX,n.LastMove.Y=t.clientY,this.MouseDrag=n,this.SelectChartDrawPicture=null,this.BorderDrag);else\x20if(this.CurrentChartDrawPicture){2==this.CurrentChartDrawPicture.Status?this.SetChartDrawPictureThirdPoint(n.Click.X,n.Click.Y):(this.SetChartDrawPictureFirstPoint(n.Click.X,n.Click.Y),this.FinishChartDrawPicturePoint()&&this.DrawDynamicInfo())}else{var\x20s={};e=GetDevicePixelRatio();if(s.X=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,s.Y=(t.clientY-this.UIElement.getBoundingClientRect().top)*e,this.GetChartDrawPictureByPoint(s)){s.ChartDrawPicture.Status=20,s.ChartDrawPicture.ValueToPoint(),s.ChartDrawPicture.MovePointIndex=s.PointIndex,this.CurrentChartDrawPicture=s.ChartDrawPicture,this.SelectChartDrawPicture=s.ChartDrawPicture;var\x20o=this.GetEventCallback(JSCHART_EVENT_ID.ON_CLICK_DRAWPICTURE);if(o&&o.Callback){var\x20h={DrawPicture:s.ChartDrawPicture};o.Callback(o,h,this)}else\x20this.OnSelectChartPicture(s.ChartDrawPicture)}}document.onmousemove=(t=>{this.DocOnMouseMove(t)}),document.onmouseup=(t=>{this.DocOnMouseUp(t)})}},this.DocOnMouseMove=function(e){if(!this.ChartSplashPaint||1!=this.IsEnableSplash){var\x20a=this.MouseDrag;if(a){var\x20i=Math.abs(a.LastMove.X-e.clientX);if(this.BorderDrag&&this.BorderDrag.Index>=0){if(Math.abs(a.LastMove.Y-e.clientY)<5)return;var\x20r=e.clientY-a.LastMove.Y;this.OnMoveFromeBorder(this.BorderDrag.Index,r),a.LastMove.X=e.clientX,a.LastMove.Y=e.clientY}else\x20if(this.CurrentChartDrawPicture){var\x20n=this.CurrentChartDrawPicture;if(1==n.Status||2==n.Status){if(Math.abs(a.LastMove.X-e.clientX)<5&&Math.abs(a.LastMove.Y-e.clientY)<5)return;this.SetChartDrawPictureSecondPoint(e.clientX,e.clientY)&&this.DrawDynamicInfo()}else\x20if(3==n.Status)this.SetChartDrawPictureThirdPoint(e.clientX,e.clientY)&&this.DrawDynamicInfo();else\x20if(20==n.Status){if(Math.abs(a.LastMove.X-e.clientX)<5&&Math.abs(a.LastMove.Y-e.clientY)<5)return;this.MoveChartDrawPicture(e.clientX-a.LastMove.X,e.clientY-a.LastMove.Y)&&this.DrawDynamicInfo()}a.LastMove.X=e.clientX,a.LastMove.Y=e.clientY}else\x20if(1==this.DragMode){if(i<5)return;var\x20s=!0;a.LastMove.X<e.clientX&&(s=!1),this.UIElement.style.cursor=\x22pointer\x22,this.DataMove(i,s)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()):this.DragDownloadData&&this.DragDownloadData(),a.LastMove.X=e.clientX,a.LastMove.Y=e.clientY}else\x20if(2==this.DragMode){var\x20o=Math.abs(a.LastMove.Y-e.clientY);if(i<5&&o<5)return;var\x20h=a.Click.X-t.getBoundingClientRect().left,l=a.Click.Y-t.getBoundingClientRect().top,C=e.clientX-t.getBoundingClientRect().left,u=e.clientY-t.getBoundingClientRect().top;this.ShowSelectRect(h,l,C,u),a.LastMove.X=e.clientX,a.LastMove.Y=e.clientY}}}},this.DocOnMouseUp=function(e){document.onmousemove=null,document.onmouseup=null;var\x20a=!0;if(this.CurrentChartDrawPicture){var\x20i=this.CurrentChartDrawPicture;2==i.Status||1==i.Status||3==i.Status?(i.PointStatus=i.Status,this.FinishChartDrawPicturePoint()?this.DrawDynamicInfo():a=!1):20==i.Status&&this.FinishMoveChartDrawPicture()&&this.DrawDynamicInfo()}else\x20if(2==this.DragMode){var\x20r=this.MouseDrag,n=new\x20SelectRectData;if(n.XStart=r.Click.X-t.getBoundingClientRect().left,n.XEnd=r.LastMove.X-t.getBoundingClientRect().left,n.JSChartContainer=this.JSChartContainer,n.Stock={Symbol:this.Symbol,Name:this.Name},this.GetSelectRectData(n)){var\x20s=this.GetEventCallback(JSCHART_EVENT_ID.ON_SELECT_RECT);if(s&&s.Callback){var\x20o={X:r.LastMove.X-t.getBoundingClientRect().left,Y:r.LastMove.Y-t.getBoundingClientRect().top,SelectData:n};s.Callback(s,o,this)}this.SelectRectRightMenu&&(e.data={Chart:this,X:r.LastMove.X-t.getBoundingClientRect().left,Y:r.LastMove.Y-t.getBoundingClientRect().top,SelectData:n},this.SelectRectRightMenu.DoModal(e))}else\x20this.TryClickPaintEvent(e)}else\x20this.TryClickPaintEvent(e);JSConsole.Chart.Log(\x22[KLineChartContainer::document.onmouseup]\x22,e),this.UIElement.style.cursor=\x22default\x22,this.MouseDrag=null,this.ClickDownPoint=null,this.IsOnTouch=!1,this.BorderDrag&&this.BorderDrag.Index>=0&&this.Frame.SaveSubFrameHeightRate(),this.BorderDrag=null,!0===a&&(this.CurrentChartDrawPicture=null)},this.UIOnMounseOut=function(t){JSConsole.Chart.Log(\x22[KLineChartContainer::UIOnMounseOut]\x22,t),this.UIOnMouseMove(t)},this.TryClickPaintEvent=function(e){var\x20a=this.GetEventCallback(JSCHART_EVENT_ID.ON_CLICK_CHART_PAINT);if(a&&a.Callback&&this.ClickDownPoint.X==e.clientX&&this.ClickDownPoint.Y==e.clientY){var\x20i=GetDevicePixelRatio(),r=(e.clientX-t.getBoundingClientRect().left)*i,n=(e.clientY-t.getBoundingClientRect().top)*i,s=new\x20TooltipData,o=null;for(var\x20h\x20in\x20this.ChartPaint){if(this.ChartPaint[h].GetTooltipData(r,n,s)){o={Symbol:this.Symbol,Name:this.Name};break}}if(!s.Data)for(var\x20h\x20in\x20this.OverlayChartPaint){if(this.OverlayChartPaint[h].GetTooltipData(r,n,s)){o={Symbol:s.ChartPaint.Symbol,Name:s.ChartPaint.Title};break}}if(s.Data){var\x20l={X:e.clientX,Y:e.clientY,Stock:o,Tooltip:s};return\x20a.Callback(a,l,this),!0}}return!1},this.IsPhoneDragging=function(t){var\x20e=t.changedTouches.length,a=t.touches.length;return\x201==e&&1==a},this.IsPhonePinching=function(t){var\x20e=t.changedTouches.length,a=t.touches.length;return(1==e||2==e)&&2==a},this.PreventTouchEvent=function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()},this.GetToucheData=function(t,e){for(var\x20a=new\x20Array,i=GetDevicePixelRatio(),r=0;r<t.touches.length;++r){var\x20n=t.touches[r];e?a.push({clientX:n.clientY*i,clientY:n.clientX*i,pageX:n.pageY*i,pageY:n.pageX*i}):a.push({clientX:n.clientX*i,clientY:n.clientY*i,pageX:n.pageX*i,pageY:n.pageY*i})}return\x20a},this.IsSingleTouch=function(t){return\x201==t.touches.length},this.StopDragTimer=function(){IFrameSplitOperator.IsNumber(this.DragTimer)&&(clearTimeout(this.DragTimer),this.DragTimer=null)},this.GetMoveAngle=function(t,e){var\x20a=Math.abs(t.X-e.X),i=Math.abs(t.Y-e.Y);return\x20180*Math.atan(a/i)/Math.PI},t.ontouchstart=(t=>{this.OnTouchStart(t)}),t.ontouchmove=(t=>{this.OnTouchMove(t)}),t.ontouchend=(t=>{this.OnTouchEnd(t)}),this.OnTouchStart=function(t){this.IsTouchMove=!1,this.IsOnTouch=!0,this.TouchDrawCount=0,this.PhonePinch=null,this.StopDragTimer();var\x20e=this.IsSingleTouch(t);if((0==this.EnableScrollUpDown||!e||this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID&&1==this.TouchStatus.CorssCursorShow)&&t.cancelable&&t.preventDefault(),this.IsPhoneDragging(t)){if(this.TryClickLock||this.TryClickIndexTitle){var\x20a=this.GetToucheData(t,this.IsForceLandscape),i=(o=this.PointAbsoluteToRelative(a[0].clientX,a[0].clientY,!0)).X,r=o.Y;if(this.TryClickLock&&this.TryClickLock(i,r))return;if(this.TryClickIndexTitle&&this.TryClickIndexTitle(i,r))return}var\x20n=!0;this.ChartDrawOption.IsLockScreen?n=!1:this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID?1==this.TouchStatus.CorssCursorShow&&(n=!1):this.DragMode==JSCHART_DRAG_ID.DISABLE_DRAG_ID?n=!1:e||(n=!1);var\x20s={Click:{},LastMove:{}};a=this.GetToucheData(t,this.IsForceLandscape);s.Click.X=a[0].clientX,s.Click.Y=a[0].clientY,s.LastMove.X=a[0].clientX,s.LastMove.Y=a[0].clientY,this.MouseDrag=s,this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.IsSelected=!1),this.SelectChartDrawPicture=null;if(this.CurrentChartDrawPicture)return\x202==this.CurrentChartDrawPicture.Status?this.SetChartDrawPictureThirdPoint(s.Click.X,s.Click.Y,!0):(this.SetChartDrawPictureFirstPoint(s.Click.X,s.Click.Y,!0),this.FinishChartDrawPicturePoint()&&this.DrawDynamicInfo({Corss:!1,Tooltip:!1})),void(t.cancelable&&t.preventDefault());var\x20o,h={X:(o=this.PointAbsoluteToRelative(a[0].clientX,a[0].clientY,!0)).X,Y:o.Y};GetDevicePixelRatio();if(this.GetChartDrawPictureByPoint(h)){h.ChartDrawPicture.Status=20,h.ChartDrawPicture.ValueToPoint(),h.ChartDrawPicture.MovePointIndex=h.PointIndex,h.ChartDrawPicture.IsSelected=!0,this.CurrentChartDrawPicture=h.ChartDrawPicture,this.SelectChartDrawPicture=h.ChartDrawPicture;let\x20e=this.GetEventCallback(JSCHART_EVENT_ID.ON_CLICK_DRAWPICTURE);if(e&&e.Callback){let\x20t={DrawPicture:h.ChartDrawPicture};e.Callback(e,t,this)}return\x20void(t.cancelable&&t.preventDefault())}if(n){var\x20l=this;this.DragTimer=setTimeout(function(){if(s.Click.X==s.LastMove.X&&s.Click.Y==s.LastMove.Y){l.MouseDrag;l.MouseDrag=null,l.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID&&(l.TouchStatus.CorssCursorShow=!0),l.MoveCorssCursor(s.Click,t)}},l.PressTime)}this.ChartDrawOption.IsLockScreen?this.MouseDrag=null:this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID||(this.DragMode==JSCHART_DRAG_ID.DISABLE_DRAG_ID?(this.MouseDrag=null,this.MoveCorssCursor(s.Click,t)):this.IsClickShowCorssCursor&&this.MoveCorssCursor(s.Click,t))}else\x20if(this.IsPhonePinching(t)){var\x20C={Start:{},Last:{}};a=this.GetToucheData(t,this.IsForceLandscape);C.Start={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},C.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},this.PhonePinch=C,this.SelectChartDrawPicture=null}},this.OnTouchMove=function(e){this.IsTouchMove=!0;var\x20a=this.GetToucheData(e,this.IsForceLandscape);if(this.IsPhoneDragging(e)){var\x20i=this.MouseDrag;if(null==i)this.IsForceLandscape&&(y=t.getBoundingClientRect().width-a[0].clientY),this.ChartDrawOption.IsLockScreen||this.MoveCorssCursor({X:a[0].clientX,Y:a[0].clientY},e);else{var\x20r=this.GetMoveAngle(i.LastMove,{X:a[0].clientX,Y:a[0].clientY}),n=Math.abs(i.LastMove.X-a[0].clientX),s=Math.abs(i.LastMove.Y-a[0].clientY);n=parseInt(n);var\x20o=this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID&&1==this.TouchStatus.CorssCursorShow;if(this.CurrentChartDrawPicture){var\x20h=this.CurrentChartDrawPicture;if(1==h.Status||2==h.Status){if(n<5&&s<5)return;this.SetChartDrawPictureSecondPoint(a[0].clientX,a[0].clientY,!0)&&this.DrawDynamicInfo()}else\x20if(3==h.Status)this.SetChartDrawPictureThirdPoint(a[0].clientX,a[0].clientY,!0)&&this.DrawDynamicInfo();else\x20if(20==h.Status){if(n<5&&s<5)return;this.MoveChartDrawPicture(a[0].clientX-i.LastMove.X,a[0].clientY-i.LastMove.Y,!0)&&this.DrawDynamicInfo()}i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}else\x20if(o){this.MouseDrag;this.MouseDrag=null,this.MoveCorssCursor(i.Click,e)}else\x20if(1==this.DragMode||0==o){if((s>0&&n<=3||r<=this.TouchMoveMinAngle)&&1==this.EnableScrollUpDown)return\x20void\x20this.StopDragTimer();if(n<5||r<=this.TouchMoveMinAngle)return\x20void\x20this.PreventTouchEvent(e);var\x20l=!0;i.LastMove.X<a[0].clientX&&(l=!1),this.DataMove(n,l)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()):this.DragDownloadData&&this.DragDownloadData(),i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}}}else\x20if(this.IsPhonePinching(e)){if(this.DragMode==JSCHART_DRAG_ID.DISABLE_DRAG_ID)return;this.PreventTouchEvent(e);var\x20C=this.PhonePinch;if(!C)return;var\x20u=Math.abs(a[0].pageY-a[1].pageY)-Math.abs(C.Last.Y-C.Last.Y2),D=Math.abs(a[0].pageX-a[1].pageX)-Math.abs(C.Last.X-C.Last.X2),d=this.ZoomStepPixel;if(Math.abs(u)<d&&Math.abs(D)<d)return;var\x20c=u;if(Math.abs(u)<d&&(c=D),c>0){if((m={}).Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomUp(m))return;this.CursorIndex=m.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.StopDragTimer()}else{var\x20m;if((m={}).Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomDown(m))return;this.CursorIndex=m.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.StopDragTimer()}C.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY}}this.PreventTouchEvent(e)},this.OnTouchEnd=function(t){JSConsole.Chart.Log(\x22[KLineChartContainer:OnTouchEnd]\x22,t);var\x20e=!0;if(this.CurrentChartDrawPicture){var\x20a=this.CurrentChartDrawPicture;2==a.Status||1==a.Status||3==a.Status?(a.PointStatus=a.Status,this.FinishChartDrawPicturePoint()?this.DrawDynamicInfo():e=!1):20==a.Status&&this.FinishMoveChartDrawPicture()&&this.DrawDynamicInfo()}this.IsOnTouch=!1,!0===e&&(this.CurrentChartDrawPicture=null),this.StopDragTimer(),this.OnTouchFinished(),this.TouchDrawCount=0},this.MoveCorssCursor=function(t,e){var\x20a=GetDevicePixelRatio(),i=t.X-this.UIElement.getBoundingClientRect().left*a,r=t.Y-this.UIElement.getBoundingClientRect().top*a;this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID&&(this.TouchStatus.CorssCursorShow=!0),this.OnMouseMove(i,r,e)},this.DrawEmpty=function(){this.UIElement.width<=0||this.UIElement.height<=0||(this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height),this.Frame&&(this.Frame.ScreenImageData=null,this.Frame.Draw()))},this.Draw=function(){if(this.ChartCorssCursor&&(this.ChartCorssCursor.Status=0),!(this.UIElement.width<=0||this.UIElement.height<=0)){this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height);var\x20t=GetDevicePixelRatio();if(this.Canvas.lineWidth=t,this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return\x20this.Frame.Draw(),void\x20this.ChartSplashPaint.Draw();if(this.Frame.SetDrawDepthMap(()=>{for(var\x20t\x20in\x20this.ExtendChartPaint){var\x20e=this.ExtendChartPaint[t];e.IsCallbackDraw&&e.Draw()}}),this.Frame.Draw(),this.Frame.DrawCustomVertical){var\x20e=this.GetEventCallback(JSCHART_EVENT_ID.ON_CUSTOM_VERTICAL_DRAW);this.Frame.DrawCustomVertical(e)}for(var\x20a\x20in\x20this.Frame.CalculateLock(),this.ChartPaint){(n=this.ChartPaint[a]).IsDrawFirst&&n.Draw()}for(var\x20a\x20in\x20this.ChartPaint){(n=this.ChartPaint[a]).IsDrawFirst||n.Draw()}for(var\x20a\x20in\x20this.ChartPaintEx){(n=this.ChartPaintEx[a]).Draw()}for(var\x20a\x20in\x20this.OverlayChartPaint){(n=this.OverlayChartPaint[a]).Draw()}for(var\x20a\x20in\x20this.Frame.DrawOveraly&&this.Frame.DrawOveraly(),this.ExtendChartPaint){(n=this.ExtendChartPaint[a]).IsCallbackDraw||(n.IsDynamic||0!=n.IsAnimation||n.Draw())}for(var\x20a\x20in\x20this.Frame.DrawInsideHorizontal&&this.Frame.DrawInsideHorizontal(),this.Frame.DrawCustomHorizontal&&this.Frame.DrawCustomHorizontal(),this.ChartInfoPaint&&this.ChartInfoPaint.Draw(),this.Frame.DrawLock(),this.Frame.Snapshot(),this.ExtendChartPaint){(n=this.ExtendChartPaint[a]).IsCallbackDraw||n.IsDynamic&&!1===n.DrawAfterTitle&&n.Draw()}null==this.LastPoint.X&&null==this.LastPoint.Y||this.ChartCorssCursor&&(this.ChartCorssCursor.LastPoint=this.LastPoint,this.ChartCorssCursor.CursorIndex=this.CursorIndex,this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID?1==this.TouchStatus.CorssCursorShow&&this.ChartCorssCursor.Draw():!0===this.CorssCursorTouchEnd&&this.MouseDrag||1==this.CorssCursorTouchEnd&&0==this.IsOnTouch||this.ChartCorssCursor.Draw());var\x20i=this.GetEventCallback(JSCHART_EVENT_ID.ON_TITLE_DRAW),r=this.GetEventCallback(JSCHART_EVENT_ID.ON_INDEXTITLE_DRAW);for(var\x20a\x20in\x20this.TitlePaint){(n=this.TitlePaint[a]).IsDynamic&&(n.CursorIndex=this.CursorIndex,\x22DynamicChartTitlePainting\x22==n.ClassName?n.OnDrawEvent=r:n.OnDrawEvent=i,n.OnDrawEvent&&(n.OnDrawEvent.FunctionName=\x22Draw\x22,n.OnDrawEvent.PointPosition=null),n.Draw())}for(var\x20a\x20in\x20this.ExtendChartPaint){(n=this.ExtendChartPaint[a]).IsCallbackDraw||n.IsDynamic&&!0===n.DrawAfterTitle&&0==n.IsAnimation&&n.Draw()}if(this.EnableAnimation)for(var\x20a\x20in\x20this.ExtendChartPaint){!0===(n=this.ExtendChartPaint[a]).IsAnimation&&n.Draw()}for(var\x20a\x20in\x20this.ChartDrawPicture){var\x20n;(n=this.ChartDrawPicture[a]).Draw()}if(this.CurrentChartDrawPicture&&10!=this.CurrentChartDrawPicture.Status&&this.CurrentChartDrawPicture.Draw(),this.OffscreenToShowCanvas(),this.mapEvent.has(JSCHART_EVENT_ID.CHART_STATUS)){var\x20s=this.mapEvent.get(JSCHART_EVENT_ID.CHART_STATUS),o={};\x22function\x22==typeof\x20this.GetChartStatus&&(o=this.GetChartStatus()),s.Callback(s,o,this)}++this.TouchDrawCount}},this.OffscreenToShowCanvas=function(){this.ShowCanvas&&(this.ShowCanvas.clearRect(0,0,this.UIElement.width,this.UIElement.height),this.ShowCanvas.drawImage(this.OffscreenCanvasElement,0,0))},this.DrawDynamicInfo=function(t){if(null!=this.Frame.ScreenImageData){var\x20e=!1;if(this.ChartCorssCursor&&(null==this.ChartCorssCursor.PointX&&null==this.ChartCorssCursor.PointY||(e=!0)),0==(e=!0))for(var\x20a\x20in\x20this.ExtendChartPaint){if(!(r=this.ExtendChartPaint[a]).IsCallbackDraw&&(r.IsDynamic&&r.IsEraseBG)){e=!0;break}}for(var\x20a\x20in\x20e&&this.Canvas.putImageData(this.Frame.ScreenImageData,0,0),this.ExtendChartPaint){(r=this.ExtendChartPaint[a]).IsCallbackDraw||r.IsDynamic&&!1===r.DrawAfterTitle&&0==r.IsAnimation&&r.Draw()}this.ChartCorssCursor&&(this.ChartCorssCursor.LastPoint=this.LastPoint,this.ChartCorssCursor.CursorIndex=this.CursorIndex,t&&0==t.Corss||(this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID?1==this.TouchStatus.CorssCursorShow&&this.ChartCorssCursor.Draw():!1===this.IsOnTouch&&!0===this.CorssCursorTouchEnd||this.CurrentChartDrawPicture||this.ChartCorssCursor.Draw()));var\x20i=null;for(var\x20a\x20in\x20t&&\x22OnMouseMove\x22==t.ParentFunction&&t.Point&&(i=this.Frame.PtInFrame(t.Point.X,t.Point.Y)),this.TitlePaint){(r=this.TitlePaint[a]).IsDynamic&&(r.CursorIndex=this.CursorIndex,r.OnDrawEvent&&(r.OnDrawEvent.FunctionName=\x22DrawDynamicInfo\x22,r.OnDrawEvent.PointPosition=i),r.Draw())}for(var\x20a\x20in\x20this.ExtendChartPaint){(r=this.ExtendChartPaint[a]).IsCallbackDraw||(\x22KLineTooltipPaint\x22==r.ClassName&&t&&0==t.Tooltip||r.IsDynamic&&!0===r.DrawAfterTitle&&r.Draw())}if(this.EnableAnimation)for(var\x20a\x20in\x20this.ExtendChartPaint){!0===(r=this.ExtendChartPaint[a]).IsAnimation&&r.Draw()}for(var\x20a\x20in\x20this.ChartDrawPicture){var\x20r;(r=this.ChartDrawPicture[a]).Draw()}this.CurrentChartDrawPicture&&10!=this.CurrentChartDrawPicture.Status&&this.CurrentChartDrawPicture.Draw(),this.OffscreenToShowCanvas(),++this.TouchDrawCount}},this.DrawAnimation=function(){if(this.EnableAnimation){if(this.Frame.ScreenImageData&&!this.IsOnTouch){for(var\x20t\x20in\x20this.ExtendChartPaint){var\x20e=this.ExtendChartPaint[t];!0===e.IsAnimation&&(e.IsMoveStep=!0)}this.DrawDynamicInfo()}var\x20a=this;window.requestAnimationFrame(function(){a.DrawAnimation()})}},this.StartAnimation=function(t){var\x20e=!1,a=null;for(var\x20i\x20in\x20this.ExtendChartPaint){var\x20r=this.ExtendChartPaint[i];if(\x22BarragePaint\x22===r.ClassName){e=!0,a=r.BarrageList;break}}if(!e){var\x20n=new\x20BarragePaint;n.Canvas=this.Canvas,n.ChartBorder=this.Frame.ChartBorder,n.ChartFrame=this.Frame,n.HQChart=this,n.SetOption(t),this.ExtendChartPaint.push(n),a=n.BarrageList}this.EnableAnimation=!0;var\x20s=this;return\x20window.requestAnimationFrame(function(){s.DrawAnimation()}),a},this.StopAnimation=function(){this.EnableAnimation=!1,this.DrawDynamicInfo()},this.OnMouseMove=function(t,e,a){if(this.LastPoint.X=t,this.LastPoint.Y=e,this.CursorIndex=this.Frame.GetXData(t),this.EnableBorderDrag&&this.Frame){var\x20i=this.Frame.PtInFrameBorder(t,e);if(i&&i.Index>=0)return\x20void(this.UIElement.style.cursor=\x22n-resize\x22)}var\x20r=!1;if(this.CurrentChartDrawPicture)this.CurrentChartDrawPicture.SetLastPoint&&this.CurrentChartDrawPicture.SetLastPoint({X:t,Y:e}),r=!0;else{var\x20n={};n.X=t,n.Y=e,this.GetChartDrawPictureByPoint(n)?(100===n.PointIndex?this.UIElement.style.cursor=\x22move\x22:this.UIElement.style.cursor=\x22pointer\x22,r=!0):this.MouseDrag||(this.UIElement.style.cursor=\x22default\x22)}var\x20s={ParentFunction:\x22OnMouseMove\x22,Point:{X:t,Y:e}};if(this.DrawDynamicInfo(s),this.IsShowTooltip&&0==r){var\x20o=new\x20TooltipData;for(var\x20h\x20in\x20this.ChartPaint){if(this.ChartPaint[h].GetTooltipData(t,e,o))break}if(this.ChartInfoPaint&&this.ChartInfoPaint.GetTooltipData(t,e,o),!o.Data)for(var\x20h\x20in\x20this.OverlayChartPaint){if(this.OverlayChartPaint[h].GetTooltipData(t,e,o))break}if(o.Data){var\x20l=a.clientX-this.UIElement.getBoundingClientRect().left,C=a.clientY-this.UIElement.getBoundingClientRect().top;this.ShowTooltip(l,C,o)}else\x20this.HideTooltip()}},this.OnKeyDown=function(t){switch(t.keyCode?t.keyCode:t.which){case\x2037:if(this.CursorIndex<=.99999){if(!this.DataMoveLeft()){this.DragDownloadData&&this.DragDownloadData();break}this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown()}else--this.CursorIndex,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo(),this.ShowTooltipByKeyDown();break;case\x2039:var\x20e=0;if(e=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,this.CursorIndex+1>=e){if(!this.DataMoveRight())break;this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown()}else{var\x20a=null;if(!(a=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data))break;if(this.CursorIndex+a.DataOffset+1>=a.Data.length)break;++this.CursorIndex,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo(),this.ShowTooltipByKeyDown()}break;case\x2038:if((i={ZoomType:this.ZoomType}).Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomUp(i))break;this.CursorIndex=i.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown();break;case\x2040:var\x20i;if((i={ZoomType:this.ZoomType}).Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomDown(i))break;this.CursorIndex=i.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown();break;case\x2046:if(!this.SelectChartDrawPicture)break;var\x20r=this.SelectChartDrawPicture;JSConsole.Chart.Log(r,\x22drawPicturedrawPicturedrawPicture\x22),this.SelectChartDrawPicture=null,this.ClearChartDrawPicture(r);break;default:return}t.preventDefault?t.preventDefault():t.returnValue=!1},this.OnDoubleClick=function(t,e,a){},this.OnMoveFromeBorder=function(t,e){this.Frame&&this.Frame.OnMoveFromeBorder(t,e)&&(this.Frame.ReDrawToolbar(),this.Draw())},this.IsKLineContainer=function(){return\x22KLineChartContainer\x22==this.ClassName||\x22KLineChartHScreenContainer\x22==this.ClassName||\x22KLineTrainChartContainer\x22==this.ClassName||\x22CustomKLineChartContainer\x22==this.ClassName},this.UpdatePointByCursorIndex=function(t){var\x20e={X:null,Y:null};e.X=this.Frame.GetXFromIndex(this.CursorIndex);var\x20a=Math.trunc(Math.abs(this.CursorIndex-.5));this.IsKLineContainer()&&(a=this.CursorIndex);var\x20i=this.Frame.Data;if(i.DataOffset+a<i.Data.length){var\x20r=i.Data[i.DataOffset+a].Close;e.Y=this.Frame.GetYFromData(r)}if(1==t&&this.ChartCorssCursor)if(1==this.ChartCorssCursor.Status);else{this.LastPoint.X=this.Frame.GetXFromIndex(this.CursorIndex);a=Math.abs(this.CursorIndex-.5);a=parseInt(a.toFixed(0)),this.IsKLineContainer()&&(a=this.CursorIndex),this.LastPoint.Y=null}else\x202==t&&this.ChartCorssCursor?(this.LastPoint.Y=null,this.LastPoint.X=null):(this.LastPoint.X=e.X,this.LastPoint.Y=e.Y)},this.ShowTooltipByKeyDown=function(){var\x20t=Math.abs(this.CursorIndex-.5);t=parseInt(t.toFixed(0)),\x22KLineChartContainer\x22!=this.ClassName&&\x22KLineTrainChartContainer\x22!=this.ClassName||(t=this.CursorIndex);var\x20e=this.Frame.Data,a=new\x20TooltipData;a.Data=e.Data[e.DataOffset+t],a.ChartPaint=this.ChartPaint[0];var\x20i=GetDevicePixelRatio();0===i&&(i=1),this.ShowTooltip(this.LastPoint.X/i,this.LastPoint.Y/i,a)},this.ShowTooltip=function(t,e,a){},this.HideTooltip=function(){this.Tooltip.style.display=\x22none\x22},this.ShowSelectRect=function(t,e,a,i){var\x20r=t,n=e,s=this.Frame.ChartBorder.GetRight(),o=this.Frame.ChartBorder.GetLeft();t>s&&(t=s),a>s&&(a=s),t<o&&(t=o),a<o&&(a=o),t>a&&(r=a),e>i&&(n=i);var\x20h=Math.abs(t-a),l=Math.abs(e-i);this.SelectRect.style.width=h+\x22px\x22,this.SelectRect.style.height=l+\x22px\x22,this.SelectRect.style.position=\x22absolute\x22,this.SelectRect.style.left=r+\x22px\x22,this.SelectRect.style.top=n+\x22px\x22,this.SelectRect.style.display=\x22block\x22},this.UpdateSelectRect=function(t,e){if(this.ChartPaint[0].Data){var\x20a=this.ChartPaint[0].Data.DataOffset,i=t-a,r=e-a,n=this.Frame.GetXFromIndex(i),s=this.Frame.GetXFromIndex(r);JSConsole.Chart.Log(\x22[JSChartContainer::UpdateSelectRect]\x22,t,e,n,s);var\x20o=GetScrollPosition();this.SelectRect.style.left=n+o.Left+\x22px\x22,this.SelectRect.style.width=s-n+\x22px\x22}},this.HideSelectRect=function(){this.SelectRect.style.display=\x22none\x22},this.ResetFrameXYSplit=function(){\x22function\x22==typeof\x20this.Frame.ResetXYSplit&&this.Frame.ResetXYSplit()},this.UpdateFrameMaxMin=function(){var\x20t=new\x20Array,e=new\x20Array;for(var\x20a\x20in\x20this.ChartPaint){0!=(o=this.ChartPaint[a]).IsShow&&e.push(this.ChartPaint[a])}for(var\x20a\x20in\x20this.OverlayChartPaint)e.push(this.OverlayChartPaint[a]);for(var\x20a\x20in\x20e){var\x20i=e[a],r=i.GetMaxMin();if(null!=r&&null!=r.Max&&null!=r.Min){var\x20n=null;for(var\x20s\x20in\x20t)if(t[s].Frame==i.ChartFrame){n=t[s];break}n?(n.Range.Max<r.Max&&(n.Range.Max=r.Max),n.Range.Min>r.Min&&(n.Range.Min=r.Min)):((n={}).Frame=i.ChartFrame,n.Range=r,t.push(n))}}for(var\x20a\x20in\x20t){var\x20o;(o=t[a]).Frame&&o.Range&&(null!=o.Range.Max&&null!=o.Range.Min&&(o.Frame.YSpecificMaxMin?(o.Frame.HorizontalMax=o.Frame.YSpecificMaxMin.Max,o.Frame.HorizontalMin=o.Frame.YSpecificMaxMin.Min):(o.Frame.HorizontalMax=o.Range.Max,o.Frame.HorizontalMin=o.Range.Min),o.Frame.XYSplit=!0))}for(var\x20a\x20in\x20this.Frame.SubFrame){var\x20h=this.Frame.SubFrame[a];for(var\x20s\x20in\x20h.OverlayIndex){h.OverlayIndex[s].UpdateFrameMaxMin()}}},this.DataMoveLeft=function(){var\x20t=null;return!!(t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data)&&(!(t.DataOffset<=0)&&(--t.DataOffset,!0))},this.DataMoveRight=function(){var\x20t=null;if(!(t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data))return!1;var\x20e=0;return!!(e=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount)&&(!(e+t.DataOffset>=t.Data.length)&&(++t.DataOffset,!0))},this.UpdataDataoffset=function(){var\x20t=null;if(t=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data){for(var\x20e\x20in\x20debug&&console.log(\x22UpdataDataoffset\x22,this,t),this.ChartPaint){(s=this.ChartPaint[e]).Data&&(s.Data.DataOffset=t.DataOffset,debug&&console.log(\x22\x20\x20\x20+++++++ChartPaint\x22,t.DataOffset,s))}for(var\x20e\x20in\x20this.OverlayChartPaint){(s=this.OverlayChartPaint[e]).Data&&(s.Data.DataOffset=t.DataOffset,debug&&console.log(\x22\x20\x20\x20+++++++OverlayChartPaint\x22,t.DataOffset,s))}for(var\x20e\x20in\x20this.Frame.SubFrame){var\x20a=this.Frame.SubFrame[e];for(var\x20i\x20in\x20a.OverlayIndex){var\x20r=a.OverlayIndex[i];for(var\x20n\x20in\x20r.ChartPaint){var\x20s;(s=r.ChartPaint[n]).Data&&(s.Data.DataOffset=t.DataOffset,debug&&console.log(\x22\x20\x20\x20+++++++SubFrame\x22,t.DataOffset,s))}}}}},this.DataMove=function(t,e){var\x20a=t;if((t=parseInt(t/this.StepPixel))<=0)return!1;var\x20i=null;if(!(i=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data))return!1;var\x20r=0;if(!(r=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount))return!1;if(this.Frame.SubFrame&&this.Frame.SubFrame.length>0&&this.Frame.SubFrame[0].Frame){var\x20n=this.Frame.SubFrame[0].Frame;(n.DataWidth<=1||n.DistanceWidth<=1)&&(t=a*this.StepPixel)}if(e){if(this.RightSpaceCount>0){if(r+i.DataOffset>=i.Data.length+this.RightSpaceCount-1)return!1;i.DataOffset+=t,i.DataOffset+r>=i.Data.length+this.RightSpaceCount&&(i.DataOffset=i.Data.length-(r-this.RightSpaceCount))}else{if(r+i.DataOffset>=i.Data.length)return!1;i.DataOffset+=t,i.DataOffset+r>=i.Data.length&&(i.DataOffset=i.Data.length-r)}return\x20i.DataOffset=Math.trunc(i.DataOffset),window.chartdata[i.Period].DataOffset=i.DataOffset,!0}return!(i.DataOffset<=0)&&(i.DataOffset-=t,i.DataOffset<0&&(i.DataOffset=0),i.DataOffset=Math.trunc(i.DataOffset),window.chartdata[i.Period].DataOffset=i.DataOffset,!0)},this.GetSubFrameIndex=function(t,e){if(!this.Frame.SubFrame||this.Frame.SubFrame.length<=0)return-1;for(var\x20a\x20in\x20this.Frame.SubFrame){var\x20i=this.Frame.SubFrame[a].Frame,r=i.ChartBorder.GetLeft(),n=i.ChartBorder.GetTop(),s=i.ChartBorder.GetHeight(),o=i.ChartBorder.GetWidth();if(this.Canvas.beginPath(),this.Canvas.rect(r,n,o,s),this.Canvas.isPointInPath(t,e))return\x20parseInt(a)}return\x200},this.GetDataIndexByPoint=function(t){var\x20e=this.Frame;this.Frame.SubFrame&&this.Frame.SubFrame.length>0&&(e=this.Frame.SubFrame[0].Frame);var\x20a=null;if((a=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data)&&e){var\x20i=parseInt(e.GetXData(t));return\x20a.DataOffset+i}},this.GetSelectRectData=function(t){if(Math.abs(t.XStart-t.XEnd)<5)return!1;var\x20e=null;if(!(e=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data))return!1;var\x20a=this.GetDataIndexByPoint(t.XStart),i=this.GetDataIndexByPoint(t.XEnd);return!(Math.abs(a-i)<2)&&(t.Data=e,a>i?(t.Start=i,t.End=a):(t.Start=a,t.End=i),!0)},this.GetChartDrawPictureByPoint=function(t){for(var\x20e\x20in\x20this.ChartDrawPicture){var\x20a=this.ChartDrawPicture[e],i=a.IsPointIn(t.X,t.Y);if(!1!==i&&i>=0)return\x20t.ChartDrawPicture=a,t.PointIndex=i,!0}return!1},this.SaveToImage=function(t,e){if(this.UIElement.width<=0||this.UIElement.height<=0)return\x20null;if(this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return\x20null;JSConsole.Chart.Log(\x22[JSChartContainer::SaveToImage]\x22,this.UIElement);var\x20a=\x22rgb(255,255,255)\x22;e&&(a=e),this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height),this.Canvas.fillStyle=a,this.Canvas.fillRect(0,0,this.UIElement.width,this.UIElement.height);var\x20i=GetDevicePixelRatio();for(var\x20r\x20in\x20this.Canvas.lineWidth=i,this.Frame.Draw(),this.ChartPaint){(n=this.ChartPaint[r]).IsDrawFirst&&n.Draw()}for(var\x20r\x20in\x20this.ChartPaint){(n=this.ChartPaint[r]).IsDrawFirst||n.Draw()}for(var\x20r\x20in\x20this.ChartPaintEx){(n=this.ChartPaintEx[r]).Draw()}for(var\x20r\x20in\x20this.OverlayChartPaint){(n=this.OverlayChartPaint[r]).Draw()}for(var\x20r\x20in\x20this.ExtendChartPaint){(n=this.ExtendChartPaint[r]).IsDynamic||0!=n.IsAnimation||n.Draw()}for(var\x20r\x20in\x20this.Frame.DrawInsideHorizontal&&this.Frame.DrawInsideHorizontal(),this.Frame.DrawLock(),this.ExtendChartPaint){(n=this.ExtendChartPaint[r]).IsDynamic&&!1===n.DrawAfterTitle&&n.Draw()}for(var\x20r\x20in\x20null==this.LastPoint.X&&null==this.LastPoint.Y||this.ChartCorssCursor&&(this.ChartCorssCursor.LastPoint=this.LastPoint,this.ChartCorssCursor.CursorIndex=this.CursorIndex),this.TitlePaint){(n=this.TitlePaint[r]).IsDynamic&&(n.CursorIndex=this.CursorIndex,n.Draw())}for(var\x20r\x20in\x20this.ExtendChartPaint){(n=this.ExtendChartPaint[r]).IsDynamic&&!0===n.DrawAfterTitle&&0==n.IsAnimation&&n.Draw()}if(this.EnableAnimation)for(var\x20r\x20in\x20this.ExtendChartPaint){!0===(n=this.ExtendChartPaint[r]).IsAnimation&&n.Draw()}for(var\x20r\x20in\x20this.ChartDrawPicture){var\x20n;(n=this.ChartDrawPicture[r]).Draw()}this.CurrentChartDrawPicture&&10!=this.CurrentChartDrawPicture.Status&&this.CurrentChartDrawPicture.Draw();var\x20s=this.UIElement.toDataURL(t||\x22image/png\x22,1);return\x20JSConsole.Chart.Log(\x22[JSChartContainer::SaveToImage]\x20data=\x20\x22,s),s},this.SaveToImageUrl=function(t,e){t||(t={Format:\x22image/png\x22,ColorGB:\x22rgb(255,255,255)\x22});var\x20a={Base64:this.SaveToImage(t.Format,t.ColorGB),BucketName:\x22downloadcache\x22,Path:\x22hqchart/hq_snapshot\x22},i=g_JSChartResource.Domain+\x22/API/FileUploadForBase64\x22;JSNetwork.HttpRequest({url:i,method:\x22POST\x22,dataType:\x22json\x22,data:a,success:function(t){JSConsole.Chart.Log(\x22[JSChartContainer::SaveToImageUrl]\x20recv\x20data\x22,t);var\x20a={Path:t.relativeurl,Domain:\x22https://opensourcedownload.zealink.com\x22};a.Url=`${a.Domain}/${a.Path}`,e&&e(!0,a,\x22\x22)},error:function(t){JSConsole.Chart.Log(\x22[JSChartContainer::SaveToImageUrl]\x20error\x20\x22,t),e&&e(!1,null,\x22upload\x20failed\x22)}})},this.SetLanguage=function(t){var\x20e=null;switch(t){case\x22EN\x22:e=JSCHART_LANGUAGE_ID.LANGUAGE_ENGLISH_ID;break;case\x22CN\x22:e=JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID;break;default:return\x20void\x20console.warn(`[JSChartContainer::SetLanguage]\x20language=${t}\x20error`)}if(this.LanguageID!=e){for(var\x20a\x20in\x20this.LanguageID=e,this.ChartCorssCursor&&this.ChartCorssCursor.StringFormatY&&(this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID),this.TitlePaint){var\x20i=this.TitlePaint[a];i&&(i.LanguageID=this.LanguageID)}this.Frame&&this.Frame.SetLanguage&&this.Frame.SetLanguage(this.LanguageID),this.Frame.SetSizeChage(!0),this.Draw()}},this.ReloadTiltePaintResource=function(t){for(var\x20e\x20in\x20this.TitlePaint){var\x20a=this.TitlePaint[e];a.ReloadResource&&a.ReloadResource(t)}},this.ReloadResource=function(t){this.ReloadBorder(t),this.ReloadTiltePaintResource(t.Resource),this.ReloadChartPaint(t.Resource),this.ReloadFrame(t.Resource),this.ReloadChartCorssCursor(t,t.Resource),t.Update&&this.Update?this.Update({UpdateCursorIndexType:2}):1==t.Draw&&this.Draw()},this.ReloadBorder=function(t){if(t){var\x20e=GetDevicePixelRatio();if(t.Border){var\x20a=t.Border;IFrameSplitOperator.IsNumber(a.Left)&&(this.Frame.ChartBorder.Left=a.Left*e),IFrameSplitOperator.IsNumber(a.Right)&&(this.Frame.ChartBorder.Right=a.Right*e),IFrameSplitOperator.IsNumber(a.Top)&&(this.Frame.ChartBorder.Top=a.Top*e),IFrameSplitOperator.IsNumber(a.Bottom)&&(this.Frame.ChartBorder.Bottom=a.Bottom*e)}for(var\x20i\x20in\x20t.Windows){a=t.Windows[i];if(!(i>=this.Frame.SubFrame.length)){var\x20r=this.Frame.SubFrame[i].Frame.ChartBorder;IFrameSplitOperator.IsNumber(a.TitleHeight)&&(r.TitleHeight=a.TitleHeight*e)}}for(var\x20i\x20in\x20t.Frame){a=t.Frame[i];if(!(i>=this.Frame.SubFrame.length)){r=this.Frame.SubFrame[i].Frame.ChartBorder;a.TopSpace>=0&&(r.TopSpace=a.TopSpace*e),a.BottomSpace>=0&&(r.BottomSpace=a.BottomSpace*e)}}}},this.ReloadFrame=function(t){for(var\x20e\x20in\x20this.Frame.SubFrame){var\x20a=this.Frame.SubFrame[e].Frame;a&&a.ReloadResource&&a.ReloadResource(t)}},this.ReloadChartPaint=function(t){for(var\x20e\x20in\x20this.ChartPaint){var\x20a=this.ChartPaint[e];a&&a.ReloadResource&&a.ReloadResource(t)}},this.ReloadChartCorssCursor=function(t,e){var\x20a=GetDevicePixelRatio();if(t&&t.CorssCursor){var\x20i=t.CorssCursor;IFrameSplitOperator.IsNumber(i.TitleHeight)&&(this.ChartCorssCursor.TextHeight=i.TitleHeight*a)}this.ChartCorssCursor.ReloadResource&&this.ChartCorssCursor.ReloadResource(e)},this.SetDepthMapData=function(t,e){for(var\x20a\x20in\x20t){var\x20i=t[a];for(var\x20r\x20in\x20this.ExtendChartPaint){var\x20n=this.ExtendChartPaint[r];if(n.ID==i.ID){n.Data=i.Data;break}}}e&&this.Draw()},this.PointAbsoluteToRelative=function(t,e,a){var\x20i={X:t,Y:e},r=GetDevicePixelRatio(),n=this.UIElement.getBoundingClientRect();return\x20a?(i.X=t-n.left*r,i.Y=e-n.top*r):(i.X=(t-n.left)*r,i.Y=(e-n.top)*r),i},this.SetChartDrawPictureFirstPoint=function(t,e,a){var\x20i=this.CurrentChartDrawPicture;if(!i)return!1;if(!this.Frame.SubFrame||this.Frame.SubFrame.length<=0)return!1;var\x20r=this.PointAbsoluteToRelative(t,e,a),n=r.X,s=r.Y;for(var\x20o\x20in\x20this.Frame.SubFrame){var\x20h=this.Frame.SubFrame[o].Frame,l=h.ChartBorder.GetLeft(),C=h.ChartBorder.GetTopEx(),u=h.ChartBorder.GetHeight(),D=h.ChartBorder.GetWidth();if(this.Canvas.beginPath(),this.Canvas.rect(l,C,D,u),this.Canvas.isPointInPath(n,s)){i.Frame=h;break}}return!!i.Frame&&(i.Point[0]=new\x20Point,i.Point[0].X=n,i.Point[0].Y=s,i.Status=1,!0)},this.SetChartDrawPictureSecondPoint=function(t,e,a){var\x20i=this.CurrentChartDrawPicture;if(!i)return!1;var\x20r=this.PointAbsoluteToRelative(t,e,a);return\x20i.Point[1]=new\x20Point,i.Point[1].X=r.X,i.Point[1].Y=r.Y,i.Status=2,!0},this.SetChartDrawPictureThirdPoint=function(t,e,a){var\x20i=this.CurrentChartDrawPicture;if(!i)return!1;var\x20r=this.PointAbsoluteToRelative(t,e,a);return\x20i.Point[2]=new\x20Point,i.Point[2].X=r.X,i.Point[2].Y=r.Y,i.Status=3,!0},this.MoveChartDrawPicture=function(t,e,a){var\x20i=this.CurrentChartDrawPicture;if(!i)return!1;var\x20r=GetDevicePixelRatio();a&&(r=1);var\x20n=t*r,s=e*r;return\x20i.Move(n,s),!0},this.FinishChartDrawPicturePoint=function(){var\x20t=this.CurrentChartDrawPicture;if(!t)return!1;if(t.PointCount!=t.Point.length)return!1;t.Status=10,t.PointToValue(),this.ChartDrawPicture.push(t),this.CurrentChartDrawPicture=null;let\x20e=this.GetEventCallback(JSCHART_EVENT_ID.ON_FINISH_DRAWPICTURE);if(e&&e.Callback){let\x20a={DrawPicture:t};e.Callback(e,a,this)}else\x20t.FinishedCallback&&t.FinishedCallback(t);return\x20this.ChartDrawStorage&&this.ChartDrawStorage.SaveDrawData(t),!0},this.OnSelectChartPicture=function(t){JSConsole.Chart.Log(\x22[JSChartContainer::OnSelectChartPicture\x22,t),this.ChartPictureMenu||(this.ChartPictureMenu=new\x20ChartPictureSettingMenu(this.UIElement.parentNode));var\x20e={data:{ChartPicture:t,HQChart:this}};this.ChartPictureMenu.DoModal(e)},this.FinishMoveChartDrawPicture=function(){var\x20t=this.CurrentChartDrawPicture;return!!t&&(t.PointCount==t.Point.length&&(t.Status=10,t.PointToValue(),this.ChartDrawStorage&&this.ChartDrawStorage.SaveDrawData(t),this.CurrentChartDrawPicture=null,!0))},this.ClearChartDrawPicture=function(t){if(t)for(var\x20e\x20in\x20this.ChartDrawPicture)this.ChartDrawPicture[e]==t&&(this.ChartDrawStorage&&this.ChartDrawStorage.DeleteDrawData(t),this.ChartDrawPicture.splice(e,1),this.Draw());else\x20this.ChartDrawPicture=[],this.ChartDrawStorage&&this.ChartDrawStorage.Clear(),this.Draw()},this.SetChartDrawOption=function(t){IFrameSplitOperator.IsBool(t.IsLockScreen)&&(this.ChartDrawOption.IsLockScreen=t.IsLockScreen),IFrameSplitOperator.IsNumber(t.Zoom)&&t.Zoom>=0&&(this.ChartDrawOption.Zoom=t.Zoom)},this.EnableShowCorssCursorLine=function(t){this.ChartCorssCursor&&(this.ChartCorssCursor.IsShowCorss=t)}}function\x20GetDevicePixelRatio(){return\x22undefined\x22==typeof\x20window?1:window.devicePixelRatio||1}function\x20IsPhoneWeb(){var\x20t=navigator.userAgent;const\x20e=new\x20Array(\x22Android\x22,\x22iPhone\x22,\x22SymbianOS\x22,\x22Windows\x20Phone\x22,\x22iPad\x22,\x22iPod\x22);for(var\x20a=0;a<e.length;a++)if(t.indexOf(e[a])>0)return!0;return!1}function\x20OnKeyDown(t){this.JSChartContainer&&this.JSChartContainer.OnKeyDown&&this.JSChartContainer.OnKeyDown(t)}function\x20OnWheel(t){this.JSChartContainer&&this.JSChartContainer.OnWheel&&this.JSChartContainer.OnWheel(t)}function\x20ToFixed(t,e){var\x20a=1;if(isNaN(t))return\x20t;t<0&&(a=-1);var\x20i=Math.pow(10,e),r=Math.round(Math.abs(t)*i)/i*a;if(/^(d+(?:.d+)?)(e)([-]?d+)$/.test(r))var\x20n=r.toFixed2(e);else\x20n=r.toString();var\x20s=n.indexOf(\x22.\x22);for(s<0&&e>0&&(s=n.length,n+=\x22.\x22);n.length<=s+e;)n+=\x220\x22;return\x20n}function\x20Guid(){function\x20t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return\x22guid\x22+(t()+t())+\x22-\x22+t()+\x22-\x22+t()+\x22-\x22+t()+\x22-\x22+t()+t()+t()}function\x20GetScrollPosition(){var\x20t={},e=0,a=0;return\x20document.documentElement&&document.documentElement.scrollTop?(e=document.documentElement.scrollTop,a=document.documentElement.scrollLeft):document.body&&(e=document.body.scrollTop,a=document.body.scrollLeft),t.Top=e,t.Left=a,t}function\x20ToFixedPoint(t){return\x20parseInt(t)+.5}function\x20ToFixedRect(t){return.5+t<<0}function\x20Point(){this.X,this.Y}function\x20SelectRectData(){this.Data,this.JSChartContainer,this.Start,this.End,this.XStart,this.XEnd}function\x20CoordinateInfo(){this.Value,this.Message=new\x20Array,this.TextColor=g_JSChartResource.FrameSplitTextColor,this.Font=g_JSChartResource.FrameSplitTextFont,this.LineColor=g_JSChartResource.FrameSplitPen,this.LineType=1}function\x20ChartBorder(){this.UIElement,this.Left=50,this.Right=80,this.Top=50,this.Bottom=50,this.TitleHeight=24,this.TopSpace=0,this.BottomSpace=0,this.GetChartWidth=function(){return\x20this.UIElement.width},this.GetChartHeight=function(){return\x20this.UIElement.height},this.GetLeft=function(){return\x20this.Left},this.GetRight=function(){return\x20this.UIElement.width-this.Right},this.GetTop=function(){return\x20this.Top},this.GetTopEx=function(){return\x20this.Top+this.TitleHeight+this.TopSpace},this.GetTopTitle=function(){return\x20this.Top+this.TitleHeight},this.GetBottom=function(){return\x20this.UIElement.height-this.Bottom},this.GetBottomEx=function(){return\x20this.UIElement.height-this.Bottom-this.BottomSpace},this.GetWidth=function(){return\x20this.UIElement.width-this.Left-this.Right},this.GetHeight=function(){return\x20this.UIElement.height-this.Top-this.Bottom},this.GetHeightEx=function(){return\x20this.UIElement.height-this.Top-this.Bottom-this.TitleHeight-this.TopSpace-this.BottomSpace},this.GetRightEx=function(){return\x20this.UIElement.width-this.Right-this.TitleHeight-this.TopSpace},this.GetWidthEx=function(){return\x20this.UIElement.width-this.Left-this.Right-this.TitleHeight-this.TopSpace-this.BottomSpace},this.GetLeftEx=function(){return\x20this.Left+this.BottomSpace},this.GetRightTitle=function(){return\x20this.UIElement.width-this.Right-this.TitleHeight},this.GetTitleHeight=function(){return\x20this.TitleHeight}}function\x20IChartFramePainting(){this.HorizontalInfo=new\x20Array,this.VerticalInfo=new\x20Array,this.ClassName=\x22IChartFramePainting\x22,this.Canvas,this.Identify,this.ChartBorder,this.PenBorder=g_JSChartResource.FrameBorderPen,this.TitleBGColor=g_JSChartResource.FrameTitleBGColor,this.IsShow=!0,this.SizeChange=!0,this.XYSplit=!0,this.HorizontalMax,this.HorizontalMin,this.XPointCount=10,this.YSplitOperator,this.XSplitOperator,this.Data,this.IsLocked=!1,this.LockPaint=null,this.YSpecificMaxMin=null,this.IsShowBorder=!0,this.IsShowTitleArraw=!0,this.IsShowIndexName=!0,this.IndexParamSpace=2,this.BorderLine=null,this.Draw=function(){this.DrawFrame(),this.DrawBorder(),this.SizeChange=!1,this.XYSplit=!1},this.DrawFrame=function(){},this.DrawBorder=function(){if(this.IsShowBorder){var\x20t=ToFixedPoint(this.ChartBorder.GetLeft()),e=ToFixedPoint(this.ChartBorder.GetTop()),a=ToFixedPoint(this.ChartBorder.GetRight()),i=ToFixedPoint(this.ChartBorder.GetBottom()),r=a-t,n=i-e;null==this.BorderLine?(this.Canvas.strokeStyle=this.PenBorder,this.Canvas.strokeRect(t,e,r,n)):IFrameSplitOperator.IsPlusNumber(this.BorderLine)&&(this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),(1&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(a,e)),(2&this.BorderLine)>0&&(this.Canvas.moveTo(t,i),this.Canvas.lineTo(a,i)),(4&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(t,i)),(8&this.BorderLine)>0&&(this.Canvas.moveTo(a,e),this.Canvas.lineTo(a,i)),this.Canvas.stroke())}},this.DrawTitleBG=function(){if(!(this.ChartBorder.TitleHeight<=0)){var\x20t=ToFixedPoint(this.ChartBorder.GetLeft()),e=ToFixedPoint(this.ChartBorder.GetTop()),a=ToFixedPoint(this.ChartBorder.GetRight())-t,i=ToFixedPoint(this.ChartBorder.GetTopTitle())-e;this.Canvas.fillStyle=this.TitleBGColor,this.Canvas.fillRect(t,e,a,i)}},this.DrawLock=function(){this.IsLocked&&(null==this.LockPaint&&(this.LockPaint=new\x20ChartLock),this.LockPaint.Canvas=this.Canvas,this.LockPaint.ChartBorder=this.ChartBorder,this.LockPaint.ChartFrame=this,this.LockPaint.Draw(!0))},this.CalculateLock=function(){this.IsLocked&&(null==this.LockPaint&&(this.LockPaint=new\x20ChartLock),this.LockPaint.Canvas=this.Canvas,this.LockPaint.ChartBorder=this.ChartBorder,this.LockPaint.ChartFrame=this,this.LockPaint.Draw(!1))},this.SetLock=function(t){t?(this.IsLocked=!0,this.LockPaint||(this.LockPaint=new\x20ChartLock),t.Callback&&(this.LockPaint.Callback=t.Callback),t.IndexName&&(this.LockPaint.IndexName=t.IndexName),t.ID&&(this.LockPaint.LockID=t.ID),t.BG&&(this.LockPaint.BGColor=t.BG),t.Text&&(this.LockPaint.Title=t.Text),t.TextColor&&(this.LockPaint.TextColor=t.TextColor),t.Font&&(this.LockPaint.Font=t.Font),t.Count&&(this.LockPaint.LockCount=t.Count),t.MinWidth>0&&(this.LockPaint.MinWidth=t.MinWidth)):this.IsLocked=!1},this.GetLockRect=function(){return\x20this.IsLocked&&this.LockPaint?this.LockPaint.LockRect:null},this.ReloadResource=function(t){for(var\x20e\x20in\x20t||(this.PenBorder=g_JSChartResource.FrameBorderPen,this.TitleBGColor=g_JSChartResource.FrameTitleBGColor),this.HorizontalInfo){(a=this.HorizontalInfo[e]).Font&&(a.Font=g_JSChartResource.FrameSplitTextFont),a.TextColor&&(a.TextColor=g_JSChartResource.FrameSplitTextColor),a.LineColor&&(a.LineColor=g_JSChartResource.FrameSplitPen)}for(var\x20e\x20in\x20this.VerticalInfo){var\x20a;(a=this.VerticalInfo[e]).Font&&(a.Font=g_JSChartResource.FrameSplitTextFont),a.TextColor&&(a.TextColor=g_JSChartResource.FrameSplitTextColor),a.LineColor&&(a.LineColor=g_JSChartResource.FrameSplitPen)}}}function\x20NoneFrame(){this.newMethod=IChartFramePainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22NoneFrame\x22,this.Snapshot=function(){},this.SetSizeChage=function(t){this.SizeChange=t,this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight}}}function\x20AverageWidthFrame(){this.newMethod=IChartFramePainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22AverageWidthFrame\x22,this.DataWidth=50*GetDevicePixelRatio(),this.DistanceWidth=10*GetDevicePixelRatio(),this.MinXDistance=30*GetDevicePixelRatio(),this.MinYDistance=12*GetDevicePixelRatio(),this.CoordinateType=0,this.IsShowYText=[!0,!0],this.XBottomOffset=g_JSChartResource.Frame.XBottomOffset,this.YTextTopOffset=g_JSChartResource.Frame.YTopOffset,this.YTextPosition=[0,0],this.IsShowXLine=!0,this.IsShowYLine=!0,this.DrawDepthMapCallback,this.DrawFrame=function(){if(this.XPointCount>0){let\x20t=this.ChartBorder.GetWidth()/(6*this.XPointCount);this.DistanceWidth=2*t,this.DataWidth=4*t}this.DrawHorizontal(),this.DrawVertical()},this.GetYFromData=function(t,e){if(this.Logarithmic&&this.GetYLogarithmicFromData)return\x20this.GetYLogarithmicFromData(t,e);if(!1===e){if(1==this.CoordinateType){var\x20a=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return\x20this.ChartBorder.GetTopEx()+a}a=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return\x20this.ChartBorder.GetBottomEx()-a}if(1==this.CoordinateType){if(t<=this.HorizontalMin)return\x20this.ChartBorder.GetTopEx();if(t>=this.HorizontalMax)return\x20this.ChartBorder.GetBottomEx();a=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return\x20this.ChartBorder.GetTopEx()+a}if(t<=this.HorizontalMin)return\x20this.ChartBorder.GetBottomEx();if(t>=this.HorizontalMax)return\x20this.ChartBorder.GetTopEx();a=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return\x20this.ChartBorder.GetBottomEx()-a},this.DrawHorizontal=function(){for(var\x20t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetTopTitle(),r=this.ChartBorder.Right,n=this.ChartBorder.Left>10&&!0===this.IsShowYText[0]&&2!=this.YTextPosition[0],s=r>10&&!0===this.IsShowYText[1]&&2!=this.YTextPosition[1],o=null,h=this.HorizontalInfo.length-1;h>=0;--h){var\x20l=this.HorizontalInfo[h],C=this.GetYFromData(l.Value);if(!(null!=C&&null!=o&&Math.abs(C-o)<this.MinYDistance)){C!=a&&this.IsShowYLine&&(this.Canvas.strokeStyle=l.LineColor,2==l.LineType?(this.Canvas.save(),this.Canvas.setLineDash([5,5]),this.Canvas.beginPath(),this.Canvas.moveTo(t,ToFixedPoint(C)),this.Canvas.lineTo(e,ToFixedPoint(C)),this.Canvas.stroke(),this.Canvas.restore()):g_JSChartResource.FrameYLineDash?(this.Canvas.save(),this.Canvas.setLineDash(g_JSChartResource.FrameYLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(t,ToFixedPoint(C)),this.Canvas.lineTo(e,ToFixedPoint(C)),this.Canvas.stroke(),this.Canvas.restore()):(this.Canvas.beginPath(),this.Canvas.moveTo(t,ToFixedPoint(C)),this.Canvas.lineTo(e,ToFixedPoint(C)),this.Canvas.stroke()));var\x20u=C;C>=a-2?this.Canvas.textBaseline=\x22bottom\x22:C<=i+2?(this.Canvas.textBaseline=\x22top\x22,u+=this.YTextTopOffset):this.Canvas.textBaseline=\x22middle\x22,null!=l.Message[0]&&n&&(null!=l.Font&&(this.Canvas.font=l.Font),this.Canvas.fillStyle=l.TextColor,this.Canvas.textAlign=\x22right\x22,this.Canvas.fillText(l.Message[0],t-2,u)),null!=l.Message[1]&&s&&(null!=l.Font&&(this.Canvas.font=l.Font),this.Canvas.fillStyle=l.TextColor,this.Canvas.textAlign=\x22left\x22,this.Canvas.fillText(l.Message[1],e+2,u)),o=C}}},this.DrawInsideHorizontal=function(){if(!0!==this.IsHScreen&&(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1])){var\x20t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetTopTitle(),r=this.ChartBorder.Right,n=this.ChartBorder.Left,s=(this.ChartBorder.TitleHeight,(n<10||2==this.YTextPosition[0])&&!0===this.IsShowYText[0]),o=(r<10||2==this.YTextPosition[1])&&!0===this.IsShowYText[1];if(s||o)for(var\x20h=GetDevicePixelRatio(),l=null,C=this.HorizontalInfo.length-1;C>=0;--C){var\x20u=this.HorizontalInfo[C],D=this.GetYFromData(u.Value);if(!(null!=D&&null!=l&&Math.abs(D-l)<this.MinYDistance)){if(null!=u.Message[0]&&s){null!=u.Font&&(this.Canvas.font=u.Font),this.Canvas.fillStyle=u.TextColor,this.Canvas.textAlign=\x22left\x22;var\x20d=D;D>=a-2?this.Canvas.textBaseline=\x22bottom\x22:D<=i+2?(this.Canvas.textBaseline=\x22top\x22,d+=this.YTextTopOffset):this.Canvas.textBaseline=\x22middle\x22;var\x20c={X:t,Y:d,Text:{BaseLine:this.Canvas.textBaseline,TextAlign:this.Canvas.textAlign,Font:this.Canvas.font,Value:u.Message[0]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(c)||this.Canvas.fillText(u.Message[0],t+1*h,d)}if(null!=u.Message[1]&&o){null!=u.Font&&(this.Canvas.font=u.Font),this.Canvas.fillStyle=u.TextColor,this.Canvas.textAlign=\x22right\x22;d=D;D>=a-2?this.Canvas.textBaseline=\x22bottom\x22:D<=i+2?(this.Canvas.textBaseline=\x22top\x22,d+=this.YTextTopOffset):this.Canvas.textBaseline=\x22middle\x22;c={X:e-this.Canvas.measureText(u.Message[1]).width,Y:d,Text:{BaseLine:this.Canvas.textBaseline,TextAlign:this.Canvas.textAlign,Font:this.Canvas.font,Value:u.Message[1]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(c)||this.Canvas.fillText(u.Message[1],e-1*h,d)}l=D}}}},this.GetXFromIndex=function(t){var\x20e=this.XPointCount;return\x201==e?0==t?this.ChartBorder.GetLeft():this.ChartBorder.GetRight():e<=0?this.ChartBorder.GetLeft():t>=e?this.ChartBorder.GetRight():this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*t/e},this.DrawVertical=function(){var\x20t=this.ChartBorder.GetTopTitle(),e=this.ChartBorder.GetBottom(),a=this.ChartBorder.GetRight();GetDevicePixelRatio();if(!(this.ChartBorder.Bottom<=5*GetDevicePixelRatio())){var\x20i=null,r=null;for(var\x20n\x20in\x20this.VerticalInfo){var\x20s=this.GetXFromIndex(this.VerticalInfo[n].Value);if(s>a)break;if(!(null!=i&&Math.abs(s-i)<this.MinXDistance)){if(this.VerticalInfo[n].LineType>0&&this.IsShowXLine&&(this.Canvas.strokeStyle=this.VerticalInfo[n].LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(ToFixedPoint(s),t),this.Canvas.lineTo(ToFixedPoint(s),e),this.Canvas.stroke()),null!=this.VerticalInfo[n].Message[0]){null!=this.VerticalInfo[n].Font&&(this.Canvas.font=this.VerticalInfo[n].Font);var\x20o=0;this.Canvas.fillStyle=this.VerticalInfo[n].TextColor;var\x20h=this.Canvas.measureText(this.VerticalInfo[n].Message[0]).width;s<h/2?(this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22top\x22,o=s):s+h/2>=this.ChartBorder.GetChartWidth()?(this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22top\x22,o=s-h):(this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22top\x22,o=s-h/2),(null==r||o>r)&&(this.Canvas.fillText(this.VerticalInfo[n].Message[0],s,e+this.XBottomOffset),r=o+h)}i=s}}}},this.GetYData=function(t,e){return\x20this.Logarithmic&&this.GetYLogarithmicFromData?this.GetYLogarithmicData(t):1==this.CoordinateType?0==e?(t-this.ChartBorder.GetTopEx())/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin:t<this.ChartBorder.GetTopEx()?this.HorizontalMin:t>this.ChartBorder.GetBottomEx()?this.HorizontalMax:(t-this.ChartBorder.GetTopEx())/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin:0==e?(this.ChartBorder.GetBottomEx()-t)/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin:t<this.ChartBorder.GetTopEx()?this.HorizontalMax:t>this.ChartBorder.GetBottomEx()?this.HorizontalMin:(this.ChartBorder.GetBottomEx()-t)/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t){return\x20t<=this.ChartBorder.GetLeft()?0:t>=this.ChartBorder.GetRight()?this.XPointCount:(t-this.ChartBorder.GetLeft())*(1*this.XPointCount/this.ChartBorder.GetWidth())},this.DrawCustomItem=function(t){if((t.Message[1]||t.Message[0])&&!(t.Value>this.HorizontalMax||t.Value<this.HorizontalMin)){var\x20e=this.ChartBorder.GetLeft(),a=this.ChartBorder.GetRight(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetTopTitle(),n=this.ChartBorder.Right,s=this.ChartBorder.Left;this.ChartBorder.TitleHeight;this.IsHScreen&&(s=this.ChartBorder.Top,n=this.ChartBorder.Bottom,r=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom());var\x20o=GetDevicePixelRatio(),h=18*o,l=this.GetYFromData(t.Value);if(t.Message[0])if(s<10){null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22;var\x20C=this.Canvas.measureText(t.Message[0]).width+2*o,u=t.LineColor;if((c=this.RGBToStruct(t.LineColor))&&(u=`rgba(${c.R},\x20${c.G},\x20${c.B},\x20${g_JSChartResource.FrameLatestPrice.BGAlpha})`),this.Canvas.fillStyle=u,this.IsHScreen){var\x20D=r,d=l-h/2-1*o;this.Canvas.fillRect(d,D,h,C),this.DrawHScreenText({X:l,Y:D},{Text:t.Message[0],Color:t.TextColor,XOffset:1*o,YOffset:2*o}),this.DrawLine(D+C,i,l,t.LineColor,t.LineType)}else{D=l-h/2-1*o,d=e+1*o;this.Canvas.fillRect(d,D,C,h),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Message[0],d+1*o,l),this.DrawLine(d+C,a,l,t.LineColor,t.LineType)}}else{null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22;C=this.Canvas.measureText(t.Message[0]).width+2*o;if(this.Canvas.fillStyle=t.LineColor,this.IsHScreen){D=r-C,d=l-h/2-1*o;this.Canvas.fillRect(d,D,h,C),this.DrawHScreenText({X:l,Y:D},{Text:t.Message[0],Color:t.TextColor,XOffset:1*o,YOffset:2*o}),this.DrawLine(D+C,i,l,t.LineColor,t.LineType)}else{D=l-h/2-1*o;this.Canvas.fillRect(e-C,D,C,h),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Message[0],e-1*o,l),this.DrawLine(e,a,l,t.LineColor,t.LineType)}}else\x20if(t.Message[1])if(n<10){null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22;var\x20c;C=this.Canvas.measureText(t.Message[1]).width+2*o,u=t.LineColor;if((c=this.RGBToStruct(t.LineColor))&&(u=`rgba(${c.R},\x20${c.G},\x20${c.B},\x20${g_JSChartResource.FrameLatestPrice.BGAlpha})`),this.Canvas.fillStyle=u,this.IsHScreen){D=i-C,d=l-h/2-1*o;this.Canvas.fillRect(d,D,h,C),this.DrawHScreenText({X:l,Y:D},{Text:t.Message[1],Color:t.TextColor,XOffset:1*o,YOffset:2*o}),this.DrawLine(r,D,l,t.LineColor,t.LineType)}else{D=l-h/2-1*o,d=a-C;this.Canvas.fillRect(d,D,C,h),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Message[1],d+1*o,l),this.DrawLine(e,d,l,t.LineColor,t.LineType)}}else{null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22;C=this.Canvas.measureText(t.Message[1]).width+2*o;if(this.Canvas.fillStyle=t.LineColor,this.IsHScreen){D=i,d=l-h/2-1*o;this.Canvas.fillRect(d,D,h,C),this.DrawHScreenText({X:l,Y:D},{Text:t.Message[1],Color:t.TextColor,XOffset:1*o,YOffset:2*o}),this.DrawLine(r,D,l,t.LineColor,t.LineType)}else{D=l-h/2-1*o;this.Canvas.fillRect(a,D,C,h),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Message[1],a+1*o,l),this.DrawLine(e,a,l,t.LineColor,t.LineType)}}}},this.DrawDotLine=function(t,e,a,i){var\x20r=GetDevicePixelRatio();this.Canvas.save(),this.Canvas.strokeStyle=i,this.Canvas.setLineDash([5*r,5*r]),this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(ToFixedPoint(a),t),this.Canvas.lineTo(ToFixedPoint(a),e)):(this.Canvas.moveTo(t,ToFixedPoint(a)),this.Canvas.lineTo(e,ToFixedPoint(a))),this.Canvas.stroke(),this.Canvas.restore()},this.DrawLine=function(t,e,a,i,r){-1!=r&&(0==r?(this.Canvas.strokeStyle=i,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(ToFixedPoint(a),t),this.Canvas.lineTo(ToFixedPoint(a),e)):(this.Canvas.moveTo(t,ToFixedPoint(a)),this.Canvas.lineTo(e,ToFixedPoint(a))),this.Canvas.stroke()):this.DrawDotLine(t,e,a,i))},this.DrawHScreenText=function(t,e){this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=e.Color,this.Canvas.save(),this.Canvas.translate(t.X,t.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(e.Text,e.XOffset,e.YOffset),this.Canvas.restore()},this.RGBToStruct=function(t){if(/^(rgb|RGB)/.test(t)){var\x20e=t.replace(/(?:(|)|rgb|RGB)*/g,\x22\x22).split(\x22,\x22),a={};return\x203!=e.length?null:(a.R=Number(e[0]),a.G=Number(e[1]),a.B=Number(e[2]),a)}return\x20null}}function\x20MinuteFrame(){this.newMethod=AverageWidthFrame,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22MinuteFrame\x22,this.DataWidth=1*GetDevicePixelRatio(),this.DistanceWidth=1*GetDevicePixelRatio(),this.MinuteCount=243,this.IsBeforeData=!1,this.BeforeBGColor=g_JSChartResource.Minute.BeforeBGColor,this.CustomHorizontalInfo=[],this.RightFrame=null,this.ToolbarID=Guid(),this.ReDrawToolbar=!1,this.ModifyIndex=!0,this.ChangeIndex=!0,this.CloseIndex=!0,this.ModifyIndexEvent,this.ChangeIndexEvent,this.ToolbarRect=null,this.LastCalculateStatus={Width:0,XPointCount:0},this.DrawFrame=function(){this.SplitXYCoordinate(),this.IsBeforeData&&this.DrawBeforeDataBG(),this.DrawTitleBG(),this.DrawHorizontal(),this.DrawVertical(),1!=this.SizeChange&&1!=this.ReDrawToolbar||(this.DrawToolbar(),this.ReDrawToolbar=!1)},this.SuperDrawBorder=this.DrawBorder,this.DrawBorder=function(){if(this.IsShowBorder&&(this.SuperDrawBorder(),1==this.Identify)){var\x20t=ToFixedPoint(this.ChartBorder.GetLeft()),e=ToFixedPoint(this.ChartBorder.GetTop()),a=ToFixedPoint(this.ChartBorder.GetRight());this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(t,e),this.Canvas.lineTo(a,e),this.Canvas.save(),this.Canvas.lineWidth=2*GetDevicePixelRatio(),this.Canvas.stroke(),this.Canvas.restore()}},this.DrawToolbar=function(){if(this.Identify<2)return;if(!this.ChartBorder.UIElement)return;var\x20t=document.getElementById(this.ToolbarID);if(t&&0==this.SizeChange&&0==this.ReDrawToolbar)return;if(t||((t=document.createElement(\x22div\x22)).className=\x22klineframe-toolbar\x22,t.id=this.ToolbarID,t.oncontextmenu=function(){return!1},t.setAttribute(\x22identify\x22,this.Identify.toString()),this.ChartBorder.UIElement.parentNode.appendChild(t)),!this.ModifyIndex&&!this.ChangeIndex&&!this.OverlayIndex)return\x20void(\x22none\x22!=t.style.display&&(t.style.display=\x22none\x22));var\x20e=GetDevicePixelRatio(),a=parseInt(this.ChartBorder.UIElement.parentElement.style.width.replace(\x22px\x22,\x22\x22)),i=(parseInt(this.ChartBorder.UIElement.parentElement.style.height.replace(\x22px\x22,\x22\x22)),this.ChartBorder.GetTitleHeight()),r=a-this.ChartBorder.Right/e-100,n=this.ChartBorder.GetTop()/e;if(this.ToolbarRect&&this.ToolbarRect.Left==r&&this.ToolbarRect.Top==n&&100==this.ToolbarRect.Width&&this.ToolbarRect.Height==i/e)return;this.ToolbarRect={Left:r,Top:n,Width:100,Height:i/e};var\x20s=\x22<span\x20class=\x27index_param\x20icon\x20iconfont\x20icon-index_param\x27\x20id=\x27modifyindex\x27\x20style=\x27cursor:pointer;margin-left:2px;margin-right:2px;\x27\x20title=\x27调整指标参数\x27></span><span\x20class=\x27index_change\x20icon\x20iconfont\x20icon-change_index\x27\x20id=\x27changeindex\x27\x20style=\x27cursor:pointer;margin-left:2px;margin-right:2px;\x27\x20title=\x27切换指标\x27></span>\x22;this.CloseIndex&&(s+=\x22<span\x20class=\x27index_close\x20icon\x20iconfont\x20icon-close\x27\x20id=\x27closeindex\x27\x20style=\x27cursor:pointer;margin-left:2px;margin-right:2px;\x27\x20title=\x27关闭指标窗口\x27></span>\x22),t.style.left=r+\x22px\x22,t.style.top=n+\x22px\x22,t.style.width=\x22100px\x22,t.style.height=i/e+\x22px\x22,t.innerHTML=s;this.ChartBorder.UIElement.JSChartContainer,this.Identify;this.ModifyIndex?\x22function\x22==typeof\x20this.ModifyIndexEvent&&$(\x22#\x22+t.id+\x22\x20.index_param\x22).click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify},this.ModifyIndexEvent):$(\x22#\x22+t.id+\x22\x20.index_param\x22).hide(),this.ChangeIndex?\x22function\x22==typeof\x20this.ChangeIndexEvent&&$(\x22#\x22+t.id+\x22\x20.index_change\x22).click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify,IsOverlay:!1},this.ChangeIndexEvent):$(\x22#\x22+t.id+\x22\x20.index_change\x22).hide(),$(\x22#\x22+t.id+\x22\x20.index_close\x22).click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify},function(t){var\x20e=t.data.Chart,a=t.data.Identify;e.RemoveIndexWindow(a)}),t.style.display=\x22block\x22},this.ClearToolbar=function(){var\x20t=document.getElementById(this.ToolbarID);t&&this.ChartBorder.UIElement.parentNode.removeChild(t)},this.DrawBeforeDataBG=function(){var\x20t=ToFixedPoint(this.ChartBorder.GetLeft()),e=ToFixedPoint(this.ChartBorder.GetTopEx()),a=this.GetXFromIndex(14)-t,i=ToFixedPoint(this.ChartBorder.GetBottom())-e;this.Canvas.fillStyle=this.BeforeBGColor,this.Canvas.fillRect(t,e,a,i)},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator())},this.GetXFromIndex=function(t){var\x20e=this.XPointCount-1;return\x201==e?0==t?this.ChartBorder.GetLeft():this.ChartBorder.GetRight():e<=0?this.ChartBorder.GetLeft():t>=e?this.ChartBorder.GetRight():this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*t/e},this.GetXData=function(t){var\x20e=this.XPointCount-1;return\x20e<0&&(e=0),t<=this.ChartBorder.GetLeft()?0:t>=this.ChartBorder.GetRight()?e:(t-this.ChartBorder.GetLeft())*(1*e/this.ChartBorder.GetWidth())},this.DrawCustomHorizontal=function(){for(var\x20t\x20in\x20this.CustomHorizontalInfo){var\x20e=this.CustomHorizontalInfo[t];switch(e.Type){case\x200:case\x201:this.DrawCustomItem(e)}}}}function\x20OverlayMinuteFrame(){this.newMethod=MinuteFrame,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22OverlayMinuteFrame\x22,this.IsShow=!0,this.Draw=function(){this.SplitXYCoordinate(),this.IsShow,this.SizeChange=!1,this.XYSplit=!1}}function\x20MinuteHScreenFrame(){this.newMethod=MinuteFrame,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22MinuteHScreenFrame\x22,this.IsHScreen=!0,this.DrawTitleBG=function(){if(!(this.ChartBorder.TitleHeight<=0)){var\x20t=ToFixedPoint(this.ChartBorder.GetRightEx()),e=ToFixedPoint(this.ChartBorder.GetTop()),a=ToFixedPoint(this.ChartBorder.GetBottom()),i=this.ChartBorder.TitleHeight,r=a-e;this.Canvas.fillStyle=this.TitleBGColor,this.Canvas.fillRect(t,e,i,r)}},this.DrawToolbar=function(){},this.DrawBeforeDataBG=function(){var\x20t=ToFixedPoint(this.ChartBorder.GetLeft()),e=ToFixedPoint(this.ChartBorder.GetRightEx()),a=ToFixedPoint(this.ChartBorder.GetTop()),i=e-t,r=this.GetXFromIndex(14)-a;this.Canvas.fillStyle=this.BeforeBGColor,this.Canvas.fillRect(t,a,i,r)},this.GetYData=function(t){return\x20t<this.ChartBorder.GetLeft()?this.HorizontalMin:t>this.ChartBorder.GetRightEx()?this.HorizontalMax:(t-this.ChartBorder.GetLeft())/this.ChartBorder.GetWidthEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t){var\x20e=this.XPointCount-1;return\x20e<0&&(e=0),t<=this.ChartBorder.GetTop()?0:t>=this.ChartBorder.GetBottom()?e:(t-this.ChartBorder.GetTop())*(1*e/this.ChartBorder.GetHeight())},this.GetXFromIndex=function(t){var\x20e=this.XPointCount-1;return\x201==e?0==t?this.ChartBorder.GetTop():this.ChartBorder.GetBottom():e<=0?this.ChartBorder.GetTop():t>=e?this.ChartBorder.GetBottom():this.ChartBorder.GetTop()+this.ChartBorder.GetHeight()*t/e},this.GetYFromData=function(t){if(t<=this.HorizontalMin)return\x20this.ChartBorder.GetLeft();if(t>=this.HorizontalMax)return\x20this.ChartBorder.GetRightEx();var\x20e=this.ChartBorder.GetWidthEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return\x20this.ChartBorder.GetLeft()+e},this.DrawHorizontal=function(){for(var\x20t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetBottom(),a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetRight(),r=this.ChartBorder.Top,n=this.ChartBorder.Bottom,s=null,o=this.HorizontalInfo.length-1;o>=0;--o){var\x20h=this.HorizontalInfo[o],l=this.GetYFromData(h.Value);if(!(null!=l&&Math.abs(l-s)<this.MinYDistance)){if(this.Canvas.strokeStyle=h.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(ToFixedPoint(l),t),this.Canvas.lineTo(ToFixedPoint(l),e),this.Canvas.stroke(),l>=i-2)this.Canvas.textBaseline=\x22top\x22,l=i;else\x20if(l<=a+2){if(this.Canvas.textBaseline=\x22bottom\x22,null!=(l=a)&&Math.abs(l-s)<2*this.MinYDistance)continue}else\x20this.Canvas.textBaseline=\x22middle\x22;if(null!=h.Message[0]&&r>10){null!=h.Font&&(this.Canvas.font=h.Font),this.Canvas.fillStyle=h.TextColor,this.Canvas.textAlign=\x22right\x22;var\x20C=l,u=t;this.Canvas.save(),this.Canvas.translate(C,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(h.Message[0],-2,0),this.Canvas.restore()}if(null!=h.Message[1]&&n>10){null!=h.Font&&(this.Canvas.font=h.Font),this.Canvas.fillStyle=h.TextColor,this.Canvas.textAlign=\x22left\x22;C=l,u=e;this.Canvas.save(),this.Canvas.translate(C,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(h.Message[1],2,0),this.Canvas.restore()}s=l}}},this.DrawVertical=function(){var\x20t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRightEx(),a=this.ChartBorder.GetBottom(),i=null;for(var\x20r\x20in\x20this.VerticalInfo){var\x20n=this.GetXFromIndex(this.VerticalInfo[r].Value);if(n>a)break;if(!(null!=i&&Math.abs(n-i)<this.MinXDistance)){if(this.Canvas.strokeStyle=this.VerticalInfo[r].LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t,ToFixedPoint(n)),this.Canvas.lineTo(e,ToFixedPoint(n)),this.Canvas.stroke(),null!=this.VerticalInfo[r].Message[0]){null!=this.VerticalInfo[r].Font&&(this.Canvas.font=this.VerticalInfo[r].Font),this.Canvas.fillStyle=this.VerticalInfo[r].TextColor;var\x20s=this.Canvas.measureText(this.VerticalInfo[r].Message[0]).width;n<s/2?(this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22top\x22):n+s/2>=this.ChartBorder.GetChartHeight()?(this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22top\x22):(this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22top\x22);var\x20o=t,h=n;this.Canvas.save(),this.Canvas.translate(o,h),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.VerticalInfo[r].Message[0],0,0),this.Canvas.restore()}i=n}}},this.DrawInsideHorizontal=function(){if(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1]){var\x20t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRightEx(),a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.Top,n=this.ChartBorder.Bottom;this.ChartBorder.TitleHeight;if(r<10*(s=GetDevicePixelRatio())&&!0===this.IsShowYText[0]||n<10*s&&!0===this.IsShowYText[1])for(var\x20s=GetDevicePixelRatio(),o=null,h=this.HorizontalInfo.length-1;h>=0;--h){var\x20l=this.HorizontalInfo[h],C=this.GetYFromData(l.Value);if(!(null!=C&&null!=o&&Math.abs(C-o)<this.MinYDistance)){if(null!=l.Message[0]&&r<10*s&&!0===this.IsShowYText[0]){null!=l.Font&&(this.Canvas.font=l.Font),this.Canvas.fillStyle=l.TextColor,this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=C>=e-2?\x22top\x22:C<=t+2?\x22bottom\x22:\x22middle\x22;this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,l.Message[0];var\x20u=C,D=a;this.Canvas.save(),this.Canvas.translate(u,D),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(l.Message[0],-2,0),this.Canvas.restore()}if(null!=l.Message[1]&&n<10*s&&!0===this.IsShowYText[1]){null!=l.Font&&(this.Canvas.font=l.Font),this.Canvas.fillStyle=l.TextColor,this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=C>=e-2?\x22top\x22:C<=t+2?\x22bottom\x22:\x22middle\x22;this.Canvas.measureText(l.Message[1]).width,this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,l.Message[1],u=C,D=i;this.Canvas.save(),this.Canvas.translate(u,D),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(l.Message[1],2,0),this.Canvas.restore()}o=C}}}}}function\x20KLineFrame(){this.newMethod=AverageWidthFrame,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22KLineFrame\x22,this.ToolbarID=Guid(),this.ModifyIndex=!0,this.ChangeIndex=!0,this.CloseIndex=!0,this.OverlayIndex=!1,this.ModifyIndexEvent,this.ChangeIndexEvent,this.ToolbarRect=null,this.ReDrawToolbar=!1,this.LastCalculateStatus={Width:0,XPointCount:0},this.CustomHorizontalInfo=[],this.IsDrawTitleBG=!1,this.CustomVerticalInfo=[],this.DrawCustomVerticalEvent,this.RightSpaceCount=0,this.Logarithmic=null,this.DrawToolbar=function(){if(\x22undefined\x22==typeof\x20$)return;if(!this.ChartBorder.UIElement||!this.ChartBorder.UIElement.parentNode)return;var\x20t=document.getElementById(this.ToolbarID);if(t&&0==this.SizeChange&&0==this.ReDrawToolbar)return;if(t||((t=document.createElement(\x22div\x22)).className=\x22klineframe-toolbar\x22,t.id=this.ToolbarID,t.oncontextmenu=function(){return!1},t.setAttribute(\x22identify\x22,this.Identify.toString()),this.ChartBorder.UIElement.parentNode.appendChild(t)),!(this.ModifyIndex||this.ChangeIndex||this.OverlayIndex||this.CloseIndex))return\x20void(\x22none\x22!=t.style.display&&(t.style.display=\x22none\x22));var\x20e=GetDevicePixelRatio(),a=parseInt(this.ChartBorder.UIElement.parentElement.style.width.replace(\x22px\x22,\x22\x22)),i=(parseInt(this.ChartBorder.UIElement.parentElement.style.height.replace(\x22px\x22,\x22\x22)),this.ChartBorder.GetTitleHeight()),r=a-this.ChartBorder.Right/e-100,n=this.ChartBorder.GetTop()/e;if(this.ToolbarRect&&this.ToolbarRect.Left==r&&this.ToolbarRect.Top==n&&100==this.ToolbarRect.Width&&this.ToolbarRect.Height==i/e)return;this.ToolbarRect={Left:r,Top:n,Width:100,Height:i/e};var\x20s=\x22<span\x20class=\x27index_param\x20icon\x20iconfont\x20icon-index_param\x27\x20id=\x27modifyindex\x27\x20style=\x27cursor:pointer;margin-left:2px;margin-right:2px;\x27\x20title=\x27调整指标参数\x27></span><span\x20class=\x27index_change\x20icon\x20iconfont\x20icon-change_index\x27\x20id=\x27changeindex\x27\x20style=\x27cursor:pointer;margin-left:2px;margin-right:2px;\x27\x20title=\x27切换指标\x27></span><span\x20class=\x27index_overlay\x20icon\x20iconfont\x20icon-overlay_index\x27\x20id=\x27overlayindex\x27\x20style=\x27cursor:pointer;margin-left:2px;margin-right:2px;\x27\x20title=\x27叠加指标\x27></span>\x22;0!==this.Identify&&this.CloseIndex&&(s+=\x22<span\x20class=\x27index_close\x20icon\x20iconfont\x20icon-close\x27\x20id=\x27closeindex\x27\x20style=\x27cursor:pointer;margin-left:2px;margin-right:2px;\x27\x20title=\x27关闭指标窗口\x27></span>\x22),t.style.left=r+\x22px\x22,t.style.top=n+\x22px\x22,t.style.width=\x22100px\x22,t.style.height=i/e+\x22px\x22,t.innerHTML=s;this.ChartBorder.UIElement.JSChartContainer,this.Identify;this.ModifyIndex?\x22function\x22==typeof\x20this.ModifyIndexEvent&&$(\x22#\x22+t.id+\x22\x20.index_param\x22).click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify},this.ModifyIndexEvent):$(\x22#\x22+t.id+\x22\x20.index_param\x22).hide(),this.ChangeIndex?\x22function\x22==typeof\x20this.ChangeIndexEvent&&$(\x22#\x22+t.id+\x22\x20.index_change\x22).click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify,IsOverlay:!1},this.ChangeIndexEvent):$(\x22#\x22+t.id+\x22\x20.index_change\x22).hide(),this.OverlayIndex?$(\x22#\x22+t.id+\x22\x20.index_overlay\x22).click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify,IsOverlay:!0},this.ChangeIndexEvent):$(\x22#\x22+t.id+\x22\x20.index_overlay\x22).hide(),$(\x22#\x22+t.id+\x22\x20.index_close\x22).click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify},function(t){var\x20e=t.data.Chart,a=t.data.Identify;e.RemoveIndexWindow(a)}),t.style.display=\x22block\x22},this.ClearToolbar=function(){var\x20t=document.getElementById(this.ToolbarID);t&&this.ChartBorder.UIElement.parentNode.removeChild(t)},this.DrawFrame=function(){if(this.SplitXYCoordinate(),1==this.SizeChange){var\x20t=this.ZoomIndex;this.CalculateDataWidth(),debug&&console.log(\x22CalculateDataWidth\x20(\x22+t+\x22)\x20out\x20(\x22+this.ZoomIndex+\x22\x20\x20\x22+this.DataWidth+\x22\x20\x20\x22+this.DistanceWidth+\x22)\x22),this.Logarithmic&&this.SplitLogarithmicXYCoordinate()}this.DrawDepthMapCallback&&this.DrawDepthMapCallback(),this.DrawTitleBG(),this.DrawHorizontal(),this.DrawVertical(),1!=this.SizeChange&&1!=this.ReDrawToolbar||(this.DrawToolbar(),this.ReDrawToolbar=!1)},this.GetXFromIndex=function(t,e){if(!1===e)if(t>=0)for(var\x20a=this.ChartBorder.GetLeft()+g_JSChartResource.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,i=1;i<=t;++i)a+=this.DistanceWidth+this.DataWidth;else{a=this.ChartBorder.GetLeft()-(this.DistanceWidth/2+this.DataWidth+this.DistanceWidth);var\x20r=Math.abs(t);for(i=1;i<r;++i)a-=this.DistanceWidth+this.DataWidth}else{t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(a=this.ChartBorder.GetLeft()+g_JSChartResource.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,i=1;i<=t;++i)a+=this.DistanceWidth+this.DataWidth}return\x20a},this.GetXData=function(t,e){var\x20a=this.DistanceWidth,i=this.DataWidth,r=this.ChartBorder.GetLeft()+g_JSChartResource.FrameLeftMargin;if(0==e){if(t<this.ChartBorder.GetLeft()){for(var\x20n=-1,s=this.ChartBorder.GetLeft()-(a/2+i+a);n>-1e4&&!(s<=t);)s-=i+a,--n;return\x20n}for(n=0,s=r+a/2+i+a;n<1e4&&!(s>=t);)s+=i+a,++n;return\x20n}if(t<=this.ChartBorder.GetLeft())return\x200;if(t>=this.ChartBorder.GetRight())return\x20this.XPointCount-1;var\x20o=this.ChartBorder.GetRight()-g_JSChartResource.FrameRightMargin;for(n=0,s=r+a/2+i+a;s<o&&n<1e4&&n+1<this.XPointCount&&!(s>=t);)s+=i+a,++n;return\x20n},this.CalculateDataWidth=function(){if(!(this.XPointCount<2)){var\x20t=this.GetFrameWidth()-g_JSChartResource.FrameMargin;if(this.ZoomIndex>=0&&this.LastCalculateStatus.Width==t&&this.LastCalculateStatus.XPointCount==this.XPointCount){var\x20e=this.DistanceWidth/2+g_JSChartResource.FrameLeftMargin+(this.DataWidth+this.DistanceWidth)*(this.XPointCount-1);this.DataWidth,this.DistanceWidth,this.XPointCount;if(e<=t)return}this.LastCalculateStatus.Width=t,this.LastCalculateStatus.XPointCount=this.XPointCount;for(var\x20a=0;a<ZOOM_SEED.length;++a)if((ZOOM_SEED[a][0]+ZOOM_SEED[a][1])*this.XPointCount<t)return\x20this.ZoomIndex=a,this.DataWidth=ZOOM_SEED[a][0],this.DistanceWidth=ZOOM_SEED[a][1],this.TrimKLineDataWidth(t),void\x20JSConsole.Chart.Log(\x22[KLineFrame::CalculateDataWidth]\x20ZOOM_SEED,\x20DataWidth,\x20DistanceWidth,\x20XPointCount\x22,ZOOM_SEED[this.ZoomIndex],this.DataWidth,this.DistanceWidth,this.XPointCount);this.ZoomIndex=ZOOM_SEED.length-1,this.DataWidth=t/this.XPointCount,this.DistanceWidth=0}},this.OnSize=function(t){for(var\x20e=this.GetFrameWidth()-g_JSChartResource.FrameMargin,a=0,i=this.DistanceWidth/2+g_JSChartResource.FrameLeftMargin+(this.DataWidth+this.DistanceWidth);i<e;i+=this.DataWidth+this.DistanceWidth,++a);return\x20t.CurCount=this.XPointCount,t.CalcCount=a,t.DataWidth=this.DataWidth,t.DistanceWidth=this.DistanceWidth,t.Changed=!1,this.LastCalculateStatus.Width=e,t.CurCount==t.CalcCount?t:(this.XPointCount=a,this.LastCalculateStatus.XPointCount=this.XPointCount,this.Data&&(this.Data.DataOffset+=t.CurCount-t.CalcCount,this.Data.DataOffset<0&&(this.Data.DataOffset=0),t.Changed=!0),t)},this.SetDataWidth=function(t){var\x20e=ZOOM_SEED.length-1;for(var\x20a\x20in\x20ZOOM_SEED){if(ZOOM_SEED[a][0]<=t){e=parseInt(a)-1;break}}this.ZoomIndex=e,this.DataWidth=ZOOM_SEED[this.ZoomIndex][0],this.DistanceWidth=ZOOM_SEED[this.ZoomIndex][1];for(var\x20i=this.GetFrameWidth()-g_JSChartResource.FrameMargin,r=0,n=this.DistanceWidth/2+g_JSChartResource.FrameLeftMargin+(this.DataWidth+this.DistanceWidth);n<=i;n+=this.DataWidth+this.DistanceWidth,++r);return\x20this.XPointCount=r,this.LastCalculateStatus.XPointCount=this.XPointCount,this.LastCalculateStatus.Width=i,{XPointCount:this.XPointCount,DataWidth:this.DataWidth,DistanceWidth:this.DistanceWidth}},this.TrimKLineDataWidth=function(t){var\x20e=ZOOM_SEED[this.ZoomIndex][0],a=ZOOM_SEED[this.ZoomIndex][1];if(1!=e||0!=a)for(;;){if((this.DistanceWidth+this.DataWidth)*this.XPointCount+this.DistanceWidth>t){this.DistanceWidth-=.01;break}this.DistanceWidth+=.01}else\x20this.DataWidth=t/this.XPointCount},this.IsOverlayMaxMin=function(t){if(!this.ChartKLine)return!1;if(!this.ChartKLine.Max||!this.ChartKLine.Min)return!1;var\x20e=this.Canvas.measureText(t.Text.Value).width+4;\x22right\x22===t.Text.TextAlign&&(t.X-=e);var\x20a=this.ChartKLine.Max,i=this.ChartKLine.Min,r=!1,n=!1;if(a.X>=t.X&&a.X<=t.X+e){var\x20s=a.Y+20,o=a.Y-20;(s>=t.Y-20&&s<=t.Y+20||o>=t.Y-20&&o<=t.Y+20)&&(r=!0)}if(1==r)return!0;if(i.X>=t.X&&i.X<=t.X+e){s=i.Y+20,o=i.Y-20;(s>=t.Y-20&&s<=t.Y+20||o>=t.Y-20&&o<=t.Y+20)&&(n=!0)}return\x20r||n},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator(),this.Logarithmic&&this.SplitLogarithmicXYCoordinate())},this.SplitLogarithmicXYCoordinate=function(){for(var\x20t=this.Logarithmic.Up,e=this.Logarithmic.Down,a=0,i=0,r=Math.max(t.length,e.length),n=[],s=0;s<r;++s)n[s]=2*s;s=0;for(var\x20o=n.length-1;s<t.length;++s,--o){(c=t[s]).LogHeight=n[o],a+=c.LogHeight,++i}for(s=0,o=n.length-1;s<e.length;++s,--o){(c=e[s]).LogHeight=n[o],a+=c.LogHeight,++i}var\x20h=2*GetDevicePixelRatio(),l=this.ChartBorder.GetTopEx(),C=this.ChartBorder.GetBottomEx(),u=(C-l-a*h)/i;if(1==this.CoordinateType){var\x20D=l;for(s=e.length-1;s>=0;--s){(c=e[s]).Height=u+h*c.LogHeight,c.Top=D,c.Bottom=c.Top+c.Height,D=c.Bottom}var\x20d=C;for(s=t.length-1;s>=0;--s){(c=t[s]).Height=u+h*c.LogHeight,c.Bottom=d,c.Top=d-c.Height,d=c.Top}}else{for(D=l,s=t.length-1;s>=0;--s){(c=t[s]).Height=u+h*c.LogHeight,c.Top=D,c.Bottom=c.Top+c.Height,D=c.Bottom}for(d=C,s=e.length-1;s>=0;--s){var\x20c;(c=e[s]).Height=u+h*c.LogHeight,c.Bottom=d,c.Top=d-c.Height,d=c.Top}}JSConsole.Chart.Log(\x22[KLineFrame::SplitLogarithmicXYCoordinate]\x22,this.Logarithmic)},this.GetYLogarithmicFromData=function(t,e){if(1==this.CoordinateType){if(t<=this.HorizontalMin)return\x20this.ChartBorder.GetTopEx();if(t>=this.HorizontalMax)return\x20this.ChartBorder.GetBottomEx();if(t>this.Logarithmic.OpenPrice){var\x20a=this.Logarithmic.Up;for(var\x20i\x20in\x20a){if(t>=(s=a[i]).Start&&t<=s.End){var\x20r=(s.Bottom-s.Top)*(t-s.Start)/(s.End-s.Start);return\x20s.Top+r}}}else{var\x20n=this.Logarithmic.Down;for(var\x20i\x20in\x20n){if(t>=(s=n[i]).Start&&t<=s.End){r=(s.Bottom-s.Top)*(t-s.Start)/(s.End-s.Start);return\x20s.Top+r}}}}else{if(t<=this.HorizontalMin)return\x20this.ChartBorder.GetBottomEx();if(t>=this.HorizontalMax)return\x20this.ChartBorder.GetTopEx();if(t>this.Logarithmic.OpenPrice){a=this.Logarithmic.Up;for(var\x20i\x20in\x20a){if(t>=(s=a[i]).Start&&t<=s.End){r=(s.Bottom-s.Top)*(t-s.Start)/(s.End-s.Start);return\x20s.Bottom-r}}}else{n=this.Logarithmic.Down;for(var\x20i\x20in\x20n){var\x20s;if(t>=(s=n[i]).Start&&t<=s.End){r=(s.Bottom-s.Top)*(t-s.Start)/(s.End-s.Start);return\x20s.Bottom-r}}}}},this.GetYLogarithmicData=function(t){if(1==this.CoordinateType){if(t<this.ChartBorder.GetTopEx())return\x20this.HorizontalMin;if(t>this.ChartBorder.GetBottomEx())return\x20this.HorizontalMax;var\x20e=this.Logarithmic.Up;for(var\x20a\x20in\x20e){if(t>=(r=e[a]).Top&&t<=r.Bottom)return(t-r.Top)/r.Height*(r.End-r.Start)+r.Start}var\x20i=this.Logarithmic.Down;for(var\x20a\x20in\x20i){if(t>=(r=i[a]).Top&&t<=r.Bottom)return(t-r.Top)/r.Height*(r.End-r.Start)+r.Start}}else{if(t<this.ChartBorder.GetTopEx())return\x20this.HorizontalMax;if(t>this.ChartBorder.GetBottomEx())return\x20this.HorizontalMin;e=this.Logarithmic.Up;for(var\x20a\x20in\x20e){if(t>=(r=e[a]).Top&&t<=r.Bottom)return(r.Bottom-t)/r.Height*(r.End-r.Start)+r.Start}i=this.Logarithmic.Down;for(var\x20a\x20in\x20i){var\x20r;if(t>=(r=i[a]).Top&&t<=r.Bottom)return(r.Bottom-t)/r.Height*(r.End-r.Start)+r.Start}}},this.CalculateCount=function(t){var\x20e=this.GetFrameWidth()-g_JSChartResource.FrameMargin;return\x20parseInt(e/(ZOOM_SEED[t][0]+ZOOM_SEED[t][1]))},this.ZoomUp=function(t){if(this.ZoomIndex<=0)return!1;if(this.Data.DataOffset<0)return!1;var\x20e=this.Data.Data.length,a=e+this.RightSpaceCount,i=0,r=this.Data.DataOffset+this.XPointCount-1,n=this.Data.DataOffset+t.Index;r>=e&&(i=r-(this.Data.Data.length-1),r=this.Data.Data.length-1,i>this.RightSpaceCount&&(i=this.RightSpaceCount));var\x20s=this.CalculateCount(this.ZoomIndex-1);JSConsole.Chart.Log(`[KLineFrame::ZoomUp]\x20old\x20status.\x20XPointCount=${this.XPointCount}\x20ZoomIndex=${this.ZoomIndex}\x20DataCount=\x20${this.Data.Data.length}\x20rightSpaceCount=${i}`);var\x20o=!1;if(--this.ZoomIndex,1==t.IsLockRight){var\x20h=this.Data.DataOffset+this.XPointCount;if(s>h)s=h,this.XPointCount=s,this.Data.DataOffset=0;else{var\x20l=r-(s-i)+1;this.XPointCount=s,this.Data.DataOffset=l,this.Data.DataOffset<0&&(this.Data.DataOffset=0)}}else\x20if(s>=a)this.XPointCount=s,this.Data.DataOffset=0,o=!0,JSConsole.Chart.Log(`[KLineFrame::ZoomUp]\x20Show\x20all\x20data.\x20XPointCount=${this.XPointCount}\x20ZoomIndex=${this.ZoomIndex}\x20DataCount=\x20${e}`);else{l=r-(s-i)+1;if(1==t.ZoomType){var\x20C=this.XPointCount-s+1,u=parseInt(t.Index/this.XPointCount*C);this.Data.DataOffset+u<e&&(l=this.Data.DataOffset+u)}this.XPointCount=s,this.Data.DataOffset=l,this.Data.DataOffset<0&&(this.Data.DataOffset=0),JSConsole.Chart.Log(`[KLineFrame::ZoomUp]\x20calculate.\x20XPointCount=${this.XPointCount}\x20ZoomIndex=${this.ZoomIndex}\x20DataCount=\x20${e}\x20DataOffset=${this.Data.DataOffset}`)}if(this.DataWidth=ZOOM_SEED[this.ZoomIndex][0],this.DistanceWidth=ZOOM_SEED[this.ZoomIndex][1],!o){var\x20D=this.GetFrameWidth()-g_JSChartResource.FrameMargin;this.TrimKLineDataWidth(D)}return\x20this.LastCalculateStatus.XPointCount=this.XPointCount,t.Index=n-this.Data.DataOffset,window.chartdata[this.Data.Period]={DataOffset:this.Data.DataOffset,XPointCount:this.XPointCount,ZoomIndex:this.ZoomIndex},debug&&console.log(window.chartdata[this.Data.Period]),!0},this.ZoomDown=function(t){if(this.ZoomIndex+1>=ZOOM_SEED.length)return!1;if(this.Data.DataOffset<0)return!1;var\x20e=this.Data.Data.length,a=e+this.RightSpaceCount,i=0,r=this.Data.DataOffset+this.XPointCount-1;r>=this.Data.Data.length&&(i=r-(this.Data.Data.length-1),r=this.Data.Data.length-1,i>this.RightSpaceCount&&(i=this.RightSpaceCount));var\x20n=this.CalculateCount(this.ZoomIndex+1),s=this.Data.DataOffset+t.Index;JSConsole.Chart.Log(`[KLineFrame::ZoomDown]\x20old\x20status.\x20XPointCount=${this.XPointCount}\x20ZoomIndex=${this.ZoomIndex}\x20DataCount=\x20${this.Data.Data.length}\x20lastCursorIndex=${s}\x20rightSpaceCount=${i}`);var\x20o=!1;if(++this.ZoomIndex,1==t.IsLockRight){var\x20h=this.Data.DataOffset+this.XPointCount;if(n>h)n=h,this.XPointCount=n,this.Data.DataOffset=0;else{var\x20l=r-(n-i)+1;this.XPointCount=n,this.Data.DataOffset=l,this.Data.DataOffset<0&&(this.Data.DataOffset=0)}}else\x20if(n>=a)this.XPointCount=n,this.Data.DataOffset=0,o=!0,JSConsole.Chart.Log(`[KLineFrame::ZoomDown]\x20Show\x20all\x20data.\x20XPointCount=${this.XPointCount}\x20ZoomIndex=${this.ZoomIndex}\x20DataCount=\x20${e}`);else{l=r-(n-i)+1;if(1==t.ZoomType){var\x20C=n-this.XPointCount+1,u=parseInt(t.Index/this.XPointCount*C);(l=this.Data.DataOffset-u)+(n-this.RightSpaceCount)>=e&&(l=this.Data.DataOffset-C)}this.XPointCount=n,this.Data.DataOffset=l,this.Data.DataOffset<0&&(this.Data.DataOffset=0),JSConsole.Chart.Log(`[KLineFrame::ZoomDown]\x20calculate.\x20XPointCount=${this.XPointCount}\x20ZoomIndex=${this.ZoomIndex}\x20DataCount=\x20${e}\x20DataOffset=${this.Data.DataOffset}`)}if(this.DataWidth=ZOOM_SEED[this.ZoomIndex][0],this.DistanceWidth=ZOOM_SEED[this.ZoomIndex][1],!o){var\x20D=this.GetFrameWidth()-g_JSChartResource.FrameMargin;this.TrimKLineDataWidth(D)}return\x20this.LastCalculateStatus.XPointCount=this.XPointCount,t.Index=s-this.Data.DataOffset,window.chartdata[this.Data.Period]={DataOffset:this.Data.DataOffset,XPointCount:this.XPointCount,ZoomIndex:this.ZoomIndex},debug&&console.log(window.chartdata[this.Data.Period]),!0},this.GetFrameWidth=function(){return\x20this.IsHScreen?this.ChartBorder.GetHeight():this.ChartBorder.GetWidth()},this.DrawCustomHorizontal=function(){for(var\x20t\x20in\x20this.CustomHorizontalInfo){var\x20e=this.CustomHorizontalInfo[t];switch(e.Type){case\x200:case\x201:this.DrawCustomItem(e)}}},this.DrawCustomVerticalItem=function(t){this.Canvas.save(),1==t.Data.Line.Type&&this.Canvas.setLineDash([5,5]),this.Canvas.strokeStyle=t.Data.Line.Color,this.Canvas.beginPath(),t.IsHScreen?(this.Canvas.moveTo(t.Top,ToFixedPoint(t.X)),this.Canvas.lineTo(t.Bottom,ToFixedPoint(t.X))):(this.Canvas.moveTo(ToFixedPoint(t.X),t.Top),this.Canvas.lineTo(ToFixedPoint(t.X),t.Bottom)),this.Canvas.stroke(),this.Canvas.restore()},this.DrawCustomVertical=function(){if(this.CustomVerticalInfo&&!(this.CustomVerticalInfo.length<=0)&&this.Data){var\x20t=this.IsHScreen,e=this.ChartBorder.GetTopEx(),a=this.ChartBorder.GetBottomEx(),i=this.DataWidth,r=this.DistanceWidth,n=this.ChartBorder.GetLeft()+r/2+2;t&&(n=this.ChartBorder.GetTop()+r/2+2,e=this.ChartBorder.GetLeftEx(),a=this.ChartBorder.GetRightEx());for(var\x20s=0,o=this.Data.DataOffset;o<this.Data.Data.length&&s<this.XPointCount;++o,++s,n+=i+r){var\x20h=this.Data.Data[o];for(var\x20l\x20in\x20this.CustomVerticalInfo){if(0==(u=this.CustomVerticalInfo[l]).Type){if(IFrameSplitOperator.IsNumber(u.Time)){if(h.Date!=u.Date||h.Time!=u.Time)continue}else\x20if(h.Date!=u.Date)continue;var\x20C={X:(D=n)+(n+i-D)/2,Top:e,Bottom:a,Data:u,IsHScreen:t};this.DrawCustomVerticalItem(C),this.DrawCustomVerticalEvent&&this.DrawCustomVerticalEvent.Callback(this.DrawCustomVerticalEvent,C,this);break}}}for(o=1;s<this.XPointCount;++o,++s,n+=i+r)for(var\x20l\x20in\x20this.CustomVerticalInfo){var\x20u;if(1==(u=this.CustomVerticalInfo[l]).Type&&u.Space==o){var\x20D;C={X:(D=n)+(n+i-D)/2,Top:e,Bottom:a,Data:u,IsHScreen:t};this.DrawCustomVerticalItem(C),this.DrawCustomVerticalEvent&&this.DrawCustomVerticalEvent.Callback(this.DrawCustomVerticalEvent,C,this);break}}}}}function\x20OverlayKLineFrame(){this.newMethod=KLineFrame,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22OverlayKLineFrame\x22,this.MainFrame=null,this.RightOffset=50,this.PenBorder=g_JSChartResource.OverlayFrame.BolderPen,this.IsShow=!0,this.Title=null,this.TitleColor=g_JSChartResource.OverlayFrame.TitleColor,this.TitleFont=g_JSChartResource.OverlayFrame.TitleFont,this.Draw=function(){this.SplitXYCoordinate(),this.IsShow&&(this.DrawVertical(),this.DrawHorizontal(),this.DrawTitle()),this.SizeChange=!1,this.XYSplit=!1},this.DrawTitle=function(){if(this.Title){var\x20t=this.ChartBorder.GetTopTitle(),e=this.ChartBorder.GetBottom(),a=this.ChartBorder.GetRight();a+=this.RightOffset,this.Canvas.fillStyle=this.TitleColor,this.Canvas.font=this.TitleFont,this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22top\x22;var\x20i=a-2,r=t+(e-t)/2;this.Canvas.save(),this.Canvas.translate(i,r),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.Title,0,0),this.Canvas.restore()}},this.SplitXYCoordinate=function(){0!=this.XYSplit&&null!=this.YSplitOperator&&this.YSplitOperator.Operator()},this.DrawHorizontal=function(){this.ChartBorder.GetLeft();var\x20t=this.ChartBorder.GetRight(),e=this.ChartBorder.GetBottom(),a=this.ChartBorder.GetTopTitle(),i=this.ChartBorder.Right;t+=this.RightOffset;for(var\x20r=null,n=this.HorizontalInfo.length-1;n>=0;--n){var\x20s=this.HorizontalInfo[n],o=this.GetYFromData(s.Value);null!=o&&Math.abs(o-r)<this.MinYDistance||(this.Canvas.textBaseline=o>=e-2?\x22bottom\x22:o<=a+2?\x22top\x22:\x22middle\x22,this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(t-2,ToFixedPoint(o)),this.Canvas.lineTo(t,ToFixedPoint(o)),this.Canvas.stroke(),null!=s.Message[1]&&i>10&&(null!=s.Font&&(this.Canvas.font=s.Font),this.Canvas.fillStyle=s.TextColor,this.Canvas.textAlign=\x22left\x22,this.Canvas.fillText(s.Message[1],t+2,o)),r=o)}},this.DrawVertical=function(){var\x20t=this.ChartBorder.GetTopEx(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetBottomEx();e+=this.RightOffset,this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(ToFixedPoint(e),ToFixedPoint(t)),this.Canvas.lineTo(ToFixedPoint(e),ToFixedPoint(a)),this.Canvas.stroke()}}function\x20KLineHScreenFrame(){this.newMethod=KLineFrame,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22KLineHScreenFrame\x22,this.IsHScreen=!0,this.DrawTitleBG=function(){if(!(this.ChartBorder.TitleHeight<=0)){var\x20t=ToFixedPoint(this.ChartBorder.GetRightTitle()),e=ToFixedPoint(this.ChartBorder.GetTop()),a=ToFixedPoint(this.ChartBorder.GetBottom()),i=this.ChartBorder.TitleHeight,r=a-e;this.Canvas.fillStyle=this.TitleBGColor,this.Canvas.fillRect(t,e,i,r)}},this.DrawToolbar=function(){},this.GetYFromData=function(t){if(t<=this.HorizontalMin)return\x20this.ChartBorder.GetLeftEx();if(t>=this.HorizontalMax)return\x20this.ChartBorder.GetRightEx();var\x20e=this.ChartBorder.GetWidthEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return\x20this.ChartBorder.GetLeftEx()+e},this.DrawHorizontal=function(){for(var\x20t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetBottom(),a=this.ChartBorder.Top,i=this.ChartBorder.Bottom,r=this.ChartBorder.GetLeft(),n=(this.ChartBorder.GetRight(),null),s=GetDevicePixelRatio(),o=a>10*s&&!0===this.IsShowYText[0]&&2!=this.YTextPosition[0],h=i>10*s&&!0===this.IsShowYText[1]&&2!=this.YTextPosition[1],l=this.HorizontalInfo.length-1;l>=0;--l){var\x20C=this.HorizontalInfo[l],u=this.GetYFromData(C.Value);if(!(null!=u&&Math.abs(u-n)<this.MinYDistance)){if(u!=r&&(this.Canvas.strokeStyle=C.LineColor,g_JSChartResource.FrameYLineDash?(this.Canvas.save(),this.Canvas.setLineDash(g_JSChartResource.FrameYLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(ToFixedPoint(u),t),this.Canvas.lineTo(ToFixedPoint(u),e),this.Canvas.stroke(),this.Canvas.restore()):(this.Canvas.beginPath(),this.Canvas.moveTo(ToFixedPoint(u),t),this.Canvas.lineTo(ToFixedPoint(u),e),this.Canvas.stroke())),null!=C.Message[0]&&o){null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22;var\x20D=u,d=t;this.Canvas.save(),this.Canvas.translate(D,d),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(C.Message[0],-2,0),this.Canvas.restore()}if(null!=C.Message[1]&&h){null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22;D=u,d=e;this.Canvas.save(),this.Canvas.translate(D,d),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(C.Message[1],2,0),this.Canvas.restore()}n=u}}},this.DrawInsideHorizontal=function(){if(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1]){var\x20t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRightEx(),a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.Top,n=this.ChartBorder.Bottom,s=(this.ChartBorder.TitleHeight,(r<10*(h=GetDevicePixelRatio())||2==this.YTextPosition[0])&&!0===this.IsShowYText[0]),o=(n<10*h||2==this.YTextPosition[1])&&!0===this.IsShowYText[1];if(s||o)for(var\x20h=GetDevicePixelRatio(),l=null,C=this.HorizontalInfo.length-1;C>=0;--C){var\x20u=this.HorizontalInfo[C],D=this.GetYFromData(u.Value);if(!(null!=D&&null!=l&&Math.abs(D-l)<this.MinYDistance)){if(null!=u.Message[0]&&s){null!=u.Font&&(this.Canvas.font=u.Font),this.Canvas.fillStyle=u.TextColor,this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=D>=e-2?\x22top\x22:D<=t+2?\x22bottom\x22:\x22middle\x22;this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,u.Message[0];var\x20d=D,c=a;this.Canvas.save(),this.Canvas.translate(d,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(u.Message[0],-2,0),this.Canvas.restore()}if(null!=u.Message[1]&&o){null!=u.Font&&(this.Canvas.font=u.Font),this.Canvas.fillStyle=u.TextColor,this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=D>=e-2?\x22top\x22:D<=t+2?\x22bottom\x22:\x22middle\x22;this.Canvas.measureText(u.Message[1]).width,this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,u.Message[1],d=D,c=i;this.Canvas.save(),this.Canvas.translate(d,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(u.Message[1],2,0),this.Canvas.restore()}l=D}}}},this.GetXFromIndex=function(t){t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(var\x20e=this.ChartBorder.GetTop()+g_JSChartResource.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,a=1;a<=t;++a)e+=this.DistanceWidth+this.DataWidth;return\x20e},this.DrawVertical=function(){var\x20t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRightTitle(),a=this.ChartBorder.GetBottom(),i=null;for(var\x20r\x20in\x20this.VerticalInfo){var\x20n=this.GetXFromIndex(this.VerticalInfo[r].Value);if(n>=a)break;if(!(null!=i&&Math.abs(n-i)<80)){if(this.Canvas.strokeStyle=this.VerticalInfo[r].LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t,ToFixedPoint(n)),this.Canvas.lineTo(e,ToFixedPoint(n)),this.Canvas.stroke(),null!=this.VerticalInfo[r].Message[0]){null!=this.VerticalInfo[r].Font&&(this.Canvas.font=this.VerticalInfo[r].Font),this.Canvas.fillStyle=this.VerticalInfo[r].TextColor,n<this.Canvas.measureText(this.VerticalInfo[r].Message[0]).width/2?(this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22top\x22):(this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22top\x22);var\x20s=t,o=n;this.Canvas.save(),this.Canvas.translate(s,o),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.VerticalInfo[r].Message[0],0,0),this.Canvas.restore()}i=n}}},this.GetYData=function(t){return\x20t<this.ChartBorder.GetLeftEx()?this.HorizontalMin:t>this.ChartBorder.GetRightEx()?this.HorizontalMax:(t-this.ChartBorder.GetLeftEx())/this.ChartBorder.GetWidthEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t){if(t<=this.ChartBorder.GetTop())return\x200;if(t>=this.ChartBorder.GetBottom())return\x20this.XPointCount-1;for(var\x20e=this.ChartBorder.GetTop(),a=this.ChartBorder.GetBottom(),i=this.DistanceWidth,r=this.DataWidth,n=0,s=e+i/2+r+i;s<a&&n<1e4&&n+1<this.XPointCount&&!(s>t);)s+=r+i,++n;return\x20n}}function\x20OverlayKLineHScreenFrame(){this.newMethod=KLineHScreenFrame,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22OverlayKLineHScreenFrame\x22,this.MainFrame=null,this.RightOffset=50,this.PenBorder=g_JSChartResource.OverlayFrame.BolderPen,this.IsShow=!0,this.Title=null,this.TitleColor=g_JSChartResource.OverlayFrame.TitleColor,this.TitleFont=g_JSChartResource.OverlayFrame.TitleFont,this.Draw=function(){this.SplitXYCoordinate(),this.IsShow&&(this.DrawVertical(),this.DrawHorizontal(),this.DrawTitle()),this.SizeChange=!1,this.XYSplit=!1},this.DrawTitle=function(){},this.SplitXYCoordinate=function(){0!=this.XYSplit&&null!=this.YSplitOperator&&this.YSplitOperator.Operator()},this.DrawHorizontal=function(){},this.DrawVertical=function(){}}function\x20SubFrameItem(){this.Frame,this.Height,this.OverlayIndex=[],this.Interval=60}function\x20OverlayIndexItem(){this.Frame,this.ChartPaint=[],this.Identify=Guid(),this.Scprit,this.UpdateFrameMaxMin=function(){var\x20t={Max:null,Min:null};if(this.Frame.YSpecificMaxMin)t.Max=this.Frame.YSpecificMaxMin.Max,t.Min=this.Frame.YSpecificMaxMin.Min;else\x20for(var\x20e\x20in\x20this.ChartPaint){var\x20a=this.ChartPaint[e].GetMaxMin();IFrameSplitOperator.IsNumber(a.Max)&&(null==t.Max||t.Max<a.Max)&&(t.Max=a.Max),IFrameSplitOperator.IsNumber(a.Min)&&(null==t.Min||t.Min>a.Min)&&(t.Min=a.Min)}null!=t.Max&&null!=t.Min&&(this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min,this.Frame.XYSplit=!0)}}function\x20HQTradeFrame(){this.SubFrame=new\x20Array,this.SizeChange=!0,this.ChartBorder,this.Canvas,this.ScreenImageData,this.Data,this.Position,this.SizeChange=!0,this.MinSubFrameHeight=g_JSChartResource.DragSubFrameBorder.MinFrameHeight,this.DragBorderHeight=g_JSChartResource.DragSubFrameBorder.TopBorderHeight,this.OnMoveFromeBorder=function(t,e){if(this.SubFrame.length<=0)return!1;for(var\x20a=this.SubFrame[t],i=null,r=t+1;r<this.SubFrame.length;++r){var\x20n=this.SubFrame[r];if(n.Height>0){i=n;break}}if(!a||!i)return!1;var\x20s=a.Frame.ChartBorder.Bottom,o=i.Frame.ChartBorder.Top;a.Frame.ChartBorder.Bottom-=e,i.Frame.ChartBorder.Top+=e;var\x20h=a.Frame.ChartBorder.GetHeightEx(),l=i.Frame.ChartBorder.GetHeightEx();return!(h<this.MinSubFrameHeight&&e<0||l<this.MinSubFrameHeight&&e>0)||(a.Frame.ChartBorder.Bottom=s,i.Frame.ChartBorder.Top=o,!1)},this.ReDrawToolbar=function(){for(var\x20t\x20in\x20this.SubFrame)this.SubFrame[t].Frame.ReDrawToolbar=!0},this.SaveSubFrameHeightRate=function(){var\x20t=this.ChartBorder.GetHeight();for(var\x20e\x20in\x20this.SubFrame){var\x20a=this.SubFrame[e],i=a.Frame.ChartBorder.GetHeight()/t*100;a.Height=i}},this.CalculateChartBorder=function(){if(!(this.SubFrame.length<=0)){var\x20t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetHeight(),a=0;for(var\x20i\x20in\x20this.SubFrame){a+=(r=this.SubFrame[i]).Height}for(var\x20i\x20in\x20this.SubFrame){var\x20r;(r=this.SubFrame[i]).Frame.ChartBorder.Top=t,r.Frame.ChartBorder.Left=this.ChartBorder.Left,r.Frame.ChartBorder.Right=this.ChartBorder.Right;var\x20n=e*(r.Height/a)+t;r.Frame.ChartBorder.Bottom=this.ChartBorder.GetChartHeight()-n,t=n}}},this.CalculateChartBorder2=function(){if(!(this.SubFrame.length<=0)){var\x20t=this.ChartBorder.Top,e=this.ChartBorder.Bottom,a=this.ChartBorder.GetHeight(),i=0;for(var\x20r\x20in\x20this.SubFrame){i+=(s=this.SubFrame[r]).Height}var\x20n=0;for(var\x20r\x20in\x20this.SubFrame){var\x20s;(s=this.SubFrame[r]).Frame.ChartBorder.Top=t,s.Frame.ChartBorder.Left=this.ChartBorder.Left,s.Frame.ChartBorder.Right=this.ChartBorder.Right,s.Frame.ChartBorder.X=this.ChartBorder.X,s.Frame.ChartBorder.Y=this.ChartBorder.Y,s.Frame.ChartBorder.Width=this.ChartBorder.Width,s.Frame.ChartBorder.Height=this.ChartBorder.Height;var\x20o=a*(s.Height/i);n+=o,e=this.ChartBorder.Bottom+(a-n),s.Frame.ChartBorder.Bottom=e,t+=o}}},this.Draw=function(){for(var\x20t\x20in!0===this.SizeChange&&this.CalculateChartBorder(),this.SubFrame){var\x20e=this.SubFrame[t];if(!(e.Height<=0)){e.Frame.Draw();var\x20a=e.Interval;for(var\x20i\x20in\x20e.OverlayIndex){var\x20r=e.OverlayIndex[i];r.Frame.DataWidth=e.Frame.DataWidth,r.Frame.DistanceWidth=e.Frame.DistanceWidth,r.Frame.XPointCount=e.Frame.XPointCount,r.ChartPaint.length>0&&r.Frame.IsShow&&(r.Frame.RightOffset=a,r.Frame.Draw(),a+=e.Interval)}}}this.SizeChange=!1},this.DrawOveraly=function(){for(var\x20t\x20in\x20this.SubFrame){var\x20e=this.SubFrame[t];for(var\x20a\x20in\x20e.OverlayIndex){var\x20i=e.OverlayIndex[a];for(var\x20r\x20in\x20i.ChartPaint)i.ChartPaint[r].IsShow&&i.ChartPaint[r].Draw()}}},this.DrawLock=function(){for(var\x20t\x20in\x20this.SubFrame){this.SubFrame[t].Frame.DrawLock()}},this.CalculateLock=function(){for(var\x20t\x20in\x20this.SubFrame){this.SubFrame[t].Frame.CalculateLock()}},this.DrawInsideHorizontal=function(){for(var\x20t\x20in\x20this.SubFrame){var\x20e=this.SubFrame[t];e.Frame.DrawInsideHorizontal&&e.Frame.DrawInsideHorizontal()}},this.DrawCustomHorizontal=function(){for(var\x20t\x20in\x20this.SubFrame){var\x20e=this.SubFrame[t];e.Frame.DrawCustomHorizontal&&e.Frame.DrawCustomHorizontal()}},this.DrawCustomVertical=function(t){for(var\x20e\x20in\x20this.SubFrame){var\x20a=this.SubFrame[e];a.Frame.DrawCustomVerticalEvent=t,a.Frame.DrawCustomVertical&&a.Frame.DrawCustomVertical()}},this.SetSizeChage=function(t){for(var\x20e\x20in\x20this.SizeChange=t,this.SubFrame){var\x20a=this.SubFrame[e];for(var\x20i\x20in\x20a.Frame.SizeChange=t,a.OverlayIndex){var\x20r=a.OverlayIndex[i];r.Frame&&(r.Frame.SizeChange=t)}}this.ChartBorder.UIElement&&(this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight})},this.SetDrawDepthMap=function(t){for(var\x20e\x20in\x20this.SubFrame){this.SubFrame[e].Frame.DrawDepthMapCallback=t}},this.Snapshot=function(){this.ScreenImageData=this.Canvas.getImageData(0,0,this.ChartBorder.GetChartWidth(),this.ChartBorder.GetChartHeight())},this.GetXData=function(t){return\x20this.SubFrame[0].Frame.GetXData(t)},this.GetYData=function(t,e){var\x20a;for(var\x20i\x20in\x20this.SubFrame){var\x20r=this.SubFrame[i],n=r.Frame.ChartBorder.GetLeft(),s=r.Frame.ChartBorder.GetTopEx(),o=r.Frame.ChartBorder.GetWidth(),h=r.Frame.ChartBorder.GetHeightEx();if(r.Frame.Canvas.beginPath(),r.Frame.Canvas.rect(n,s,o,h),r.Frame.Canvas.isPointInPath(n,t)){a=r.Frame,e&&(e.FrameID=parseInt(i));break}}if(null!=a){a.RightFrame&&(e.RightYValue=a.RightFrame.GetYData(t));var\x20l=a.GetYData(t);if(1==a.YSplitOperator.CoordinateType){var\x20C=a.YSplitOperator.GetFirstOpenPrice();e.RightYValue=((l-C)/C*100).toFixed(2)+\x22%\x22}return\x20l}},this.PtInFrame=function(t,e){for(var\x20a\x20in\x20this.SubFrame){var\x20i=this.SubFrame[a],r=i.Frame.ChartBorder.GetLeft(),n=i.Frame.ChartBorder.GetTop(),s=i.Frame.ChartBorder.GetWidth(),o=i.Frame.ChartBorder.GetHeight();if(i.Frame.Canvas.beginPath(),i.Frame.Canvas.rect(r,n,s,o),i.Frame.Canvas.isPointInPath(t,e))return\x20parseInt(a)}return-1},this.GetXFromIndex=function(t){return\x20this.SubFrame[0].Frame.GetXFromIndex(t)},this.GetYFromData=function(t){return\x20this.SubFrame[0].Frame.GetYFromData(t)},this.ZoomUp=function(t){if(\x2200\x22==window.chartdata.viewperiod){var\x20e=!1,a=this.SubFrame[0].Frame,i=this.ChartBorder.GetWidth()/GetDevicePixelRatio();return\x20debug&&console.log(\x22::::::::::::::::::::::zoomup\x22,window.chartdata[\x2200\x22].DataOffset,this.Data.DataOffset,a.Data.DataOffset,a.XPointCount,a.MinuteCount,i,this),enlargeminutechart>=1&&enlargeminutechart<7&&(e=!0,enlargeminutechart++),enlargeminutechart<1&&(e=!0,enlargeminutechart+=.1),1==e&&(minutecount=Math.trunc(i/enlargeminutechart),this.Data.DataOffset=Math.max(0,Math.min(a.Data.Data.length,this.Data.DataOffset+a.XPointCount)-minutecount),a.XPointCount=minutecount),e&&debug&&console.log(\x22::::::::::::::::::::::result\x22,this.Data.DataOffset,a.XPointCount),e}e=this.SubFrame[0].Frame.ZoomUp(t);return\x20this.UpdateAllFrame(),e},this.ZoomDown=function(t){if(\x2200\x22==window.chartdata.viewperiod){var\x20e=!1,a=this.SubFrame[0].Frame,i=this.ChartBorder.GetWidth()/GetDevicePixelRatio();return\x20debug&&console.log(\x22::::::::::::::::::::::zoomdown\x22,window.chartdata[\x2200\x22].DataOffset,this.Data.DataOffset,a.Data.DataOffset,a.XPointCount,a.MinuteCount,i,this),enlargeminutechart>.2&&enlargeminutechart<=1&&(e=!0,enlargeminutechart-=.1),enlargeminutechart>1&&(e=!0,enlargeminutechart--),1==e&&(minutecount=Math.trunc(i/enlargeminutechart),this.Data.DataOffset=a.Data.DataOffset=window.chartdata[\x2200\x22].DataOffset=Math.max(0,Math.min(a.Data.Data.length,this.Data.DataOffset+a.XPointCount)-minutecount),a.XPointCount=minutecount),e&&debug&&console.log(\x22::::::::::::::::::::::result\x22,this.Data.DataOffset,a.XPointCount),e}e=this.SubFrame[0].Frame.ZoomDown(t);return\x20this.UpdateAllFrame(),e},this.ResetXYSplit=function(){for(var\x20t\x20in\x20this.SubFrame)this.SubFrame[t].Frame.XYSplit=!0},this.SetLanguage=function(t){for(var\x20e\x20in\x20this.SubFrame){var\x20a=this.SubFrame[e];a&&a.Frame&&(a.Frame.YSplitOperator&&(a.Frame.YSplitOperator.LanguageID=t),a.Frame.XSplitOperator&&(a.Frame.XSplitOperator.LanguageID=t))}},this.GetCurrentPageSize=function(){if(this.SubFrame.length<=0)return\x20null;var\x20t=this.SubFrame[0];return\x20t&&t.Frame?t.Frame.XPointCount:null},this.OnSize=function(){var\x20t={};return\x20this.SubFrame[0].Frame.OnSize(t),this.UpdateAllFrame(),t},this.SetDataWidth=function(t){var\x20e=this.SubFrame[0].Frame.SetDataWidth(t);return\x20this.UpdateAllFrame(),e},this.UpdateAllFrame=function(){for(var\x20t=this.SubFrame[0].Frame,e=0;e<this.SubFrame.length;++e){var\x20a=this.SubFrame[e];for(var\x20i\x20in\x20e>0&&(a.Frame.XPointCount=t.XPointCount,a.Frame.ZoomIndex=t.ZoomIndex,a.Frame.DataWidth=t.DataWidth,a.Frame.DistanceWidth=t.DistanceWidth,a.Frame.LastCalculateStatus.Width=t.LastCalculateStatus.Width,a.Frame.LastCalculateStatus.XPointCount=t.LastCalculateStatus.XPointCount),a.OverlayIndex){var\x20r=this.SubFrame[e].OverlayIndex[i];r.Frame.XPointCount=t.XPointCount,r.Frame.ZoomIndex=t.ZoomIndex,r.Frame.DataWidth=t.DataWidth,r.Frame.DistanceWidth=t.DistanceWidth,r.Frame.LastCalculateStatus.Width=t.LastCalculateStatus.Width,r.Frame.LastCalculateStatus.XPointCount=t.LastCalculateStatus.XPointCount}}},this.PtInFrameBorder=function(t,e){for(var\x20a=this.DragBorderHeight,i=0;i<this.SubFrame.length-1;++i){var\x20r=this.SubFrame[i];if(!(r.Frame.Heigh<=0)){var\x20n=r.Frame.ChartBorder.GetBottom(),s=r.Frame.ChartBorder.GetLeft(),o=r.Frame.ChartBorder.GetRight();if(r.Frame.Canvas.beginPath(),r.Frame.Canvas.rect(s,n-a/2,o-s,a),r.Frame.Canvas.isPointInPath(t,e))return{Index:i,Bottom:!0}}}return\x20null}}function\x20HQTradeHScreenFrame(){this.newMethod=HQTradeFrame,this.newMethod(),delete\x20this.newMethod,this.IsHScreen=!0,this.CalculateChartBorder=function(){if(!(this.SubFrame.length<=0)){var\x20t=this.ChartBorder.Right,e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetWidth(),i=0;for(var\x20r\x20in\x20this.SubFrame){i+=(n=this.SubFrame[r]).Height}for(var\x20r\x20in\x20this.SubFrame){var\x20n;(n=this.SubFrame[r]).Frame.ChartBorder.Top=this.ChartBorder.Top,n.Frame.ChartBorder.Bottom=this.ChartBorder.Bottom;var\x20s=a*(n.Height/i);n.Frame.ChartBorder.Right=t,n.Frame.ChartBorder.Left=e-s,t+=s,e-=s}}},this.GetYData=function(t,e){var\x20a;for(var\x20i\x20in\x20this.SubFrame){var\x20r=this.SubFrame[i],n=r.Frame.ChartBorder.GetLeftEx(),s=r.Frame.ChartBorder.GetTop(),o=r.Frame.ChartBorder.GetWidthEx(),h=r.Frame.ChartBorder.GetHeight();if(r.Frame.Canvas.beginPath(),r.Frame.Canvas.rect(n,s,o,h),r.Frame.Canvas.isPointInPath(t,s)){a=r.Frame,e&&(e.FrameID=i);break}}if(null!=a)return\x20a.GetYData(t)}}function\x20SimpleChartFrame(){this.newMethod=AverageWidthFrame,this.newMethod(),delete\x20this.newMethod,this.ScreenImageData,this.Position,this.DrawFrame=function(){if(this.XPointCount>0){let\x20t=this.ChartBorder.GetWidth()/(6*this.XPointCount);this.DistanceWidth=2*t,this.DataWidth=4*t}this.SplitXYCoordinate(),this.DrawHorizontal(),this.DrawVertical()},this.GetXFromIndex=function(t){t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(var\x20e=this.ChartBorder.GetLeft()+2+this.DistanceWidth/2+this.DataWidth/2,a=1;a<=t;++a)e+=this.DistanceWidth+this.DataWidth;return\x20e},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator())},this.Snapshot=function(){this.ScreenImageData=this.Canvas.getImageData(0,0,this.ChartBorder.GetChartWidth(),this.ChartBorder.GetChartHeight())},this.SetSizeChage=function(t){this.SizeChange=t,this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight}}}function\x20HistoryData(){this.Date,this.YClose,this.Open,this.Close,this.High,this.Low,this.Vol,this.Amount,this.Time,this.FlowCapital=0,this.Position=null,this.YFClose=null,this.FClose=null,this.Stop,this.Up,this.Down,this.Unchanged}function\x20MinuteData(){this.Close,this.Open,this.High,this.Low,this.Vol,this.Amount,this.DateTime,this.Increase,this.Risefall,this.AvPrice,this.Lead=null,this.Time,this.Date,this.Position=null}function\x20SingleData(){this.Date,this.Time,this.Value}Number.prototype.toFixed2=Number.prototype.toFixed,Number.prototype.toFixed=function(t){return\x20ToFixed(this,t)},HistoryData.Copy=function(t){var\x20e=new\x20HistoryData;return\x20e.Date=t.Date,e.YClose=t.YClose,e.Open=t.Open,e.Close=t.Close,e.High=t.High,e.Low=t.Low,e.Vol=t.Vol,e.Amount=t.Amount,e.Time=t.Time,e.FlowCapital=t.FlowCapital,e.Position=t.Position,e.YFClose=t.YFClose,e.FClose=t.FClose,e.Stop=t.Stop,e.Up=t.Up,e.Down=t.Down,e.Unchanged=t.Unchanged,e},HistoryData.CopyTo=function(t,e){t.Date=e.Date,t.YClose=e.YClose,t.Open=e.Open,t.Close=e.Close,t.High=e.High,t.Low=e.Low,t.Vol=e.Vol,t.Amount=e.Amount,t.Time=e.Time,t.FlowCapital=e.FlowCapital,t.Position=e.Position,t.YFClose=e.YFClose,t.FClose=e.FClose,t.Stop=e.Stop,t.Up=e.Up,t.Down=e.Down,t.Unchanged=e.Unchanged},HistoryData.CopyRight=function(t,e){var\x20a=new\x20HistoryData;return\x20a.Date=t.Date,a.YClose=t.YClose*e,a.Open=t.Open*e,a.Close=t.Close*e,a.High=t.High*e,a.Low=t.Low*e,a.Vol=t.Vol,a.Amount=t.Amount,a.FlowCapital=t.FlowCapital,a.Position=t.Position,a.YFClose=t.YFClose,a.FClose=t.FClose,a};var\x20KLINE_INFO_TYPE={INVESTOR:1,ANNOUNCEMENT:2,PFORECAST:3,ANNOUNCEMENT_QUARTER_1:4,ANNOUNCEMENT_QUARTER_2:5,ANNOUNCEMENT_QUARTER_3:6,ANNOUNCEMENT_QUARTER_4:7,RESEARCH:8,BLOCKTRADING:9,TRADEDETAIL:10,ANNOUNCEMENT_EX_START:100,ANNOUNCEMENT_EX_END:200};function\x20KLineInfoData(){this.ID,this.Date,this.Title,this.InfoType,this.ExtendData}function\x20DataPlus(){this.PeriodCallback=new\x20Map,this.GetPeriodCallback=function(t){return\x20this.PeriodCallback.has(t)?this.PeriodCallback.get(t):null},this.AddPeriodCallback=function(t){if(IFrameSplitOperator.IsNumber(t.Period)&&t.Callback){var\x20e={Period:t.Period,Callback:t.Callback};this.PeriodCallback.set(t.Period,e)}},this.RemovePeriodCallback=function(t){this.PeriodCallback.has(t.ID)&&this.PeriodCallback.delete(t.ID)}}DataPlus.GetMinutePeriodData=null;var\x20g_DataPlus=new\x20DataPlus;function\x20ChartData(){this.Data=new\x20Array,this.DataOffset=0,this.Period=0,this.Right=0,this.Symbol,this.Data2=new\x20Array,this.GetCloseMA=function(t){for(var\x20e=new\x20Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var\x20r=0,n=0;n<t;n++)r+=this.Data[a-n].Close;e[a]=r/t}return\x20e},this.GetVolMA=function(t){for(var\x20e=new\x20Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var\x20r=0,n=0;n<t;n++)r+=this.Data[a-n].Vol;e[a]=r/t}return\x20e},this.GetAmountMA=function(t){for(var\x20e=new\x20Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var\x20r=0,n=0;n<t;n++)r+=this.Data[a-n].Amount;e[a]=r/t}return\x20e},this.GetClose=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data)t[e]=this.Data[e].Close;return\x20t},this.GetYClose=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data)t[e]=this.Data[e].YClose;return\x20t},this.GetHigh=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data)t[e]=this.Data[e].High;return\x20t},this.GetLow=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data)t[e]=this.Data[e].Low;return\x20t},this.GetOpen=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data)t[e]=this.Data[e].Open;return\x20t},this.GetVol=function(t){var\x20e=1;IFrameSplitOperator.IsNumber(t)>0&&(e=t);var\x20a=new\x20Array;for(var\x20i\x20in\x20this.Data)a[i]=this.Data[i].Vol/e;return\x20a},this.GetAmount=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data)t[e]=this.Data[e].Amount;return\x20t},this.GetPosition=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data)t[e]=this.Data[e].Position;return\x20t},this.GetLead=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data)t[e]=this.Data[e].Lead;return\x20t},this.GetDate=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data)t[e]=this.Data[e].Date;return\x20t},this.GetTime=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data)t[e]=this.Data[e].Time;return\x20t},this.GetUp=function(){var\x20t=[];for(var\x20e\x20in\x20this.Data)t[e]=this.Data[e].Up;return\x20t},this.GetDown=function(){var\x20t=[];for(var\x20e\x20in\x20this.Data)t[e]=this.Data[e].Down;return\x20t},this.GetYear=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data)t[e]=parseInt(this.Data[e].Date/1e4);return\x20t},this.GetMonth=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data)t[e]=parseInt(this.Data[e].Date%1e4/100);return\x20t},this.GetAvPrice=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data){var\x20a=this.Data[e].AvPrice;IFrameSplitOperator.IsNumber(a)?t[e]=a:t[e]=0}return\x20t},this.GetDateRange=function(){if(!this.Data||this.Data.length<=0)return\x20null;var\x20t=this.Data[0],e=this.Data[this.Data.length-1],a={Start:{Date:t.Date},End:{Date:e.Date}};return\x20IFrameSplitOperator.IsNumber(t.Time)&&(a.Start.Time=t.Time),IFrameSplitOperator.IsNumber(e.Time)&&(a.End.Time=e.Time),a},this.GetMinutePeriodData=function(t){if(DataPlus.GetMinutePeriodData)return\x20DataPlus.GetMinutePeriodData(t,this.Data,this);var\x20e=new\x20Array,a=5;if(5==t)a=5;else\x20if(6==t)a=15;else\x20if(7==t)a=30;else\x20if(8==t)a=60;else\x20if(11==t)a=120;else\x20if(12==t)a=240;else{if(0!=t)return\x20t>CUSTOM_MINUTE_PERIOD_START&&t<=CUSTOM_MINUTE_PERIOD_END?(a=t-CUSTOM_MINUTE_PERIOD_START,this.GetMinuteCustomPeriodData(a)):this.Data;a=1440}for(var\x20i=!1,r=null,n=null,s=0;s<this.Data.length;){i=!0;for(var\x20o=0;o<a&&s<this.Data.length;++s){i&&(r=new\x20HistoryData,e.push(r),i=!1);var\x20h=this.Data[s];if(null!=h){if((925!=h.Time||null!=n&&924==n)&&(930!=h.Time||null!=n&&929==n)&&(1300!=h.Time||null!=n&&1259==n)&&++o,r.Date=h.Date,r.Time=h.Time,n=r.Time,null!=h.Open&&null!=h.Close&&(null==r.Open||null==r.Close?(r.Open=h.Open,r.High=h.High,r.Low=h.Low,r.YClose=h.YClose,r.Close=h.Close,r.Vol=h.Vol,r.Amount=h.Amount,r.FlowCapital=h.FlowCapital,r.Position=h.Position,r.YFClose=h.YFClose,r.FClose=h.FClose):(r.High<h.High&&(r.High=h.High),r.Low>h.Low&&(r.Low=h.Low),r.Close=h.Close,r.Vol+=h.Vol,null!=h.Amount&&(r.Amount+=h.Amount),r.Position=h.Position,r.FlowCapital=h.FlowCapital,r.FClose=h.FClose),s+1<this.Data.length)){var\x20l=this.Data[s+1];if(l&&l.Date!=h.Date){++s;break}}}else++o}}return\x20e},this.GetMinuteCustomPeriodData=function(t){for(var\x20e=new\x20Array,a=t,i=!1,r=null,n=0;n<this.Data.length;){i=!0;for(var\x20s=0;s<a&&n<this.Data.length;++n,++s){i&&(r=new\x20HistoryData,e.push(r),i=!1);var\x20o=this.Data[n];null!=o&&(r.Date=o.Date,r.Time=o.Time,null!=o.Open&&null!=o.Close&&(null==r.Open||null==r.Close?(r.Open=o.Open,r.High=o.High,r.Low=o.Low,r.YClose=o.YClose,r.Close=o.Close,r.Vol=o.Vol,r.Amount=o.Amount,r.FlowCapital=o.FlowCapital,r.Position=o.Position,r.YFClose=o.YFClose,r.FClose=o.FClose):(r.High<o.High&&(r.High=o.High),r.Low>o.Low&&(r.Low=o.Low),r.Close=o.Close,r.Vol+=o.Vol,null!=o.Amount&&(r.Amount+=o.Amount),r.Position=o.Position,r.FlowCapital=o.FlowCapital,r.FClose=o.FClose)))}}return\x20e},this.GetDayPeriodData=function(t){if(t>CUSTOM_DAY_PERIOD_START&&t<=CUSTOM_DAY_PERIOD_END)return\x20this.GetDayCustomPeriodData(t-CUSTOM_DAY_PERIOD_START);var\x20e=MARKET_SUFFIX_NAME.IsBIT(this.Symbol),a=new\x20Array,i=0,r=2,n=null;for(var\x20s\x20in\x20this.Data){var\x20o=!1,h=this.Data[s];switch(t){case\x201:if(e)var\x20l=ChartData.GetSunday(h.Date);else\x20l=ChartData.GetFirday(h.Date);l!=i&&(o=!0,i=l);break;case\x2021:if(e)l=ChartData.GetSunday(h.Date);else\x20l=ChartData.GetFirday(h.Date);l!=i&&(++r>=2&&(o=!0,r=0),i=l);break;case\x202:parseInt(h.Date/100)!=parseInt(i/100)&&(o=!0,i=h.Date);break;case\x203:parseInt(h.Date/1e4)!=parseInt(i/1e4)&&(o=!0,i=h.Date);break;case\x209:var\x20C=ChartData.GetQuarter(h.Date);C=10*parseInt(h.Date/1e4)+C;var\x20u=ChartData.GetQuarter(i);C!=(u=10*parseInt(i/1e4)+u)&&(o=!0,i=h.Date)}if(o){if((n=new\x20HistoryData).Date=h.Date,a.push(n),null==h.Open||null==h.Close)continue;n.Open=h.Open,n.High=h.High,n.Low=h.Low,n.YClose=h.YClose,n.Close=h.Close,n.Vol=h.Vol,n.Amount=h.Amount,n.FlowCapital=h.FlowCapital,n.Position=h.Position,n.YFClose=h.YFClose,n.FClose=h.FClose}else{if(null==n)continue;if(null==h.Open||null==h.Close)continue;null==n.Open||null==n.Close?(n.Open=h.Open,n.High=h.High,n.Low=h.Low,n.YClose=h.YClose,n.Close=h.Close,n.Vol=h.Vol,n.Amount=h.Amount,n.FlowCapital=h.FlowCapital,n.Position=h.Position,n.YFClose=h.YFClose,n.FClose=h.FClose):(n.High<h.High&&(n.High=h.High),n.Low>h.Low&&(n.Low=h.Low),n.Close=h.Close,n.Vol+=h.Vol,null!=h.Amount&&(n.Amount+=h.Amount),n.Position=h.Position,n.FlowCapital=h.FlowCapital,n.Date=h.Date,n.FClose=h.FClose)}}return\x20a},this.GetDayCustomPeriodData=function(t){for(var\x20e=[],a=t,i=!1,r=null,n=0;n<this.Data.length;){i=!0;for(var\x20s=0;s<a&&n<this.Data.length;++n,++s){i&&(r=new\x20HistoryData,e.push(r),i=!1);var\x20o=this.Data[n];null!=o&&(r.Date=o.Date,null!=o.Open&&null!=o.Close&&(null==r.Open||null==r.Close?(r.Open=o.Open,r.High=o.High,r.Low=o.Low,r.YClose=o.YClose,r.Close=o.Close,r.Vol=o.Vol,r.Amount=o.Amount,r.FlowCapital=o.FlowCapital,r.Position=o.Position,r.YFClose=o.YFClose,r.FClose=o.FClose):(r.High<o.High&&(r.High=o.High),r.Low>o.Low&&(r.Low=o.Low),r.Close=o.Close,r.Vol+=o.Vol,null!=o.Amount&&(r.Amount+=o.Amount),r.Position=o.Position,r.FlowCapital=o.FlowCapital,r.FClose=o.FClose)))}}return\x20e},this.GetPeriodData=function(t){var\x20e=g_DataPlus.GetPeriodCallback(t);if(e)return\x20e.Callback(t,this.Data,this);if(MARKET_SUFFIX_NAME.IsBIT(this.Symbol)&&(5==t||6==t||7==t||8==t||t>CUSTOM_MINUTE_PERIOD_START&&t<=CUSTOM_MINUTE_PERIOD_END)){var\x20a=5;return\x205==t?a=5:6==t?a=15:7==t?a=30:8==t?a=60:11==t?a=120:12==t?a=240:t>CUSTOM_MINUTE_PERIOD_START&&t<=CUSTOM_MINUTE_PERIOD_END&&(a=t-CUSTOM_MINUTE_PERIOD_START),this.GetMinuteCustomPeriodData(a)}return\x20debug&&console.log(\x22GetPeriodData\x22,t),1==t||2==t||3==t||9==t||21==t||t>CUSTOM_DAY_PERIOD_START&&t<=CUSTOM_DAY_PERIOD_END?this.GetDayPeriodData(t):5==t||6==t||7==t||8==t||11==t||12==t||t>CUSTOM_MINUTE_PERIOD_START&&t<=CUSTOM_MINUTE_PERIOD_END?this.GetMinutePeriodData(t):0==t?this.GetMinutePeriodData(t):void\x200},this.GetRightDate=function(t){var\x20e=[];if(this.Data.length<=0)return\x20e;if(1==t){var\x20a=this.Data.length-1,i=1,r=this.Data[a].YClose;for(e[a]=HistoryData.Copy(this.Data[a]),--a;a>=0&&r==this.Data[a].Close;--a)e[a]=HistoryData.Copy(this.Data[a]),r=this.Data[a].YClose;for(;a>=0;--a){var\x20n=this.Data[a].Close;r!=n&&0!=n&&(i*=r/n),e[a]=HistoryData.CopyRight(this.Data[a],i),r=this.Data[a].YClose}}else\x20if(2==t){a=0,i=1;var\x20s=this.Data[a].Close;for(e[a]=HistoryData.Copy(this.Data[a]),++a;a<this.Data.length&&s==this.Data[a].YClose;++a)e[a]=HistoryData.Copy(this.Data[a]),s=this.Data[a].Close;for(;a<this.Data.length;++a)s!=this.Data[a].YClose&&(i*=s/this.Data[a].YClose),e[a]=HistoryData.CopyRight(this.Data[a],i),s=this.Data[a].Close}return\x20e},this.GetRightData=this.GetRightDate,this.GetOverlayData=function(t,e){for(var\x20a=[],i=0,r=0;i<this.Data.length;){var\x20n=this.Data[i].Date;if(r>=t.length)a[i]=new\x20HistoryData,a[i].Date=n,++i;else{var\x20s=t[r].Date;s==n?(a[i]=new\x20HistoryData,a[i].Date=t[r].Date,a[i].YClose=t[r].YClose,a[i].Open=t[r].Open,a[i].High=t[r].High,a[i].Low=t[r].Low,a[i].Close=t[r].Close,a[i].Vol=t[r].Vol,a[i].Amount=t[r].Amount,a[i].Stop=t[r].Stop,a[i].Up=t[r].Up,a[i].Down=t[r].Down,a[i].Unchanged=t[r].Unchanged,++r,++i):s<n?++r:(a[i]=new\x20HistoryData,a[i].Date=n,++i)}}return\x20a},this.GetOverlayMinuteData=function(t,e){for(var\x20a=[],i=0,r=0;i<this.Data.length;){var\x20n=this.Data[i].Date,s=this.Data[i].Time;if(r>=t.length)a[i]=new\x20HistoryData,a[i].Date=n,a[i].Time=s,++i;else{var\x20o=t[r].Date,h=t[r].Time;o==n&&h==s?(a[i]=new\x20HistoryData,a[i].Date=t[r].Date,a[i].Time=t[r].Time,a[i].YClose=t[r].YClose,a[i].Open=t[r].Open,a[i].High=t[r].High,a[i].Low=t[r].Low,a[i].Close=t[r].Close,a[i].Vol=t[r].Vol,a[i].Amount=t[r].Amount,a[i].Stop=t[r].Stop,a[i].Up=t[r].Up,a[i].Down=t[r].Down,a[i].Unchanged=t[r].Unchanged,++r,++i):o<n||o==n&&h<s?++r:(a[i]=new\x20HistoryData,a[i].Date=n,a[i].Time=s,++i)}}return\x20a},this.GetFittingData=function(t){for(var\x20e=new\x20Array,a=0,i=0;a<this.Data.length;){var\x20r=this.Data[a].Date;if(i>=t.length)e[a]=null,++a;else{var\x20n=t[i].Date;if(n==r){var\x20s=new\x20SingleData;s.Date=t[i].Date,s.Value=t[i].Value,e[a]=s,++i,++a}else\x20n<r?++i:(e[a]=new\x20SingleData,e[a].Date=r,++a)}}return\x20e},this.GetFittingData2=function(t,e){for(var\x20a=new\x20Array,i=0,r=0;i<this.Data.length;){var\x20n=this.Data[i].Date;if(r>=t.length)a[i]=new\x20SingleData,a[i].Date=n,a[i].Value=e,++i;else{var\x20s=t[r].Date;if(s==n){var\x20o=new\x20SingleData;o.Date=t[r].Date,o.Value=t[r].Value,a[i]=o,++r,++i}else\x20s<n?++r:(a[i]=new\x20SingleData,a[i].Date=n,a[i].Value=e,++i)}}return\x20a},this.GetDateIndex=function(t){for(var\x20e=0,a=0;e<this.Data.length;){var\x20i=this.Data[e].Date;if(a>=t.length)break;var\x20r=t[a];r.Date==i?(r.Index=e,++a):r.Date<i?++a:++e}},this.GetDateTimeIndex=function(t){for(var\x20e=0,a=0;e<this.Data.length;){var\x20i=this.Data[e].Date,r=this.Data[e].Time;if(a>=t.length)break;var\x20n=t[a];n.Date==i&&n.Time==r?(n.Index=e,++a):n.Date<i||n.Date==i&&n.Time<r?++a:++e}},this.GetMinuteFittingData=function(t){for(var\x20e=[],a=0,i=0;a<this.Data.length;){var\x20r=this.Data[a].Date,n=this.Data[a].Time;if(i>=t.length){e[a]=null,++a;continue}var\x20s=t[i].Date,o=t[i].Time;const\x20l=t[i];if(s==r&&o==n)(h=new\x20SingleData).Date=l.Date,h.Time=l.Time,h.Value=l.Value,e[a]=h,++i,++a;else\x20if(s<r||s==r&&o<n)++i;else{var\x20h;(h=new\x20SingleData).Date=r,h.Time=n,e[a]=h,++a}}return\x20e},this.GetFittingFinanceData=function(t){for(var\x20e=[],a=0,i=0;a<this.Data.length;){var\x20r=this.Data[a].Date;if(i<t.length)if(r<t[i].Date){++a;continue}if(i+1<t.length&&t[i].Date<r&&t[i+1].Date<=r)++i;else{var\x20n=new\x20SingleData;n.Date=r,i<t.length?(n.Value=t[i].Value,n.FinanceDate=t[i].Date):(n.Value=null,n.FinanceDate=null),e[a]=n,++a}}return\x20e},this.GetMinuteFittingFinanceData=function(t){for(var\x20e=[],a=0,i=0;a<this.Data.length;){var\x20r=this.Data[a].Date,n=this.Data[a].Time;if(i+1<t.length&&t[i].Date<r&&t[i+1].Date<=r)++i;else{var\x20s=new\x20SingleData;s.Date=r,s.Time=n,i<t.length?(s.Value=t[i].Value,s.FinanceDate=t[i].Date):(s.Value=null,s.FinanceDate=null),e[a]=s,++a}}return\x20e},this.GetFittingTradeData=function(t,e,a){for(var\x20i=[],r=!1,n=0,s=0;n<this.Data.length;){var\x20o=this.Data[n].Date;if(s<t.length&&t[s].Date>o)(h=new\x20SingleData).Date=o,h.Value=e,i[n]=h,++n;else\x20if(s+1<t.length&&t[s].Date<o&&t[s+1].Date<=o)++s,r=!1;else{var\x20h;if((h=new\x20SingleData).Date=o,h.Value=e,h.FinanceDate=null,s<t.length){var\x20l=t[s];0==this.Period&&!0===a?l.Date==h.Date&&(h.Value=l.Value,h.FinanceDate=l.Date,r=!0):0==r&&(h.Value=l.Value,h.FinanceDate=l.Date,r=!0)}i[n]=h,++n}}return\x20i},this.GetMinuteFittingTradeData=function(t,e){for(var\x20a=[],i=0,r=0;i<this.Data.length;){var\x20n=this.Data[i].Date,s=this.Data[i].Time;if(r+1<t.length&&t[r].Date<n&&t[r+1].Date<=n)++r;else{var\x20o=new\x20SingleData;if(o.Date=n,o.FinanceDate=null,o.Time=s,o.Value=e,r<t.length){var\x20h=t[r];h.Date==o.Date&&(o.Value=h.Value,o.FinanceDate=h.Date)}a[i]=o,++i}}return\x20a},this.GetFittingMarketValueData=function(t){for(var\x20e=[],a=0,i=0;a<this.Data.length;){var\x20r=this.Data[a].Date,n=this.Data[a].Close;if(i+1<t.length&&t[i].Date<r&&t[i+1].Date<=r)++i;else{var\x20s=new\x20SingleData;s.Date=r,s.Value=t[i].Value*n,s.FinanceDate=t[i].Date,e[a]=s,++a}}return\x20e},this.GetFittingMonthData=function(t){for(var\x20e=new\x20Array,a=null,i=0,r=0;i<this.Data.length;){var\x20n=this.Data[i].Date;if(r>=t.length)e[i]=null,++i;else{var\x20s=t[r].Date;if(s==n)(o=new\x20SingleData).Date=t[r].Date,o.Value=t[r].Value,o.Text=t[r].Text,e[i]=o,++r,++i;else\x20if(null!=a&&a<s&&n>s){var\x20o;(o=new\x20SingleData).Date=n,o.OverlayDate=t[r].Date,o.Value=t[r].Value,o.Text=t[r].Text,e[i]=o,++r,++i}else\x20s<n?++r:(e[i]=new\x20SingleData,e[i].Date=n,++i);a=n}}return\x20e},this.GetValue=function(){var\x20t=[];for(var\x20e\x20in\x20this.Data)if(this.Data[e]&&null!=this.Data[e].Value){var\x20a=this.Data[e].Value;isNaN(a)?a\x20instanceof\x20Array?t[e]=a:t[e]=null:t[e]=a}else\x20t[e]=null;return\x20t},this.GetObject=function(){var\x20t=[];for(var\x20e\x20in\x20this.Data)if(this.Data[e]&&this.Data[e].Value){var\x20a=this.Data[e].Value;t[e]=a}else\x20t[e]=null;return\x20t},this.GetPeriodSingleData=function(t){var\x20e=new\x20Array,a=0,i=2,r=null;for(var\x20n\x20in\x20this.Data){var\x20s=!1,o=this.Data[n];if(null!=o&&null!=o.Date){switch(t){case\x201:(h=ChartData.GetFirday(o.Date))!=a&&(s=!0,a=h);break;case\x2021:var\x20h;(h=ChartData.GetFirday(o.Date))!=a&&(++i>=2&&(s=!0,i=0),a=h);break;case\x202:parseInt(o.Date/100)!=parseInt(a/100)&&(s=!0,a=o.Date);break;case\x203:parseInt(o.Date/1e4)!=parseInt(a/1e4)&&(s=!0,a=o.Date);break;case\x209:var\x20l=ChartData.GetQuarter(o.Date);l=10*parseInt(o.Date/1e4)+l;var\x20C=ChartData.GetQuarter(a);l!=(C=10*parseInt(a/1e4)+C)&&(s=!0,a=o.Date)}if(s)(r=new\x20SingleData).Date=o.Date,r.Value=o.Value,e.push(r);else{if(null==r)continue;if(null==o.Value||isNaN(o.Value))continue;(null==r.Value||isNaN(r.Value))&&(r.Value=o.Value)}}}return\x20e},this.GetMinuteAvPrice=function(){var\x20t=new\x20Array;for(var\x20e\x20in\x20this.Data)t[e]=this.Data[e].AvPrice;return\x20t},this.MergeMinuteData=function(t){for(var\x20e=this.Data[0],a=0,i=null,r=0;r<t.length;++r){if((C=t[r]).Date>e.Date){a=r,i=C;break}if(C.Date==e.Date&&C.Time>=e.Time){a=r,i=C;break}}if(null==i)return!1;var\x20n=null,s=!1;for(r=this.Data.length-1;r>=0;--r){var\x20o=this.Data[r].Date,h=this.Data[r].Time;if(i.Date>o||i.Date==o&&i.Time>=h){n=r,i.Date==o&&i.Time==h&&(s=!0);break}}if(null==n)return!1;var\x20l=n;r=a;if(1==s){var\x20C=t[r];l-1>0&&!C.YClose&&(C.YClose=this.Data[l-1].Close);var\x20u=HistoryData.Copy(C);this.Data[l]=u,++l,++r}else++l;for(;r<t.length;){C=t[r];if(l>=this.Data.length-1){l-1>0&&!C.YClose&&(C.YClose=this.Data[l-1].YClose);u=HistoryData.Copy(C);this.Data[l]=u,++l,++r}else{var\x20D=this.Data[l];D.Date==C.Date&&D.Time==C.Time?(HistoryData.CopyTo(D,C),++l,++r):++l}}return!0},this.ConverPeriod=function(t,e,a){for(var\x20i=[],r=null,n=ChartData.IsMinutePeriod(e,!0),s=ChartData.IsMinutePeriod(a,!0),o=n&&s,h=n&&!s,l=!n&&!s,C=0,u=0;C<this.Data.length;++C){for(var\x20D=this.Data[C];u<t.length;++u){var\x20d=t[u];if(o){if(d.Date>D.Date||d.Date==D.Date&&d.Time>=D.Time){r=d;break}}else\x20if((h||l)&&d.Date>=D.Date){r=d;break}}var\x20c=null;r?((c=HistoryData.Copy(r)).PDate=r.Date,c.PTime=r.Time):c=new\x20HistoryData,c.Date=D.Date,(o||h)&&(c.Time=D.Time),i.push(c)}return\x20JSConsole.Chart.Log(\x22[ChartData::ConverPeriod]\x20result\x22,i),i},this.GetRef=function(t){let\x20e=[];for(var\x20a=0;a<this.Data.length;++a){e[a]=null;var\x20i=this.Data[a];if(a-t<0){(r=new\x20HistoryData).Date=i.Date,r.Time=i.Time,e[a]=r}else{var\x20r,n=this.Data[a-t];(r=HistoryData.Copy(n)).Date=i.Date,r.Time=i.Time,e[a]=r}}return\x20e},this.FitKLineIndex=function(t,e,a,i){for(var\x20r=this.Data.length,n=t.length,s=[ChartData.IsMinutePeriod(a,!0),ChartData.IsMinutePeriod(i,!0)],o=[ChartData.IsDayPeriod(a,!0),ChartData.IsDayPeriod(i,!0)],h=ChartData.GetKLineDataTime(this.Data[0]),l=[],C=n,u=0;u<n;++u){var\x20D=ChartData.GetKLineDataTime(t[u]);if(o[0]&&o[1]||s[0]&&o[1]){if(D.Date>=h.Date){C=u;break}}else\x20if(s[0]&&s[1]){if(D.Date>h.Date){C=u;break}if(D.Date==h.Date&&D.Time>=h.Time){C=u;break}}}u=0;for(var\x20d=C;u<r;){D=ChartData.GetKLineDataTime(this.Data[u]);if(d>=n){var\x20c={Date:D.Date,Time:D.Time,Index:-1};l[u]=c,++u}else{var\x20m=ChartData.GetKLineDataTime(t[d]);if(o[0]&&o[1]||s[0]&&o[1])if(m.Date==D.Date){c={Date:D.Date,Time:D.Time,Index:d,Data2:m.Date,Time2:m.Time};l[u]=c,++u}else\x20if(d+1<n){var\x20f=ChartData.GetKLineDataTime(t[d+1]);if(m.Date<=D.Date&&f.Date>D.Date){c={Date:D.Date,Time:D.Time,Index:d,Data2:m.Date,Time2:m.Time};l[u]=c,++u}else\x20if(f.Date<=D.Date)++d;else{c={Date:D.Date,Time:D.Time,Index:-1};l[u]=c,++u}}else++d;else\x20if(s[0]&&s[1])if(m.Date==D.Date&&m.Time==D.Time){c={Date:D.Date,Time:D.Time,Index:d,Data2:m.Date,Time2:m.Time};l[u]=c,++u}else\x20if(d+1<n){f=ChartData.GetKLineDataTime(t[d+1]);if(m.Date<D.Date&&f.Date>D.Date||m.Date==D.Date&&m.Time<D.Time&&f.Date==D.Date&&f.Time>D.Time||m.Date==D.Date&&m.Time<D.Time&&f.Date>D.Date||m.Date<D.Date&&f.Date==D.Date&&f.Time>D.Time){c={Date:D.Date,Time:D.Time,Index:d,Data2:m.Date,Time2:m.Time};l[u]=c,++u}else\x20if(f.Date<D.Date||f.Date==D.Date&&f.Time<=D.Time)++d;else{c={Date:D.Date,Time:D.Time,Index:-1};l[u]=c,++u}}else++d}}var\x20v=[];for(var\x20u\x20in\x20e){D=e[u];if(Array.isArray(D.Data)){var\x20S=[];v[u]={Data:S,Name:D.Name};for(d=0;d<l.length;++d){var\x20T=l[d];S[d]=null,T&&T.Index>=0&&T.Index<D.Data.length&&(S[d]=D.Data[T.Index])}}else\x20v[u]={Data:D.Data,Name:D.Name}}return\x20v},this.FindDataIndexByDateTime=function(t){var\x20e=0;for(var\x20a\x20in\x20t)t[a].Index=-1;for(var\x20a\x20in\x20this.Data){var\x20i=this.Data[a];for(var\x20r\x20in\x20t){var\x20n=t[r];if(!(n.Index>=0)){if(IFrameSplitOperator.IsNumber(n.Time)){if(n.Date==i.Date&&n.Time==i.Time){n.Index=parseInt(a),++e;break}}else\x20if(n.Date==i.Date){n.Index=parseInt(a),++e;break}if(e>=t.length)break}}}},this.CloneData=function(t){var\x20e=[];if(\x22HistoryData\x22==t)for(var\x20a\x20in\x20this.Data){var\x20i=this.Data[a],r=HistoryData.Copy(i);e.push(r)}return\x20e},this.GetAPIDataIndex=function(t,e){var\x20a=[];if(t&&e){for(var\x20i=this.Data.length,r=t.length,n=ChartData.GetKLineDataTime(this.Data[0]),s=r,o=(s=r,0);o<r;++o){var\x20h=t[o],l=e[o];if(h>n.Date||h==n.Date&&l>=n.Time){s=o;break}}o=0;for(var\x20C=s;o<i;){var\x20u=this.Data[o];if(C>=r){var\x20D={KDate:u.Date,KTime:u.Time,KIndex:o,Index:-1};a[o]=D,++o}else{h=t[C],l=e[C];if(h==u.Date&&l==u.Time){D={KDate:u.Date,KTime:u.Time,KIndex:o,Index:C,Data:h,Time:l};a[o]=D,++o}else\x20if(C+1<r){var\x20d=t[C+1],c=e[C+1];if(h<u.Date&&d>u.Date||h==u.Date&&l<u.Time&&d==u.Date&&c>u.Time||h==u.Date&&l<u.Time&&d>u.Date||h<u.Date&&d==u.Date&&c>u.Time){D={KDate:u.Date,KTime:u.Time,KIndex:o,Index:C,Data:h,Time:l};a[o]=D,++o}else\x20if(d<u.Date||d==u.Date&&c<=u.Time)++C;else{D={KDate:u.Date,KTime:u.Time,KIndex:o,Index:-1};a[o]=D,++o}}else++C}}}else\x20if(t){for(i=this.Data.length,r=t.length,n=ChartData.GetKLineDataTime(this.Data[0]),s=r,o=0;o<r;++o){if((u=t[o])>=n.Date){s=o;break}}for(o=0,C=s;o<i;){u=this.Data[o];if(C>=r){D={KDate:u.Date,KIndex:o,Index:-1};a[o]=D,++o}else{var\x20m=t[C];if(m==u.Date){D={KDate:u.Date,KIndex:o,Index:C,Data:m};a[o]=D,++o}else\x20if(C+1<r){var\x20f=t[C+1];if(m<=u.Date&&f>u.Date){D={KDate:u.Date,KIndex:o,Index:C,Data:m};a[o]=D,++o}else\x20if(f<=u.Date)++C;else{D={KDate:u.Date,KIndex:o,Index:-1};a[o]=D,++o}}else++C}}}return\x20a},this.FixKData=function(t,e){return\x20ChartData.IsDayPeriod(e,!0)?this.FixKData_Day(t):ChartData.IsMinutePeriod(e,!0)?this.FixKData_Minute(t):null},this.FixKData_Day=function(t){for(var\x20e=[],a=t.length,i=0,r=0;i<this.Data.length;){var\x20n=this.Data[i];if(r<a)if((s=t[r]).Date>n.Date){++i;continue}if(r+1<a){var\x20s=t[r],o=t[r+1];if(s.Date<n.Date&&o.Date<=n.Date){++r;continue}}var\x20h=new\x20HistoryData;h.Date=n.Date;s=t[r<a?r:a-1];h.Close=s.Close,h.High=s.High,h.Low=s.Low,h.Open=s.Open,h.YClose=s.YClose,h.Amount=s.Amount,h.Vol=s.Vol,h.ExDate=s.Date,e[i]=h,++i}return\x20e},this.FixKData_Minute=function(t){for(var\x20e=[],a=t.length,i=0,r=0;i<this.Data.length;){var\x20n=this.Data[i],s=ChartData.DateTimeToNumber(n);if(r<a){var\x20o=t[r];if((l=ChartData.DateTimeToNumber(o))>s){++i;continue}}if(r+1<a){o=t[r];var\x20h=t[r+1],l=ChartData.DateTimeToNumber(o),C=ChartData.DateTimeToNumber(h);if(l<s&&C<=s){++r;continue}}var\x20u=new\x20HistoryData;u.Date=n.Date,u.Time=n.Time;o=t[r<a?r:a-1];u.Close=o.Close,u.High=o.High,u.Low=o.Low,u.Open=o.Open,u.YClose=o.YClose,u.Amount=o.Amount,u.Vol=o.Vol,u.ExDate=o.Date,u.ExTime=o.Time,e[i]=u,++i}return\x20e}}ChartData.DateTimeToNumber=function(t){return\x201e4*t.Date+t.Time},ChartData.GetKLineDataTime=function(t){var\x20e={Date:t.Date,Time:0};return\x20IFrameSplitOperator.IsNumber(t.Time)&&(e.Time=t.Time),e},ChartData.GetFirday=function(t){var\x20e=new\x20Date(parseInt(t/1e4),t/100%100-1,t%100),a=e.getDay();if(5==a)return\x20t;var\x20i=e.getTime();a<5?i+=864e5*(5-a):i-=864e5*(a-5);e.setTime(i);var\x20r=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();e.getDay();return\x20r},ChartData.GetSunday=function(t){var\x20e=new\x20Date(parseInt(t/1e4),t/100%100-1,t%100),a=e.getDay();if(0==a)return\x20t;var\x20i=e.getTime();a>0&&(i+=864e5*(7-a));e.setTime(i);var\x20r=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();e.getDay();return\x20r},ChartData.GetQuarter=function(t){var\x20e=parseInt(t%1e4/100);return\x201==e||2==e||3==e?1:4==e||5==e||6==e?2:7==e||8==e||9==e?3:10==e||11==e||12==e?4:0};var\x20CUSTOM_DAY_PERIOD_START=4e4,CUSTOM_DAY_PERIOD_END=49999;ChartData.IsDayPeriod=function(t,e){return\x201==t||2==t||3==t||9==t||21==t||(t>CUSTOM_DAY_PERIOD_START&&t<=CUSTOM_DAY_PERIOD_END||0==t&&1==e)};var\x20CUSTOM_MINUTE_PERIOD_START=2e4,CUSTOM_MINUTE_PERIOD_END=29999;ChartData.IsMinutePeriod=function(t,e){return\x205==t||6==t||7==t||8==t||11==t||12==t||(t>CUSTOM_MINUTE_PERIOD_START&&t<=CUSTOM_MINUTE_PERIOD_END||(4==t&&1==e||0==t))};var\x20CUSTOM_SECOND_PERIOD_START=3e4,CUSTOM_SECOND_PERIOD_END=32e3;function\x20TooltipData(){this.ChartPaint,this.Data,this.Type=0}function\x20Rect(t,e,a,i){this.X=t,this.Y=e,this.Width=a,this.Height=i}function\x20IChartPainting(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName=\x22IChartPainting\x22,this.Data=new\x20ChartData,this.NotSupportMessage=null,this.MessageFont=g_JSChartResource.Index.NotSupport.Font,this.MessageColor=g_JSChartResource.Index.NotSupport.TextColor,this.IsDrawFirst=!1,this.IsShow=!0,this.Draw=function(){},this.DrawNotSupportmessage=function(){this.Canvas.font=this.MessageFont,this.Canvas.fillStyle=this.MessageColor;var\x20t=this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()/2,e=this.ChartBorder.GetTopEx()+this.ChartBorder.GetHeightEx()/2;this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillText(this.NotSupportMessage,t,e)},this.GetTooltipData=function(t,e,a){return!1},this.GetMaxMin=function(){var\x20t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return\x20e;for(var\x20a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var\x20r=this.Data.Data[a];null==r||isNaN(r)||(null==e.Max&&(e.Max=r),null==e.Min&&(e.Min=r),e.Max<r&&(e.Max=r),e.Min>r&&(e.Min=r))}return\x20e},this.GetDynamicFont=function(t,e,a,i,r,n){var\x20s=GetDevicePixelRatio();if((a*=s)==(i*=s))return`${a.toFixed(0)}px\x20${n}`;var\x20o=t+e;return\x20r&&(0==r.Type?r.Value>0&&(o=t*r.Value):1==r.Type?r.Value>0&&(o=(t+e)*r.Value):2==r.Type&&IFrameSplitOperator.IsNumber(r.Value)&&(o=t+e+2*r.Value*s)),o<i?o=i:o>a&&(o=a),`${o.toFixed(0)}px\x20${n}`},this.GetLockRect=function(){return\x20this.ChartFrame.GetLockRect()},this.SetFillStyle=function(t,e,a,i,r){if(Array.isArray(t)){let\x20o=this.Canvas.createLinearGradient(e,a,i,r);var\x20n=1/t.length;for(var\x20s\x20in\x20t)o.addColorStop(s*n,t[s]);this.Canvas.fillStyle=o}else\x20this.Canvas.fillStyle=t},this.GetDynamicIconSize=function(t,e,a,i,r){var\x20n=GetDevicePixelRatio();if((a*=n)==(i*=n))return\x20a;var\x20s=t+e-2*n;return\x20r&&(0==r.Type?r.Value>0&&(s=t*r.Value):1==r.Type?r.Value>0&&(s=(t+e)*r.Value):2==r.Type&&IFrameSplitOperator.IsNumber(r.Value)&&(s=t+e+2*r.Value*n)),s<i?s=i:s>a&&(s=a),s}}ChartData.IsSecondPeriod=function(t){return\x20t>CUSTOM_SECOND_PERIOD_START&&t<=CUSTOM_SECOND_PERIOD_END},ChartData.IsTickPeriod=function(t){return\x2010==t},ChartData.GetPeriodName=function(t){var\x20e=new\x20Map([[0,\x22日线\x22],[1,\x22周线\x22],[2,\x22月线\x22],[3,\x22年线\x22],[9,\x22季线\x22],[21,\x22双周\x22],[4,\x221分\x22],[5,\x225分\x22],[6,\x2215分\x22],[7,\x2230分\x22],[8,\x2260分\x22],[11,\x222小时\x22],[12,\x224小时\x22],[10,\x22分笔\x22]]);return\x20e.has(t)?e.get(t):\x22\x22};var\x20ZOOM_SEED=[[48,10],[44,10],[40,9],[36,9],[32,8],[28,8],[24,7],[20,7],[18,6],[16,6],[14,5],[12,5],[8,4],[6,4],[4,4],[3,3],[3,1],[2,1],[1,1],[1,0]];function\x20ChartKLine(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartKLine\x22,this.Symbol,this.DrawType=0,this.CloseLineColor=g_JSChartResource.CloseLineColor,this.CloseLineAreaColor=g_JSChartResource.CloseLineAreaColor,this.UpColor=g_JSChartResource.UpBarColor,this.DownColor=g_JSChartResource.DownBarColor,this.UnchagneColor=g_JSChartResource.UnchagneBarColor,this.ColorData,this.TradeData,this.TradeIcon=g_JSChartResource.KLine.TradeIcon,this.TooltipRect=[],this.InfoTooltipRect=[],this.TradeIconTooltipRect=[],this.IsShowMaxMinPrice=!0,this.IsShowKTooltip=!0,this.TextFont=g_JSChartResource.KLine.MaxMin.Font,this.TextColor=g_JSChartResource.KLine.MaxMin.Color,this.InfoData,this.InfoPosition=0,this.PtMax,this.PtMin,this.TickSymbol=\x22╳\x22,this.TickFontName=\x22arial\x22,this.Period,this.ShowRange={},this.ReloadResource=function(t){this.TextFont=g_JSChartResource.KLine.MaxMin.Font,this.TextColor=g_JSChartResource.KLine.MaxMin.Color,this.CloseLineColor=g_JSChartResource.CloseLineColor,this.CloseLineAreaColor=g_JSChartResource.CloseLineAreaColor,this.UpColor=g_JSChartResource.UpBarColor,this.DownColor=g_JSChartResource.DownBarColor,this.UnchagneColor=g_JSChartResource.UnchagneBarColor},this.DrawAKLine=function(){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2;t&&(i=this.ChartBorder.GetTop()+a/2+2);var\x20r=this.ChartBorder.GetRight();t&&(r=this.ChartBorder.GetBottom());for(var\x20n=this.ChartFrame.XPointCount,s=(this.UpColor,this.DownColor,this.UnchagneColor,{X:null,Y:null,Value:null,Align:\x22left\x22}),o={X:null,Y:null,Value:null,Align:\x22left\x22},h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<n;++h,++l,i+=e+a){var\x20C=this.Data.Data[h];if(null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){var\x20u=i,D=i+e;if(D>r)break;var\x20d=u+(D-u)/2,c=this.ChartFrame.GetYFromData(C.Low),m=this.ChartFrame.GetYFromData(C.High),f=this.ChartFrame.GetYFromData(C.Open),v=this.ChartFrame.GetYFromData(C.Close);if((null==s.Value||s.Value<C.High)&&(s.X=d,s.Y=m,s.Value=C.High,s.Align=l<n/2?\x22left\x22:\x22right\x22),(null==o.Value||o.Value>C.Low)&&(o.X=d,o.Y=c,o.Value=C.Low,o.Align=l<n/2?\x22left\x22:\x22right\x22),C.Open<C.Close?this.Canvas.strokeStyle=this.UpColor:C.Open>C.Close?this.Canvas.strokeStyle=this.DownColor:this.Canvas.strokeStyle=this.UnchagneColor,this.ColorData&&(h<this.ColorData.length&&this.ColorData[h]>0?this.UpColor:this.DownColor),this.Canvas.beginPath(),t?(this.Canvas.moveTo(m,ToFixedPoint(d)),this.Canvas.lineTo(c,ToFixedPoint(d))):(this.Canvas.moveTo(ToFixedPoint(d),m),this.Canvas.lineTo(ToFixedPoint(d),c)),this.Canvas.stroke(),e>=4&&(this.Canvas.beginPath(),t?(this.Canvas.moveTo(ToFixedPoint(f),u),this.Canvas.lineTo(ToFixedPoint(f),d)):(this.Canvas.moveTo(u,ToFixedPoint(f)),this.Canvas.lineTo(d,ToFixedPoint(f))),this.Canvas.stroke(),this.Canvas.beginPath(),t?(this.Canvas.moveTo(ToFixedPoint(v),D),this.Canvas.lineTo(ToFixedPoint(v),d)):(this.Canvas.moveTo(D,ToFixedPoint(v)),this.Canvas.lineTo(d,ToFixedPoint(v))),this.Canvas.stroke()),0==this.Data.DataType){var\x20S={Xleft:u,XRight:D,YMax:m,XCenter:d,YMin:c,DayData:C,Index:l};this.DrawInfo(S)}}}this.PtMax=s,this.PtMin=o},this.DrawCloseArea=function(){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2;t&&(i=this.ChartBorder.GetTop()+a/2+2);var\x20r=this.ChartBorder.GetRight();t&&(r=this.ChartBorder.GetBottom());var\x20n=this.ChartFrame.XPointCount,s=!0,o=null;this.Canvas.beginPath(),this.Canvas.strokeStyle=this.CloseLineColor;for(var\x20h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<n;++h,++l,i+=e+a){var\x20C=this.Data.Data[h];if(null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){var\x20u=i,D=i+e;if(D>r)break;var\x20d=u+(D-u)/2,c=this.ChartFrame.GetYFromData(C.Close);s?(t?(this.Canvas.moveTo(c,d),o={X:c,Y:d}):(this.Canvas.moveTo(d,c),o={X:d,Y:c}),s=!1):t?this.Canvas.lineTo(c,d):this.Canvas.lineTo(d,c)}}if(!s){if(this.Canvas.stroke(),t?(this.Canvas.lineTo(this.ChartBorder.GetLeft(),d),this.Canvas.lineTo(this.ChartBorder.GetLeft(),o.Y)):(this.Canvas.lineTo(d,this.ChartBorder.GetBottom()),this.Canvas.lineTo(o.X,this.ChartBorder.GetBottom())),this.Canvas.closePath(),Array.isArray(this.CloseLineAreaColor))if(t){let\x20t=this.Canvas.createLinearGradient(this.ChartBorder.GetRightEx(),this.ChartBorder.GetTop(),this.ChartBorder.GetLeft(),this.ChartBorder.GetTop());t.addColorStop(0,this.CloseLineAreaColor[0]),t.addColorStop(1,this.CloseLineAreaColor[1]),this.Canvas.fillStyle=t}else{let\x20t=this.Canvas.createLinearGradient(o.X,this.ChartBorder.GetTopEx(),o.X,this.ChartBorder.GetBottom());t.addColorStop(0,this.CloseLineAreaColor[0]),t.addColorStop(1,this.CloseLineAreaColor[1]),this.Canvas.fillStyle=t}else\x20this.Canvas.fillStyle=this.CloseLineAreaColor;this.Canvas.fill()}},this.DrawCloseLine=function(){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2;t&&(i=this.ChartBorder.GetTop()+a/2+2);var\x20r=this.ChartBorder.GetRight();t&&(r=this.ChartBorder.GetBottom());var\x20n=this.ChartFrame.XPointCount,s=!0;this.Canvas.beginPath(),this.Canvas.strokeStyle=this.CloseLineColor;for(var\x20o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<n;++o,++h,i+=e+a){var\x20l=this.Data.Data[o];if(null!=l.Open&&null!=l.High&&null!=l.Low&&null!=l.Close){var\x20C=i,u=i+e;if(u>r)break;var\x20D=C+(u-C)/2,d=this.ChartFrame.GetYFromData(l.Close);s?(t?this.Canvas.moveTo(d,D):this.Canvas.moveTo(D,d),s=!1):t?this.Canvas.lineTo(d,D):this.Canvas.lineTo(D,d)}}0==s&&this.Canvas.stroke()},this.DrawKBar=function(){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2,r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount;t&&(i=this.ChartBorder.GetTop()+a/2+2,r=this.ChartBorder.GetBottom());var\x20s={X:null,Y:null,Value:null,Align:\x22left\x22},o={X:null,Y:null,Value:null,Align:\x22left\x22},h=this.UpColor,l=this.DownColor,C=this.UnchagneColor;debug&&console.log(\x22=============\x22,this.Data.DataOffset,this.ChartFrame.ZoomIndex,this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth),window.chartdata[this.Data.Period]||(window.chartdata[this.Data.Period]={}),window.chartdata[this.Data.Period].DataOffset=this.Data.DataOffset,this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=n;for(var\x20u=this.Data.DataOffset,D=0;u<this.Data.Data.length&&D<n;++u,++D,i+=e+a,++this.ShowRange.DataCount){var\x20d=this.Data.Data[u];if(this.ShowRange.End=u,null!=d.Open&&null!=d.High&&null!=d.Low&&null!=d.Close){var\x20c=i,m=i+e;if(m>r)break;var\x20f=c+(m-c)/2,v=this.ChartFrame.GetYFromData(d.Low),S=this.ChartFrame.GetYFromData(d.High),T=this.ChartFrame.GetYFromData(d.Open),I=this.ChartFrame.GetYFromData(d.Close),F=S;if((null==s.Value||s.Value<d.High)&&(s.X=f,s.Y=S,s.Value=d.High,s.Align=D<n/2?\x22left\x22:\x22right\x22),(null==o.Value||o.Value>d.Low)&&(o.X=f,o.Y=v,o.Value=d.Low,o.Align=D<n/2?\x22left\x22:\x22right\x22),this.ColorData&&(h=l=C=u<this.ColorData.length&&this.ColorData[u]>0?this.UpColor:this.DownColor),d.Open<d.Close?e>=4?(this.Canvas.strokeStyle=h,d.High>d.Close?(this.Canvas.beginPath(),t?(this.Canvas.moveTo(ToFixedPoint(F),ToFixedPoint(f)),this.Canvas.lineTo(ToFixedPoint(3==this.DrawType?Math.max(I,T):I),ToFixedPoint(f))):(this.Canvas.moveTo(ToFixedPoint(f),ToFixedPoint(F)),this.Canvas.lineTo(ToFixedPoint(f),ToFixedPoint(3==this.DrawType?Math.min(I,T):I))),this.Canvas.stroke(),F=I):F=I,this.Canvas.fillStyle=h,t?Math.abs(T-F)<1?this.Canvas.fillRect(ToFixedRect(F),ToFixedRect(c),1,ToFixedRect(e)):3==this.DrawType?(this.Canvas.beginPath(),this.Canvas.rect(ToFixedPoint(F),ToFixedPoint(c),ToFixedRect(T-F),ToFixedRect(e)),this.Canvas.stroke()):this.Canvas.fillRect(ToFixedRect(F),ToFixedRect(c),ToFixedRect(T-F),ToFixedRect(e)):Math.abs(T-F)<1?this.Canvas.fillRect(ToFixedRect(c),ToFixedRect(F),ToFixedRect(e),1):3==this.DrawType?(this.Canvas.beginPath(),this.Canvas.rect(ToFixedPoint(c),ToFixedPoint(F),ToFixedRect(e),ToFixedRect(T-F)),this.Canvas.stroke()):this.Canvas.fillRect(ToFixedRect(c),ToFixedRect(Math.min(F,T)),ToFixedRect(e),ToFixedRect(Math.abs(T-F))),d.Open>d.Low&&(this.Canvas.beginPath(),t?(this.Canvas.moveTo(ToFixedPoint(3==this.DrawType?Math.min(I,T):F),ToFixedPoint(f)),this.Canvas.lineTo(ToFixedPoint(v),ToFixedPoint(f))):(this.Canvas.moveTo(ToFixedPoint(f),ToFixedPoint(3==this.DrawType?Math.max(I,T):F)),this.Canvas.lineTo(ToFixedPoint(f),ToFixedPoint(v))),this.Canvas.stroke())):(this.Canvas.beginPath(),t?(this.Canvas.moveTo(S,ToFixedPoint(f)),this.Canvas.lineTo(v,ToFixedPoint(f))):(this.Canvas.moveTo(ToFixedPoint(f),S),this.Canvas.lineTo(ToFixedPoint(f),v)),this.Canvas.strokeStyle=h,this.Canvas.stroke()):d.Open>d.Close?e>=4?(this.Canvas.strokeStyle=l,d.High>d.Close?(this.Canvas.beginPath(),t?(this.Canvas.moveTo(ToFixedPoint(F),ToFixedPoint(f)),this.Canvas.lineTo(ToFixedPoint(T),ToFixedPoint(f))):(this.Canvas.moveTo(ToFixedPoint(f),ToFixedPoint(F)),this.Canvas.lineTo(ToFixedPoint(f),ToFixedPoint(T))),this.Canvas.stroke(),F=T):F=T,this.Canvas.fillStyle=l,t?Math.abs(I-F)<1?this.Canvas.fillRect(ToFixedRect(F),ToFixedRect(c),1,ToFixedRect(e)):this.Canvas.fillRect(ToFixedRect(F),ToFixedRect(c),ToFixedRect(I-F),ToFixedRect(e)):Math.abs(I-F)<1?this.Canvas.fillRect(ToFixedRect(c),ToFixedRect(F),ToFixedRect(e),1):this.Canvas.fillRect(ToFixedRect(c),ToFixedRect(Math.min(F,I)),ToFixedRect(e),ToFixedRect(Math.abs(I-F))),d.Open>d.Low&&(this.Canvas.beginPath(),t?(this.Canvas.moveTo(ToFixedPoint(F),ToFixedPoint(f)),this.Canvas.lineTo(ToFixedPoint(v),ToFixedPoint(f))):(this.Canvas.moveTo(ToFixedPoint(f),ToFixedPoint(F)),this.Canvas.lineTo(ToFixedPoint(f),ToFixedPoint(v))),this.Canvas.stroke())):(this.Canvas.beginPath(),t?(this.Canvas.moveTo(S,ToFixedPoint(f)),this.Canvas.lineTo(v,ToFixedPoint(f))):(this.Canvas.moveTo(ToFixedPoint(f),S),this.Canvas.lineTo(ToFixedPoint(f),v)),this.Canvas.strokeStyle=l,this.Canvas.stroke()):e>=4?(this.Canvas.strokeStyle=C,this.Canvas.beginPath(),d.High>d.Close?(t?(this.Canvas.moveTo(F,ToFixedPoint(f)),this.Canvas.lineTo(T,ToFixedPoint(f))):(this.Canvas.moveTo(ToFixedPoint(f),F),this.Canvas.lineTo(ToFixedPoint(f),T)),F=T):F=T,t?(this.Canvas.moveTo(ToFixedPoint(F),ToFixedPoint(c)),this.Canvas.lineTo(ToFixedPoint(F),ToFixedPoint(m))):(this.Canvas.moveTo(ToFixedPoint(c),ToFixedPoint(F)),this.Canvas.lineTo(ToFixedPoint(m),ToFixedPoint(F))),d.Open>d.Low&&(t?(this.Canvas.moveTo(ToFixedPoint(F),ToFixedPoint(f)),this.Canvas.lineTo(ToFixedPoint(v),ToFixedPoint(f))):(this.Canvas.moveTo(ToFixedPoint(f),ToFixedPoint(F)),this.Canvas.lineTo(ToFixedPoint(f),ToFixedPoint(v)))),this.Canvas.stroke()):(this.Canvas.beginPath(),t?(this.Canvas.moveTo(S,ToFixedPoint(f)),this.Canvas.lineTo(v,ToFixedPoint(f))):(this.Canvas.moveTo(ToFixedPoint(f),S),this.Canvas.lineTo(ToFixedPoint(f),v)),this.Canvas.strokeStyle=C,this.Canvas.stroke()),this.IsShowKTooltip&&!t){var\x20g=Math.min(T,I),p=Math.max(T,I);Math.abs(T-I)<5&&(g=Math.min(S,g-5),p=Math.max(v,p+5));var\x20x=new\x20Rect(c,g,e,p-g);this.TooltipRect.push([u,x])}if(0==this.Data.DataType){var\x20P={Xleft:c,XRight:m,XCenter:f,YMax:S,YMin:v,DayData:d,Index:D};this.DrawInfo(P)}}}this.PtMax=s,this.PtMin=o},this.DrawTrade=function(){if(this.TradeData){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2,r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount;t&&(i=this.ChartBorder.GetTop()+a/2+2,r=this.ChartBorder.GetBottom());var\x20s=this.TradeData.Sell,o=this.TradeData.Buy,h=e;h>10&&(h=10);for(var\x20l=this.Data.DataOffset,C=0;l<this.Data.Data.length&&C<n;++l,++C,i+=e+a){var\x20u=this.Data.Data[l];if(null!=u.Open&&null!=u.High&&null!=u.Low&&null!=u.Close){var\x20D=!1,d=!1;if(s&&l<s.length&&(d=s[l]>0),o&&l<o.length&&(D=o[l]>0),d||D){var\x20c=i,m=i+e;if(m>r)break;var\x20f=c+(m-c)/2,v=this.ChartFrame.GetYFromData(u.Low),S=this.ChartFrame.GetYFromData(u.High);this.ChartFrame.GetYFromData(u.Open),this.ChartFrame.GetYFromData(u.Close);D&&(this.Canvas.fillStyle=this.UpColor,this.Canvas.strokeStyle=this.UnchagneColor,this.Canvas.beginPath(),t?(this.Canvas.moveTo(v-1,f),this.Canvas.lineTo(v-h-1,f-h/2),this.Canvas.lineTo(v-h-1,f+h/2)):(this.Canvas.moveTo(f,v+1),this.Canvas.lineTo(f-h/2,v+h+1),this.Canvas.lineTo(f+h/2,v+h+1)),this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke()),d&&(this.Canvas.fillStyle=this.DownColor,this.Canvas.strokeStyle=this.UnchagneColor,this.Canvas.beginPath(),t?(this.Canvas.moveTo(S+1,f),this.Canvas.lineTo(S+h+1,f-h/2),this.Canvas.lineTo(S+h+1,f+h/2)):(this.Canvas.moveTo(f,S-1),this.Canvas.lineTo(f-h/2,S-h-1),this.Canvas.lineTo(f+h/2,S-h-1)),this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke())}}}}},this.DrawTick=function(){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2;t&&(i=this.ChartBorder.GetTop()+a/2+2);var\x20r=this.ChartBorder.GetRight();t&&(r=this.ChartBorder.GetBottom());var\x20n=this.ChartFrame.XPointCount,s=parseInt(e);s<=1?s=2:s>=18&&(s=18);this.Canvas.beginPath(),this.Canvas.font=s*GetDevicePixelRatio()+\x22px\x20\x22+this.TickFontName;for(var\x20o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<n;++o,++h,i+=e+a){var\x20l=this.Data.Data[o];if(null!=l.Open&&null!=l.High&&null!=l.Low&&null!=l.Close){var\x20C=i,u=i+e;if(u>r)break;var\x20D=C+(u-C)/2,d=this.ChartFrame.GetYFromData(l.Close);0===l.Flag?this.Canvas.fillStyle=this.UpColor:1==l.Flag?this.Canvas.fillStyle=this.DownColor:this.Canvas.fillStyle=this.UnchagneColor,this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22middle\x22,t?this.Canvas.fillText(this.TickSymbol,d,D):this.Canvas.fillText(this.TickSymbol,D,d)}}},this.Draw=function(){this.TooltipRect=[],this.InfoTooltipRect=[],this.TradeIconTooltipRect=[],this.PtMax={X:null,Y:null,Value:null,Align:\x22left\x22},this.PtMin={X:null,Y:null,Value:null,Align:\x22left\x22},this.ChartFrame.ChartKLine={Max:null,Min:null},this.IsShow&&(ChartData.IsTickPeriod(this.Period)?this.DrawTick():1!=this.DrawType?(2==this.DrawType?this.DrawAKLine():4==this.DrawType?this.DrawCloseArea():this.DrawKBar(),this.TradeIcon?this.DrawTradeIcon():this.DrawTrade(),this.IsShowMaxMinPrice&&(!0===this.ChartFrame.IsHScreen?this.HScreenDrawMaxMinPrice(this.PtMax,this.PtMin):this.DrawMaxMinPrice(this.PtMax,this.PtMin))):this.DrawCloseLine())},this.DrawMaxMinPrice=function(t,e){if(null!=t.X&&null!=t.Y&&null!=t.Value&&null!=e.X&&null!=e.Y&&null!=e.Value){var\x20a=GetfloatPrecision(this.Symbol);this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.TextColor;var\x20i=t;1==this.ChartFrame.CoordinateType?(t.Y<e.Y&&(i=e),this.Canvas.textBaseline=\x22top\x22):(t.Y>e.Y&&(i=e),this.Canvas.textBaseline=\x22bottom\x22),this.Canvas.textAlign=i.Align;var\x20r=(i.Align,i.X),n=i.Value.toFixed(a);\x22left\x22==i.Align?n=\x22←\x22+n:n+=\x22→\x22,this.Canvas.fillText(n,r,i.Y),this.ChartFrame.ChartKLine.Max={X:r,Y:i.Y,Text:{BaseLine:\x22bottom\x22}};var\x20s=e;1==this.ChartFrame.CoordinateType?(e.Y>t.Y&&(s=t),this.Canvas.textBaseline=\x22bottom\x22):(t.Y>e.Y&&(i=e),this.Canvas.textBaseline=\x22top\x22),this.Canvas.textAlign=s.Align;r=(s.Align,s.X),n=e.Value.toFixed(a);\x22left\x22==s.Align?n=\x22←\x22+n:n+=\x22→\x22,this.Canvas.fillText(n,r,s.Y),this.ChartFrame.ChartKLine.Min={X:r,Y:s.Y,Text:{BaseLine:\x22top\x22}}}},this.HScreenDrawMaxMinPrice=function(t,e){if(null!=t.X&&null!=t.Y&&null!=t.Value&&null!=e.X&&null!=e.Y&&null!=e.Value){var\x20a=GetfloatPrecision(this.Symbol),i=t.Y,r=t.X;this.Canvas.save(),this.Canvas.translate(i,r),this.Canvas.rotate(90*Math.PI/180),this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign=t.Align,this.Canvas.textBaseline=\x22bottom\x22;var\x20n=t.Value.toFixed(a);\x22left\x22==t.Align?n=\x22←\x22+n:n+=\x22→\x22,this.Canvas.fillText(n,0,0),this.Canvas.restore();i=e.Y,r=e.X;this.Canvas.save(),this.Canvas.translate(i,r),this.Canvas.rotate(90*Math.PI/180),this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign=e.Align,this.Canvas.textBaseline=\x22top\x22;n=e.Value.toFixed(a);\x22left\x22==e.Align?n=\x22←\x22+n:n+=\x22→\x22,this.Canvas.fillText(n,0,0),this.Canvas.restore()}},this.DrawInfo=function(t){if(this.InfoData&&!(this.InfoData.length<=0)){var\x20e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetBottom(),n=this.InfoData.get(t.DayData.Date.toString());if(n&&!(n.Data.length<=0)){var\x20s=GetDevicePixelRatio(),o=a+i,h=18*s,l=!0;o<=15&&(l=!1),o<h&&(o=h);var\x20C,u=\x22\x22,D=new\x20Map,d=t.YMax+1*s,c=0;for(var\x20m\x20in\x20n.Data){var\x20f=n.Data[m],v=D.get(f.InfoType);if(v)v.Data.push(f);else{var\x20S=JSKLineInfoMap.GetIconFont(f.InfoType);if(this.Canvas.fillStyle=S.Color,this.Canvas.font=o+\x22px\x20\x22+S.Family,e){this.Canvas.textBaseline=\x22middle\x22,this.Canvas.textAlign=\x22left\x22,this.Canvas.fillText(S.HScreenText,d,t.XCenter,o);var\x20T=new\x20Rect(t.XCenter-o/2,d-o,o,o),I={Data:new\x20Array(f),Rect:T,Type:f.InfoType,TextRect:{X:d,Y:t.XCenter}};D.set(f.InfoType,I),d+=o}else\x20if(this.Canvas.textBaseline=\x22bottom\x22,this.Canvas.textAlign=\x22center\x22,1===this.InfoPosition){var\x20F=r+c;this.Canvas.fillText(S.Text,t.XCenter,F,o);T=new\x20Rect(t.XCenter-o/2,F-o,o,o),I={Data:new\x20Array(f),Rect:T,Type:f.InfoType,TextRect:{X:t.XCenter,Y:F}};D.set(f.InfoType,I),c-=o}else{this.Canvas.fillText(S.Text,t.XCenter,d,o);T=new\x20Rect(t.XCenter-o/2,d-o,o,o),I={Data:new\x20Array(f),Rect:T,Type:f.InfoType,TextRect:{X:t.XCenter,Y:d}};D.set(f.InfoType,I),d-=o}}}for(var\x20t\x20of(g_JSChartResource.KLine.NumIcon&&(C=e?g_JSChartResource.KLine.NumIcon.HScreenText:g_JSChartResource.KLine.NumIcon.Text),D)){var\x20g=t[1];if(g.Data.length>=2&&C&&l){var\x20p=g.Data.length;p>=C.length&&(p=0),this.Canvas.fillStyle=g_JSChartResource.KLine.NumIcon.Color;u=C[p];this.Canvas.fillText(u,g.TextRect.X,g.TextRect.Y,o)}e||this.InfoTooltipRect.push(g)}}}},this.DrawTradeIcon=function(){if(this.TradeData){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2,r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount;t&&(i=this.ChartBorder.GetTop()+a/2+2,r=this.ChartBorder.GetBottom());var\x20s=this.TradeData.Sell,o=this.TradeData.Buy,h=e+a,l=GetDevicePixelRatio(),C=24*l,u=12*l;h<u?h=u:h>C&&(h=C),this.Canvas.font=h+\x22px\x20\x22+this.TradeIcon.Family;for(var\x20D=this.Data.DataOffset,d=0;D<this.Data.Data.length&&d<n;++D,++d,i+=e+a){var\x20c=this.Data.Data[D];if(null!=c.Open&&null!=c.High&&null!=c.Low&&null!=c.Close){var\x20m=!1,f=!1;if(s&&D<s.length&&(f=s[D]>0),o&&D<o.length&&(m=o[D]>0),f||m){var\x20v=i,S=i+e;if(S>r)break;var\x20T=v+(S-v)/2,I=this.ChartFrame.GetYFromData(c.Low),F=this.ChartFrame.GetYFromData(c.High);this.ChartFrame.GetYFromData(c.Open),this.ChartFrame.GetYFromData(c.Close);if(m)if(this.Canvas.fillStyle=this.TradeIcon.Buy.Color,t)this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillText(this.TradeIcon.Buy.HScreenText,I,T);else{this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22top\x22,this.Canvas.fillText(this.TradeIcon.Buy.Text,T,I);var\x20g=new\x20Rect(T-h/2,I,h,h),p={Data:{Type:1,KData:c,Name:this.TradeData.Name,Param:this.TradeData.Param},Rect:g,TextRect:{X:T,Y:I}};this.TradeIconTooltipRect.push(p)}if(f)if(this.Canvas.fillStyle=this.TradeIcon.Sell.Color,t)this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillText(this.TradeIcon.Sell.HScreenText,F,T);else{this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22bottom\x22,this.Canvas.fillText(this.TradeIcon.Sell.Text,T,F);g=new\x20Rect(T-h/2,F-h,h,h),p={Data:{Type:2,KData:c,Name:this.TradeData.Name,Param:this.TradeData.Param},Rect:g,TextRect:{X:T,Y:F}};this.TradeIconTooltipRect.push(p)}}}}}},this.GetTooltipData=function(t,e,a){for(var\x20i\x20in\x20this.TradeIconTooltipRect){if((n=this.TradeIconTooltipRect[i]).Rect){var\x20r=n.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(r.X,r.Y,r.Width,r.Height),this.Canvas.isPointInPath(t,e))return\x20JSConsole.Chart.Log(\x22[ChartKLine::GetTooltipData]\x20trade\x20icon\x20\x22,n),a.Data=n,a.ChartPaint=this,a.Type=2,!0}}for(var\x20i\x20in\x20this.InfoTooltipRect){var\x20n;if((n=this.InfoTooltipRect[i]).Rect){r=n.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(r.X,r.Y,r.Width,r.Height),this.Canvas.isPointInPath(t,e))return\x20a.Data=n,a.ChartPaint=this,a.Type=1,!0}}for(var\x20i\x20in\x20this.TooltipRect){r=this.TooltipRect[i][1];if(this.Canvas.beginPath(),this.Canvas.rect(r.X,r.Y,r.Width,r.Height),this.Canvas.isPointInPath(t,e)){var\x20s=this.TooltipRect[i][0];return\x20a.Data=this.Data.Data[s],a.ChartPaint=this,a.Type=0,!0}}return!1},this.GetMaxMin=function(){var\x20t=this.ChartFrame.XPointCount,e={Max:null,Min:null};if(1==this.DrawType||4==this.DrawType)for(var\x20a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var\x20r=this.Data.Data[a];IFrameSplitOperator.IsNumber(r.Close)&&(null==e.Max&&(e.Max=r.Close),null==e.Min&&(e.Min=r.Close),e.Max<r.Close&&(e.Max=r.Close),e.Min>r.Close&&(e.Min=r.Close))}else\x20for(a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){null!=(r=this.Data.Data[a]).Open&&null!=r.High&&null!=r.Low&&null!=r.Close&&(null==e.Max&&(e.Max=r.High),null==e.Min&&(e.Min=r.Low),e.Max<r.High&&(e.Max=r.High),e.Min>r.Low&&(e.Min=r.Low))}return\x20e},this.GetAllPrice=function(){for(var\x20t=this.ChartFrame.XPointCount,e=new\x20Set,a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var\x20r=this.Data.Data[a];if(null!=r.Open&&null!=r.High&&null!=r.Low&&null!=r.Close){var\x20n=r.Close;e.add(n)}}var\x20s=[];for(var\x20o\x20of\x20e)s.push(o);return\x20s.sort(function(t,e){return\x20t-e}),s}}function\x20ChartColorKline(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartColorKline\x22,this.Symbol,this.Color=\x22rgb(0,255,44)\x22,this.DrawType=0,this.KLineColor,this.Draw=function(){this.IsShow&&this.KLineColor&&this.DrawBar()},this.DrawUpBarItem=function(t,e,a,i){var\x20r=!0===this.ChartFrame.IsHScreen,n=e,s=n+(e+a-n)/2,o=this.ChartFrame.GetYFromData(t.Low),h=this.ChartFrame.GetYFromData(t.High),l=this.ChartFrame.GetYFromData(t.Open),C=this.ChartFrame.GetYFromData(t.Close),u=h;a>=4?(t.High>t.Close?(this.Canvas.beginPath(),r?(this.Canvas.moveTo(ToFixedPoint(u),ToFixedPoint(s)),this.Canvas.lineTo(ToFixedPoint(3==this.DrawType?Math.max(C,l):C),ToFixedPoint(s))):(this.Canvas.moveTo(ToFixedPoint(s),ToFixedPoint(u)),this.Canvas.lineTo(ToFixedPoint(s),ToFixedPoint(3==this.DrawType?Math.min(C,l):C))),this.Canvas.stroke(),u=C):u=C,r?Math.abs(l-u)<1?this.Canvas.fillRect(ToFixedRect(u),ToFixedRect(n),1,ToFixedRect(a)):3==this.DrawType?(this.Canvas.beginPath(),this.Canvas.rect(ToFixedPoint(u),ToFixedPoint(n),ToFixedRect(l-u),ToFixedRect(a)),this.Canvas.stroke()):this.Canvas.fillRect(ToFixedRect(u),ToFixedRect(n),ToFixedRect(l-u),ToFixedRect(a)):Math.abs(l-u)<1?this.Canvas.fillRect(ToFixedRect(n),ToFixedRect(u),ToFixedRect(a),1):3==this.DrawType?(this.Canvas.beginPath(),this.Canvas.rect(ToFixedPoint(n),ToFixedPoint(u),ToFixedRect(a),ToFixedRect(l-u)),this.Canvas.stroke()):this.Canvas.fillRect(ToFixedRect(n),ToFixedRect(Math.min(u,l)),ToFixedRect(a),ToFixedRect(Math.abs(l-u))),t.Open>t.Low&&(this.Canvas.beginPath(),r?(this.Canvas.moveTo(ToFixedPoint(3==this.DrawType?Math.min(C,l):u),ToFixedPoint(s)),this.Canvas.lineTo(ToFixedPoint(o),ToFixedPoint(s))):(this.Canvas.moveTo(ToFixedPoint(s),ToFixedPoint(3==this.DrawType?Math.max(C,l):u)),this.Canvas.lineTo(ToFixedPoint(s),ToFixedPoint(o))),this.Canvas.stroke())):(this.Canvas.beginPath(),r?(this.Canvas.moveTo(h,ToFixedPoint(s)),this.Canvas.lineTo(o,ToFixedPoint(s))):(this.Canvas.moveTo(ToFixedPoint(s),h),this.Canvas.lineTo(ToFixedPoint(s),o)),this.Canvas.stroke())},this.DrawDownBarItem=function(t,e,a,i){var\x20r=!0===this.ChartFrame.IsHScreen,n=e,s=n+(e+a-n)/2,o=this.ChartFrame.GetYFromData(t.Low),h=this.ChartFrame.GetYFromData(t.High),l=this.ChartFrame.GetYFromData(t.Open),C=this.ChartFrame.GetYFromData(t.Close),u=h;a>=4?(t.High>t.Close?(this.Canvas.beginPath(),r?(this.Canvas.moveTo(ToFixedPoint(u),ToFixedPoint(s)),this.Canvas.lineTo(ToFixedPoint(l),ToFixedPoint(s))):(this.Canvas.moveTo(ToFixedPoint(s),ToFixedPoint(u)),this.Canvas.lineTo(ToFixedPoint(s),ToFixedPoint(l))),this.Canvas.stroke(),u=l):u=l,r?Math.abs(C-u)<1?this.Canvas.fillRect(ToFixedRect(u),ToFixedRect(n),1,ToFixedRect(a)):this.Canvas.fillRect(ToFixedRect(u),ToFixedRect(n),ToFixedRect(C-u),ToFixedRect(a)):Math.abs(C-u)<1?this.Canvas.fillRect(ToFixedRect(n),ToFixedRect(u),ToFixedRect(a),1):this.Canvas.fillRect(ToFixedRect(n),ToFixedRect(Math.min(u,C)),ToFixedRect(a),ToFixedRect(Math.abs(C-u))),t.Open>t.Low&&(this.Canvas.beginPath(),r?(this.Canvas.moveTo(ToFixedPoint(u),ToFixedPoint(s)),this.Canvas.lineTo(ToFixedPoint(o),ToFixedPoint(s))):(this.Canvas.moveTo(ToFixedPoint(s),ToFixedPoint(u)),this.Canvas.lineTo(ToFixedPoint(s),ToFixedPoint(o))),this.Canvas.stroke())):(this.Canvas.beginPath(),r?(this.Canvas.moveTo(h,ToFixedPoint(s)),this.Canvas.lineTo(o,ToFixedPoint(s))):(this.Canvas.moveTo(ToFixedPoint(s),h),this.Canvas.lineTo(ToFixedPoint(s),o)),this.Canvas.stroke())},this.DrawUnChangeBarItem=function(t,e,a,i){var\x20r=!0===this.ChartFrame.IsHScreen,n=e,s=e+a,o=n+(s-n)/2,h=this.ChartFrame.GetYFromData(t.Low),l=this.ChartFrame.GetYFromData(t.High),C=this.ChartFrame.GetYFromData(t.Open),u=(this.ChartFrame.GetYFromData(t.Close),l);a>=4?(this.Canvas.beginPath(),t.High>t.Close?(r?(this.Canvas.moveTo(u,ToFixedPoint(o)),this.Canvas.lineTo(C,ToFixedPoint(o))):(this.Canvas.moveTo(ToFixedPoint(o),u),this.Canvas.lineTo(ToFixedPoint(o),C)),u=C):u=C,r?(this.Canvas.moveTo(ToFixedPoint(u),ToFixedPoint(n)),this.Canvas.lineTo(ToFixedPoint(u),ToFixedPoint(s))):(this.Canvas.moveTo(ToFixedPoint(n),ToFixedPoint(u)),this.Canvas.lineTo(ToFixedPoint(s),ToFixedPoint(u))),t.Open>t.Low&&(r?(this.Canvas.moveTo(ToFixedPoint(u),ToFixedPoint(o)),this.Canvas.lineTo(ToFixedPoint(h),ToFixedPoint(o))):(this.Canvas.moveTo(ToFixedPoint(o),ToFixedPoint(u)),this.Canvas.lineTo(ToFixedPoint(o),ToFixedPoint(h)))),this.Canvas.stroke()):(this.Canvas.beginPath(),r?(this.Canvas.moveTo(l,ToFixedPoint(o)),this.Canvas.lineTo(h,ToFixedPoint(o))):(this.Canvas.moveTo(ToFixedPoint(o),l),this.Canvas.lineTo(ToFixedPoint(o),h)),this.Canvas.stroke())},this.DrawBar=function(){var\x20t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetLeft()+e/2+2,i=this.ChartBorder.GetRight(),r=this.ChartFrame.XPointCount;this.IsHScreen&&(a=this.ChartBorder.GetTop()+e/2+2,i=this.ChartBorder.GetBottom());for(var\x20n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<r;++n,++s,a+=t+e){var\x20o=this.Data.Data[n];if(null!=o.Open&&null!=o.High&&null!=o.Low&&null!=o.Close&&this.KLineColor.has(n)){var\x20h=this.KLineColor.get(n);if(a+t>i)break;h.Color?(this.Canvas.strokeStyle=h.Color,this.Canvas.fillStyle=h.Color):(this.Canvas.strokeStyle=this.Color,this.Canvas.fillStyle=this.Color),o.Open<o.Close?this.DrawUpBarItem(o,a,t,h):o.Open>o.Close?this.DrawDownBarItem(o,a,t,h):this.DrawUnChangeBarItem(o,a,t,h)}}},this.GetMaxMin=function(){return{Max:null,Min:null}}}var\x20OVERLAY_STATUS_ID={STATUS_NONE_ID:0,STATUS_REQUESTDATA_ID:1,STATUS_RECVDATA_ID:2,STATUS_FINISHED_ID:3};function\x20ChartOverlayKLine(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartOverlayKLine\x22,this.Color=\x22rgb(65,105,225)\x22,this.MainData,this.SourceData,this.Title,this.DrawType=0,this.CustomDrawType=null,this.Status=OVERLAY_STATUS_ID.STATUS_NONE_ID,this.IsDelete=!1,this.SetOption=function(t){t&&IFrameSplitOperator.IsNumber(t.DrawType)&&(this.CustomDrawType=t.DrawType)},this.DrawKBar=function(t){var\x20e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var\x20n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var\x20s=this.ChartFrame.XPointCount,o=this.DrawType;null!=this.CustomDrawType&&(o=this.CustomDrawType);for(var\x20h=!0,l=null,C=this.Data.DataOffset,u=0;C<this.Data.Data.length&&u<s;++C,++u,r+=a+i){var\x20D=this.Data.Data[C];if(D&&null!=D.Open&&null!=D.High&&null!=D.Low&&null!=D.Close){null==l&&(l=D.Open),h&&(this.Canvas.strokeStyle=this.Color,this.Canvas.fillStyle=this.Color,this.Canvas.beginPath(),h=!1);var\x20d=r,c=r+a;if(c>n)break;var\x20m=d+(c-d)/2,f=this.ChartFrame.GetYFromData(D.Low/l*t),v=this.ChartFrame.GetYFromData(D.High/l*t),S=this.ChartFrame.GetYFromData(D.Open/l*t),T=this.ChartFrame.GetYFromData(D.Close/l*t),I=v;D.Open<D.Close?a>=4?(D.High>D.Close?(e?(this.Canvas.moveTo(ToFixedPoint(I),ToFixedPoint(m)),this.Canvas.lineTo(ToFixedPoint(3==this.DrawType?Math.max(T,S):T),ToFixedPoint(m))):(this.Canvas.moveTo(ToFixedPoint(m),ToFixedPoint(I)),this.Canvas.lineTo(ToFixedPoint(m),ToFixedPoint(3==this.DrawType?Math.min(T,S):T))),I=T):I=T,e?Math.abs(S-I)<1?this.Canvas.fillRect(ToFixedRect(I),ToFixedRect(d),1,ToFixedRect(a)):3==o?this.Canvas.rect(ToFixedPoint(I),ToFixedPoint(d),ToFixedRect(S-I),ToFixedRect(a)):this.Canvas.fillRect(ToFixedRect(I),ToFixedRect(d),ToFixedRect(S-I),ToFixedRect(a)):Math.abs(S-I)<1?this.Canvas.fillRect(ToFixedRect(d),ToFixedRect(I),ToFixedRect(a),1):3==o?this.Canvas.rect(ToFixedPoint(d),ToFixedPoint(I),ToFixedRect(a),ToFixedRect(S-I)):this.Canvas.fillRect(ToFixedRect(d),ToFixedRect(I),ToFixedRect(a),ToFixedRect(S-I)),D.Open>D.Low&&(e?(this.Canvas.moveTo(ToFixedPoint(3==this.DrawType?Math.min(T,S):I),ToFixedPoint(m)),this.Canvas.lineTo(ToFixedPoint(f),ToFixedPoint(m))):(this.Canvas.moveTo(ToFixedPoint(m),ToFixedPoint(3==this.DrawType?Math.max(T,S):I)),this.Canvas.lineTo(ToFixedPoint(m),ToFixedPoint(f))))):e?(this.Canvas.moveTo(v,ToFixedPoint(m)),this.Canvas.lineTo(f,ToFixedPoint(m))):(this.Canvas.moveTo(ToFixedPoint(m),v),this.Canvas.lineTo(ToFixedPoint(m),f)):D.Open>D.Close?a>=4?(D.High>D.Close?(e?(this.Canvas.moveTo(ToFixedPoint(I),ToFixedPoint(m)),this.Canvas.lineTo(ToFixedPoint(S),ToFixedPoint(m))):(this.Canvas.moveTo(ToFixedPoint(m),ToFixedPoint(I)),this.Canvas.lineTo(ToFixedPoint(m),ToFixedPoint(S))),I=S):I=S,e?Math.abs(T-I)<1?this.Canvas.fillRect(ToFixedRect(I),ToFixedRect(d),1,ToFixedRect(a)):this.Canvas.fillRect(ToFixedRect(I),ToFixedRect(d),ToFixedRect(T-I),ToFixedRect(a)):Math.abs(T-I)<1?this.Canvas.fillRect(ToFixedRect(d),ToFixedRect(I),ToFixedRect(a),1):this.Canvas.fillRect(ToFixedRect(d),ToFixedRect(I),ToFixedRect(a),ToFixedRect(T-I)),D.Open>D.Low&&(e?(this.Canvas.moveTo(ToFixedPoint(I),ToFixedPoint(m)),this.Canvas.lineTo(ToFixedPoint(f),ToFixedPoint(m))):(this.Canvas.moveTo(ToFixedPoint(m),ToFixedPoint(I)),this.Canvas.lineTo(ToFixedPoint(m),ToFixedPoint(f))))):e?(this.Canvas.moveTo(v,ToFixedPoint(m)),this.Canvas.lineTo(f,ToFixedPoint(m))):(this.Canvas.moveTo(ToFixedPoint(m),v),this.Canvas.lineTo(ToFixedPoint(m),f)):a>=4?(D.High>D.Close?(e?(this.Canvas.moveTo(I,ToFixedPoint(m)),this.Canvas.lineTo(S,ToFixedPoint(m))):(this.Canvas.moveTo(ToFixedPoint(m),I),this.Canvas.lineTo(ToFixedPoint(m),S)),I=S):I=S,e?(this.Canvas.moveTo(ToFixedPoint(I),ToFixedPoint(d)),this.Canvas.lineTo(ToFixedPoint(I),ToFixedPoint(c))):(this.Canvas.moveTo(ToFixedPoint(d),ToFixedPoint(I)),this.Canvas.lineTo(ToFixedPoint(c),ToFixedPoint(I))),D.Open>D.Low&&(e?(this.Canvas.moveTo(ToFixedPoint(I),ToFixedPoint(m)),this.Canvas.lineTo(ToFixedPoint(f),ToFixedPoint(m))):(this.Canvas.moveTo(ToFixedPoint(m),ToFixedPoint(I)),this.Canvas.lineTo(ToFixedPoint(m),ToFixedPoint(f))))):e?(this.Canvas.moveTo(v,ToFixedPoint(m)),this.Canvas.lineTo(f,ToFixedPoint(m))):(this.Canvas.moveTo(ToFixedPoint(m),v),this.Canvas.lineTo(ToFixedPoint(m),f));var\x20F=Math.min(f,v,S,T),g=new\x20Rect(d,F,a,Math.max(f,v,S,T)-F);this.TooltipRect.push([C,g])}}0==h&&this.Canvas.stroke()},this.DrawAKLine=function(t){var\x20e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var\x20n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var\x20s=this.ChartFrame.XPointCount,o=null;this.Canvas.strokeStyle=this.Color;for(var\x20h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<s;++h,++l,r+=a+i){var\x20C=this.Data.Data[h];if(null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){null==o&&(o=C.Open);var\x20u=r,D=r+a;if(D>n)break;var\x20d=u+(D-u)/2,c=this.ChartFrame.GetYFromData(C.Low/o*t),m=this.ChartFrame.GetYFromData(C.High/o*t),f=this.ChartFrame.GetYFromData(C.Open/o*t),v=this.ChartFrame.GetYFromData(C.Close/o*t);this.Canvas.beginPath(),e?(this.Canvas.moveTo(m,ToFixedPoint(d)),this.Canvas.lineTo(c,ToFixedPoint(d))):(this.Canvas.moveTo(ToFixedPoint(d),m),this.Canvas.lineTo(ToFixedPoint(d),c)),this.Canvas.stroke(),a>=4&&(this.Canvas.beginPath(),e?(this.Canvas.moveTo(ToFixedPoint(f),u),this.Canvas.lineTo(ToFixedPoint(f),d)):(this.Canvas.moveTo(u,ToFixedPoint(f)),this.Canvas.lineTo(d,ToFixedPoint(f))),this.Canvas.stroke(),this.Canvas.beginPath(),e?(this.Canvas.moveTo(ToFixedPoint(v),D),this.Canvas.lineTo(ToFixedPoint(v),d)):(this.Canvas.moveTo(D,ToFixedPoint(v)),this.Canvas.lineTo(d,ToFixedPoint(v))),this.Canvas.stroke())}}},this.DrawCloseLine=function(t){var\x20e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var\x20n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var\x20s=this.ChartFrame.XPointCount,o=null,h=!0;this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath();for(var\x20l=this.Data.DataOffset,C=0;l<this.Data.Data.length&&C<s;++l,++C,r+=a+i){var\x20u=this.Data.Data[l];if(null!=u.Open&&null!=u.High&&null!=u.Low&&null!=u.Close){null==o&&(o=u.Open);var\x20D=r,d=r+a;if(d>n)break;var\x20c=D+(d-D)/2,m=this.ChartFrame.GetYFromData(u.Close/o*t);h?(e?this.Canvas.moveTo(m,c):this.Canvas.moveTo(c,m),h=!1):e?this.Canvas.lineTo(m,c):this.Canvas.lineTo(c,m)}}0==h&&this.Canvas.stroke()},this.Draw=function(){if(this.TooltipRect=[],this.InfoTooltipRect=[],this.MainData&&this.Data){for(var\x20t=this.ChartFrame.XPointCount,e=null,a=this.Data.DataOffset,i=0;a<this.MainData.Data.length&&i<t;++a,++i){var\x20r=this.MainData.Data[a];if(null!=r.Open&&null!=r.High&&null!=r.Low&&null!=r.Close){e=r.Open;break}}if(null!=e){var\x20n=this.DrawType;null!=this.CustomDrawType&&(n=this.CustomDrawType),1==n?this.DrawCloseLine(e):2==n?this.DrawAKLine(e):this.DrawKBar(e)}}},this.GetMaxMin=function(){var\x20t=this.ChartFrame.XPointCount,e={Max:null,Min:null};if(!this.MainData||!this.Data)return\x20e;for(var\x20a=null,i=this.Data.DataOffset,r=0;i<this.MainData.Data.length&&r<t;++i,++r){if(null!=(h=this.MainData.Data[i]).Open&&null!=h.High&&null!=h.Low&&null!=h.Close){a=h.Close;break}}if(null==a)return\x20e;var\x20n,s,o=null;for(i=this.Data.DataOffset,r=0;i<this.Data.Data.length&&r<t;++i,++r){var\x20h;(h=this.Data.Data[i])&&null!=h.Open&&null!=h.High&&null!=h.Low&&null!=h.Close&&(null==o&&(o=h.Open),n=h.High/o*a,s=h.Low/o*a,null==e.Max&&(e.Max=n),null==e.Min&&(e.Min=s),e.Max<n&&(e.Max=n),e.Min>s&&(e.Min=s))}return\x20e},this.GetTooltipData=function(t,e,a){for(var\x20i\x20in\x20this.TooltipRect){var\x20r=this.TooltipRect[i][1];if(this.Canvas.beginPath(),this.Canvas.rect(r.X,r.Y,r.Width,r.Height),this.Canvas.isPointInPath(t,e)){var\x20n=this.TooltipRect[i][0];return\x20a.Data=this.Data.Data[n],a.ChartPaint=this,!0}}return!1}}function\x20ChartMinuteVolumBar(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartMinuteVolumBar\x22,this.UpColor=g_JSChartResource.UpBarColor,this.DownColor=g_JSChartResource.DownBarColor,this.YClose,this.Draw=function(){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartBorder.GetRight();t&&(e=this.ChartBorder.GetBottom());var\x20a=this.ChartFrame.XPointCount,i=this.ChartFrame.GetYFromData(0),r=this.YClose,n=this.Data;this.Canvas.canvas.JSChartContainer.Frame.Data&&(n.DataOffset=this.Canvas.canvas.JSChartContainer.Frame.Data.DataOffset,debug&&console.log(\x22ChartMinuteVolumeBar\x22,n.DataOffset,this));for(var\x20s=n.DataOffset,o=0;s<n.Data.length&&o<a;++s,++o){var\x20h=n.Data[s],l=null;if(h){var\x20C=null;if(h.Before?(l=h.Before.Vol,C=h.Before.Close):(l=h.Vol,C=h.Close),l){var\x20u=this.ChartFrame.GetYFromData(l),D=this.ChartFrame.GetXFromIndex(o);if(D>e)break;this.Canvas.strokeStyle=C>=r?this.UpColor:this.DownColor,this.Canvas.beginPath(),t?(this.Canvas.moveTo(u,ToFixedPoint(D)),this.Canvas.lineTo(i,ToFixedPoint(D))):(this.Canvas.moveTo(ToFixedPoint(D),u),this.Canvas.lineTo(ToFixedPoint(D),i)),this.Canvas.stroke(),C&&(r=C)}}}},this.GetMaxMin=function(){var\x20t=this.ChartFrame.XPointCount,e={Min:0,Max:null};window.chartdata[\x2200\x22]&&(this.Data.DataOffset=window.chartdata[\x2200\x22].DataOffset),debug&&console.log(\x22GetMaxMin\x22,this.Data.DataOffset,this);for(var\x20a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var\x20r=this.Data.Data[a];r&&r.Vol&&(null==e.Max&&(e.Max=r.Vol),e.Max<r.Vol&&(e.Max=r.Vol))}return\x20e}}function\x20ChartErrorMessage(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartErrorMessage\x22,this.Draw=function(){this.IsShow&&this.NotSupportMessage&&this.DrawNotSupportmessage()}}function\x20ChartLine(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartLine\x22,this.Color=\x22rgb(255,193,37)\x22,this.LineWidth,this.DrawType=0,this.IsDotLine=!1,this.Draw=function(){if(this.IsShow)if(this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(this.Data&&this.Data.Data)switch(this.DrawType){case\x200:return\x20this.DrawLine();case\x201:return\x20this.DrawStraightLine()}},this.DrawLine=function(){var\x20t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());t&&(e=this.ChartBorder.GetBottom());var\x20a=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*GetDevicePixelRatio()),this.IsDotLine&&this.Canvas.setLineDash(g_JSChartResource.DOTLINE.LineDash);for(var\x20i=!0,r=0,n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var\x20o=this.Data.Data[n];if(null!=o){var\x20h=this.ChartFrame.GetXFromIndex(s),l=this.GetYFromData(o);if(h>e)break;i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),i=!1):t?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),++r}}r>0&&this.Canvas.stroke(),this.Canvas.restore()},this.DrawStraightLine=function(){var\x20t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());t&&(e=this.ChartBorder.GetBottom());var\x20a=this.ChartFrame.XPointCount,i=this.GetLockRect();i&&(e=t?i.Top:i.Left),this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*GetDevicePixelRatio()),this.Canvas.strokeStyle=this.Color,this.IsDotLine&&this.Canvas.setLineDash(g_JSChartResource.DOTLINE.LineDash);for(var\x20r=!0,n=0,s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<a;++s,++o){var\x20h=this.Data.Data[s];if(null!=h){var\x20l=this.ChartFrame.GetXFromIndex(o),C=this.GetYFromData(h);if(l>e)break;r?(this.Canvas.beginPath(),t?this.Canvas.moveTo(C,l):this.Canvas.moveTo(l,C),r=!1):t?this.Canvas.lineTo(C,l):this.Canvas.lineTo(l,C),++n}else\x20n>0&&this.Canvas.stroke(),r=!0,n=0}n>0&&this.Canvas.stroke(),this.Canvas.restore()},this.GetYFromData=function(t){return\x20this.ChartFrame.GetYFromData(t)}}function\x20ChartSubLine(){this.newMethod=ChartLine,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartSubLine\x22,this.Color=\x22rgb(255,193,37)\x22,this.LineWidth,this.DrawType=0,this.IsDotLine=!1,this.SubFrame={Max:null,Min:null},this.Draw=function(){if(this.IsShow&&this.Data&&this.Data.Data)switch(this.CalculateDataMaxMin(),this.DrawType){case\x200:return\x20this.DrawLine();case\x201:return\x20this.DrawStraightLine()}},this.GetYFromData=function(t){if(!0===this.ChartFrame.IsHScreen){if(t<=this.SubFrame.Min)return\x20this.ChartBorder.GetLeftEx();if(t>=this.SubFrame.Max)return\x20this.ChartBorder.GetRightEx();var\x20e=this.ChartBorder.GetWidthEx()*(t-this.SubFrame.Min)/(this.SubFrame.Max-this.SubFrame.Min);return\x20this.ChartBorder.GetLeftEx()+e}if(t<=this.SubFrame.Min)return\x20this.ChartBorder.GetBottomEx();if(t>=this.SubFrame.Max)return\x20this.ChartBorder.GetTopEx();var\x20a=this.ChartBorder.GetHeightEx()*(t-this.SubFrame.Min)/(this.SubFrame.Max-this.SubFrame.Min);return\x20this.ChartBorder.GetBottomEx()-a},this.CalculateDataMaxMin=function(){this.SubFrame={Max:null,Min:null};var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartBorder.GetRight();t&&(e=this.ChartBorder.GetBottom());for(var\x20a=this.ChartFrame.XPointCount,i=this.Data.DataOffset,r=0;i<this.Data.Data.length&&r<a;++i,++r){var\x20n=this.Data.Data[i];if(null!=n){if(this.ChartFrame.GetXFromIndex(r)>e)break;(null==this.SubFrame.Min||this.SubFrame.Min>n)&&(this.SubFrame.Min=n),(null==this.SubFrame.Max||this.SubFrame.Max<n)&&(this.SubFrame.Max=n)}}},this.GetMaxMin=function(){return{Min:null,Max:null}}}function\x20ChartOverlayLine(){this.newMethod=ChartLine,this.newMethod(),delete\x20this.newMethod,this.MainData=new\x20ChartData,this.Draw=function(){if(this.Data&&this.Data.Data&&this.MainData&&this.MainData.Data)switch(this.DrawType){case\x200:return\x20this.DrawLine();case\x201:return\x20this.DrawStraightLine()}},this.GetFirstVaildIndex=function(){for(var\x20t=this.Data.DataOffset,e=0;t<this.MainData.Data.length&&t<this.Data.Data.length;++t,++e){var\x20a=this.MainData.Data[t],i=this.Data.Data[t];if(IFrameSplitOperator.IsNumber(a)&&IFrameSplitOperator.IsNumber(i))return{Index:e,DataOffset:t,OverlayValue:i,MainValue:a}}return\x20null},this.DrawStraightLine=function(){var\x20t=this.GetFirstVaildIndex();if(t){var\x20e=!0===this.ChartFrame.IsHScreen,a=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());e&&(a=this.ChartBorder.GetBottom());var\x20i=this.ChartFrame.XPointCount,r=this.GetLockRect();r&&(a=e?r.Top:r.Left),this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*GetDevicePixelRatio()),this.Canvas.strokeStyle=this.Color,this.IsDotLine&&this.Canvas.setLineDash([3,5]);for(var\x20n=!0,s=0,o=0,h=t.DataOffset,l=t.Index;h<this.Data.Data.length&&l<i;++h,++l){var\x20C=this.Data.Data[h];if(null!=C){var\x20u=this.ChartFrame.GetXFromIndex(l),D=C-t.OverlayValue;o=0!=t.OverlayValue?1+D/Math.abs(t.OverlayValue):1+D;var\x20d=t.MainValue*o,c=this.GetYFromData(d);if(u>a)break;n?(this.Canvas.beginPath(),e?this.Canvas.moveTo(c,u):this.Canvas.moveTo(u,c),n=!1):e?this.Canvas.lineTo(c,u):this.Canvas.lineTo(u,c),++s}else\x20s>0&&this.Canvas.stroke(),n=!0,s=0}s>0&&this.Canvas.stroke(),this.Canvas.restore()}},this.GetMaxMin=function(){var\x20t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.GetFirstVaildIndex();if(!a)return\x20e;for(var\x20i=a.DataOffset,r=a.Index;i<this.Data.Data.length&&r<t;++i,++r){var\x20n=this.Data.Data[i];if(IFrameSplitOperator.IsNumber(n)){var\x20s=n-a.OverlayValue;0!=a.OverlayValue?rate=1+s/Math.abs(a.OverlayValue):rate=1+s;var\x20o=a.MainValue*rate;null==e.Max&&(e.Max=o),null==e.Min&&(e.Min=o),e.Max<o&&(e.Max=o),e.Min>o&&(e.Min=o)}}return\x20e}}function\x20ChartPartLine(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartPartLine\x22,this.LineWidth,this.Draw=function(){this.IsShow&&(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&this.DrawLine())},this.DrawLine=function(){var\x20t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());t&&(e=this.ChartBorder.GetBottom());var\x20a=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*GetDevicePixelRatio());for(var\x20i,r=0,n={X:null,Y:null},s=!1,o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<a;++o,++h){var\x20l=this.Data.Data[o];if(null!=l&&null!=l.Value){var\x20C=l.Value,u=l.RGB,D=this.ChartFrame.GetXFromIndex(h),d=this.ChartFrame.GetYFromData(C);if(D>e)break;u!=i||1==s?(i&&r>0&&this.Canvas.stroke(),r=0,i=u,this.Canvas.strokeStyle=u,this.Canvas.beginPath(),null!=n.X&&null!=n.Y?(t?this.Canvas.moveTo(n.Y,n.X):this.Canvas.moveTo(n.X,n.Y),t?this.Canvas.lineTo(d,D):this.Canvas.lineTo(D,d),++r):t?this.Canvas.moveTo(d,D):this.Canvas.moveTo(D,d)):(t?this.Canvas.lineTo(d,D):this.Canvas.lineTo(D,d),++r),n.X=D,n.Y=d,s=!1}else\x20n.X=null,n.Y=null,s=!0}r>0&&this.Canvas.stroke(),this.Canvas.restore()},this.GetMaxMin=function(){for(var\x20t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var\x20r=this.Data.Data[a];r&&r.Value&&((null==e.Max||e.Max<r.Value)&&(e.Max=r.Value),(null==e.Min||e.Min>r.Value)&&(e.Min=r.Value))}return\x20e}}function\x20ChartSlopeLine(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartSlopeLine\x22,this.Color=\x22rgb(255,193,37)\x22,this.IsDotLine=!1,this.LineWidth,this.Option,this.Draw=function(){if(this.IsShow)if(this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(this.Data&&this.Data.Data){this.Canvas.save(),this.Canvas.strokeStyle=this.Color,this.IsDotLine&&this.Canvas.setLineDash(g_JSChartResource.DOTLINE.LineDash);var\x20t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetTopEx(),a=this.ChartBorder.GetRight(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount;this.Canvas.beginPath(),this.Canvas.rect(t,e,a-t,i-e),this.Canvas.clip();for(var\x20s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<n;++s,++o){var\x20h=this.Data.Data[s];if(IFrameSplitOperator.IsNumber(h)){var\x20l=this.Option[s];if(l){var\x20C=this.ChartFrame.GetXFromIndex(o),u=this.ChartFrame.GetYFromData(h),D=l.Length*g_JSChartResource.DRAWSL.PixelWidth;if(C>r)break;var\x20d=Math.sqrt(D*D/(1+l.Slope*l.Slope)),c=d*l.Slope;this.Canvas.beginPath(),2==l.Direct?(this.Canvas.moveTo(C-d,u+c),this.Canvas.lineTo(C+d,u-c)):1==l.Direct?(this.Canvas.moveTo(C,u),this.Canvas.lineTo(C-d,u+c)):(this.Canvas.moveTo(C,u),this.Canvas.lineTo(C+d,u-c)),this.Canvas.stroke()}}}this.Canvas.restore()}}}function\x20ChartPointDot(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartPointDot\x22,this.Color=\x22rgb(255,193,37)\x22,this.Radius=1,this.Draw=function(){if(this.IsShow)if(this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(this.Data&&this.Data.Data){var\x20t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());!0===t&&(e=this.ChartBorder.GetBottom());var\x20a=this.ChartFrame.XPointCount;this.Canvas.save(),this.Canvas.fillStyle=this.Color;for(var\x20i=this.Data.DataOffset,r=0;i<this.Data.Data.length&&r<a;++i,++r){var\x20n=this.Data.Data[i];if(null!=n){var\x20s=this.ChartFrame.GetXFromIndex(r),o=this.ChartFrame.GetYFromData(n);if(s>e)break;this.Canvas.beginPath(),t?this.Canvas.arc(o,s,this.Radius,0,2*Math.PI,!0):this.Canvas.arc(s,o,this.Radius,0,2*Math.PI,!0),this.Canvas.closePath(),this.Canvas.fill()}}this.Canvas.restore()}}}function\x20ChartStick(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.Color=\x22rgb(255,193,37)\x22,this.LineWidth,this.ClassName=\x22ChartStick\x22,this.DrawLine=function(){if(this.Data&&this.Data.Data){var\x20t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());!0===t&&(e=this.ChartBorder.GetBottom());var\x20a=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*GetDevicePixelRatio());for(var\x20i=!0,r=0,n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var\x20o=this.Data.Data[n];if(null!=o){var\x20h=this.ChartFrame.GetXFromIndex(s),l=this.ChartFrame.GetYFromData(o);if(h>e)break;i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),i=!1):t?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),++r}}r>0&&this.Canvas.stroke(),this.Canvas.restore()}},this.DrawStick=function(){if(this.Data&&this.Data.Data){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartBorder.GetRight();t&&(e=this.ChartBorder.GetBottom());var\x20a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetLeft();this.Canvas.save(),this.Canvas.strokeStyle=this.Color,this.LineWidth&&(this.Canvas.lineWidth=this.LineWidth*GetDevicePixelRatio());for(var\x20n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var\x20o=this.Data.Data[n];if(null!=o){var\x20h=this.ChartFrame.GetXFromIndex(s),l=this.ChartFrame.GetYFromData(o);if(h>e)break;if(this.Canvas.beginPath(),t)this.Canvas.moveTo(r,h),this.Canvas.lineTo(l,h),this.Canvas.stroke();else{var\x20C=parseInt(h.toString())+.5;this.Canvas.moveTo(C,l),this.Canvas.lineTo(C,i)}this.Canvas.stroke()}}this.Canvas.restore()}},this.Draw=function(){this.IsShow&&(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&this.DrawStick())}}function\x20ChartLineStick(){this.newMethod=ChartStick,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartLineStick\x22,this.Draw=function(){this.IsShow&&(this.NotSupportMessage?this.DrawNotSupportmessage():(this.DrawStick(),this.DrawLine()))}}function\x20ChartVolStick(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.UpColor=g_JSChartResource.UpBarColor,this.DownColor=g_JSChartResource.DownBarColor,this.HistoryData,this.KLineDrawType=0,this.ClassName=\x22ChartVolStick\x22,this.Draw=function(){if(!0!==this.ChartFrame.IsHScreen){var\x20t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetLeft()+e/2+2,i=this.ChartBorder.GetRight(),r=this.ChartFrame.XPointCount,n=this.GetLockRect();n&&(i=n.Left);var\x20s=this.ChartFrame.GetYFromData(0);if(t>=4){s=ToFixedRect(s);for(var\x20o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<r;++o,++h,a+=t+e){var\x20l=this.Data.Data[o],C=this.HistoryData.Data[o];if(null!=l&&null!=C){var\x20u=a;if(a+t>i)break;var\x20D=this.ChartFrame.GetYFromData(l),d=!1;C.Close>=C.Open?(this.Canvas.fillStyle=this.UpColor,d=!0):this.Canvas.fillStyle=this.DownColor;var\x20c=ToFixedRect(s-D);D=s-c,!d||1!=this.KLineDrawType&&2!=this.KLineDrawType&&3!=this.KLineDrawType?this.Canvas.fillRect(ToFixedRect(u),D,ToFixedRect(t),c):(this.Canvas.strokeStyle=this.UpColor,this.Canvas.beginPath(),this.Canvas.rect(ToFixedPoint(u),ToFixedPoint(D),ToFixedRect(t),c),this.Canvas.stroke())}}}else\x20for(o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<r;++o,++h,a+=t+e){l=this.Data.Data[o],C=this.HistoryData.Data[o];if(null!=l&&null!=C){D=this.ChartFrame.GetYFromData(l);if((m=this.ChartFrame.GetXFromIndex(h))>i)break;C.Close>=C.Open?this.Canvas.strokeStyle=this.UpColor:this.Canvas.strokeStyle=this.DownColor;var\x20m=this.ChartFrame.GetXFromIndex(h);this.Canvas.beginPath(),this.Canvas.moveTo(ToFixedPoint(m),D),this.Canvas.lineTo(ToFixedPoint(m),s),this.Canvas.stroke()}}}else\x20this.HScreenDraw()},this.HScreenDraw=function(){var\x20t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetTop()+e/2+2,i=this.ChartBorder.GetBottom(),r=this.ChartFrame.XPointCount,n=this.GetLockRect();n&&(i=n.Top);var\x20s=this.ChartFrame.GetYFromData(0);if(t>=4){s=ToFixedRect(s);for(var\x20o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<r;++o,++h,a+=t+e){var\x20l=this.Data.Data[o],C=this.HistoryData.Data[o];if(null!=l&&null!=C){var\x20u=a;if(a+t>i)break;var\x20D=this.ChartFrame.GetYFromData(l),d=!1;C.Close>=C.Open?(d=!0,this.Canvas.fillStyle=this.UpColor):this.Canvas.fillStyle=this.DownColor;var\x20c=ToFixedRect(D-s);!d||1!=this.KLineDrawType&&2!=this.KLineDrawType&&3!=this.KLineDrawType?this.Canvas.fillRect(s,ToFixedRect(u),c,ToFixedRect(t)):(this.Canvas.strokeStyle=this.UpColor,this.Canvas.beginPath(),this.Canvas.rect(ToFixedPoint(s),ToFixedPoint(u),c,ToFixedRect(t)),this.Canvas.stroke())}}}else\x20for(o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<r;++o,++h,a+=t+e){l=this.Data.Data[o],C=this.HistoryData.Data[o];if(null!=l&&null!=C){D=this.ChartFrame.GetYFromData(l);if((m=this.ChartFrame.GetXFromIndex(h))>i)break;C.Close>C.Open?this.Canvas.strokeStyle=this.UpColor:this.Canvas.strokeStyle=this.DownColor;var\x20m=this.ChartFrame.GetXFromIndex(h);this.Canvas.beginPath(),this.Canvas.moveTo(D,ToFixedPoint(m)),this.Canvas.lineTo(s,ToFixedPoint(m)),this.Canvas.stroke()}}},this.GetMaxMin=function(){for(var\x20t=this.ChartFrame.XPointCount,e={Min:0,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var\x20r=this.Data.Data[a];null==e.Max&&(e.Max=r),e.Max<r&&(e.Max=r)}return\x20e}}function\x20ChartLineMultiData(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartLineMultiData\x22,this.Color=\x22rgb(255,193,37)\x22,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(this.Data&&this.Data.Data){var\x20t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());t&&(e=this.ChartBorder.GetBottom());for(var\x20a=this.ChartFrame.XPointCount,i=!0,r=0,n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var\x20o=this.Data.Data[n];if(null!=o){var\x20h=this.ChartFrame.GetXFromIndex(s);if(h>e)break;for(var\x20l\x20in\x20o){var\x20C=o[l].Value,u=this.ChartFrame.GetYFromData(C);i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(u,h):this.Canvas.moveTo(h,u),i=!1):t?this.Canvas.lineTo(u,h):this.Canvas.lineTo(h,u),++r}}}r>0&&this.Canvas.stroke()}},this.GetMaxMin=function(){var\x20t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return\x20e;for(var\x20a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var\x20r=this.Data.Data[a];if(null!=r)for(var\x20n\x20in\x20r){var\x20s=r[n].Value;null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=s),e.Max<s&&(e.Max=s),e.Min>s&&(e.Min=s)}}return\x20e}}function\x20ChartStickLine(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartStickLine\x22,this.Color=\x22rgb(255,193,37)\x22,this.BarType=0,this.LineDotted=[3,3],this.Width=0,this.SetEmptyBar=function(){return(1==this.BarType||-1==this.BarType)&&(this.Canvas.lineWidth=GetDevicePixelRatio(),this.Canvas.strokeStyle=this.Color,-1==this.BarType&&this.Canvas.setLineDash(this.LineDotted),!0)},this.IsEmptyBar=function(){return\x201==this.BarType||-1==this.BarType},this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(this.Data&&this.Data.Data){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetRight();this.ChartFrame.ZoomIndex;t&&(i=this.ChartBorder.GetBottom());var\x20r=this.ChartFrame.XPointCount,n=this.ChartBorder.GetLeft()+a/2+2;t&&(n=this.ChartBorder.GetTop()+a/2+2),this.Canvas.save();var\x20s=!1,o=!1;if(0==this.Width)this.SetEmptyBar();else\x20if(3==this.Width||50==this.Width)e>=4?(o=!0,this.SetEmptyBar(),this.Canvas.fillStyle=this.Color,this.Canvas.strokeStyle=this.Color):(this.Canvas.lineWidth=GetDevicePixelRatio(),this.Canvas.strokeStyle=this.Color);else\x20if(101==this.Width){var\x20h=e+a+1*GetDevicePixelRatio();this.Canvas.lineWidth=h,this.Canvas.strokeStyle=this.Color}else\x20if(this.Width<=3){var\x20l=2*GetDevicePixelRatio();(C=e*(this.Width/3))<l&&(C=l),this.SetEmptyBar(),this.Canvas.fillStyle=this.Color,s=!0}else{var\x20C=this.Width*GetDevicePixelRatio()+e;this.SetEmptyBar(),this.Canvas.fillStyle=this.Color,s=!0}for(var\x20u=this.Data.DataOffset,D=0;u<this.Data.Data.length&&D<r;++u,++D,n+=e+a){var\x20d=this.Data.Data[u];if(null!=d){var\x20c=d.Value,m=d.Value2;null==m&&(m=0);var\x20f=this.ChartFrame.GetXFromIndex(D),v=this.ChartFrame.GetYFromData(c),S=this.ChartFrame.GetYFromData(m);if(f>i)break;if(s)if(t){var\x20T=f-C/2,I=C;this.IsEmptyBar()?(this.Canvas.beginPath(),this.Canvas.rect(ToFixedPoint(Math.min(v,S)),ToFixedPoint(T),ToFixedRect(Math.abs(v-S)),ToFixedRect(I)),this.Canvas.stroke()):this.Canvas.fillRect(ToFixedRect(Math.min(v,S)),ToFixedRect(T),ToFixedRect(Math.abs(v-S)),ToFixedRect(I))}else{(T=f-C/2)+(I=C)>i&&(I=i-T),this.IsEmptyBar()?(this.Canvas.beginPath(),this.Canvas.rect(ToFixedPoint(T),ToFixedPoint(Math.min(v,S)),ToFixedRect(I),ToFixedRect(Math.abs(v-S))),this.Canvas.stroke()):this.Canvas.fillRect(ToFixedRect(T),ToFixedRect(Math.min(v,S)),ToFixedRect(I),ToFixedRect(Math.abs(v-S)))}else\x20if(o)this.IsEmptyBar()?t?(this.Canvas.beginPath(),this.Canvas.rect(ToFixedPoint(Math.min(v,S)),ToFixedPoint(n),ToFixedRect(Math.abs(v-S)),ToFixedRect(e)),this.Canvas.stroke()):(this.Canvas.beginPath(),this.Canvas.rect(ToFixedPoint(n),ToFixedPoint(Math.min(v,S)),ToFixedRect(e),ToFixedRect(Math.abs(v-S))),this.Canvas.stroke()):t?this.Canvas.fillRect(ToFixedRect(Math.min(v,S)),ToFixedRect(n),ToFixedRect(Math.abs(v-S)),ToFixedRect(e)):this.Canvas.fillRect(ToFixedRect(n),ToFixedRect(Math.min(v,S)),ToFixedRect(e),ToFixedRect(Math.abs(v-S)));else\x20if(t)this.Canvas.beginPath(),this.Canvas.moveTo(v,ToFixedPoint(f)),this.Canvas.lineTo(S,ToFixedPoint(f)),this.Canvas.stroke();else{var\x20F=parseInt(f.toString())+.5;this.Canvas.beginPath(),this.Canvas.moveTo(F,v),this.Canvas.lineTo(F,S),this.Canvas.stroke()}}}this.Canvas.restore()}},this.GetMaxMin=function(){var\x20t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return\x20e;for(var\x20a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var\x20r=this.Data.Data[a];if(null!=r){var\x20n=r.Value2;if(null==n&&(n=0),null!=r&&!isNaN(r.Value)&&!isNaN(n)){var\x20s=Math.max(r.Value,n),o=Math.min(r.Value,n);null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=o),e.Max<s&&(e.Max=s),e.Min>o&&(e.Min=o)}}}return\x20e}}function\x20ChartText(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartText\x22,this.TextFont=\x2214px\x20微软雅黑\x22,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(this.Data&&this.Data.Data){this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth;var\x20t=this.ChartBorder.GetRight();this.ChartFrame.XPointCount;for(var\x20e\x20in\x20this.Data.Data){var\x20a=this.Data.Data[e];if(null!=a){var\x20i=a.Value;if(\x22Left\x22==a.Position){var\x20r=this.ChartFrame.GetXFromIndex(0),n=this.ChartFrame.GetYFromData(i);if(r>t)continue;this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=a.Color,this.Canvas.font=this.TextFont,this.Canvas.fillText(a.Message,r,n)}}}}},this.GetMaxMin=function(){this.ChartFrame.XPointCount;var\x20t={Min:null,Max:null};if(!this.Data||!this.Data.Data)return\x20t;for(var\x20e\x20in\x20this.Data.Data){var\x20a=this.Data.Data[e];if(null!=a&&!isNaN(a.Value)){var\x20i=a.Value;null==t.Max&&(t.Max=i),null==t.Min&&(t.Min=i),t.Max<i&&(t.Max=i),t.Min>i&&(t.Min=i)}}return\x20t}}function\x20ChartSingleText(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartSingleText\x22,this.Color=\x22rgb(255,193,37)\x22,this.TextFont=\x2214px\x20微软雅黑\x22,this.Text,this.TextAlign=\x22left\x22,this.Direction=0,this.YOffset=0,this.Position,this.IconFont,this.IconSize={Max:g_JSChartResource.DRAWICON.Icon.MaxSize,Min:g_JSChartResource.DRAWICON.Icon.MinSize,Zoom:{Type:g_JSChartResource.DRAWICON.Icon.Zoom.Type,Value:g_JSChartResource.DRAWICON.Icon.Zoom.Value}},this.TextSize={Max:g_JSChartResource.DRAWICON.Text.MaxSize,Min:g_JSChartResource.DRAWICON.Text.MinSize,Zoom:{Type:g_JSChartResource.DRAWICON.Text.Zoom.Type,Value:g_JSChartResource.DRAWICON.Text.Zoom.Value},FontName:g_JSChartResource.DRAWICON.Text.FontName},this.ReloadResource=function(t){\x22DRAWTEXT\x22==this.Name&&(this.TextSize={Max:g_JSChartResource.DRAWTEXT.MaxSize,Min:g_JSChartResource.DRAWTEXT.MinSize,Zoom:{Type:g_JSChartResource.DRAWTEXT.Zoom.Type,Value:g_JSChartResource.DRAWTEXT.Zoom.Value},FontName:g_JSChartResource.DRAWTEXT.FontName})},this.SuperGetMaxMin=this.GetMaxMin,this.GetMaxMin=function(){return\x22DRAWTEXT_FIX\x22==this.Name||\x22DRAWNUMBER_FIX\x22==this.Name?{Min:null,Max:null}:this.SuperGetMaxMin()},this.Draw=function(){if(this.IsShow)if(this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(this.Position)this.DrawPosition();else\x20if(this.Data&&this.Data.Data){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetRight(),r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetBottomEx();t&&(i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetRightEx(),n=this.ChartBorder.GetLeftEx());var\x20s=this.ChartFrame.XPointCount,o=Array.isArray(this.Text),h=GetDevicePixelRatio();if(1==this.Direction?this.Canvas.textBaseline=\x22bottom\x22:2==this.Direction?this.Canvas.textBaseline=\x22top\x22:this.Canvas.textBaseline=\x22middle\x22,this.IconFont){this.Color=this.IconFont.Color,this.Text=this.IconFont.Text;var\x20l=this.GetDynamicIconSize(e,a,this.IconSize.Max,this.IconSize.Min,this.IconSize.Zoom);this.Canvas.font=l+\x22px\x20\x22+this.IconFont.Family}else\x20this.TextFont=this.GetDynamicFont(e,a,this.TextSize.Max,this.TextSize.Min,this.TextSize.Zoom,this.TextSize.FontName),this.Canvas.font=this.TextFont;for(var\x20C=this.Data.DataOffset,u=0;C<this.Data.Data.length&&u<s;++C,++u){var\x20D=this.Data.Data[C];if(null!=D){var\x20d=this.ChartFrame.GetXFromIndex(u),c=this.ChartFrame.GetYFromData(D);if(d>i)break;if(this.Canvas.textAlign=this.TextAlign,this.Canvas.fillStyle=this.Color,this.YOffset>0&&this.Direction>0){var\x20m=c;this.Canvas.save(),this.Canvas.setLineDash([5,10]),this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?(1==this.Direction?(c=r-this.YOffset*h,m+=5*h):(c=n+this.YOffset*h,m-=5*h),this.Canvas.moveTo(ToFixedPoint(m),ToFixedPoint(d)),this.Canvas.lineTo(ToFixedPoint(c),ToFixedPoint(d))):(1==this.Direction?(c=r+this.YOffset*h,m+=5*h):(c=n-this.YOffset*h,m-=5*h),this.Canvas.moveTo(ToFixedPoint(d),ToFixedPoint(m)),this.Canvas.lineTo(ToFixedPoint(d),ToFixedPoint(c))),this.Canvas.stroke(),this.Canvas.restore()}if(o){var\x20f=this.Text[C];if(!f)continue;\x22DRAWNUMBER\x22==this.Name&&(1==this.Direction?c-=4*h:2==this.Direction&&(c+=4*h)),this.DrawText(f,d,c,t)}else\x20this.DrawText(this.Text,d,c,t)}}}},this.DrawPosition=function(){if(this.Text){var\x20t=!0===this.ChartFrame.IsHScreen;if(t)var\x20e=this.ChartBorder.GetRightEx()-this.ChartBorder.GetWidthEx()*this.Position.Y,a=this.ChartBorder.GetTop()+this.ChartBorder.GetHeight()*this.Position.X;else\x20a=this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*this.Position.X,e=this.ChartBorder.GetTopEx()+this.ChartBorder.GetHeightEx()*this.Position.Y;if(this.Canvas.fillStyle=this.Color,0==this.Position.Type?this.Canvas.textAlign=\x22left\x22:1==this.Position.Type?this.Canvas.textAlign=\x22right\x22:this.Canvas.textAlign=\x22center\x22,1==this.Direction?this.Canvas.textBaseline=\x22bottom\x22:2==this.Direction?this.Canvas.textBaseline=\x22top\x22:this.Canvas.textBaseline=\x22middle\x22,Array.isArray(this.Text)){if(!this.Data||!this.Data.Data)return;for(var\x20i=this.ChartFrame.XPointCount,r=this.Data.DataOffset,n=0;r<this.Data.Data.length&&n<i;++r,++n){var\x20s=this.Text[r];if(s){this.DrawText(s,a,e,t);break}}}else\x20this.DrawText(this.Text,a,e,t)}},this.DrawText=function(t,e,a,i){i?(this.Canvas.save(),this.Canvas.translate(a,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,0,0),this.Canvas.restore()):this.Canvas.fillText(t,e,a)}}function\x20ChartStraightLine(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartStraightLine\x22,this.Color=\x22rgb(255,193,37)\x22,this.Draw=function(){if(this.Data&&this.Data.Data&&1==this.Data.Data.length){this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();var\x20t=this.ChartFrame.XPointCount,e=this.Data.Data[0],a=this.ChartFrame.GetYFromData(e),i=this.ChartFrame.GetXFromIndex(0),r=this.ChartFrame.GetXFromIndex(t-1),n=parseInt(a.toString())+.5;this.Canvas.beginPath(),this.Canvas.moveTo(i,n),this.Canvas.lineTo(r,n),this.Canvas.strokeStyle=this.Color,this.Canvas.stroke()}},this.GetMaxMin=function(){this.ChartFrame.XPointCount;var\x20t={Min:null,Max:null};return\x20this.Data&&this.Data.Data?1!=this.Data.Data.length?t:(t.Min=this.Data.Data[0],t.Max=this.Data.Data[0],t):t}}function\x20ChartStraightArea(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartStraightArea\x22,this.Color=\x22rgb(255,193,37)\x22,this.Font=\x2211px\x20微软雅黑\x22,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(this.Data&&this.Data.Data)if(!0!==this.ChartFrame.IsHScreen){this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight(),this.ChartBorder.GetBottom();var\x20t=this.ChartBorder.GetLeft(),e=this.ChartFrame.XPointCount,a=this.ChartFrame.GetXFromIndex(e-1);for(var\x20i\x20in\x20this.Data.Data){let\x20e=this.Data.Data[i];if(null==e||isNaN(e.Value)||isNaN(e.Value2))continue;if(null==e.Color)continue;let\x20s=Math.max(e.Value,e.Value2),o=Math.min(e.Value,e.Value2);var\x20r=this.ChartFrame.GetYFromData(s),n=this.ChartFrame.GetYFromData(o);if(this.Canvas.fillStyle=e.Color,this.Canvas.fillRect(ToFixedRect(t),ToFixedRect(r),ToFixedRect(a-t),ToFixedRect(n-r)),e.Title&&e.TitleColor){this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=e.TitleColor,this.Canvas.font=this.Font;let\x20t=r+(n-r)/2;this.Canvas.fillText(e.Title,a,t)}}}else\x20this.HScreenDraw()},this.HScreenDraw=function(){var\x20t=this.ChartBorder.GetBottom(),e=this.ChartBorder.GetTop(),a=this.ChartBorder.GetHeight();for(var\x20i\x20in\x20this.Data.Data){let\x20h=this.Data.Data[i];if(null==h||isNaN(h.Value)||isNaN(h.Value2))continue;if(null==h.Color)continue;let\x20l=Math.max(h.Value,h.Value2),C=Math.min(h.Value,h.Value2);var\x20r=this.ChartFrame.GetYFromData(l),n=this.ChartFrame.GetYFromData(C);if(this.Canvas.fillStyle=h.Color,this.Canvas.fillRect(ToFixedRect(n),ToFixedRect(e),ToFixedRect(r-n),ToFixedRect(a)),h.Title&&h.TitleColor){var\x20s=r+(n-r)/2,o=t;this.Canvas.save(),this.Canvas.translate(s,o),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=h.TitleColor,this.Canvas.font=this.Font,this.Canvas.fillText(h.Title,0,-2),this.Canvas.restore()}}},this.GetMaxMin=function(){this.ChartFrame.XPointCount;var\x20t={Min:null,Max:null};if(!this.Data||!this.Data.Data)return\x20t;for(let\x20e\x20in\x20this.Data.Data){let\x20a=this.Data.Data[e];if(null==a||isNaN(a.Value)||isNaN(a.Value2))continue;let\x20i=Math.max(a.Value,a.Value2),r=Math.min(a.Value,a.Value2);null==t.Max&&(t.Max=i),null==t.Min&&(t.Min=r),t.Max<i&&(t.Max=i),t.Min>r&&(t.Min=r)}return\x20t}}function\x20ChartMinutePriceLine(){this.newMethod=ChartLine,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartMinutePriceLine\x22,this.YClose,this.IsDrawArea=!0,this.AreaColor=\x22rgba(0,191,255,0.1)\x22,this.SourceData,this.IsShowLead=!1,this.LeadData,this.UpColor=g_JSChartResource.UpBarColor,this.DownColor=g_JSChartResource.DownBarColor,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(this.IsShow){var\x20t=!0===this.ChartFrame.IsHScreen;this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();!0===t&&this.ChartBorder.GetBottom();var\x20e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount,i=this.ChartBorder.GetBottomEx(),r=this.ChartBorder.GetLeftEx(),n=this.Data,s=!1;if(this.SourceData&&(n=this.SourceData,s=!0),this.IsShowLead&&this.DrawLead(),n){var\x20o=!0,h={},l={},C=0;if(n.Period=\x2200\x22,n.Data.length>0){debug&&console.log(n.DataOffset,window.chartdata[n.Period].DataOffset);var\x20u=Math.max(0,n.Data.length-a),D=u-(window.chartdata[n.Period]?window.chartdata[n.Period].DataOffset:u);!window.chartdata[n.Period]&&(window.chartdata[n.Period]={}),0==n.DataOffset&&(n.DataOffset=D<0||D>3?window.chartdata[n.Period].DataOffset:u),this.Canvas.canvas.JSChartContainer.Frame.Data.DataOffset=window.chartdata[n.Period].DataOffset=n.DataOffset}debug&&console.log(\x22ChartMinutePriceLine\x22,n.Data.length,a,n.DataOffset,this);for(var\x20d=n.DataOffset,c=0;d<n.Data.length&&c<e;++d,++c){var\x20m=null;if(s){var\x20f=n.Data[d];m=f.Before?f.Before.Close:f.Close}else\x20m=n.Data[d];if(null!=m){var\x20v=this.ChartFrame.GetXFromIndex(c),S=this.ChartFrame.GetYFromData(m);o?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(S,v):this.Canvas.moveTo(v,S),o=!1,h={X:v,Y:S}):t?this.Canvas.lineTo(S,v):this.Canvas.lineTo(v,S),l.X=v,l.Y=S,l.Price=m,++C>=a&&(o=!0,this.Canvas.stroke(),this.IsDrawArea&&(t?(this.Canvas.lineTo(r,v),this.Canvas.lineTo(r,h.X),this.SetFillStyle(this.AreaColor,this.ChartBorder.GetRightEx(),i,this.ChartBorder.GetLeftEx(),i)):(this.Canvas.lineTo(v,i),this.Canvas.lineTo(h.X,i),this.SetFillStyle(this.AreaColor,r,this.ChartBorder.GetTopEx(),r,i)),this.Canvas.fill()),C=0)}}if(C>0&&(this.Canvas.stroke(),this.IsDrawArea&&(t?(this.Canvas.lineTo(r,v),this.Canvas.lineTo(r,h.X),this.SetFillStyle(this.AreaColor,this.ChartBorder.GetRightEx(),i,this.ChartBorder.GetLeftEx(),i)):(this.Canvas.lineTo(v,i),this.Canvas.lineTo(h.X,i),this.SetFillStyle(this.AreaColor,r,this.ChartBorder.GetTopEx(),r,i)),this.Canvas.fill())),this.HQChart){var\x20T=this.HQChart.GetEventCallback(JSCHART_EVENT_ID.ON_DRAW_MINUTE_LAST_POINT);if(T){n={LastPoint:{X:l.X,Y:l.Y},Price:l.Price};T.Callback(T,n,this)}}}}},this.DrawLead=function(){if(this.LeadData){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount,i=(this.ChartBorder.GetBottomEx(),this.ChartBorder.GetTopEx());if(!0===t&&(i=this.ChartBorder.GetRightEx()),!(e>a)){for(var\x20r=[],n=null,s=null,o=this.ChartFrame.GetYFromData(this.YClose),h=(o-i)/3,l=this.LeadData,C=l.DataOffset,u=0;C<l.Data.length&&u<e;++C,++u){var\x20D=l.Data[C];if(IFrameSplitOperator.IsNumber(D)&&0!=D){var\x20d=this.ChartFrame.GetXFromIndex(u);(null==n||n<D)&&(n=D),(null==s||s>D)&&(s=D),r.push({X:d,Value:D})}}if(!(r.length<=0)){var\x20c=Math.max(Math.abs(n),Math.abs(s));for(var\x20C\x20in\x20r){var\x20m=r[C];m.Value>0?this.Canvas.strokeStyle=this.UpColor:this.Canvas.strokeStyle=this.DownColor;var\x20f=o-m.Value*h/c;d=ToFixedPoint(m.X);this.Canvas.beginPath(),!0===t?(this.Canvas.moveTo(o,d),this.Canvas.lineTo(f,d)):(this.Canvas.moveTo(d,o),this.Canvas.lineTo(d,f)),this.Canvas.stroke()}}}}},this.GetMaxMin=function(){var\x20t=this.ChartFrame.XPointCount,e={};if(null==this.YClose)return\x20e;if(!this.IsShow)return\x20e;e.Min=this.YClose,e.Max=this.YClose;var\x20a=this.Data,i=!1;this.SourceData&&(a=this.SourceData,i=!0);for(var\x20r=a.DataOffset,n=0;r<a.Data.length&&n<t;++r,++n){var\x20s=null;if(i){var\x20o=a.Data[r];s=o.Before?o.Before.Close:o.Close}else\x20s=a.Data[r];null!=s&&(null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=s),e.Max<s&&(e.Max=s),e.Min>s&&(e.Min=s))}if(e.Max==this.YClose&&e.Min==this.YClose)return\x20e.Max=this.YClose+.1*this.YClose,e.Min=this.YClose-.1*this.YClose,e;var\x20h=Math.max(Math.abs(this.YClose-e.Max),Math.abs(this.YClose-e.Min));return\x20e.Max=this.YClose+h,e.Min=this.YClose-h,e}}function\x20ChartOverlayMinutePriceLine(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.Color=\x22rgb(65,105,225)\x22,this.MainData,this.MainYClose,this.SourceData,this.BeforeDataCount=0,this.IsBeforeData=!1,this.ClassName=\x22ChartOverlayMinutePriceLine\x22,this.Title,this.Symbol,this.YClose,this.Status=OVERLAY_STATUS_ID.STATUS_NONE_ID,this.Draw=function(){if(this.Data)if(this.NotSupportMessage)this.DrawNotSupportmessage();else{var\x20t=!0===this.ChartFrame.IsHScreen;this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();!0===t&&this.ChartBorder.GetBottom();var\x20e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount,i=!0,r=0,n=0;this.IsBeforeData&&(n=1);for(var\x20s=this.Data.DataOffset+n,o=0;s<this.Data.Data.length&&o<e;++s,++o){var\x20h=this.Data.Data[s].Close;if(null!=h){var\x20l=h/this.YClose*this.MainYClose,C=this.ChartFrame.GetXFromIndex(o+this.BeforeDataCount),u=this.ChartFrame.GetYFromData(l);i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(u,C):this.Canvas.moveTo(C,u),i=!1):t?this.Canvas.lineTo(u,C):this.Canvas.lineTo(C,u),++r>=a&&(i=!0,this.Canvas.stroke(),r=0)}}r>0&&this.Canvas.stroke()}},this.GetMaxMin=function(){var\x20t=this.ChartFrame.XPointCount,e={};if(null==this.YClose)return\x20e;e.Min=this.MainYClose,e.Max=this.MainYClose;for(var\x20a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){if(null!=(r=this.Data.Data[a].Close)){var\x20r=r/this.YClose*this.MainYClose;null==e.Max&&(e.Max=r),null==e.Min&&(e.Min=r),e.Max<r&&(e.Max=r),e.Min>r&&(e.Min=r)}}if(e.Max==this.MainYClose&&e.Min==this.MainYClose)return\x20e.Max=this.MainYClose+.1*this.MainYClose,e.Min=this.MainYClose-.1*this.MainYClose,e;var\x20n=Math.max(Math.abs(this.MainYClose-e.Max),Math.abs(this.MainYClose-e.Min));return\x20e.Max=this.MainYClose+n,e.Min=this.MainYClose-n,e}}function\x20ChartMinuteInfo(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartMinuteInfo\x22,this.Data=new\x20Map,this.SourceData,this.ChartMinutePrice,this.YClose,this.HQChartBorder,this.TextColor=g_JSChartResource.MinuteInfo.TextColor,this.Font=g_JSChartResource.MinuteInfo.Font,this.PointColor=g_JSChartResource.MinuteInfo.PointColor,this.LineColor=g_JSChartResource.MinuteInfo.LineColor,this.TextBGColor=g_JSChartResource.MinuteInfo.TextBGColor,this.PixelTatio=GetDevicePixelRatio(),this.TextHeight=20,this.TextRectCache=[],this.InfoDrawCache=[],this.FrameBottom,this.FrameTop,this.FrameLeft,this.FrameRight,this.YOffset=5,this.IsHScreen=!1,this.IsDrawFull=!1,this.TooltipRect=[],this.SetOption=function(t){t.TextColor&&(this.TextColor=t.TextColor),t.TextBGColor&&(this.TextBGColor=t.TextBGColor),t.Font&&(this.Font=t.Font),t.PointColor&&(this.PointColor=t.PointColor),t.LineColor&&(this.LineColor=t.LineColor),t.TextHeight>0&&(this.TextHeight=t.TextHeight),1==t.IsDrawFull&&(this.IsDrawFull=!0)},this.Draw=function(){if(this.TooltipRect=[],this.ChartMinutePrice&&this.Data&&!(this.Data.size<=0)){this.TextRectCache=[],this.InfoDrawCache=[],this.PixelTatio=GetDevicePixelRatio(),this.YOffset=5*this.PixelTatio,this.IsHScreen=!0===this.ChartFrame.IsHScreen;var\x20t=this.ChartFrame.XPointCount;this.ChartFrame.MinuteCount;this.FrameBottom=this.ChartBorder.GetBottom(),this.IsDrawFull&&this.HQChartBorder&&(this.FrameBottom=this.HQChartBorder.GetBottom()),this.FrameTop=this.ChartBorder.GetTop(),this.FrameLeft=this.ChartBorder.GetLeft(),this.FrameRight=this.ChartBorder.GetRight(),this.IsHScreen&&(this.FrameRight=this.ChartBorder.GetBottom(),this.FrameLeft=this.ChartBorder.GetTop(),this.FrameBottom=this.ChartBorder.GetLeft(),this.FrameTop=this.ChartBorder.GetRight()),this.YClose=this.ChartMinutePrice.YClose;var\x20e=this.ChartMinutePrice.Data,a=!1;this.ChartMinutePrice.SourceData&&(e=this.ChartMinutePrice.SourceData,a=!0);for(var\x20i=e.DataOffset,r=0;i<e.Data.length&&r<t;++i,++r){var\x20n=this.SourceData.Data[i];if((!a||!n.Before)&&n){var\x20s=n.DateTime;this.Data.has(s)&&(this.IsHScreen?this.CalcuateInfoHScreenPosition(this.Data.get(s),r,n):this.CalcuateInfoPosition(this.Data.get(s),r,n))}}for(var\x20i\x20in\x20this.InfoDrawCache){n=this.InfoDrawCache[i];this.DrawInfoLines(n)}for(var\x20i\x20in\x20this.InfoDrawCache){n=this.InfoDrawCache[i];if(this.DrawInfoText(n),!this.IsHScreen){var\x20o=n.Border,h={Data:{Item:n},Rect:new\x20Rect(o.X,o.Y,o.Width,o.Height)};this.TooltipRect.push(h)}}this.TextRectCache=[],this.InfoDrawCache=[]}},this.CalcuateInfoPosition=function(t,e,a){if(t&&t.Data&&!(t.Data.length<=0)){var\x20i=t.Data[0];this.Canvas.font=this.Font;var\x20r,n=this.Canvas.measureText(i.Title).width+4*this.PixelTatio,s=this.TextHeight*this.PixelTatio,o=this.ChartFrame.GetXFromIndex(e);r=IFrameSplitOperator.IsNumber(i.Price)?this.ChartFrame.GetYFromData(i.Price):this.ChartFrame.GetYFromData(a.Close);var\x20h=(o=ToFixedPoint(o))<this.FrameLeft+Math.abs(this.FrameLeft-this.FrameRight)/2,l=[2,4,6,8,3,5,7],C=s+l[e%l.length]*this.PixelTatio,u={Y:[{Value:r+(s+this.YOffset),Offset:C},{Value:r-(2*s+this.YOffset),Offset:-C}]};a.Close<this.YClose&&(u.Y=u.Y.reverse());var\x20D={X:o,Y:null,Width:n,Height:s};h||(D.X-=D.Width),this.FixTextRect(D,u);var\x20d={Border:D,Start:{X:o,Y:r},IsLeft:h,Title:i.Title,Date:i.Date,Time:i.Time};i.Content&&(d.Content=i.Content),i.Link&&(d.Link=i.Link),i.Color&&(d.Color=i.Color),i.BGColor&&(d.BGColor=i.BGColor),this.InfoDrawCache.push(d),this.TextRectCache.push(D)}},this.CalcuateInfoHScreenPosition=function(t,e,a){if(t&&t.Data&&!(t.Data.length<=0)){var\x20i=t.Data[0];this.Canvas.font=this.Font;var\x20r,n=this.Canvas.measureText(i.Title).width+4*this.PixelTatio,s=this.TextHeight*this.PixelTatio,o=this.ChartFrame.GetXFromIndex(e);r=IFrameSplitOperator.IsNumber(i.Price)?this.ChartFrame.GetYFromData(i.Price):this.ChartFrame.GetYFromData(a.Close);var\x20h=(o=ToFixedPoint(o))<this.FrameLeft+Math.abs(this.FrameLeft-this.FrameRight)/2,l=[2,4,6,8,3,5,7],C=s+l[e%l.length]*this.PixelTatio,u={X:[{Value:r+(s+this.YOffset),Offset:C},{Value:r-(2*s+this.YOffset),Offset:-C}]};a.Close>this.YClose&&(u.X=u.X.reverse());var\x20D={X:null,Y:o,Width:s,Height:n};h||(D.Y-=D.Height),this.FixHScreenTextRect(D,u);var\x20d={Border:D,Start:{X:r,Y:o},IsLeft:h,Title:i.Title};this.InfoDrawCache.push(d),this.TextRectCache.push(D)}},this.DrawInfoLines=function(t){var\x20e=t.Border,a=t.IsLeft;this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(ToFixedPoint(t.Start.X),t.Start.Y),a?this.Canvas.lineTo(ToFixedPoint(t.Start.X),e.Y):this.IsHScreen?this.Canvas.lineTo(e.X,e.Y+e.Height):this.Canvas.lineTo(ToFixedPoint(t.Start.X),e.Y),this.Canvas.stroke(),this.Canvas.fillStyle=this.PointColor,this.Canvas.beginPath(),this.Canvas.arc(t.Start.X,t.Start.Y,5,0,2*Math.PI),this.Canvas.closePath(),this.Canvas.fill()},this.DrawInfoText=function(t){var\x20e=t.Border,a=e.X,i=e.Y;t.BGColor?this.Canvas.fillStyle=t.BGColor:this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(a,i,e.Width,e.Height),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.rect(a,i,e.Width,e.Height),this.Canvas.stroke(),this.IsHScreen&&(this.Canvas.save(),this.Canvas.translate(e.X,e.Y),this.Canvas.rotate(90*Math.PI/180),a=0,i=0),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,t.Color?this.Canvas.fillStyle=t.Color:this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.IsHScreen?this.Canvas.fillText(t.Title,a+2*this.PixelTatio,i-e.Width/2):this.Canvas.fillText(t.Title,a+2*this.PixelTatio,i+e.Height/2),this.IsHScreen&&this.Canvas.restore()},this.FixTextRect=function(t,e){for(var\x20a\x20in\x20e.Y){var\x20i,r=e.Y[a];t.Y=r.Value;for(var\x20n=0;n<10;++n){var\x20s=!1;for(var\x20o\x20in\x20this.TextRectCache){var\x20h=this.TextRectCache[o];if(this.IsOverlap(h,t)){s=!0;break}}if(0==s)return;if(i=t.Y,(i+=r.Offset)+t.Height>this.FrameBottom||i<this.FrameTop)break;t.Y=i}}},this.FixHScreenTextRect=function(t,e){for(var\x20a\x20in\x20e.X){var\x20i,r=e.X[a];t.X=r.Value;for(var\x20n=0;n<10;++n){var\x20s=!1;for(var\x20o\x20in\x20this.TextRectCache){var\x20h=this.TextRectCache[o];if(this.IsOverlap(h,t)){s=!0;break}}if(0==s)return;if(i=t.X,(i+=r.Offset)+t.Width<this.FrameBottom||i>this.FrameTop)break;t.X=i}}},this.IsOverlap=function(t,e){return\x20t.X+t.Width>e.X&&e.X+e.Width>t.X&&t.Y+t.Height>e.Y&&e.Y+e.Height>t.Y},this.GetMaxMin=function(){return{Min:null,Max:null}},this.GetTooltipData=function(t,e,a){for(var\x20i\x20in\x20this.TooltipRect){var\x20r=this.TooltipRect[i];if(r.Rect){var\x20n=r.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(n.X,n.Y,n.Width,n.Height),this.Canvas.isPointInPath(t,e))return\x20a.Data=r,a.ChartPaint=this,a.Type=3,!0}}return!1}}function\x20ChartMACD(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartMACD\x22,this.UpColor=g_JSChartResource.UpBarColor,this.DownColor=g_JSChartResource.DownBarColor,this.LineWidth=1,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(!0!==this.ChartFrame.IsHScreen){var\x20t=this.ChartFrame.DataWidth,e=(this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight()),a=this.ChartFrame.XPointCount,i=this.GetLockRect();i&&(e=i.Left);var\x20r=this.ChartFrame.GetYFromData(0),n=this.LineWidth*GetDevicePixelRatio();50==this.LineWidth?n=t:n>t&&(n=t);var\x20s=this.Canvas.lineWidth;this.Canvas.lineWidth=n;for(var\x20o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<a;++o,++h){var\x20l=this.Data.Data[o];if(null!=l){var\x20C=this.ChartFrame.GetXFromIndex(h),u=this.ChartFrame.GetYFromData(l);if(C>e)break;var\x20D=parseInt(C.toString())+.5;this.Canvas.beginPath(),this.Canvas.moveTo(D,r),this.Canvas.lineTo(D,u),this.Canvas.strokeStyle=l>=0?this.UpColor:this.DownColor,this.Canvas.stroke(),this.Canvas.closePath()}}this.Canvas.lineWidth=s}else\x20this.HScreenDraw()},this.HScreenDraw=function(){var\x20t=this.ChartFrame.DataWidth,e=(this.ChartFrame.DistanceWidth,this.ChartBorder.GetBottom()),a=this.ChartFrame.XPointCount,i=this.GetLockRect();i&&(e=i.Top);var\x20r=this.ChartFrame.GetYFromData(0),n=this.LineWidth*GetDevicePixelRatio();50==this.LineWidth?n=t:n>t&&(n=t);var\x20s=this.Canvas.lineWidth;this.Canvas.lineWidth=n;for(var\x20o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<a;++o,++h){var\x20l=this.Data.Data[o];if(null!=l){var\x20C=this.ChartFrame.GetXFromIndex(h),u=this.ChartFrame.GetYFromData(l);if(C>e)break;this.Canvas.beginPath(),this.Canvas.moveTo(r,ToFixedPoint(C)),this.Canvas.lineTo(u,ToFixedPoint(C)),this.Canvas.strokeStyle=l>=0?this.UpColor:this.DownColor,this.Canvas.stroke(),this.Canvas.closePath()}}this.Canvas.lineWidth=s}}function\x20ChartBar(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartBar\x22,this.UpBarColor=g_JSChartResource.UpBarColor,this.DownBarColor=g_JSChartResource.DownBarColor,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else{var\x20t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetRight(),i=this.ChartFrame.XPointCount,r=this.ChartBorder.GetLeft()+e/2+2,n=this.ChartFrame.GetYFromData(0);if(t>=4){n=ToFixedRect(n);for(var\x20s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<i;++s,++o,r+=t+e){if(null!=(D=this.Data.Data[s])&&0!=D){var\x20h=r;if(r+t>a)break;var\x20l=this.ChartFrame.GetXFromIndex(o),C=this.ChartFrame.GetYFromData(D);this.Canvas.fillStyle=D>0?this.UpBarColor:this.DownBarColor;var\x20u=ToFixedRect(Math.abs(n-C));C=n-C>0?n-u:n+u,this.Canvas.fillRect(ToFixedRect(h),C,ToFixedRect(t),u)}}}else\x20for(s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<i;++s,++o,r+=t+e){var\x20D;if(null!=(D=this.Data.Data[s])&&0!=D){h=r;if(r+t>a)break;l=this.ChartFrame.GetXFromIndex(o),C=this.ChartFrame.GetYFromData(D);this.Canvas.strokeStyle=D>0?this.UpBarColor:this.DownBarColor,this.Canvas.beginPath(),this.Canvas.moveTo(ToFixedPoint(l),C),this.Canvas.lineTo(ToFixedPoint(l),n),this.Canvas.stroke()}}}},this.GetMaxMin=function(){for(var\x20t=this.ChartFrame.XPointCount,e={Min:0,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var\x20r=this.Data.Data[a];null==e.Max&&(e.Max=r),e.Max<r&&(e.Max=r)}return\x20e}}function\x20ChartBand(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.IsDrawFirst=!0,this.ClassName=\x22ChartBand\x22,this.FirstColor=g_JSChartResource.Index.LineColor[0],this.SecondColor=g_JSChartResource.Index.LineColor[1],this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else\x20for(var\x20t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+2,r=0,n=0,s=0,o=[],h=[],l=this.Data.DataOffset,C=0;l<this.Data.Data.length&&C<a;++l,++C,i+=t+e){for(o=[],h=[];l<this.Data.Data.length&&C<a;++l,++C,i+=t+e){var\x20u=this.Data.Data[l];if(null==u||null==u.Value||null==u.Value2)break;r=this.ChartFrame.GetXFromIndex(C),n=this.ChartFrame.GetYFromData(u.Value),s=this.ChartFrame.GetYFromData(u.Value2),o.push({x:r,y:n}),h.push({x:r,y:s})}o.length>1&&h.length>1&&this.DrawBand(o,h)}},this.DrawBand=function(t,e){this.Canvas.save(),this.Canvas.beginPath();for(var\x20a=0;a<t.length;++a)0==a?this.Canvas.moveTo(t[a].x,t[a].y):this.Canvas.lineTo(t[a].x,t[a].y);for(a=e.length-1;a>=0;--a)this.Canvas.lineTo(e[a].x,e[a].y);this.Canvas.closePath(),this.Canvas.clip(),this.Canvas.moveTo(t[0].x,this.ChartBorder.GetBottom());for(a=0;a<t.length;++a)this.Canvas.lineTo(t[a].x,t[a].y);this.Canvas.lineTo(t[t.length-1].x,this.ChartBorder.GetBottom()),this.Canvas.closePath(),this.Canvas.fillStyle=this.FirstColor,this.Canvas.fill(),this.Canvas.beginPath(),this.Canvas.moveTo(e[0].x,this.ChartBorder.GetBottom());for(a=0;a<e.length;++a)this.Canvas.lineTo(e[a].x,e[a].y);this.Canvas.lineTo(e[e.length-1].x,this.ChartBorder.GetBottom()),this.Canvas.closePath(),this.Canvas.fillStyle=this.SecondColor,this.Canvas.fill(),this.Canvas.restore()},this.GetMaxMin=function(){for(var\x20t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var\x20r=this.Data.Data[a];if(null!=r&&null!=r.Value&&null!=r.Value2){var\x20n=r.Value>r.Value2?r.Value:r.Value2,s=r.Value<r.Value2?r.Value:r.Value2;null==e.Max?e.Max=n:e.Max<n&&(e.Max=n),null==e.Min?e.Min=s:e.Min>s&&(e.Min=s)}}return\x20e}}function\x20ChartLineArea(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.IsDrawFirst=!0,this.ClassName=\x22ChartLineArea\x22,this.Color=\x22rgb(56,67,99)\x22,this.IsHScreen=!1,this.Draw=function(){if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(this.Data&&this.Data.Data){for(var\x20t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+g_JSChartResource.FrameLeftMargin,r=0,n=0,s=0,o=[],h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<a;++h,++l,i+=t+e){var\x20C=this.Data.Data[h];o[h]=null,null!=C&&null!=C.Value&&null!=C.Value2&&(r=this.ChartFrame.GetXFromIndex(l),n=this.ChartFrame.GetYFromData(C.Value),s=this.ChartFrame.GetYFromData(C.Value2),this.IsHScreen?o[h]={Line:{X:n,Y:r},Line2:{X:s,Y:r}}:o[h]={Line:{X:r,Y:n},Line2:{X:r,Y:s}})}this.Canvas.fillStyle=this.Color;var\x20u=!0,D=0,d=[];for(var\x20h\x20in\x20o){var\x20c=o[h];if(c)u?(this.Canvas.beginPath(),this.Canvas.moveTo(c.Line.X,c.Line.Y),u=!1):this.Canvas.lineTo(c.Line.X,c.Line.Y),d.push(c),++D;else{if(D>0){for(l=d.length-1;l>=0;--l){var\x20m=d[l];this.Canvas.lineTo(m.Line2.X,m.Line2.Y)}this.Canvas.closePath(),this.Canvas.fill()}u=!0,D=0,d=[]}}if(D>0){for(l=d.length-1;l>=0;--l){m=d[l];this.Canvas.lineTo(m.Line2.X,m.Line2.Y)}this.Canvas.closePath(),this.Canvas.fill()}}},this.GetMaxMin=function(){for(var\x20t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var\x20r=this.Data.Data[a];if(r&&null!=r.Value&&null!=r.Value2){var\x20n=r.Value>r.Value2?r.Value:r.Value2,s=r.Value<r.Value2?r.Value:r.Value2;null==e.Max?e.Max=n:e.Max<n&&(e.Max=n),null==e.Min?e.Min=s:e.Min>s&&(e.Min=s)}}return\x20e}}function\x20ChartFillRGN(){this.newMethod=ChartLineArea,this.newMethod(),delete\x20this.newMethod,this.IsDrawFirst=!0,this.IsHScreen=!1,this.ClassName=\x22ChartFillRGN\x22,this.DrawRGB=function(t){var\x20e=!0,a=0,i=[],r=null;for(var\x20n\x20in\x20t){var\x20s=t[n];if(!s||r&&s.Color!=r){if(a>0){for(var\x20o=i.length-1;o>=0;--o){var\x20h=i[o];this.Canvas.lineTo(h.Line2.X,h.Line2.Y)}this.Canvas.closePath(),this.Canvas.fillStyle=r,this.Canvas.fill()}e=!0,a=0,i=[],r=null}s&&(e?(this.Canvas.beginPath(),this.Canvas.moveTo(s.Line.X,s.Line.Y),e=!1,r=s.Color):this.Canvas.lineTo(s.Line.X,s.Line.Y),i.push(s),++a)}if(a>0){for(o=i.length-1;o>=0;--o){h=i[o];this.Canvas.lineTo(h.Line2.X,h.Line2.Y)}this.Canvas.closePath(),this.Canvas.fillStyle=r,this.Canvas.fill()}},this.Draw=function(){if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(this.Data&&this.Data.Data){for(var\x20t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+g_JSChartResource.FrameLeftMargin,r=0,n=0,s=0,o=[],h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<a;++h,++l,i+=t+e){var\x20C=this.Data.Data[h];o[h]=null,null!=C&&null!=C.Value&&null!=C.Value2&&C.Color&&(r=this.ChartFrame.GetXFromIndex(l),n=this.ChartFrame.GetYFromData(C.Value),s=this.ChartFrame.GetYFromData(C.Value2),this.IsHScreen?o[h]={Line:{X:n,Y:r},Line2:{X:s,Y:r},Color:C.Color}:o[h]={Line:{X:r,Y:n},Line2:{X:r,Y:s},Color:C.Color})}this.DrawRGB(o)}}}function\x20ChartFLOATRGN(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.IsDrawFirst=!1,this.ClassName=\x22ChartFLOATRGN\x22,this.Color=\x22rgb(56,67,99)\x22,this.IsHScreen=!1,this.Draw=function(){if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(this.Data&&this.Data.Data){for(var\x20t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+g_JSChartResource.FrameLeftMargin,r=0,n=0,s=0,o=[],h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<a;++h,++l,i+=t+e){var\x20C=this.Data.Data[h];o[h]=null,C&&IFrameSplitOperator.IsNumber(C.Value)&&IFrameSplitOperator.IsNumber(C.Value2)&&C.Color&&(r=this.ChartFrame.GetXFromIndex(l),n=this.ChartFrame.GetYFromData(C.Value),this.IsHScreen?o[h]={Line:{X:n,Y:r},Line2:{X:n+C.Value2*GetDevicePixelRatio(),Y:r},Color:C.Color}:o[h]={Line:{X:r,Y:n},Line2:{X:r,Y:n-C.Value2*GetDevicePixelRatio()},Color:C.Color})}var\x20u=null;for(var\x20h\x20in\x20o){C=o[h];if(u&&C)if(this.IsHScreen){var\x20D=C.Line.Y-u.Line.Y;r=u.Line.Y+D/2,n=u.Line.X+(C.Line.X-u.Line.X)/2,s=u.Line2.X+(C.Line2.X-u.Line2.X)/2,u.RightLine={X:n,Y:r},u.RightLine2={X:s,Y:r},C.LeftLine={X:n,Y:r},C.LeftLine2={X:s,Y:r}}else{D=C.Line.X-u.Line.X;r=u.Line.X+D/2,n=u.Line.Y+(C.Line.Y-u.Line.Y)/2,s=u.Line2.Y+(C.Line2.Y-u.Line2.Y)/2,u.RightLine={X:r,Y:n},u.RightLine2={X:r,Y:s},C.LeftLine={X:r,Y:n},C.LeftLine2={X:r,Y:s}}u=C}this.DrawRGB(o)}},this.DrawRGB=function(t){var\x20e=!0,a=0,i=[],r=null;if(this.IsHScreen)var\x20n=this.ChartBorder.GetLeftEx(),s=this.ChartBorder.GetRightEx(),o=this.ChartBorder.GetTop(),h=this.ChartBorder.GetBottom();else\x20n=this.ChartBorder.GetLeft(),s=this.ChartBorder.GetRight(),o=this.ChartBorder.GetTopEx(),h=this.ChartBorder.GetBottomEx();for(var\x20l\x20in\x20this.Canvas.save(),this.Canvas.beginPath(),this.Canvas.rect(n,o,s-n,h-o),this.Canvas.clip(),t){var\x20C=t[l];if(!C||r&&C.Color!=r){if(a>0){var\x20u=i[i.length-1],D=i[0];u.RightLine&&(this.Canvas.lineTo(u.RightLine.X,u.RightLine.Y),this.Canvas.lineTo(u.RightLine2.X,u.RightLine2.Y));for(var\x20d=i.length-1;d>=0;--d){var\x20c=i[d];this.Canvas.lineTo(c.Line2.X,c.Line2.Y)}D.LeftLine2&&this.Canvas.lineTo(D.LeftLine2.X,D.LeftLine2.Y),this.Canvas.closePath(),this.Canvas.fillStyle=r,this.Canvas.fill()}e=!0,a=0,i=[],r=null}C&&(e?(this.Canvas.beginPath(),C.LeftLine?(this.Canvas.moveTo(C.LeftLine.X,C.LeftLine.Y),this.Canvas.lineTo(C.Line.X,C.Line.Y)):this.Canvas.moveTo(C.Line.X,C.Line.Y),e=!1,r=C.Color):this.Canvas.lineTo(C.Line.X,C.Line.Y),i.push(C),++a)}if(a>0){u=i[i.length-1],D=i[0];u.RightLine&&(this.Canvas.lineTo(u.RightLine.X,u.RightLine.Y),this.Canvas.lineTo(u.RightLine2.X,u.RightLine2.Y));for(d=i.length-1;d>=0;--d){c=i[d];this.Canvas.lineTo(c.Line2.X,c.Line2.Y)}D.LeftLine2&&this.Canvas.lineTo(D.LeftLine2.X,D.LeftLine2.Y),this.Canvas.closePath(),this.Canvas.fillStyle=r,this.Canvas.fill()}this.Canvas.restore()},this.GetMaxMin=function(){for(var\x20t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var\x20r=this.Data.Data[a];if(r&&IFrameSplitOperator.IsNumber(r.Value)){var\x20n=r.Value;null==e.Max?e.Max=n:e.Max<n&&(e.Max=n),null==e.Min?e.Min=n:e.Min>n&&(e.Min=n)}}return\x20e}}function\x20ChartFillBGRGN(){this.newMethod=ChartFillRGN,this.newMethod(),delete\x20this.newMethod,this.IsDrawFirst=!0,this.IsHScreen=!1,this.ClassName=\x22ChartFillBGRGN\x22,this.DrawVerticalRGN=function(){for(var\x20t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+g_JSChartResource.FrameLeftMargin,r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetBottomEx(),s=[],o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<a;++o,++h,i+=t+e){var\x20l=this.Data.Data[o];s[o]=null,l&&l.Color&&(x=this.ChartFrame.GetXFromIndex(h),this.IsHScreen?s[o]={Line:{X:r,Y:x},Line2:{X:n,Y:x},Color:l.Color}:s[o]={Line:{X:x,Y:r},Line2:{X:x,Y:n},Color:l.Color})}this.DrawRGB(s)},this.Draw=function(){if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(this.Data&&this.Data.Data)if(\x22FILLVERTICALRGN\x22!=this.Name){var\x20t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+g_JSChartResource.FrameLeftMargin,r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetBottomEx(),s=0,o=0,h=r;\x22FILLBOTTOMRGN\x22==this.Name&&(h=n);for(var\x20l=[],C=this.Data.DataOffset,u=0;C<this.Data.Data.length&&u<a;++C,++u,i+=t+e){var\x20D=this.Data.Data[C];l[C]=null,null!=D&&null!=D.Value&&D.Color&&(s=this.ChartFrame.GetXFromIndex(u),o=this.ChartFrame.GetYFromData(D.Value),this.IsHScreen?l[C]={Line:{X:o,Y:s},Line2:{X:h,Y:s},Color:D.Color}:l[C]={Line:{X:s,Y:o},Line2:{X:s,Y:h},Color:D.Color})}this.DrawRGB(l)}else\x20this.DrawVerticalRGN()},this.DrawRGB=function(t){var\x20e=this.ChartFrame.DataWidth,a=(this.ChartFrame.DistanceWidth+e)/2,i=!0,r=0,n=[],s=null;for(var\x20o\x20in\x20t){var\x20h=t[o];if(!h||s&&h.Color!=s){if(r>0){for(var\x20l=n.length-1;l>=0;--l){var\x20C=n[l];this.Canvas.lineTo(C.Line2.X+a,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-a,C.Line2.Y)}this.Canvas.closePath(),this.Canvas.fillStyle=s,this.Canvas.fill()}i=!0,r=0,n=[],s=null}h&&(i?(this.Canvas.beginPath(),this.Canvas.moveTo(h.Line.X-a,h.Line.Y),this.Canvas.lineTo(h.Line.X+a,h.Line.Y),i=!1,s=h.Color):(this.Canvas.lineTo(h.Line.X-a,h.Line.Y),this.Canvas.lineTo(h.Line.X+a,h.Line.Y)),n.push(h),++r)}if(r>0){for(l=n.length-1;l>=0;--l){C=n[l];this.Canvas.lineTo(C.Line2.X+a,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-a,C.Line2.Y)}this.Canvas.closePath(),this.Canvas.fillStyle=s,this.Canvas.fill()}},this.GetMaxMin=function(){for(var\x20t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){if((r=this.Data.Data[a])&&null!=r.Value){var\x20r=r.Value;null==e.Max?e.Max=r:e.Max<r&&(e.Max=r),null==e.Min?e.Min=r:e.Min>r&&(e.Min=r)}}return\x20e}}function\x20ChartChannel(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.IsDrawFirst=!0,this.ClassName=\x22ChartChannel\x22,this.IsHScreen=!1,this.PointCount=0,this.DataWidth=0,this.DistanceWidth=0,this.ChartRight=0,this.LineColor=\x22RGB(255,0,0)\x22,this.LineDotted=[3,3],this.AreaColor=\x22RGB(255,222,173)\x22,this.LineWidth=1,this.CalculateData=function(){for(var\x20t=[],e=[],a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<this.PointCount;++a,++i){var\x20r=this.Data.Data[a];if(r&&IFrameSplitOperator.IsNumber(r.Value)&&IFrameSplitOperator.IsNumber(r.Value2)){var\x20n=this.ChartFrame.GetXFromIndex(i);if(n>this.ChartRight)break;var\x20s=this.ChartFrame.GetYFromData(r.Value),o=this.ChartFrame.GetYFromData(r.Value2);e.push({X:n,Y:s,Y2:o})}else\x20e.length>0&&(t.push(e),e=[])}return\x20e.length>0&&t.push(e),t},this.DrawArea=function(t){if(!(t.length<=0)){this.Canvas.beginPath();var\x20e=t[0];this.IsHScreen?this.Canvas.moveTo(e.Y,e.X):this.Canvas.moveTo(e.X,e.Y);for(var\x20a=1;a<t.length;++a){var\x20i=t[a];this.IsHScreen?this.Canvas.lineTo(i.Y,i.X):this.Canvas.lineTo(i.X,i.Y),0}for(a=t.length-1;a>=0;--a){i=t[a];this.IsHScreen?this.Canvas.lineTo(i.Y2,i.X):this.Canvas.lineTo(i.X,i.Y2),0}this.Canvas.closePath(),this.Canvas.fillStyle=this.AreaColor,this.Canvas.fill()}},this.DrawLine=function(t){this.Canvas.strokeStyle=this.LineColor;for(var\x20e=0;e<2;++e){for(var\x20a=!0,i=0,r=0;r<t.length;++r){var\x20n=t[r];a?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(0===e?n.Y:n.Y2,n.X):this.Canvas.moveTo(n.X,0===e?n.Y:n.Y2),a=!1):this.IsHScreen?this.Canvas.lineTo(0===e?n.Y:n.Y2,n.X):this.Canvas.lineTo(n.X,0===e?n.Y:n.Y2),++i}i>0&&this.Canvas.stroke()}},this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else{this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.PointCount=this.ChartFrame.XPointCount,this.DataWidth=this.ChartFrame.DataWidth,this.DistanceWidth=this.ChartFrame.DistanceWidth,this.IsHScreen?this.ChartRight=this.ChartBorder.GetBottom():this.ChartRight=this.ChartBorder.GetRight();var\x20t=this.CalculateData();if(t&&!(t.length<=0)){this.Canvas.save(),this.Canvas.lineWidth=this.LineWidth*GetDevicePixelRatio(),this.Canvas.setLineDash(this.LineDotted);for(var\x20e=0;e<t.length;++e){var\x20a=t[e];this.DrawArea(a),this.DrawLine(a)}this.Canvas.restore()}}},this.GetMaxMin=function(){for(var\x20t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var\x20r=this.Data.Data[a];if(null!=r&&null!=r.Value&&null!=r.Value2){var\x20n=r.Value>r.Value2?r.Value:r.Value2,s=r.Value<r.Value2?r.Value:r.Value2;null==e.Max?e.Max=n:e.Max<n&&(e.Max=n),null==e.Min?e.Min=s:e.Min>s&&(e.Min=s)}}return\x20e}}function\x20ChartBackground(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartBackground\x22,this.Color=null,this.ColorAngle=0,this.IsDrawFirst=!0,this.Draw=function(){if(this.IsShow&&this.Color&&!(this.Color.length<=0)){if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,2==this.Color.length){if(this.IsHScreen)if(0==this.ColorAngle)var\x20t={X:this.ChartBorder.GetRight(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()};else\x20t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetBottomEx()};else\x20if(0==this.ColorAngle)t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetBottomEx()};else\x20t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetRight(),Y:this.ChartBorder.GetTopEx()};let\x20a=this.Canvas.createLinearGradient(t.X,t.Y,e.X,e.Y);a.addColorStop(0,this.Color[0]),a.addColorStop(1,this.Color[1]),this.Canvas.fillStyle=a}else{if(1!=this.Color.length)return;this.Canvas.fillStyle=this.Color[0]}if(\x22DRAWGBK2\x22!=this.Name&&\x22KLINE_BG\x22!=this.Name){if(this.IsHScreen)var\x20a=this.ChartBorder.GetLeftEx(),i=this.ChartBorder.GetTop(),r=this.ChartBorder.GetWidthEx(),n=this.ChartBorder.GetHeight();else\x20a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetTopEx(),r=this.ChartBorder.GetWidth(),n=this.ChartBorder.GetHeightEx();this.Canvas.fillRect(a,i,r,n)}else\x20this.DrawRegion()}},this.DrawRegion=function(){var\x20t=this.ChartFrame.XPointCount,e=this.ChartBorder.GetLeft()+i/2+g_JSChartResource.FrameLeftMargin,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetBottomEx();this.IsHScreen&&(r=this.ChartBorder.GetRightEx(),n=this.ChartBorder.GetLeftEx());for(var\x20s=[],o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<t;++o,++h,e+=a+i){var\x20l=this.Data.Data[o];if(s[o]=null,IFrameSplitOperator.IsNumber(l)&&!(l<=0)){var\x20C=this.ChartFrame.GetXFromIndex(h);this.ChartFrame.GetYFromData(l.Value);this.IsHScreen?s[o]={Line:{X:n,Y:C},Line2:{X:r,Y:C}}:s[o]={Line:{X:C,Y:r},Line2:{X:C,Y:n}}}}this.DrawBG(s)},this.DrawBG=function(t){var\x20e=this.ChartFrame.DataWidth,a=(this.ChartFrame.DistanceWidth+e)/2,i=!0,r=0,n=[],s=null;for(var\x20o\x20in\x20t){var\x20h=t[o];if(!h||s&&h.Color!=s){if(r>0){for(var\x20l=n.length-1;l>=0;--l){var\x20C=n[l];this.IsHScreen?(this.Canvas.lineTo(C.Line2.X,C.Line2.Y+a),this.Canvas.lineTo(C.Line2.X,C.Line2.Y-a)):(this.Canvas.lineTo(C.Line2.X+a,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-a,C.Line2.Y))}this.Canvas.closePath(),this.Canvas.fill()}i=!0,r=0,n=[],s=null}h&&(i?(this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(h.Line.X,h.Line.Y-a),this.Canvas.lineTo(h.Line.X,h.Line.Y+a)):(this.Canvas.moveTo(h.Line.X-a,h.Line.Y),this.Canvas.lineTo(h.Line.X+a,h.Line.Y)),i=!1,s=h.Color):this.IsHScreen?(this.Canvas.lineTo(h.Line.X,h.Line.Y-a),this.Canvas.lineTo(h.Line.X,h.Line.Y+a)):(this.Canvas.lineTo(h.Line.X-a,h.Line.Y),this.Canvas.lineTo(h.Line.X+a,h.Line.Y)),n.push(h),++r)}if(r>0){for(l=n.length-1;l>=0;--l){C=n[l];this.IsHScreen?(this.Canvas.lineTo(C.Line2.X,C.Line2.Y+a),this.Canvas.lineTo(C.Line2.X,C.Line2.Y-a)):(this.Canvas.lineTo(C.Line2.X+a,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-a,C.Line2.Y))}this.Canvas.closePath(),this.Canvas.fill()}},this.GetMaxMin=function(){return{Min:null,Max:null}}}function\x20ChartRectangle(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartRectangle\x22,this.Color=[],this.Rect,this.BorderColor=g_JSChartResource.FrameBorderPen,this.Draw=function(){if(this.IsShow&&this.Color&&this.Rect&&!(this.Color.length<=0)){this.Canvas.strokeStyle=this.BorderColor;var\x20t=!1;if(2==this.Color.length)this.Canvas.fillStyle=this.Color[0],t=!0;else{if(1!=this.Color.length)return;this.Color[0]&&(this.Canvas.fillStyle=this.Color[0],t=!0)}var\x20e=this.ChartBorder.GetWidth(),a=this.ChartBorder.GetHeightEx(),i=this.Rect.Left/1e3*e,r=this.Rect.Top/1e3*a,n=this.Rect.Right/1e3*e,s=this.Rect.Bottom/1e3*a;i=this.ChartBorder.GetLeft()+i,r=this.ChartBorder.GetTopEx()+r,n=this.ChartBorder.GetLeft()+n,s=this.ChartBorder.GetTopEx()+s;var\x20o=Math.abs(i-n),h=Math.abs(r-s);t&&this.Canvas.fillRect(i,r,o,h),this.Canvas.rect(ToFixedPoint(i),ToFixedPoint(r),ToFixedRect(o),ToFixedRect(h)),this.Canvas.stroke()}}}function\x20ChartTextLine(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartTextLine\x22,this.Text,this.Line,this.Price,this.Draw=function(){if(this.IsShow&&this.Text&&this.Line&&IFrameSplitOperator.IsNumber(this.Price)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var\x20t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetBottomEx(),i=this.ChartBorder.GetTopEx(),r=this.ChartFrame.GetYFromData(this.Price),n=0;if(this.Text.Title){var\x20s=t+2*GetDevicePixelRatio(),o=r;this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22;var\x20h=8*GetDevicePixelRatio();r-h<i?(this.Canvas.textBaseline=\x22top\x22,o=i):r+h>a&&(this.Canvas.textBaseline=\x22bottom\x22,o=a),this.Canvas.fillStyle=this.Text.Color,this.Canvas.font=this.Text.Font,this.Canvas.fillText(this.Text.Title,s,o),n=this.Canvas.measureText(this.Text.Title).width+4*GetDevicePixelRatio()}if(this.Line.Type>0){2==this.Line.Type&&(this.Canvas.save(),this.Canvas.setLineDash([3,5]));s=t+n;this.Canvas.strokeStyle=this.Line.Color,this.Canvas.beginPath(),this.Canvas.moveTo(s,ToFixedPoint(r)),this.Canvas.lineTo(e,ToFixedPoint(r)),this.Canvas.stroke(),2==this.Line.Type&&this.Canvas.restore()}}},this.GetMaxMin=function(){var\x20t={Min:null,Max:null};return\x20IFrameSplitOperator.IsNumber(this.Price)&&(t.Min=this.Price,t.Max=this.Price),t}}function\x20ChartMultiBar(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartMultiBar\x22,this.Bars=[],this.IsHScreen=!1,this.Draw=function(){if(this.IsShow&&this.Data&&!(this.Data.length<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var\x20t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=this.ChartFrame.DataWidth,i=GetDevicePixelRatio(),r=[];for(var\x20n\x20in\x20this.Bars){var\x20s={Point:[],Color:(d=this.Bars[n]).Color,Width:a,Type:0};for(var\x20o\x20in\x20d.Type>0&&(s.Type=d.Type),d.Width>0?(s.Width=d.Width*i,s.Width>a&&(s.Width=a)):s.Width<4&&(s.Width=1*i),d.Point){var\x20h=d.Point[o];if(IFrameSplitOperator.IsNumber(h.Index)){var\x20l=h.Index-e;if(l>=0&&l<t){var\x20C=this.ChartFrame.GetXFromIndex(l),u=this.ChartFrame.GetYFromData(h.Value),D=this.ChartFrame.GetYFromData(h.Value2);s.Point.push({X:C,Y:u,Y2:D})}}}s.Point.length>0&&r.push(s)}for(var\x20n\x20in\x20r){var\x20d;(d=r[n]).Width>=4?1==d.Type?this.DrawHollowBar(d):this.DrawFillBar(d):this.DrawLineBar(d)}}},this.DrawLineBar=function(t){this.Canvas.strokeStyle=t.Color;var\x20e=this.Canvas.lineWidth;for(var\x20a\x20in\x20this.Canvas.lineWidth=t.Width,t.Point){var\x20i=t.Point[a];this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(ToFixedPoint(i.Y),ToFixedPoint(i.X)),this.Canvas.lineTo(ToFixedPoint(i.Y2),ToFixedPoint(i.X))):(this.Canvas.moveTo(ToFixedPoint(i.X),ToFixedPoint(i.Y)),this.Canvas.lineTo(ToFixedPoint(i.X),ToFixedPoint(i.Y2))),this.Canvas.stroke()}this.Canvas.lineWidth=e},this.DrawFillBar=function(t){for(var\x20e\x20in\x20this.Canvas.fillStyle=t.Color,t.Point){var\x20a=t.Point[e],i=a.X-t.Width/2,r=Math.min(a.Y,a.Y2),n=t.Width,s=Math.abs(a.Y-a.Y2);this.IsHScreen?this.Canvas.fillRect(ToFixedRect(r),ToFixedRect(i),ToFixedRect(s),ToFixedRect(n)):this.Canvas.fillRect(ToFixedRect(i),ToFixedRect(r),ToFixedRect(n),ToFixedRect(s))}},this.DrawHollowBar=function(t){this.Canvas.strokeStyle=t.Color;for(var\x20e\x20in\x20t.Point){var\x20a=t.Point[e],i=a.X-t.Width/2,r=Math.min(a.Y,a.Y2),n=t.Width,s=Math.abs(a.Y-a.Y2);this.Canvas.beginPath(),this.IsHScreen?this.Canvas.rect(ToFixedPoint(r),ToFixedPoint(i),ToFixedRect(s),ToFixedRect(n)):this.Canvas.rect(ToFixedPoint(i),ToFixedPoint(r),ToFixedRect(n),ToFixedRect(s)),this.Canvas.stroke()}this.Canvas.lineWidth=1},this.GetMaxMin=function(){var\x20t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var\x20r\x20in\x20this.Bars){var\x20n=this.Bars[r];for(var\x20s\x20in\x20n.Point){var\x20o=n.Point[s];if(o.Index>=a&&o.Index<i){var\x20h=Math.min(o.Value,o.Value2),l=Math.max(o.Value,o.Value2);null==t.Max?t.Max=l:t.Max<l&&(t.Max=l),null==t.Min?t.Min=h:t.Min>h&&(t.Min=h)}}}return\x20t}}function\x20ChartMultiLine(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartMultiLine\x22,this.Lines=[],this.LineDash,this.IsHScreen=!1,this.Draw=function(){if(this.IsShow&&this.Data&&!(this.Data.length<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var\x20t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=[];for(var\x20i\x20in\x20this.Lines){var\x20r=this.Lines[i],n={Point:[],Color:r.Color};for(var\x20s\x20in\x20r.BGColor&&(n.BGColor=r.BGColor),r.Point){var\x20o=r.Point[s];if(IFrameSplitOperator.IsNumber(o.Index)){var\x20h=o.Index-e;if(h>=0&&h<t){var\x20l=this.ChartFrame.GetXFromIndex(h),C=this.ChartFrame.GetYFromData(o.Value);n.Point.push({X:l,Y:C,End:!1})}else\x20n.Point.length>0&&(n.Point[n.Point.length-1].End=!0)}}n.Point.length>=2&&a.push(n)}for(var\x20i\x20in\x20this.Canvas.save(),this.LineDash&&this.Canvas.setLineDash(this.LineDash),a){var\x20u=a[i];this.DrawLine(u)}this.Canvas.restore()}},this.DrawLine=function(t){if(t.BGColor){for(var\x20e\x20in\x20this.Canvas.fillStyle=t.BGColor,t.Point){var\x20a=t.Point[e];0==e?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(a.Y,a.X):this.Canvas.moveTo(a.X,a.Y)):this.IsHScreen?this.Canvas.lineTo(a.Y,a.X):this.Canvas.lineTo(a.X,a.Y)}this.Canvas.closePath(),this.Canvas.fill()}this.Canvas.strokeStyle=t.Color;var\x20i=0;for(var\x20e\x20in\x20t.Point){a=t.Point[e];0==i?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(a.Y,a.X):this.Canvas.moveTo(a.X,a.Y),++i):(this.IsHScreen?this.Canvas.lineTo(a.Y,a.X):this.Canvas.lineTo(a.X,a.Y),++i),1==a.End&&(i>0&&this.Canvas.stroke(),i=0)}i>0&&this.Canvas.stroke()},this.GetMaxMin=function(){var\x20t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var\x20r\x20in\x20this.Lines){var\x20n=this.Lines[r];for(var\x20s\x20in\x20n.Point){var\x20o=n.Point[s];o.Index>=a&&o.Index<i&&(null==t.Max?t.Max=o.Value:t.Max<o.Value&&(t.Max=o.Value),null==t.Min?t.Min=o.Value:t.Min>o.Value&&(t.Min=o.Value))}}return\x20t}}function\x20ChartMultiText(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartMultiText\x22,this.Texts=[],this.Font=g_JSChartResource.DefaultTextFont,this.Color=g_JSChartResource.DefaultTextColor,this.IsHScreen=!1,this.Draw=function(){if(this.IsShow&&this.Data&&!(this.Data.length<=0)&&this.Texts){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var\x20t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetRight();for(var\x20r\x20in\x20this.IsHScreen&&(a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom()),this.Texts){var\x20n=this.Texts[r];if(n.Text&&IFrameSplitOperator.IsNumber(n.Index)){var\x20s=n.Index-e;if(s>=0&&s<t){var\x20o=this.ChartFrame.GetXFromIndex(s),h=this.ChartFrame.GetYFromData(n.Value);n.Color?this.Canvas.fillStyle=n.Color:this.Canvas.fillStyle=this.Color,n.Font?this.Canvas.font=n.Font:this.Canvas.font=this.Font;var\x20l=this.Canvas.measureText(n.Text).width;if(this.Canvas.textAlign=\x22center\x22,o+l/2>=i?(this.Canvas.textAlign=\x22right\x22,o=i):o-l/2<a&&(this.Canvas.textAlign=\x22left\x22,o=a),1==n.Baseline?this.Canvas.textBaseline=\x22top\x22:2==n.Baseline?this.Canvas.textBaseline=\x22bottom\x22:this.Canvas.textBaseline=\x22middle\x22,this.IsHScreen?(this.Canvas.save(),this.Canvas.translate(h,o),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(n.Text,0,0),this.Canvas.restore()):this.Canvas.fillText(n.Text,o,h),n.Line){var\x20C=this.Data.Data[n.Index],u=\x22H\x22==n.Line.KData?C.High:C.Low,D=this.ChartFrame.GetYFromData(u),d=h;Array.isArray(n.Line.Offset)&&2==n.Line.Offset.length&&(d>D?(d-=n.Line.Offset[1],D+=n.Line.Offset[0]):d<D&&(d+=n.Line.Offset[1],D-=n.Line.Offset[0])),this.Canvas.save(),n.Line.Dash&&this.Canvas.setLineDash(n.Line.Dash),n.Line.Width>0&&(this.Canvas.lineWidth=n.Line.Width),this.Canvas.strokeStyle=n.Line.Color,this.Canvas.beginPath(),this.Canvas.moveTo(ToFixedPoint(o),d),this.Canvas.lineTo(ToFixedPoint(o),D),this.Canvas.stroke(),this.Canvas.restore()}}}}}},this.GetMaxMin=function(){var\x20t={Min:null,Max:null};if(!this.Texts)return\x20t;var\x20e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var\x20r\x20in\x20this.Texts){var\x20n=this.Texts[r];n.Index>=a&&n.Index<i&&(null==t.Max?t.Max=n.Value:t.Max<n.Value&&(t.Max=n.Value),null==t.Min?t.Min=n.Value:t.Min>n.Value&&(t.Min=n.Value))}return\x20t}}function\x20ChartMultiSVGIcon(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartMultiSVGIcon\x22,this.Icon,this.IconSize={Max:g_JSChartResource.DRAWICON.Icon.MaxSize,Min:g_JSChartResource.DRAWICON.Icon.MinSize,Zoom:{Type:g_JSChartResource.DRAWICON.Icon.Zoom.Type,Value:g_JSChartResource.DRAWICON.Icon.Zoom.Value}},this.Family,this.Color=g_JSChartResource.DefaultTextColor,this.IsHScreen=!1,this.Draw=function(){if(this.IsShow&&this.Data&&!(this.Data.length<=0)&&this.Family&&this.Icon){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var\x20t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetRight();this.DataWidth=this.ChartFrame.DataWidth,this.DistanceWidth=this.ChartFrame.DistanceWidth,this.IsHScreen&&(a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom());var\x20r=this.GetDynamicIconSize(this.DataWidth,this.DistanceWidth,this.IconSize.Max,this.IconSize.Min,this.IconSize.Zoom);for(var\x20n\x20in\x20this.Canvas.font=r+\x22px\x20\x22+this.Family,this.Icon){var\x20s=this.Icon[n];if(IFrameSplitOperator.IsNumber(s.Index)){var\x20o=s.Index-e;if(o>=0&&o<t){var\x20h=this.ChartFrame.GetXFromIndex(o),l=this.ChartFrame.GetYFromData(s.Value);s.Color?this.Canvas.fillStyle=s.Color:this.Canvas.fillStyle=this.Color;var\x20C=this.Canvas.measureText(s.Text).width;this.Canvas.textAlign=\x22center\x22,h+C/2>=i?(this.Canvas.textAlign=\x22right\x22,h+=this.DataWidth/2):h-C/2<a&&(this.Canvas.textAlign=\x22left\x22,h-=this.DataWidth/2),1==s.Baseline?this.Canvas.textBaseline=\x22top\x22:2==s.Baseline?this.Canvas.textBaseline=\x22bottom\x22:this.Canvas.textBaseline=\x22middle\x22,this.IsHScreen?(this.Canvas.save(),this.Canvas.translate(l,h),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(s.Symbol,0,0),this.Canvas.restore()):this.Canvas.fillText(s.Symbol,h,l)}}}}},this.GetMaxMin=function(){var\x20t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var\x20r\x20in\x20this.Icon){var\x20n=this.Icon[r];n.Index>=a&&n.Index<i&&(null==t.Max?t.Max=n.Value:t.Max<n.Value&&(t.Max=n.Value),null==t.Min?t.Min=n.Value:t.Min>n.Value&&(t.Min=n.Value))}return\x20t}}function\x20ChartLock(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartLock\x22,this.WidthDiv=.2,this.LockCount=20,this.BGColor=g_JSChartResource.LockBGColor,this.TextColor=g_JSChartResource.LockTextColor,this.Font=g_JSChartResource.DefaultTextFont,this.Title=\x22🔒开通权限\x22,this.LockRect=null,this.LockID,this.Callback,this.IndexName,this.MinWidth=null,this.Draw=function(t){if(this.LockRect=null,this.NotSupportMessage)this.DrawNotSupportmessage();else\x20if(!0!==this.ChartFrame.IsHScreen){var\x20e=this.ChartBorder.GetRight(),a=0;if(null!=this.ChartFrame.Data){var\x20i=this.ChartFrame.DataWidth,r=this.ChartFrame.DistanceWidth;e=this.ChartBorder.GetLeft()+r/2+2;for(var\x20n=this.ChartBorder.GetRight(),s=this.ChartFrame.XPointCount,o=this.ChartFrame.Data.DataOffset,h=0;o<this.ChartFrame.Data.Data.length&&h<s;++o,++h,e+=i+r){var\x20l=this.ChartFrame.Data.Data[o];if(null!=l.Open&&null!=l.High&&null!=l.Low&&null!=l.Close){if(e+i>n)break}}a=(i+r)*this.LockCount}0==a&&(a=(e-this.ChartBorder.GetLeft())*this.WidthDiv);var\x20C=e-a;C<this.ChartBorder.GetLeft()&&(C=this.ChartBorder.GetLeft());var\x20u=this.ChartBorder.GetBottom()-this.ChartBorder.GetTop(),D=this.ChartBorder.GetRight()-C;if(this.MinWidth>10&&D<this.MinWidth&&(D=this.MinWidth,(C=this.ChartBorder.GetRight()-D)<this.ChartBorder.GetLeft()&&(C=this.ChartBorder.GetLeft())),t){this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(C,this.ChartBorder.GetTop(),D,u);var\x20d=C+D/2,c=this.ChartBorder.GetTop()+u/2;this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.Title,d,c)}this.LockRect={Left:C,Top:this.ChartBorder.GetTop(),Width:D,Heigh:u}}else\x20this.HScreenDraw(t)},this.HScreenDraw=function(t){var\x20e=this.ChartBorder.GetBottom(),a=0;if(null!=this.ChartFrame.Data){var\x20i=this.ChartFrame.DataWidth,r=this.ChartFrame.DistanceWidth;e=this.ChartBorder.GetTop()+r/2+2;for(var\x20n=this.ChartBorder.GetBottom(),s=this.ChartFrame.XPointCount,o=this.ChartFrame.Data.DataOffset,h=0;o<this.ChartFrame.Data.Data.length&&h<s;++o,++h,e+=i+r){var\x20l=this.ChartFrame.Data.Data[o];if(null!=l.Open&&null!=l.High&&null!=l.Low&&null!=l.Close){if(e+i>n)break}}a=(i+r)*this.LockCount}0==a&&(a=(e-this.ChartBorder.GetTop())*this.WidthDiv);var\x20C=e-a;C<this.ChartBorder.GetTop()&&(C=this.ChartBorder.GetTop());var\x20u=this.ChartBorder.GetRight()-this.ChartBorder.GetLeft(),D=this.ChartBorder.GetBottom()-C;this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(this.ChartBorder.GetLeft(),C,u,D);var\x20d=this.ChartBorder.GetLeft()+u/2,c=C+D/2;this.Canvas.save(),this.Canvas.translate(d,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.Title,0,0),this.Canvas.restore(),this.LockRect={Left:this.ChartBorder.GetLeft(),Top:C,Width:u,Heigh:D}},this.GetTooltipData=function(t,e,a){return\x20null!=this.LockRect&&(this.Canvas.beginPath(),this.Canvas.rect(this.LockRect.Left,this.LockRect.Top,this.LockRect.Width,this.LockRect.Heigh),!!this.Canvas.isPointInPath(t,e)&&(a.Data={ID:this.LockID,Callback:this.Callback,IndexName:this.IndexName},a.ChartPaint=this,!0))}}function\x20ChartBuySell(){this.newMethod=ChartSingleText,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartBuySell\x22,this.TextFont=g_JSChartResource.KLineTrain.Font,this.LastDataIcon=g_JSChartResource.KLineTrain.LastDataIcon,this.BuyIcon=g_JSChartResource.KLineTrain.BuyIcon,this.SellIcon=g_JSChartResource.KLineTrain.SellIcon,this.BuySellData=new\x20Map,this.IconFont=g_JSChartResource.KLineTrain.IconFont,this.AddTradeItem=function(t){this.BuySellData.has(t.Key)?this.BuySellData.get(t.Key).Data.push(t):this.BuySellData.set(t.Key,{Data:[t]})},this.ClearTradeData=function(){this.BuySellData=new\x20Map},this.Draw=function(){if(this.Data&&this.Data.Data){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetRight();!0===t&&(i=this.ChartBorder.GetBottom());var\x20r=this.ChartFrame.XPointCount;if(this.IconFont){var\x20n=e+a,s=18*GetDevicePixelRatio();n<s&&(n=s),this.Canvas.font=n+\x22px\x20\x22+this.IconFont.Family}else\x20this.Canvas.font=this.TextFont;for(var\x20o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<r;++o,++h){var\x20l=this.Data.Data[o];if(null!=l){if((C=this.ChartFrame.GetXFromIndex(h))>i)break;if(o==this.Data.Data.length-1){var\x20C=this.ChartFrame.GetXFromIndex(h),u=this.ChartFrame.GetYFromData(l.High);this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22bottom\x22,this.IconFont?(this.Canvas.fillStyle=this.IconFont.Last.Color,this.DrawText(this.IconFont.Last.Text,C,u,t)):(this.Canvas.fillStyle=this.LastDataIcon.Color,this.Canvas.font=this.TextFont,this.DrawText(this.LastDataIcon.Text,C,u,t))}var\x20D=o;if(this.BuySellData.has(D)){var\x20d=this.BuySellData.get(D),c=(u=this.ChartFrame.GetYFromData(l.High),this.ChartFrame.GetYFromData(l.Low)),m=[!1,!1];for(var\x20f\x20in\x20d.Data){if(1==m[0]&&1==m[1])break;var\x20v=d.Data[f];0==v.Op&&0==m[0]?(this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22top\x22,this.IconFont?(this.Canvas.fillStyle=this.IconFont.Buy.Color,this.DrawText(this.IconFont.Buy.Text,C,c,t)):(this.Canvas.fillStyle=this.BuyIcon.Color,this.DrawText(this.BuyIcon.Text,C,c,t)),m[0]=!0):1==v.Op&&0==m[1]&&(this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22bottom\x22,this.IconFont?(this.Canvas.fillStyle=this.IconFont.Sell.Color,this.DrawText(this.IconFont.Sell.Text,C,u,t)):(this.Canvas.fillStyle=this.SellIcon.Color,this.DrawText(this.SellIcon.Text,C,u,t)),m[1]=!0)}}}}}}}function\x20ChartPie(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.Radius=100,this.Distance=30,this.txtLine=20,this.paddingX=20/3,this.Draw=function(){if(!(this.Data&&this.Data.Data&&this.Data.Data.length>0))return\x20this.DrawEmptyData();this.ChartBorder.GetLeft(),this.ChartBorder.GetRight(),this.ChartBorder.GetTop(),this.ChartBorder.GetBottom();let\x20t=this.ChartBorder.GetWidth(),e=this.ChartBorder.GetHeight();if(isNaN(this.Radius)){let\x20a=this.Radius.replace(\x22%\x22,\x22\x22);a/=100,t>=e&&(this.Radius=a*e),t<e&&(this.Radius=a*t)}this.Canvas.save(),this.Canvas.translate(t/2,e/2);let\x20a=0;for(var\x20i\x20in\x20this.Data.Data)a+=this.Data.Data[i].Value;let\x20r=0,n=0;for(var\x20i\x20in\x20this.Data.Data){let\x20t=this.Data.Data[i],e=(t.Value/a).toFixed(2);this.Canvas.beginPath(),this.Canvas.moveTo(0,0),n+=2*e*Math.PI,this.Canvas.strokeStyle=\x22white\x22,this.Canvas.fillStyle=t.Color,this.Canvas.arc(0,0,this.Radius,r,n),this.Canvas.fill(),this.Canvas.closePath(),this.Canvas.stroke(),this.Canvas.beginPath(),this.Canvas.strokeStyle=t.Color,this.Canvas.moveTo(0,0);let\x20s=(this.Radius+this.Distance)*Math.cos(n-(n-r)/2),o=(this.Radius+this.Distance)*Math.sin(n-(n-r)/2);this.Canvas.lineTo(s,o);let\x20h=this.txtLine,l=this.paddingX;if(this.Canvas.textAlign=\x22left\x22,n-(n-r)/2<1.5*Math.PI&&n-(n-r)/2>.5*Math.PI&&(h=-this.txtLine,l=-this.paddingX,this.Canvas.textAlign=\x22right\x22),this.Canvas.lineTo(s+h,o),this.Canvas.stroke(),t.Text)this.Canvas.fillText(t.Text,s+h+l,o);else{let\x20e=`${t.Name}:${t.Value}`;this.Canvas.fillText(e,s+h+l,o)}r+=2*e*Math.PI}this.Canvas.restore()},this.DrawEmptyData=function(){JSConsole.Chart.Log(\x22[ChartPie::DrawEmptyData]\x22)}}function\x20ChartRadar(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.BorderPoint=[],this.DataPoint=[],this.CenterPoint={},this.StartAngle=0,this.Color=\x22rgb(198,198,198)\x22,this.AreaColor=\x22rgba(242,154,118,0.4)\x22,this.AreaLineColor=\x22rgb(242,154,118)\x22,this.TitleFont=24*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,this.TitleColor=\x22rgb(102,102,102)\x22,this.BGColor=[\x22rgb(255,255,255)\x22,\x22rgb(224,224,224)\x22],this.DrawBorder=function(){if(this.BorderPoint.length<=0)return;this.Canvas.font=this.TitleFont,this.Canvas.strokeStyle=this.Color;const\x20t=[1,.8,.6,.4,.2];for(let\x20n\x20in\x20t){var\x20e=t[n],a=!0;for(var\x20i\x20in\x20this.BorderPoint){(r=this.BorderPoint[i]).X=this.CenterPoint.X+r.Radius*Math.cos(r.Angle*Math.PI/180)*e,r.Y=this.CenterPoint.Y+r.Radius*Math.sin(r.Angle*Math.PI/180)*e,a?(this.Canvas.beginPath(),this.Canvas.moveTo(r.X,r.Y),a=!1):this.Canvas.lineTo(r.X,r.Y)}this.Canvas.closePath(),this.Canvas.stroke(),this.Canvas.fillStyle=this.BGColor[n%2==0?0:1],this.Canvas.fill()}for(var\x20i\x20in\x20this.Canvas.beginPath(),this.BorderPoint){var\x20r;(r=this.BorderPoint[i]).X=this.CenterPoint.X+r.Radius*Math.cos(r.Angle*Math.PI/180),r.Y=this.CenterPoint.Y+r.Radius*Math.sin(r.Angle*Math.PI/180),this.Canvas.moveTo(this.CenterPoint.X,this.CenterPoint.Y),this.Canvas.lineTo(r.X,r.Y),this.DrawText(r)}this.Canvas.stroke()},this.DrawArea=function(){if(this.DataPoint&&!(this.DataPoint.length<=0)){this.Canvas.fillStyle=this.AreaColor,this.Canvas.strokeStyle=this.AreaLineColor,this.Canvas.beginPath();var\x20t=!0;for(var\x20e\x20in\x20this.DataPoint){var\x20a=this.DataPoint[e];t?(this.Canvas.beginPath(),this.Canvas.moveTo(a.X,a.Y),t=!1):this.Canvas.lineTo(a.X,a.Y)}this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke()}},this.DrawText=function(t){if(t.Text){this.Canvas.fillStyle=this.TitleColor;var\x20e=t.X,a=t.Y;t.Angle>0&&t.Angle<45?(this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,e+=2):t.Angle>=0&&t.Angle<90?(this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22top\x22,e+=2):t.Angle>=90&&t.Angle<135?(this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22top\x22,e-=2):t.Angle>=135&&t.Angle<180?(this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22top\x22,e-=2):t.Angle>=180&&t.Angle<225?(this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22,e-=2):t.Angle>=225&&t.Angle<=270?(this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22bottom\x22):t.Angle>270&&t.Angle<315?(this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22bottom\x22,e+=2):(this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,e+=2),this.Canvas.fillText(t.Text,e,a)}},this.Draw=function(){this.BorderPoint=[],this.DataPoint=[],this.CenterPoint={},this.Data&&this.Data.Data&&this.Data.Data.length>0?this.CalculatePoints(this.Data.Data):this.CalculatePoints(null),this.DrawBorder(),this.DrawArea()},this.CalculatePoints=function(t){let\x20e=this.ChartBorder.GetLeft(),a=(this.ChartBorder.GetRight(),this.ChartBorder.GetTop()),i=(this.ChartBorder.GetBottom(),this.ChartBorder.GetWidth()),r=this.ChartBorder.GetHeight(),n={X:e+i/2,Y:a+r/2},s=Math.min(i/2,r/2)-2,o=Math.max(5,t?t.length:0),h=360/o;for(var\x20l=0;l<o;++l){let\x20e={Index:l,Radius:s,Angle:l*h+this.StartAngle},a=e.Angle;if(t&&l<t.length){var\x20C=t[l];let\x20i={Index:l,Text:C.Text};if(e.Text=C.Name,C.Value){var\x20u=C.Value;u>=1&&(u=1);var\x20D=s*u;i.X=n.X+D*Math.cos(a*Math.PI/180),i.Y=n.Y+D*Math.sin(a*Math.PI/180)}else\x20i.X=n.X,i.Y=n.Y;this.DataPoint.push(i)}this.BorderPoint.push(e)}this.CenterPoint=n},this.DrawEmptyData=function(){JSConsole.Chart.Log(\x22[ChartPie::DrawEmptyData]\x22)}}function\x20ChartChinaMap(){this.newMethod=IChartPainting,this.newMethod(),delete\x20this.newMethod,this.ImageData=null,this.Left,this.Top,this.Width,this.Height,this.ImageWidth,this.ImageHeight,this.DefaultColor=[217,222,239],this.Color=[{Name:\x22海南\x22,Color:\x22rgb(217,222,223)\x22},{Name:\x22内蒙古\x22,Color:\x22rgb(217,222,225)\x22},{Name:\x22新疆\x22,Color:\x22rgb(217,222,226)\x22},{Name:\x22青海\x22,Color:\x22rgb(217,222,227)\x22},{Name:\x22西藏\x22,Color:\x22rgb(217,222,228)\x22},{Name:\x22云南\x22,Color:\x22rgb(217,222,229)\x22},{Name:\x22黑龙江\x22,Color:\x22rgb(217,222,230)\x22},{Name:\x22吉林\x22,Color:\x22rgb(217,222,231)\x22},{Name:\x22辽宁\x22,Color:\x22rgb(217,222,232)\x22},{Name:\x22河北\x22,Color:\x22rgb(217,222,233)\x22},{Name:\x22山东\x22,Color:\x22rgb(217,222,234)\x22},{Name:\x22江苏\x22,Color:\x22rgb(217,222,235)\x22},{Name:\x22浙江\x22,Color:\x22rgb(217,222,236)\x22},{Name:\x22福建\x22,Color:\x22rgb(217,222,237)\x22},{Name:\x22广东\x22,Color:\x22rgb(217,222,238)\x22},{Name:\x22广西\x22,Color:\x22rgb(217,222,239)\x22},{Name:\x22贵州\x22,Color:\x22rgb(217,222,240)\x22},{Name:\x22湖南\x22,Color:\x22rgb(217,222,241)\x22},{Name:\x22江西\x22,Color:\x22rgb(217,222,242)\x22},{Name:\x22安徽\x22,Color:\x22rgb(217,222,243)\x22},{Name:\x22湖北\x22,Color:\x22rgb(217,222,244)\x22},{Name:\x22重庆\x22,Color:\x22rgb(217,222,245)\x22},{Name:\x22四川\x22,Color:\x22rgb(217,222,246)\x22},{Name:\x22甘肃\x22,Color:\x22rgb(217,222,247)\x22},{Name:\x22陕西\x22,Color:\x22rgb(217,222,248)\x22},{Name:\x22山西\x22,Color:\x22rgb(217,222,249)\x22},{Name:\x22河南\x22,Color:\x22rgb(217,222,250)\x22}],this.Draw=function(){let\x20t=this.ChartBorder.GetLeft()+1,e=(this.ChartBorder.GetRight(),this.ChartBorder.GetTop()+1),a=(this.ChartBorder.GetBottom(),this.ChartBorder.GetWidth()-2),i=this.ChartBorder.GetHeight()-2,r=CHINA_MAP_IMAGE.width,n=CHINA_MAP_IMAGE.height,s=r,o=n;if(i<o||a<s)this.ImageData=null;else\x20if(this.Left==t&&this.Top==e&&this.Width==a&&this.Height==i&&this.ImageWidth==r&&this.ImageHeight==n||(this.ImageData=null,this.ImageWidth=r,this.ImageHeight=n,this.Left=t,this.Top=e,this.Width=a,this.Height=i,JSConsole.Chart.Log(r,n)),null==this.ImageData){this.Canvas.drawImage(CHINA_MAP_IMAGE,0,0,r,n,t,e,s,o),this.ImageData=this.Canvas.getImageData(t,e,s,o);let\x20a=new\x20Set,i=new\x20Map,C=new\x20Map;if(this.Data.length>0)for(var\x20h\x20in\x20this.Data){let\x20t=this.Data[h];C.set(t.Name,t.Color)}for(var\x20h\x20in\x20JSConsole.Chart.Log(this.Data),this.Color){let\x20t=this.Color[h];C.has(t.Name)?i.set(t.Color,C.get(t.Name)):a.add(t.Color)}var\x20l;for(let\x20t=0;t<this.ImageData.data.length;t+=4)if(l=\x22rgb(\x22+this.ImageData.data[t]+\x22,\x22+this.ImageData.data[t+1]+\x22,\x22+this.ImageData.data[t+2]+\x22)\x22,a.has(l))this.ImageData.data[t]=this.DefaultColor[0],this.ImageData.data[t+1]=this.DefaultColor[1],this.ImageData.data[t+2]=this.DefaultColor[2];else\x20if(i.has(l)){let\x20e=i.get(l);this.ImageData.data[t]=e[0],this.ImageData.data[t+1]=e[1],this.ImageData.data[t+2]=e[2]}this.Canvas.clearRect(t,e,s,o),this.Canvas.putImageData(this.ImageData,t,e,0,0,s,o)}else\x20this.Canvas.putImageData(this.ImageData,t,e,0,0,s,o)}}function\x20IExtendChartPainting(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.Data,this.IsDynamic=!1,this.IsAnimation=!1,this.ClassName=\x22IExtendChartPainting\x22,this.SizeChange=!0,this.IsEraseBG=!1,this.DrawAfterTitle=!1,this.IsCallbackDraw=!1,this.Left=5,this.Right=5,this.Top=5,this.Bottom=5,this.Draw=function(){},this.SetOption=function(t){}}function\x20KLineTooltipPaint(){this.newMethod=IExtendChartPainting,this.newMethod(),delete\x20this.newMethod,this.IsDynamic=!0,this.IsEraseBG=!0,this.DrawAfterTitle=!0,this.ClassName=\x22KLineTooltipPaint\x22,this.BorderColor=g_JSChartResource.TooltipPaint.BorderColor,this.BGColor=g_JSChartResource.TooltipPaint.BGColor,this.TitleColor=g_JSChartResource.TooltipPaint.TitleColor,this.Left=1*GetDevicePixelRatio(),this.Top=5*GetDevicePixelRatio(),this.Width=50,this.Height=100,this.LineHeight=15*GetDevicePixelRatio(),this.Font=[g_JSChartResource.TooltipPaint.TitleFont],this.HQChart,this.KLineTitlePaint,this.IsHScreen=!1,this.LanguageID=JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.GetLeft=function(){return\x20this.IsHScreen?this.ChartBorder.GetRightEx()-this.Height-this.Top:this.ChartBorder.GetLeft()+this.Left},this.GetTop=function(){return\x20this.IsHScreen?this.ChartBorder.GetTop():this.ChartBorder.GetTopEx()+this.Top},this.IsEnableDraw=function(){if(!this.HQChart||!this.HQChart.TitlePaint||!this.HQChart.TitlePaint[0])return!1;if(this.HQChart.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID){if(0==this.HQChart.TouchStatus.CorssCursorShow)return!1}else\x20if(!this.HQChart.IsOnTouch)return!1;return!this.HQChart.CurrentChartDrawPicture},this.Draw=function(){if(this.IsEnableDraw()){this.KLineTitlePaint=this.HQChart.TitlePaint[0];var\x20t=this.KLineTitlePaint.GetCurrentKLineData();if(t){var\x20e,a=8;this.HQChart.Symbol&&(e=this.HQChart.Symbol.toUpperCase()),\x22MinuteTooltipPaint\x22===this.ClassName?(a=7,MARKET_SUFFIX_NAME.IsFutures(e)&&++a):(IFrameSplitOperator.IsNumber(t.Time)&&++a,MARKET_SUFFIX_NAME.IsSHSZStockA(this.HQChart.Symbol)&&t.FlowCapital>0&&++a,MARKET_SUFFIX_NAME.IsFutures(e)&&IFrameSplitOperator.IsNumber(t.Position)&&++a),this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.Canvas.font=this.Font[0];var\x20i=GetfloatPrecision(this.HQChart.Symbol),r=\x22\x20擎:\x209999.99亿\x20\x22;if(i>=5&&(r=`\x20擎:\x20${99.99.toFixed(i)}\x20`),this.Width=this.Canvas.measureText(r).width,this.Height=this.LineHeight*a+2*GetDevicePixelRatio()*2,t&&t.High>0){r=`\x20擎:\x20${t.High.toFixed(i)}\x20`;var\x20n=this.Canvas.measureText(r).width;n>this.Width&&(this.Width=n)}this.DrawBG(),this.DrawTooltipData(t),this.DrawBorder()}}},this.DrawTooltipData=function(t){this.HQChart.Symbol&&(u=this.HQChart.Symbol.toUpperCase());var\x20e=GetfloatPrecision(this.HQChart.Symbol),a=this.GetLeft()+2*GetDevicePixelRatio(),i=this.GetTop()+3*GetDevicePixelRatio();if(this.IsHScreen){this.Canvas.save();var\x20r=this.GetLeft()+this.Height,n=this.GetTop();this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),a=2*GetDevicePixelRatio(),i=3*GetDevicePixelRatio()}this.Canvas.textBaseline=\x22top\x22,this.Canvas.textAlign=\x22left\x22,this.Canvas.font=this.Font[0];var\x20s=this.Canvas.measureText(\x22擎:\x20\x22).width,o=IFrameSplitOperator.FormatDateString(t.Date);this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(o,a,i);var\x20h=this.HQChart.Period;ChartData.IsMinutePeriod(h,!0)&&t.Time?(i+=this.LineHeight,o=IFrameSplitOperator.FormatTimeString(t.Time),this.Canvas.fillText(o,a,i)):ChartData.IsSecondPeriod(h)&&t.Time&&(i+=this.LineHeight,o=IFrameSplitOperator.FormatTimeString(t.Time,\x22HH:MM:SS\x22),this.Canvas.fillText(o,a,i)),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,o=g_JSChartLocalization.GetText(\x22Tooltip-Open\x22,this.LanguageID),this.Canvas.fillText(o,a,i);var\x20l=this.KLineTitlePaint.GetColor(t.Open,t.YClose);o=t.Open.toFixed(e),this.Canvas.fillStyle=l,this.Canvas.fillText(o,a+s,i),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,o=g_JSChartLocalization.GetText(\x22Tooltip-High\x22,this.LanguageID),this.Canvas.fillText(o,a,i);l=this.KLineTitlePaint.GetColor(t.High,t.YClose),o=t.High.toFixed(e);this.Canvas.fillStyle=l,this.Canvas.fillText(o,a+s,i),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,o=g_JSChartLocalization.GetText(\x22Tooltip-Low\x22,this.LanguageID),this.Canvas.fillText(o,a,i);l=this.KLineTitlePaint.GetColor(t.Low,t.YClose),o=t.Low.toFixed(e);this.Canvas.fillStyle=l,this.Canvas.fillText(o,a+s,i),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,o=g_JSChartLocalization.GetText(\x22Tooltip-Close\x22,this.LanguageID),this.Canvas.fillText(o,a,i);l=this.KLineTitlePaint.GetColor(t.Close,t.YClose),o=t.Close.toFixed(e);if(this.Canvas.fillStyle=l,this.Canvas.fillText(o,a+s,i),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,o=g_JSChartLocalization.GetText(\x22Tooltip-Increase\x22,this.LanguageID),this.Canvas.fillText(o,a,i),t.YFClose>0&&MARKET_SUFFIX_NAME.IsChinaFutures(u)){var\x20C=(t.Close-t.YFClose)/t.YFClose*100;l=this.KLineTitlePaint.GetColor(C,0),o=C.toFixed(2)+\x22%\x22}else\x20if(t.YClose>0)C=(t.Close-t.YClose)/t.YClose*100,l=this.KLineTitlePaint.GetColor(C,0),o=C.toFixed(2)+\x22%\x22;else\x20o=\x22--.--\x22,l=this.KLineTitlePaint.GetColor(0,0);this.Canvas.fillStyle=l,this.Canvas.fillText(o,a+s,i),this.Canvas.fillStyle=this.TitleColor,i+=this.LineHeight,o=g_JSChartLocalization.GetText(\x22Tooltip-Vol\x22,this.LanguageID),this.Canvas.fillText(o,a,i);o=IFrameSplitOperator.FromatIntegerString(t.Vol,2,this.LanguageID);if(this.Canvas.fillText(o,a+s,i),IFrameSplitOperator.IsNumber(t.Amount)){i+=this.LineHeight,o=g_JSChartLocalization.GetText(\x22Tooltip-Amount\x22,this.LanguageID),this.Canvas.fillText(o,a,i);o=IFrameSplitOperator.FormatValueString(t.Amount,2,this.LanguageID);this.Canvas.fillText(o,a+s,i)}if(MARKET_SUFFIX_NAME.IsSHSZStockA(this.HQChart.Symbol)&&t.FlowCapital>0){i+=this.LineHeight,o=g_JSChartLocalization.GetText(\x22Tooltip-Exchange\x22,this.LanguageID),this.Canvas.fillText(o,a,i);o=(C=t.Vol/t.FlowCapital*100).toFixed(2)+\x22%\x22;this.Canvas.fillText(o,a+s,i)}var\x20u=this.HQChart.Symbol.toUpperCase();if(MARKET_SUFFIX_NAME.IsFutures(u)&&IFrameSplitOperator.IsNumber(t.Position)){this.Canvas.fillStyle=this.TitleColor,i+=this.LineHeight,o=g_JSChartLocalization.GetText(\x22Tooltip-Position\x22,this.LanguageID),this.Canvas.fillText(o,a,i);o=IFrameSplitOperator.FromatIntegerString(t.Position,2,this.LanguageID);this.Canvas.fillText(o,a+s,i)}this.IsHScreen&&this.Canvas.restore()},this.DrawBorder=function(){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.GetLeft(),a=this.GetTop();this.Canvas.strokeStyle=this.BorderColor,t?this.Canvas.strokeRect(ToFixedPoint(e),ToFixedPoint(a),this.Height,this.Width):this.Canvas.strokeRect(ToFixedPoint(e),ToFixedPoint(a),this.Width,this.Height)},this.DrawBG=function(){var\x20t=!0===this.ChartFrame.IsHScreen,e=this.GetLeft(),a=this.GetTop();this.Canvas.fillStyle=this.BGColor,t?this.Canvas.fillRect(e,a,this.Height,this.Width):this.Canvas.fillRect(e,a,this.Width,this.Height)},this.SetOption=function(t){t.LineHeight>0&&(this.LineHeight=t.LineHeight*GetDevicePixelRatio()),t.BGColor&&(this.BGColor=t.BGColor),t.LanguageID>0&&(this.LanguageID=t.LanguageID)}}function\x20MinuteTooltipPaint(){this.newMethod=KLineTooltipPaint,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22MinuteTooltipPaint\x22,this.Left=1*GetDevicePixelRatio(),this.Top=1*GetDevicePixelRatio(),this.YClose,this.GetTop=function(){return\x20this.IsHScreen?this.ChartBorder.GetTop():this.ChartBorder.GetTop()+this.Top},this.DrawTooltipData=function(t){if(this.HQChart.Symbol){var\x20e=GetfloatPrecision(this.HQChart.Symbol),a=this.GetLeft()+2*GetDevicePixelRatio(),i=this.GetTop()+3*GetDevicePixelRatio();this.YClose=this.KLineTitlePaint.YClose;var\x20r=this.HQChart.Symbol.toUpperCase();if(this.IsHScreen){this.Canvas.save();var\x20n=this.GetLeft()+this.Height,s=this.GetTop();this.Canvas.translate(n,s),this.Canvas.rotate(90*Math.PI/180),a=2*GetDevicePixelRatio(),i=3*GetDevicePixelRatio()}this.Canvas.textBaseline=\x22top\x22,this.Canvas.textAlign=\x22left\x22,this.Canvas.font=this.Font[0];var\x20o=this.Canvas.measureText(\x22擎:\x20\x22).width,h=t.DateTime.split(\x22\x20\x22);if(h&&2==h.length){var\x20l=IFrameSplitOperator.FormatDateString(h[0]);this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(l,a,i),i+=this.LineHeight,l=IFrameSplitOperator.FormatTimeString(h[1]),this.Canvas.fillText(l,a,i)}var\x20C=t.Close,u=(t.Increase,t.Vol),D=t.Amount;t.Before&&(C=t.Before.Close,t.Before.Increase,u=t.Before.Vol,D=t.Before.Amount),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,l=g_JSChartLocalization.GetText(\x22Tooltip-Price\x22,this.LanguageID),this.Canvas.fillText(l,a,i);var\x20d=this.KLineTitlePaint.GetColor(C,this.YClose);l=C.toFixed(e);this.Canvas.fillStyle=d,this.Canvas.fillText(l,a+o,i);var\x20c=!0;if(t.Before?c=!1:MARKET_SUFFIX_NAME.IsForeignExchange(r)?c=!1:MARKET_SUFFIX_NAME.IsET(r)&&!MARKET_SUFFIX_NAME.IsETShowAvPrice(r)&&(c=!1),c&&IFrameSplitOperator.IsNumber(t.AvPrice)){i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,l=g_JSChartLocalization.GetText(\x22Tooltip-AvPrice\x22,this.LanguageID),this.Canvas.fillText(l,a,i);d=this.KLineTitlePaint.GetColor(t.AvPrice,this.YClose),l=t.AvPrice.toFixed(e);this.Canvas.fillStyle=d,this.Canvas.fillText(l,a+o,i)}i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,l=g_JSChartLocalization.GetText(\x22Tooltip-Increase\x22,this.LanguageID),this.Canvas.fillText(l,a,i);var\x20m=(C-this.YClose)/this.YClose*100;d=this.KLineTitlePaint.GetColor(m,0),l=m.toFixed(2)+\x22%\x22;if(this.Canvas.fillStyle=d,this.Canvas.fillText(l,a+o,i),IFrameSplitOperator.IsNumber(u)){this.Canvas.fillStyle=this.TitleColor,i+=this.LineHeight,l=g_JSChartLocalization.GetText(\x22Tooltip-Vol\x22,this.LanguageID),this.Canvas.fillText(l,a,i);l=IFrameSplitOperator.FromatIntegerString(u,2,this.LanguageID);this.Canvas.fillText(l,a+o,i)}if(IFrameSplitOperator.IsNumber(D)){i+=this.LineHeight,l=g_JSChartLocalization.GetText(\x22Tooltip-Amount\x22,this.LanguageID),this.Canvas.fillText(l,a,i);l=IFrameSplitOperator.FormatValueString(D,2,this.LanguageID);this.Canvas.fillText(l,a+o,i)}if(IFrameSplitOperator.IsNumber(t.Position)){i+=this.LineHeight,l=g_JSChartLocalization.GetText(\x22Tooltip-Position\x22,this.LanguageID),this.Canvas.fillText(l,a,i);l=IFrameSplitOperator.FormatValueString(t.Position,2,this.LanguageID);this.Canvas.fillText(l,a+o,i)}this.IsHScreen&&this.Canvas.restore()}}}function\x20StockInfoExtendChartPaint(){this.newMethod=IExtendChartPainting,this.newMethod(),delete\x20this.newMethod,this.Left=80,this.Right=1,this.Top=1,this.Bottom=1,this.BorderColor=g_JSChartResource.FrameBorderPen,this.Symbol,this.Name,this.TitleFont=[\x2214px\x20微软雅黑\x22],this.Draw=function(){var\x20t=this.ChartBorder.GetRight()+this.Left,e=this.ChartBorder.GetChartWidth()-this.Right,a=this.Top+18,i=t+(e-t)/2;this.Symbol&&this.Name&&(this.Canvas.font=this.TitleFont[0],this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22bottom\x22,this.Canvas.fillText(this.Symbol,i-2,a),this.Canvas.textAlign=\x22left\x22,this.Canvas.fillText(this.Name,i+2,a)),this.Canvas.strokeStyle=this.BorderColor,this.Canvas.moveTo(t,a),this.Canvas.lineTo(e,a),this.Canvas.stroke(),a+=30,this.DrawBorder()},this.DrawBorder=function(){var\x20t=this.ChartBorder.GetRight()+this.Left,e=this.ChartBorder.GetChartWidth()-this.Right,a=this.Top,i=this.ChartBorder.GetChartHeight()-this.Bottom;this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(t,a,e-t,i-a)}}function\x20StockChip(){this.newMethod=IExtendChartPainting,this.newMethod(),delete\x20this.newMethod,this.Name=\x22筹码分布\x22,this.ClassName=\x22StockChip\x22,this.HQChart,this.PenBorder=g_JSChartResource.FrameBorderPen,this.ColorProfit=\x22rgb(255,0,0)\x22,this.ColorNoProfit=\x22rgb(90,141,248)\x22,this.ColorAveragePrice=\x22rgb(0,139,0)\x22,this.ColorBG=\x22rgb(190,190,190)\x22,this.PixelRatio=GetDevicePixelRatio(),this.ShowType=0,this.IsDynamic=!0,this.ClientRect={},this.Font=g_JSChartResource.TitleFont,this.InfoColor=\x22rgb(0,0,0)\x22,this.DayInfoColor=\x22rgb(255,255,255)\x22,this.LineHeight=16,this.Left=50*this.PixelRatio,this.IsShowX=!1,this.ShowXCount=3,this.Width=150*this.PixelRatio,this.CalculateType=0,this.PriceZoom=100,this.ButtonID=Guid(),this.DAY_COLOR=[[\x22rgb(255,0,0)\x22,\x22rgb(255,128,128)\x22,\x22rgb(255,0,128)\x22,\x22rgb(255,100,0)\x22,\x22rgb(192,128,0)\x22,\x22rgb(255,192,0)\x22],[\x22rgb(120,80,225)\x22,\x22rgb(160,160,225)\x22,\x22rgb(80,80,255)\x22,\x22rgb(120,120,255)\x22,\x22rgb(32,64,192)\x22,\x22rgb(0,64,128)\x22]],this.SetOption=function(t){t&&(t.ShowType>0&&(this.ShowType=t.ShowType),t.IsShowX&&(this.IsShowX=t.IsShowX),t.ShowXCount>0&&(this.ShowXCount=t.ShowXCount),t.Width>100&&(this.Width=t.Width*GetDevicePixelRatio()),t.CalculateType>0&&(this.CalculateType=t.CalculateType),IFrameSplitOperator.IsNumber(t.PriceZoom)&&(this.PriceZoom=t.PriceZoom))},this.Draw=function(){this.PixelRatio=GetDevicePixelRatio();var\x20t=ToFixedPoint(this.ChartBorder.GetRight()+this.Left),e=ToFixedPoint(this.ChartBorder.GetTop()),a=ToFixedPoint(t+this.Width-1*this.PixelRatio)-t,i=ToFixedPoint(this.ChartBorder.GetBottom())-e;this.ClientRect={Left:t,Top:e,Width:a,Height:i},this.CalculateChip()?(this.DrawFrame(),this.DrawAllChip(),1!=this.ShowType&&2!=this.ShowType||this.DrawDayChip(),this.CalculateCast(),this.DrawChipInfo()):JSConsole.Chart.Log(\x22[StockChip::Draw]\x20no\x20data\x22),this.DrawBorder(),1==this.SizeChange&&this.DrawButton(),this.SizeChange=!1},this.DrawChipInfo=function(){var\x20t=this.ClientRect.Top+this.ClientRect.Height-1,e=this.ClientRect.Left+2,a=this.ClientRect.Left+this.ClientRect.Width;this.Canvas.font=this.Font,this.Canvas.fillStyle=this.InfoColor,this.Canvas.textBaseline=\x22bottom\x22,this.Canvas.textAlign=\x22left\x22;var\x20i=this.LineHeight*GetDevicePixelRatio(),r=\x2270%成本价\x22+this.Data.Cast[1].MinPrice.toFixed(2)+\x22-\x22+this.Data.Cast[1].MaxPrice.toFixed(2)+\x22集中\x22+this.Data.Cast[1].Rate.toFixed(2)+\x22%\x22;this.Canvas.fillText(r,e,t),t-=i,r=\x2290%成本价\x22+this.Data.Cast[0].MinPrice.toFixed(2)+\x22-\x22+this.Data.Cast[0].MaxPrice.toFixed(2)+\x22集中\x22+this.Data.Cast[0].Rate.toFixed(2)+\x22%\x22,this.Canvas.fillText(r,e,t),t-=i,r=\x22平均成本：\x22+this.Data.ChipInfo.AveragePrice.toFixed(2)+\x22元\x22,this.Canvas.fillText(r,e,t),t-=i,r=+this.Data.YPrice.toFixed(2)+\x22处获利盘：\x22+this.Data.ChipInfo.YProfitRate.toFixed(2)+\x22%\x22,this.Canvas.fillText(r,e,t),t-=i,r=\x22获利比例：\x22,this.Canvas.fillText(r,e,t);var\x20n=e+(o=this.Canvas.measureText(r).width+2),s=a-5-n;if(this.Canvas.strokeStyle=this.ColorNoProfit,this.Canvas.strokeRect(n,t-i,s,i),this.Canvas.strokeStyle=this.ColorProfit,this.Canvas.strokeRect(n,t-i,s*(this.Data.ChipInfo.ProfitRate/100),i),r=this.Data.ChipInfo.ProfitRate.toFixed(2)+\x22%\x22,this.Canvas.textAlign=\x22center\x22,this.Canvas.fillText(r,n+s/2,t),t-=i,this.Canvas.textAlign=\x22left\x22,r=\x22成本分布,日期：\x22+IFrameSplitOperator.FormatDateString(this.Data.SelectData.Date),this.Data.SelectData.Time&&(r+=\x22\x20\x22+IFrameSplitOperator.FormatTimeString(this.Data.SelectData.Time)),this.Canvas.fillText(r,e,t),t-=i,1==this.ShowType||2==this.ShowType){a=this.ClientRect.Left+this.ClientRect.Width-1;this.Canvas.textAlign=\x22right\x22;var\x20o=50;for(var\x20h\x20in\x20this.Data.DayChip.sort(function(t,e){return\x20e.Day-t.Day}),this.Data.DayChip){var\x20l=this.Data.DayChip[h],C=0;this.Data.ChipInfo&&this.Data.ChipInfo.Vol>0&&(C=l.Vol/this.Data.ChipInfo.Vol*100),r=l.Day+\x22周期\x22+(1==this.ShowType?\x22前\x22:\x22内\x22)+\x22成本\x22+C.toFixed(2)+\x22%\x22,0==h&&(o=this.Canvas.measureText(r).width+8),this.Canvas.fillStyle=l.Color,this.Canvas.fillRect(a-o,t-i,o,i),this.Canvas.fillStyle=this.DayInfoColor,this.Canvas.fillText(r,a,t),t-=i}}},this.DrawDayChip=function(){var\x20t=this.HQChart.Frame.SubFrame[0].Frame;for(var\x20e\x20in\x20this.Data.DayChip){var\x20a=[],i=this.Data.DayChip[e].Chip;if(i){for(var\x20r=0,n=0;n<i.length;++n){var\x20s=i[n];if(s){r+=s;var\x20o=(n+this.Data.MinPrice)/100,h=t.GetYFromData(o),l=s/this.Data.MaxVol*this.ClientRect.Width+this.ClientRect.Left;a.push({X:l,Y:h})}}this.Data.DayChip[e].Vol=r,this.DrawArea(a,this.Data.DayChip[e].Color)}}},this.Clear=function(){var\x20t=document.getElementById(this.ButtonID);t&&this.ChartBorder.UIElement.parentNode.removeChild(t)},this.DrawButton=function(){var\x20t=document.getElementById(this.ButtonID);t||((t=document.createElement(\x22div\x22)).className=\x22klineframe-button\x22,t.id=this.ButtonID,this.ChartBorder.UIElement.parentNode.appendChild(t));var\x20e=this.PixelRatio,a=(this.ClientRect.Left,this.ClientRect.Left+this.ClientRect.Width),i=this.ChartBorder.GetChartWidth(),r=this.ChartBorder.GetTitleHeight(),n=this.ChartBorder.GetTop()/e;const\x20s=[{Class:\x22chip_default\x20icon\x20iconfont\x20icon-chip_default\x22,ID:\x22chip_default\x22,Color:[\x22#808080\x22,\x22#FF0000\x22],Title:\x22默认筹码分布图\x22},{Class:\x22chip_long\x20icon\x20iconfont\x20icon-chip_date\x22,ID:\x22chip_long\x22,Color:[\x22#808080\x22,\x22#FF8000\x22],Title:\x22远期筹码分布图\x22},{Class:\x22chip_recent\x20icon\x20iconfont\x20icon-chip_date\x22,ID:\x22chip_recent\x22,Color:[\x22#808080\x22,\x22#0000CC\x22],Title:\x22近期筹码分布图\x22}];var\x20o=\x22\x22;for(var\x20h\x20in\x20s){var\x20l=s[h],C=\x22<span\x20class=\x27{iconclass}\x27\x20id=\x27{iconid}\x27\x20title=\x27{icontitle}\x27\x20style=\x27cursor:pointer;display:inline-block;color:{iconcolor};font-size:{iconsize}px\x27></span>\x22;C=(C=(C=(C=(C=C.replace(\x22{iconclass}\x22,l.Class)).replace(\x22{iconid}\x22,l.ID)).replace(\x22{iconcolor}\x22,l.Color[h==this.ShowType?1:0])).replace(\x22{iconsize}\x22,r)).replace(\x22{icontitle}\x22,l.Title),o.length>0&&(o+=\x22&nbsp;&nbsp;\x22),o+=C}t.style.right=Math.floor((i-a+2)/e)+\x22px\x22,t.style.top=n+\x22px\x22,t.style.height=r+\x22px\x22,t.innerHTML=o;var\x20u=this;for(var\x20h\x20in\x20s){l=s[h];$(\x22#\x22+this.ButtonID+\x22\x20.\x22+l.ID).click({IconID:l.ID,ShowType:h},function(t){t.data.IconID;var\x20e=t.data.ShowType;for(var\x20a\x20in\x20u.ShowType=e,u.HQChart&&u.HQChart.Draw(),s){var\x20i=s[a];$(\x22#\x22+u.ButtonID+\x22\x20.\x22+i.ID)[0].style.color=i.Color[a==e?1:0]}})}},this.DrawAllChip=function(){for(var\x20t=this.HQChart.Frame.SubFrame[0].Frame,e=this.Data.SelectData.Close,a=[],i=[],r=0,n=0,s=0,o=0,h=this.Data.YPrice,l=t.HorizontalMax,C=t.HorizontalMin,u=1,D=0;D<this.Data.AllChip.length;++D){if(d=this.Data.AllChip[D])r+=d,n+=(c=(D+this.Data.MinPrice)/this.PriceZoom)*d,c<h&&(o+=d),c<e&&(s+=d),c<=l&&c>=C&&u<d&&(u=d)}this.Data.MaxVol=u;for(D=0;D<this.Data.AllChip.length;++D){var\x20d,c;if(d=this.Data.AllChip[D])if(!((c=(D+this.Data.MinPrice)/this.PriceZoom)>l||c<C)){var\x20m=t.GetYFromData(c),f=d/this.Data.MaxVol*this.ClientRect.Width+this.ClientRect.Left;c<e?a.push({X:f,Y:m}):i.push({X:f,Y:m})}}if(this.Data.ChipInfo={Vol:r,AveragePrice:n/r,ProfitVol:s,ProfitRate:r>0?s/r*100:0,YProfitRate:r>0?o/r*100:0},0==this.ShowType){this.DrawLines(a,this.ColorProfit),this.DrawLines(i,this.ColorNoProfit);var\x20v=this.Data.ChipInfo.AveragePrice;v>0&&v<=l&&v>=C&&(v=v.toFixed(2),this.DrawAveragePriceLine(a,i,t.GetYFromData(v),this.ColorAveragePrice))}else\x20this.DrawLines(a,this.ColorBG),this.DrawLines(i,this.ColorBG)},this.CalculateCast=function(){if(this.Data.ChipInfo&&this.Data.ChipInfo.Vol){for(var\x20t=[{Start:.05,End:.95,MaxPrice:0,MinPrice:0,Rate:0},{Start:.15,End:.85,MaxPrice:0,MinPrice:0,Rate:0}],e=(this.Data.ChipInfo.AveragePrice,this.Data.ChipInfo.ProfitVol),a=0,i=0,r=0;i<this.Data.AllChip.length&&4!=r;++i){var\x20n=this.Data.AllChip[i];if(!(n<=0)){var\x20s=(i+this.Data.MinPrice)/this.PriceZoom,o=(a+=n)/e;for(var\x20h\x20in\x20t){var\x20l=t[h];l.MinPrice<=0&&o>l.Start&&(l.MinPrice=s,++r),l.MaxPrice<=0&&o>l.End&&(l.MaxPrice=s,++r)}}}for(var\x20i\x20in\x20t){var\x20C=t[i],u=C.MaxPrice+C.MinPrice;u&&(C.Rate=Math.abs(C.MaxPrice-C.MinPrice)/u*100)}this.Data.Cast=t}},this.DrawArea=function(t,e){if(!(t.length<=0)){for(var\x20a\x20in\x20this.Canvas.fillStyle=e,this.Canvas.beginPath(),this.Canvas.moveTo(this.ClientRect.Left,t[0].Y),t){var\x20i=t[a];this.Canvas.lineTo(i.X,i.Y)}this.Canvas.lineTo(this.ClientRect.Left,t[t.length-1].Y),this.Canvas.fill()}},this.DrawLines=function(t,e){if(!(t.length<=0)){for(var\x20a\x20in\x20this.Canvas.strokeStyle=e,this.Canvas.beginPath(),t){var\x20i=t[a];this.Canvas.moveTo(this.ClientRect.Left,i.Y),this.Canvas.lineTo(i.X,i.Y)}this.Canvas.stroke()}},this.DrawAveragePriceLine=function(t,e,a,i){for(var\x20r\x20in\x20t){if((n=t[r]).Y==a)return\x20this.Canvas.strokeStyle=i,this.Canvas.beginPath(),this.Canvas.moveTo(this.ClientRect.Left,n.Y),this.Canvas.lineTo(n.X,n.Y),void\x20this.Canvas.stroke()}for(var\x20r\x20in\x20e){var\x20n;if((n=e[r]).Y==a)return\x20this.Canvas.strokeStyle=i,this.Canvas.beginPath(),this.Canvas.moveTo(this.ClientRect.Left,n.Y),this.Canvas.lineTo(n.X,n.Y),void\x20this.Canvas.stroke()}},this.DrawBorder=function(){this.Canvas.strokeStyle=this.PenBorder,this.Canvas.strokeRect(this.ClientRect.Left,this.ClientRect.Top,this.ClientRect.Width,this.ClientRect.Height)},this.EvenlyDistribute=function(t,e){var\x20a=e.Low,i=e.High,r=e.MaxPrice,n=e.MinPrice,s=1;if(i-a!=0){for(var\x20o=e.Vol/(i-a),h=a;h<=i&&h<=r;++h){var\x20l=h-n;t[l]+=o,s<t[l]&&(s=t[l])}e.MaxVol=s}},this.TriangleDistribute=function(t,e){for(var\x20a=e.Low,i=e.High,r=(e.MaxPrice,e.MinPrice),n=1,s=3.1415926535,o=(i-a)/2+a,h=0,l=[],C=a+1,u=1;C<=o;++C,++u){h+=D=Math.tan(45*s/180)*u,l.push({Index:C-r,Value:D})}for(C=i-1,u=1;C>o;--C,++u){var\x20D;h+=D=Math.tan(45*s/180)*u,l.push({Index:C-r,Value:D})}if(h>0){for(C=0;C<l.length;++C){var\x20d=l[C];t[d.Index]+=d.Value*e.Vol/h,n<t[d.Index]&&(n=t[d.Index])}e.MaxVol=n}},this.CalculateDistribute=function(t,e){1==this.CalculateType?this.TriangleDistribute(t,e):this.EvenlyDistribute(t,e)},this.CalculateChip=function(){if(!this.HQChart)return!1;if(!this.HQChart.FlowCapitalReady)return!1;var\x20t=this.HQChart.Symbol;if(!t)return!1;if(MARKET_SUFFIX_NAME.IsSHSZIndex(t))return!1;var\x20e=this.HQChart.ChartPaint[0].Data,a=e.DataOffset+parseInt(this.HQChart.CursorIndex);a>=e.Data.length&&(a=e.Data.length-1);var\x20i=e.Data[a],r=i.Close,n=this.HQChart.LastPoint.Y;n&&(r=this.HQChart.Frame.SubFrame[0].Frame.GetYData(n));for(var\x20s,o,h=[],l=1,C=a;C>=0;--C){var\x20u=1;(S=e.Data[C]).FlowCapital>0&&(u=S.Vol/S.FlowCapital);var\x20D={Vol:C==a?S.Vol*u:S.Vol*l,High:S.High,Low:S.Low};h.push(D),l*=1-1*u,(!s||s<S.High)&&(s=S.High),(!o||o>S.Low)&&(o=S.Low)}if(!s||!o)return!0;var\x20d=this.PriceZoom,c=(s=parseInt(s*d))-(o=parseInt(o*d)),m=new\x20Array;for(C=0;C<=c;++C)m.push(0);var\x20f,v=[];if(2==this.ShowType){v=[{Day:100,Color:this.DAY_COLOR[1][5]},{Day:60,Color:this.DAY_COLOR[1][4]},{Day:30,Color:this.DAY_COLOR[1][3]},{Day:20,Color:this.DAY_COLOR[1][2]},{Day:10,Color:this.DAY_COLOR[1][1]},{Day:5,Color:this.DAY_COLOR[1][0]}];for(var\x20C\x20in\x20h){var\x20S=h[C],T=parseInt(S.High*d),I=parseInt(S.Low*d),F=S.Vol;if(T-I>0&&(F=S.Vol/(T-I)),!(F<=1e-9)){for(var\x20g=0;g<v.length;++g)if(C==v[g].Day){v[g].Chip=m.slice(0);break}f={Low:I,High:T,Vol:S.Vol,MaxPrice:s,MinPrice:o},this.CalculateDistribute(m,f)}}}else\x20if(1==this.ShowType)for(v=[{Day:5,Color:this.DAY_COLOR[0][0]},{Day:10,Color:this.DAY_COLOR[0][1]},{Day:20,Color:this.DAY_COLOR[0][2]},{Day:30,Color:this.DAY_COLOR[0][3]},{Day:60,Color:this.DAY_COLOR[0][4]},{Day:100,Color:this.DAY_COLOR[0][5]}],C=h.length-1;C>=0;--C){S=h[C],T=parseInt(S.High*d),I=parseInt(S.Low*d),F=S.Vol;if(T-I>0&&(F=S.Vol/(T-I)),!(F<=1e-9)){for(g=0;g<v.length;++g)if(C==v[g].Day){v[g].Chip=m.slice(0);break}f={Low:I,High:T,Vol:S.Vol,MaxPrice:s,MinPrice:o},this.CalculateDistribute(m,f)}}else\x20for(var\x20C\x20in\x20h){S=h[C],T=parseInt(S.High*d),I=parseInt(S.Low*d),F=S.Vol;T-I>0&&(F=S.Vol/(T-I)),F<=1e-9||(f={Low:I,High:T,Vol:S.Vol,MaxPrice:s,MinPrice:o},this.CalculateDistribute(m,f))}return\x20this.Data={AllChip:m,MaxVol:f.MaxVol,MaxPrice:s,MinPrice:o,SelectData:i,DayChip:v,YPrice:r},!0},this.DrawFrame=function(){if(0!=this.IsShowX&&!(this.Data.MaxVol<=0)){var\x20t=1!==this.HQChart.Frame.SubFrame.length,e=ToFixedPoint(this.HQChart.Frame.SubFrame[0].Frame.ChartBorder.GetBottomEx()+1);t||(e=this.ClientRect.Top+this.ClientRect.Height);var\x20a=this.ClientRect.Left,i=a+this.ClientRect.Width;this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),t&&(this.Canvas.moveTo(a,e),this.Canvas.lineTo(i,e));var\x20r=this.ShowXCount,n=this.Data.MaxVol,s=Math.floor(n/r);this.Canvas.font=this.Font,this.Canvas.textBaseline=\x22top\x22,this.Canvas.fillStyle=this.InfoColor;GetDevicePixelRatio();for(var\x20o=1;o<=r;++o){var\x20h=s*o,l=h/this.Data.MaxVol*this.ClientRect.Width+this.ClientRect.Left;if(l=ToFixedPoint(l),o==r){this.Canvas.textAlign=\x22right\x22;var\x20C=IFrameSplitOperator.FormatValueString(n,1);this.Canvas.fillText(C,l,e+2)}else{this.Canvas.moveTo(l,this.ClientRect.Top),this.Canvas.lineTo(l,e),this.Canvas.textAlign=\x22center\x22;C=IFrameSplitOperator.FormatValueString(h,1);var\x20u=this.Canvas.measureText(C).width;this.Canvas.fillText(C,Math.floor(l-.25*u),e+2)}}this.Canvas.stroke()}}}function\x20DrawToolsButton(){this.newMethod=IExtendChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22DrawToolsButton\x22,this.HQChart,this.ID=Guid(),this.ToolsDiv,this.Color=\x22#696969\x22,this.Top=5*GetDevicePixelRatio(),this.Width=45*GetDevicePixelRatio(),this.SetOption=function(t){var\x20e=GetDevicePixelRatio();t&&t.Width>10&&(this.Width=t.Width*e)},this.Clear=function(){this.ToolsDiv&&this.ChartBorder.UIElement.parentNode.removeChild(this.ToolsDiv)},this.Draw=function(){if(0==this.SizeChange)return;const\x20t=[[{HTML:{Title:\x22线段\x22,IClass:\x22iconfont\x20icon-draw_line\x22,ID:\x22icon-segment\x22},Name:\x22线段\x22},{HTML:{Title:\x22射线\x22,IClass:\x22iconfont\x20icon-draw_rays\x22,ID:\x22icon-beam\x22},Name:\x22射线\x22},{HTML:{Title:\x22趋势线\x22,IClass:\x22iconfont\x20icon-draw_trendline\x22,ID:\x22icon-trendline\x22},Name:\x22趋势线\x22},{HTML:{Title:\x22水平线\x22,IClass:\x22iconfont\x20icon-draw_hline\x22,ID:\x22icon-hline\x22},Name:\x22水平线\x22},{HTML:{Title:\x22平行线\x22,IClass:\x22iconfont\x20icon-draw_parallel_lines\x22,ID:\x22icon-parallellines\x22},Name:\x22平行线\x22},{HTML:{Title:\x22平行通道\x22,IClass:\x22iconfont\x20icon-draw_parallelchannel\x22,ID:\x22icon-parallelchannel\x22},Name:\x22平行通道\x22},{HTML:{Title:\x22价格通道线\x22,IClass:\x22iconfont\x20icon-draw_pricechannel\x22,ID:\x22icon-pricechannel\x22},Name:\x22价格通道线\x22},{HTML:{Title:\x22M头W底\x22,IClass:\x22iconfont\x20icon-draw_wavemw\x22,ID:\x22icon-wavemw\x22},Name:\x22M头W底\x22}],[{HTML:{Title:\x22圆弧\x22,IClass:\x22iconfont\x20icon-draw_arc\x22,ID:\x22icon-arc\x22},Name:\x22圆弧线\x22},{HTML:{Title:\x22矩形\x22,IClass:\x22iconfont\x20icon-rectangle\x22,ID:\x22icon-rect\x22},Name:\x22矩形\x22},{HTML:{Title:\x22平行四边形\x22,IClass:\x22iconfont\x20icon-draw_quadrangle\x22,ID:\x22icon-quad\x22},Name:\x22平行四边形\x22},{HTML:{Title:\x22三角形\x22,IClass:\x22iconfont\x20icon-draw_triangle\x22,ID:\x22icon-triangle\x22},Name:\x22三角形\x22},{HTML:{Title:\x22圆\x22,IClass:\x22iconfont\x20icon-draw_circle\x22,ID:\x22icon-circle\x22},Name:\x22圆\x22},{HTML:{Title:\x22对称角度\x22,IClass:\x22iconfont\x20icon-draw_symangle\x22,ID:\x22icon-symangle\x22},Name:\x22对称角度\x22}],[{HTML:{Title:\x22文本\x22,IClass:\x22iconfont\x20icon-draw_text\x22,ID:\x22icon-text\x22},Name:\x22文本\x22},{HTML:{Title:\x22向上箭头\x22,IClass:\x22iconfont\x20icon-arrow_up\x22,ID:\x22icon-arrowup\x22},Name:\x22icon-arrow_up\x22},{HTML:{Title:\x22向下箭头\x22,IClass:\x22iconfont\x20icon-arrow_down\x22,ID:\x22icon-arrowdown\x22},Name:\x22icon-arrow_down\x22},{HTML:{Title:\x22向左箭头\x22,IClass:\x22iconfont\x20icon-arrow_left\x22,ID:\x22icon-arrowleft\x22},Name:\x22icon-arrow_left\x22},{HTML:{Title:\x22向右箭头\x22,IClass:\x22iconfont\x20icon-arrow_right\x22,ID:\x22icon-arrowright\x22},Name:\x22icon-arrow_right\x22}],[{HTML:{Title:\x22江恩角度线\x22,IClass:\x22iconfont\x20icon-draw_gannfan\x22,ID:\x22icon-gannfan\x22},Name:\x22江恩角度线\x22},{HTML:{Title:\x22斐波那契周期线\x22,IClass:\x22iconfont\x20icon-draw_fibonacci\x22,ID:\x22icon-fibonacci\x22},Name:\x22斐波那契周期线\x22},{HTML:{Title:\x22阻速线\x22,IClass:\x22iconfont\x20icon-draw_resline\x22,ID:\x22icon-resline\x22},Name:\x22阻速线\x22},{HTML:{Title:\x22黄金分割\x22,IClass:\x22iconfont\x20icon-draw_goldensection\x22,ID:\x22icon-goldensection\x22},Name:\x22黄金分割\x22},{HTML:{Title:\x22百分比线\x22,IClass:\x22iconfont\x20icon-draw_percentage\x22,ID:\x22icon-percentage\x22},Name:\x22百分比线\x22},{HTML:{Title:\x22波段线\x22,IClass:\x22iconfont\x20icon-draw_waveband\x22,ID:\x22icon-waveband\x22},Name:\x22波段线\x22}],[{HTML:{Title:\x22全部删除\x22,IClass:\x22iconfont\x20icon-recycle_bin\x22,ID:\x22icon-delete\x22},Name:\x22全部删除\x22}]];var\x20e=this.HQChart;if(!this.ToolsDiv){var\x20a=document.createElement(\x22div\x22);a.className=\x22drawtools\x22,a.id=this.ID;var\x20i=\x22\x22,r=\x22\x22,n=new\x20Array;t.forEach(function(t,e){n.push(t[0])});for(var\x20s=0;s<t.length;s++){for(var\x20o=n[s],h=t[s],l=\x22\x22,C=\x22\x22,u=0;u<h.length;u++){var\x20D=h[u],d=D.Name;d.indexOf(\x22up\x22)>-1?d=\x22向上箭头\x22:d.indexOf(\x22down\x22)>-1?d=\x22向下箭头\x22:d.indexOf(\x22left\x22)>-1?d=\x22向左箭头\x22:d.indexOf(\x22right\x22)>-1&&(d=\x22向右箭头\x22),l+=\x27<p\x20class=\x22menuTwoItem\x20\x27+D.HTML.ID+\x27\x22>\x27+d+\x27<i\x20class=\x22\x27+D.HTML.IClass+\x27\x22\x20title=\x22\x27+D.HTML.Title+\x27\x22></i></p>\x27}s!==t.length-1?(r=\x27<div\x20class=\x22menuTwo\x22>\x27+l+\x22</div>\x22,C=\x27<i\x20class=\x22contentArrow\x20iconfont\x20icon-menu_arraw_left\x22></i>\x27):(r=\x22\x22,C=\x22\x22),i+=\x27<div\x20class=\x22icon-image\x20first-\x27+o.HTML.ID+\x27\x22><i\x20class=\x22\x27+o.HTML.IClass+\x27\x22\x20title=\x22\x27+o.HTML.Title+\x27\x22></i>\x27+r+C+\x22</div>\x22}for(var\x20s\x20in\x20this.ChartBorder.UIElement.parentNode.appendChild(a),a.innerHTML=i,this.ToolsDiv=a,t){var\x20c=t[s][0];if($(\x22#\x22+this.ID+\x22\x20.first-\x22+c.HTML.ID).hover(function(){$(\x22.drawtools\x22).find(\x22.contentArrow\x22).hide(),$(this).find(\x22.contentArrow\x22).removeClass(\x22trans\x22).show()}),$(\x22#\x22+this.ID+\x22\x20.first-\x22+c.HTML.ID+\x22\x20.contentArrow\x22).click(function(t){t.stopPropagation(),$(\x22.drawtools\x22).find(\x22.menuTwo\x22).hide(),$(this).siblings(\x22.menuTwo\x22).show()}),$(\x22#\x22+this.ID+\x22\x20.first-\x22+c.HTML.ID+\x22\x20.trans\x22).click(function(){event.stopPropagation(),$(this).siblings(\x22.menuTwo\x22).hide()}),\x22全部删除\x22==c.Name)$(\x22#\x22+this.ID+\x22\x20.first-icon-delete\x22).click(function(){$(\x22.drawtools\x22).find(\x22.menuTwo\x22).hide(),$(this).siblings().removeClass(\x22active\x22),$(this).addClass(\x22active\x22),e.ClearChartDrawPicture(),$(\x22.subTolls\x22).css(\x22display\x22,\x22none\x22)});else\x20for(var\x20u\x20in\x20$(\x22#\x22+this.ID+\x22\x20.first-\x22+n[s].HTML.ID).click({CurrentIndex:s},function(t){$(\x22.drawtools\x22).find(\x22.menuTwo\x22).hide(),$(this).siblings().removeClass(\x22active\x22),$(this).addClass(\x22active\x22),e.CreateChartDrawPicture(n[t.data.CurrentIndex].Name)}),t[s]){var\x20m=t[s][u];let\x20a=m.HTML.IClass;$(\x22#\x22+this.ID+\x22\x20.\x22+m.HTML.ID).hover(function(t){t.stopPropagation(),$(this).closest(\x22.icon-image\x22).find(\x22.contentArrow\x22).addClass(\x22trans\x22)}),$(\x22#\x22+this.ID+\x22\x20.\x22+m.HTML.ID).click({DrawName:m.Name,CurrentIndex:s,CurrentData:m},function(t){t.stopPropagation(),$(this).closest(\x22.icon-image\x22).find(\x22.contentArrow\x22).hide(),$(this).siblings().removeClass(\x22current\x22),$(this).addClass(\x22current\x22),$(this).closest(\x22.icon-image\x22).children(\x22i\x22).eq(0).removeClass().addClass(a,\x22active\x22).attr(\x22title\x22,t.data.CurrentData.HTML.Title),n.splice(t.data.CurrentIndex,1,t.data.CurrentData),$(this).parent().hide(),e.CreateChartDrawPicture(t.data.DrawName)})}}}var\x20f=this.ID;$(document).click(function(t){$(\x22#\x22+f).is(t.target)||0!==$(\x22#\x22+f).has(t.target).length||($(\x22#\x22+f+\x22\x20.menuTwo\x22).hide(),$(\x22#\x22+f+\x22\x20.contentArrow\x22).hide())});GetScrollPosition();var\x20v=GetDevicePixelRatio(),S=ToFixedPoint(this.ChartBorder.GetRight()+this.Left),T=this.ChartBorder.GetTop();this.ToolsDiv.style.left=S/v+\x22px\x22,this.ToolsDiv.style.top=T/v+\x22px\x22,this.ToolsDiv.style.width=(this.Width-5)/v+\x22px\x22,this.ToolsDiv.style.height=\x22auto\x22,this.ToolsDiv.style.position=\x22absolute\x22,this.ToolsDiv.style.display=\x22block\x22,this.SizeChange}}function\x20DepthMapPaint(){this.newMethod=IExtendChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22DepthMapPaint\x22,this.LineColor=\x22rgba(0,139,0,0.6)\x22,this.AreaColor=[\x22rgba(0,139,0,0.5)\x22,\x22rgba(0,139,0,0.4)\x22,\x22rgba(0,139,0,0.3)\x22,\x22rgba(0,139,0,0.2)\x22],this.TextColor=\x22rgba(0,0,0)\x22,this.TextBGColor=\x22rgba(0,139,0)\x22,this.Width=200*GetDevicePixelRatio(),this.FrameID=0,this.ID=Guid(),this.IsDynamic=!1,this.IsCallbackDraw=!0,this.YRange,this.SetOption=function(t){t.FrameID>0&&(this.FrameID=t.FrameID),t.Width>0&&(this.Width=t.Width),IFrameSplitOperator.IsObjectExist(t.ID)&&(this.ID=t.ID),t.IsShowCorssCursor&&(this.IsShowCorssCursor=t.IsShowCorssCursor)},this.Draw=function(){if(this.Data&&this.ChartFrame&&this.ChartFrame.SubFrame&&!(this.ChartFrame.SubFrame.length<=this.FrameID)){var\x20t,e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.SubFrame[this.FrameID].Frame.ChartBorder,i=a.GetHeightEx(),r=a.GetRight(),n=a.GetTopEx(),s=a.GetBottomEx();if((t=this.Width)>this.ChartBorder.Right&&(t=this.ChartBorder.Right),e)r=a.GetBottom(),n=a.GetRight(),s=a.GetLeft(),(t=this.Width)>this.ChartBorder.Bottom&&(t=this.ChartBorder.Bottom);var\x20o={Left:r,Top:n,Right:r+t,Bottom:s,Height:i,Width:t};for(var\x20h\x20in\x20this.YRange={Max:null,Min:0},this.Data){var\x20l=this.Data[h];this.CalculateYRange(l,this.YRange)}for(var\x20h\x20in\x20this.Data){(l=this.Data[h]).Height>0&&l.Height<=1?o.Height=i*l.Height:o.Height=i,1==l.Type?(o.Top=n,o.Bottom=n+o.Height,this.DrawUpArea(l,o)):2==l.Type?(o.Bottom=s,o.Top=o.Bottom-o.Height,this.DrawDownArea(l,o)):(o.Top=n,o.Bottom=s,this.DrawDefaultArea(l,o))}}},this.CalculateYRange=function(t,e){for(var\x20a\x20in\x20t.Data){var\x20i=t.Data[a];(null==e.Max||e.Max<i.Y)&&(e.Max=i.Y),(null==e.Min||e.Min>i.Y)&&(e.Min=i.Y)}},this.GetXFromData=function(t,e,a){var\x20i=e.Width*(t-a.Min)/(a.Max-a.Min);return\x20e.Left+i},this.GetYFromData=function(t,e,a,i){if(i){var\x20r=e.Height*(t-a.Min)/(a.Max-a.Min);return\x20e.Bottom-r}r=e.Height*(t-a.Min)/(a.Max-a.Min);return\x20e.Top+r},this.DrawDefaultArea=function(t,e){var\x20a=this.ChartFrame.SubFrame[this.FrameID].Frame,i=t.Range&&t.Range.Y?t.Range.Y:this.YRange,r=[];for(var\x20n\x20in\x20t.Data){var\x20s=t.Data[n],o=this.GetXFromData(s.Y,e,i);if(!(s.X>a.HorizontalMax||s.X<a.HorizontalMin)){var\x20h=a.GetYFromData(s.X);r.push({X:o,Y:h})}}var\x20l=t.LineColor?t.LineColor:this.LineColor,C=t.AreaColor?t.AreaColor:this.AreaColor;r.length>0&&this.DrawLine(r,l,C,e)},this.DrawUpArea=function(t,e){var\x20a=[];for(var\x20i\x20in\x20t.Data){var\x20r=t.Data[i],n=this.GetXFromData(r.Y,e,t.Range.Y),s=this.GetYFromData(r.X,e,t.Range.X,t.IsASC);a.push({X:n,Y:s})}var\x20o=t.LineColor?t.LineColor:this.LineColor,h=t.AreaColor?t.AreaColor:this.AreaColor;a.length>0&&this.DrawLine(a,o,h,e)},this.DrawDownArea=function(t,e){var\x20a=[];for(var\x20i\x20in\x20t.Data){var\x20r=t.Data[i],n=this.GetXFromData(r.Y,e,t.Range.Y),s=this.GetYFromData(r.X,e,t.Range.X,t.IsASC);a.push({X:n,Y:s})}var\x20o=t.LineColor?t.LineColor:this.LineColor,h=t.AreaColor?t.AreaColor:this.AreaColor;a.length>0&&this.DrawLine(a,o,h,e)},this.DrawLine=function(t,e,a,i){var\x20r=!0===this.ChartFrame.IsHScreen,n=!0,s=0;for(var\x20o\x20in\x20this.Canvas.strokeStyle=e,t){var\x20h=t[o];n?(this.Canvas.beginPath(),r?this.Canvas.moveTo(h.Y,h.X):this.Canvas.moveTo(h.X,h.Y),n=!1):r?this.Canvas.lineTo(h.Y,h.X):this.Canvas.lineTo(h.X,h.Y),++s}s>0&&this.Canvas.stroke();var\x20l=t[0],C=t[t.length-1];if(r?(this.Canvas.lineTo(C.Y,i.Left),this.Canvas.lineTo(l.Y,i.Left)):(this.Canvas.lineTo(i.Left,C.Y),this.Canvas.lineTo(i.Left,l.Y)),this.Canvas.closePath(),Array.isArray(a))if(r){let\x20t=this.Canvas.createLinearGradient(this.ChartBorder.GetRightEx(),this.ChartBorder.GetTop(),this.ChartBorder.GetLeft(),this.ChartBorder.GetTop());t.addColorStop(0,a[0]),t.addColorStop(1,a[1]),this.Canvas.fillStyle=t}else{let\x20t=this.Canvas.createLinearGradient(i.Right,i.Top,i.Left,i.Top);var\x20u=1/a.length;for(var\x20o\x20in\x20a)t.addColorStop(o*u,a[o]);this.Canvas.fillStyle=t}else\x20this.Canvas.fillStyle=a;this.Canvas.fill()},this.GetYValueByXValue=function(t,e){var\x20a=[],i=ZOOM_VALUE[e];for(var\x20r\x20in\x20this.Data){var\x20n=this.Data[r];if(0==n.Type&&n.Data&&!(n.Data.length<0)&&0!=n.IsShowCorssCursor){var\x20s=!1;for(var\x20o\x20in\x20n.Data){var\x20h=n.Data[o];if(parseInt(h.X*i)==t){s=!0;var\x20l={X:h.X,Y:h.Y,TextColor:n.TextColor?n.TextColor:this.TextColor,TextBGColor:n.TextBGColor?n.TextBGColor:this.TextBGColor};h.YText&&(l.YText=h.YText),a.push(l);break}}if(!s){var\x20C=n.Data[0],u=n.Data[n.Data.length-1];t>C.X*i&&t<u.X*i&&a.push({X:null,Y:null,TextColor:n.TextColor?n.TextColor:this.TextColor,TextBGColor:n.TextBGColor?n.TextBGColor:this.TextBGColor})}}}return\x20a}}function\x20BackgroundPaint(){this.newMethod=IExtendChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22BackgroundPaint\x22,this.IsDynamic=!1,this.IsCallbackDraw=!0,this.FrameID=0,this.Data,this.ID=Guid(),this.ChartSubFrame,this.ChartBorder,this.KData,this.Period,this.XPointCount=0,this.SetOption=function(t){t.FrameID>0&&(this.FrameID=t.FrameID),IFrameSplitOperator.IsObjectExist(t.ID)&&(this.ID=t.ID)},this.Draw=function(){if(this.Data&&this.HQChart&&this.ChartFrame&&this.ChartFrame.SubFrame&&!(this.ChartFrame.SubFrame.length<=this.FrameID)){var\x20t=this.HQChart.ChartPaint[0];if(t&&t.Data&&(this.ChartSubFrame=this.ChartFrame.SubFrame[this.FrameID].Frame,this.ChartBorder=this.ChartSubFrame.ChartBorder,this.KData=t.Data,this.Period=this.HQChart.Period,this.KData&&!(this.KData.Data.length<=0))){var\x20e=!0===this.ChartSubFrame.IsHScreen;this.XPointCount=this.ChartSubFrame.XPointCount;var\x20a=this.ChartSubFrame.XPointCount,i=this.KData.Data[this.KData.DataOffset],r=this.KData.DataOffset+a-1;r>=this.KData.Data.length&&(r=this.KData.Data.length-1);var\x20n=this.KData.Data[r],s=this.GetShowData(i,n);if(s&&!(s.length<=0)){var\x20o=this.BuildKLineMap(),h=this.ChartBorder.GetBottomEx(),l=this.ChartBorder.GetTopEx(),C=this.ChartBorder.GetHeightEx();for(var\x20u\x20in\x20e&&(l=this.ChartBorder.GetRightEx(),h=this.ChartBorder.GetLeftEx(),C=this.ChartBorder.GetWidthEx()),s){var\x20D=s[u],d=this.GetBGCoordinate(D,o);if(d){if(Array.isArray(D.Color)){var\x20c;c=e?this.Canvas.createLinearGradient(h,d.Left,l,d.Left):this.Canvas.createLinearGradient(d.Left,l,d.Left,h);var\x20m=1/D.Color.length;for(var\x20u\x20in\x20D.Color)c.addColorStop(u*m,D.Color[u]);this.Canvas.fillStyle=c}else\x20this.Canvas.fillStyle=D.Color;e?this.Canvas.fillRect(ToFixedRect(h),ToFixedRect(d.Left),ToFixedRect(C),ToFixedRect(d.Width)):this.Canvas.fillRect(ToFixedRect(d.Left),ToFixedRect(l),ToFixedRect(d.Width),ToFixedRect(C))}}}}}},this.GetShowData=function(t,e){var\x20a=[];for(var\x20i\x20in\x20this.Data){var\x20r=this.Data[i],n={};r.Start.Date>=t.Date&&r.Start.Date<=e.Date&&(n.Start=r.Start),r.End.Date>=t.Date&&r.End.Date<=e.Date&&(n.End=r.End),(n.Start||n.End)&&(n.Color=r.Color,a.push(n))}return\x20a},this.BuildKLineMap=function(){var\x20t=!0===this.ChartSubFrame.IsHScreen,e=this.ChartSubFrame.DataWidth,a=this.ChartSubFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+g_JSChartResource.FrameLeftMargin;t&&(i=this.ChartBorder.GetTop()+a/2+g_JSChartResource.FrameLeftMargin);var\x20r=this.ChartBorder.GetRight();t&&(r=this.ChartBorder.GetBottom());for(var\x20n={Data:new\x20Map,Start:null,End:null},s=this.KData.DataOffset,o=0;s<this.KData.Data.length&&o<this.XPointCount;++s,++o,i+=e+a){var\x20h=this.KData.Data[s],l=i,C=i+e;if(C>r)break;var\x20u=l+(C-l)/2;0==o&&(n.XLeft=l),n.XRight=C;var\x20D={Index:s,ShowIndex:o,X:u,Right:C,Left:l,Date:h.Date};if(ChartData.IsMinutePeriod(this.Period,!0)){var\x20d=`Date:${h.Date}\x20Time:${h.Time}`;D.Time=h.Time}else\x20d=`Date:${h.Date}`;n.Data.set(d,D),0==o&&(n.Start=D),n.End=D}return\x20n},this.GetBGCoordinate=function(t,e){var\x20a=null,i=null,r=ChartData.IsMinutePeriod(this.Period,!0),n=!1;if(r?t.Start&&t.End&&t.Start.Date==t.End.Date&&t.Start.Time==t.End.Time&&(n=!0):t.Start&&t.End&&t.Start.Date==t.End.Date&&(n=!0),n){if(r)var\x20s=`Date:${t.Start.Date}\x20Time:${t.Start.Time}`;else\x20s=`Date:${t.Start.Date}`;return\x20e.Data.has(s)?{Left:a=(h=e.Data.get(s)).Left,Right:i=h.Right,Width:i-a}:null}if(t.Start){if(r)s=`Date:${t.Start.Date}\x20Time:${t.Start.Time}`;else\x20s=`Date:${t.Start.Date}`;if(e.Data.has(s))a=(h=e.Data.get(s)).Left;else\x20if(r)if(t.Start.Date<e.Start.Date||t.Start.Date==e.Start.Date&&t.Start.Time<=e.Start.Time)a=e.Start.Left;else\x20for(var\x20o\x20of\x20e.Data){if((C=o[1]).Date>t.Start.Date||C.Date==t.Start.Date&&C.Time>t.Start.Time){a=C.Left;break}}else\x20if(t.Start.Date<=e.Start.Date)a=e.Start.Left;else\x20for(var\x20o\x20of\x20e.Data){if((C=o[1]).Date>t.Start.Date){a=C.Left;break}}}else\x20a=e.XLeft;if(t.End){if(r)s=`Date:${t.End.Date}\x20Time:${t.End.Time}`;else\x20s=`Date:${t.End.Date}`;var\x20h;if(e.Data.has(s))i=(h=e.Data.get(s)).Right;else\x20if(r)if(t.End.Date<e.End.Date||t.End.Date==e.End.Date&&t.End.Time>=e.End.Time)i=e.End.Right;else{var\x20l=null;for(var\x20o\x20of\x20e.Data){if((C=o[1]).Date>t.End.Date||C.Date==t.End.Date&&C.Time>t.End.Time){i=l;break}l=C.Right}}else\x20if(t.End.Date<=e.End.Date)i=e.End.Right;else{l=null;for(var\x20o\x20of\x20e.Data){var\x20C;if((C=o[1]).Date>t.End.Date){i=l;break}l=C.Right}}}else\x20i=e.XRight;return\x20null==a||null==i?null:{Left:a,Right:i,Width:i-a}}}function\x20BarrageList(){this.PlayList=[],this.Cache=[],this.MinLineHeight=40*GetDevicePixelRatio(),this.Height,this.Step=1,this.GetPlayList=function(t){for(var\x20e=t.Canves,a=t.Right-t.Left,i=t.IsMoveStep,r=[],n=0,s=0;s<this.PlayList.length;++s){var\x20o=this.PlayList[s],h=this.MinLineHeight;o.Height>this.MinLineHeight&&(h=o.Height);for(var\x20l=!0,C=!1,u=0;u<o.Data.length;++u){var\x20D=o.Data[u],d={X:D.X,Y:n,Text:D.Text,Color:D.Color,Height:h,Font:D.Font,Info:D.Info};r.push(d),i&&(u==o.Data.length-1&&this.Cache.length>0?(l=!1,D.TextWidth||(D.Font&&D.Font.Name?e.font=D.Font.Name:e.font=t.Font,D.TextWidth=e.measureText(d.Text+\x22擎擎\x22).width),D.X>=D.TextWidth&&(l=!0)):0==u&&(C=!1,D.TextWidth||(D.Font&&D.Font.Name?e.font=D.Font.Name:e.font=t.Font,D.TextWidth=e.measureText(d.Text+\x22擎擎\x22).width),D.X>a+D.TextWidth&&(C=!0)),D.X+=this.Step)}if(i&&l&&this.Cache.length>0){var\x20c=this.Cache.shift(),m={X:0,Text:c.Text,Color:c.Color,Font:c.Font,Info:c.Info};o.Data.push(m)}if(i&&C&&o.Data.length>0){var\x20f=o.Data.shift();this.OnItemPlayEnd(t.HQChart,f)}n+=h}return\x20r},this.CacluatePlayLine=function(t){this.Height=t;var\x20e=parseInt(t/this.MinLineHeight);if(this.PlayList.length<e)for(var\x20a=e-this.PlayList.length,i=0;i<a;++i)this.PlayList.push({Data:[]});else\x20if(this.PlayList.length>e){var\x20r=this.PlayList.length-e;for(i=0;i<r;++i)for(var\x20n=this.PlayList.pop(),s=0;s<n.Data.length;++s){var\x20o=n.Data[s],h={Text:o.Text,Color:o.Color,Font:o.Font,Info:o.Info};this.Cache.unshift(h)}}JSConsole.Chart.Log(`[BarrageList::CacluatePlayLine]\x20LineCount=${this.PlayList.length}\x20Height=${this.Height}`)},this.AddBarrage=function(t){for(var\x20e\x20in\x20t){var\x20a=t[e];this.Cache.push(a)}},this.OnItemPlayEnd=function(t,e){if(t.mapEvent.has(JSCHART_EVENT_ID.BARRAGE_PLAY_END)){var\x20a=t.mapEvent.get(JSCHART_EVENT_ID.BARRAGE_PLAY_END);a.Callback&&a.Callback(a,e,this)}},this.Count=function(){return\x20this.Cache.length}}function\x20BarragePaint(){this.newMethod=IExtendChartPainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22BarragePaint\x22,this.IsAnimation=!0,this.IsEraseBG=!0,this.HQChart,this.Font=g_JSChartResource.Barrage.Font,this.TextColor=g_JSChartResource.Barrage.Color,this.FontHeight=g_JSChartResource.Barrage.Height,this.BarrageList=new\x20BarrageList,this.IsMoveStep=!1,this.SetOption=function(t){t&&(t.Step>0&&(this.BarrageList.Step=t.Step),t.MinLineHeight&&(this.Barrage.MinLineHeight=t.MinLineHeight))},this.DrawHScreen=function(){var\x20t=this.ChartBorder.GetWidth(),e=this.ChartBorder.GetTop(),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetRightEx();this.ChartBorder.GetChartWidth();t!=this.BarrageList.Height&&this.BarrageList.CacluatePlayLine(t),this.Canvas.textBaseline=\x22middle\x22,this.Canvas.textAlign=\x22left\x22;var\x20r=this.BarrageList.GetPlayList({Canves:this.Canvas,Right:a,Left:e,Font:this.Font,IsMoveStep:this.IsMoveStep,HQChart:this.HQChart});if(this.IsMoveStep=!1,r){this.Canvas.save(),this.Canvas.translate(this.ChartBorder.GetChartHeight(),0),this.Canvas.rotate(90*Math.PI/180);for(var\x20n=0;n<r.length;++n){var\x20s=r[n];s.Color?this.Canvas.fillStyle=s.Color:this.Canvas.fillStyle=this.TextColor,s.Font?this.Canvas.font=s.Font.Name:this.Canvas.font=this.Font;var\x20o=this.FontHeight;s.Font&&s.Font.Height>0&&(o=s.Font.Height);var\x20h=s.Y+parseInt((s.Height-o)/2);this.Canvas.fillText(s.Text,a-s.X,i+h)}this.Canvas.restore()}},this.Draw=function(){if(this.ChartFrame.IsHScreen)this.DrawHScreen();else{var\x20t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetTopEx(),i=this.ChartBorder.GetHeight();i!=this.BarrageList.Height&&this.BarrageList.CacluatePlayLine(i),this.Canvas.textBaseline=\x22middle\x22,this.Canvas.textAlign=\x22left\x22;var\x20r=this.BarrageList.GetPlayList({Canves:this.Canvas,Right:e,Left:t,Font:this.Font,IsMoveStep:this.IsMoveStep,HQChart:this.HQChart});if(this.IsMoveStep=!1,r)for(var\x20n=0;n<r.length;++n){var\x20s=r[n];s.Color?this.Canvas.fillStyle=s.Color:this.Canvas.fillStyle=this.TextColor,s.Font?this.Canvas.font=s.Font.Name:this.Canvas.font=this.Font;var\x20o=this.FontHeight;s.Font&&s.Font.Height>0&&(o=s.Font.Height);var\x20h=s.Y+parseInt((s.Height-o)/2);this.Canvas.fillText(s.Text,e-s.X,a+h)}}}}function\x20IFrameSplitOperator(){this.ChartBorder,this.Frame,this.FrameSplitData,this.SplitCount=5,this.StringFormat=0,this.IsShowLeftText=!0,this.IsShowRightText=!0,this.LanguageID=JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.IntegerCoordinateSplit=function(t){var\x20e=this.FrameSplitData.Find(t.Interval);if(!e)return!1;if(t.Interval==e.FixInterval)return!0;var\x20a=parseInt((t.Max/e.FixInterval+.5).toFixed(0))*e.FixInterval,i=parseInt((t.Min/e.FixInterval-.5).toFixed(0))*e.FixInterval;0==t.Min&&(i=0),i<0&&t.Min>0&&(i=0);for(var\x20r=0,n=i;n-a<1e-8;n+=e.FixInterval)++r;return\x20t.Interval=e.FixInterval,t.Max=a,t.Min=i,t.Count=r,!0},this.Filter=function(t,e){if(this.SplitCount<=0||t.length<=0||t.length<=this.SplitCount)return\x20t;var\x20a=parseInt(t.length/this.SplitCount);a<=1&&(a=2);for(var\x20i=[],r=0;r<t.length;r+=a)r+a>=t.length&&r!=t.length-1?i.push(t[t.length-1]):i.push(t[r]);if(2==this.SplitCount&&i.length>2)for(r=1;r<i.length-1;++r){(s=i[r]).Message[0]=null,s.Message[1]=null}if(e){var\x20n=!1;for(r=0;r<i;++r){var\x20s=i[r];if(Math.abs(s.Value)<1e-8){n=!0;break}}if(0==n){var\x20o=new\x20CoordinateInfo;o.Value=0,o.Message[0]=null,o.Message[1]=null,i.push(o)}}return\x20i},this.RemoveZero=function(t){var\x20e=[!0,!0];for(var\x20a\x20in\x20t){var\x20i=(r=t[a]).Message[0];this.IsDecimalZeroEnd(i)||(e[0]=!1);i=r.Message[1];this.IsDecimalZeroEnd(i)||(e[1]=!1)}if(0!=e[0]||0!=e[1])for(var\x20a\x20in\x20t){var\x20r=t[a];if(e[0])null!=(i=r.Message[0])&&(\x22number\x22==typeof\x20i&&(i=i.toString()),r.Message[0]=i.replace(/[.][0]+/g,\x22\x22));if(e[1])null!=(i=r.Message[1])&&(\x22number\x22==typeof\x20i&&(i=i.toString()),r.Message[1]=i.replace(/[.][0]+/g,\x22\x22))}},this.IsDecimalZeroEnd=function(t){if(null==t)return!0;if(\x22number\x22==typeof\x20t&&(t=t.toString()),\x220\x22==t)return!0;var\x20e=t.search(/[.]/);if(e<0)return!1;for(var\x20a=e+1;a<t.length;++a){var\x20i=t.charAt(a);if(i>=\x221\x22&&i<=\x229\x22)return!1}return!0}}function\x20FrameSplitKLinePriceY(){this.newMethod=IFrameSplitOperator,this.newMethod(),delete\x20this.newMethod,this.CoordinateType=0,this.Symbol,this.Data,this.FrameSplitData2,this.FloatPrecision=null,this.Period,this.KLineChart,this.Custom=[],this.SplitType=0,this.DefaultYMaxMin,this.Operator=function(){var\x20t={};if(t.Max=this.Frame.HorizontalMax,t.Min=this.Frame.HorizontalMin,t.Count=this.SplitCount,this.DefaultYMaxMin){var\x20e=this.DefaultYMaxMin;IFrameSplitOperator.IsNumber(e.Max)&&(t.Min>e.Max?t.Min=e.Max:t.Max<e.Max&&(t.Max=e.Max)),IFrameSplitOperator.IsNumber(e.Min)&&(t.Max<e.Min?t.Max=e.Min:t.Min>e.Min&&(t.Min=e.Min))}t.Interval=(t.Max-t.Min)/(t.Count-1);var\x20a=GetDevicePixelRatio(),i=this.Frame.ChartBorder.GetChartWidth()<450*a,r=GetfloatPrecision(this.Symbol);i&&MARKET_SUFFIX_NAME.IsSHSZIndex(this.Symbol)&&(r=0),null!=this.FloatPrecision&&(r=this.FloatPrecision),JSConsole.Chart.Log(`[FrameSplitKLinePriceY::Operator]\x20Max=${t.Max}\x20Min=${t.Min}\x20Count=${t.Count}\x20isPhoneModel=${i}\x20defaultfloatPrecision=${r}\x20`),this.Frame.Logarithmic=null;var\x20n=!0;if(ChartData.IsTickPeriod(this.Period))this.SplitTickData(t,r);else\x20switch(this.CoordinateType){case\x201:this.SplitPercentage(t,r);break;case\x202:this.SplitLogarithmic(t,r)?n=!1:this.SplitDefault(t,r);break;default:1==this.SplitType?(this.SplitFixed(t,r),n=!1):this.SplitDefault(t,r)}this.CustomCoordinate(r),n&&(this.Frame.HorizontalInfo=this.Filter(this.Frame.HorizontalInfo,!1)),this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min,JSConsole.Chart.Log(`[FrameSplitKLinePriceY::Operator]\x20fixed\x20.\x20Max=${t.Max}\x20Min=${t.Min}\x20Count=${t.Count}`)},this.SplitTickData=function(t,e){var\x20a=this.KLineChart.GetAllPrice();for(var\x20i\x20in\x20this.Frame.HorizontalInfo=[],a){var\x20r=a[i];this.Frame.HorizontalInfo[i]=new\x20CoordinateInfo,this.Frame.HorizontalInfo[i].Value=r,this.IsShowLeftText&&(this.Frame.HorizontalInfo[i].Message[0]=r.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[i].Message[1]=r.toFixed(e))}},this.SplitPercentage=function(t,e){var\x20a=this.GetFirstOpenPrice();t.Max=(t.Max-a)/a,t.Min=(t.Min-a)/a,t.Interval=(t.Max-t.Min)/(t.Count-1),this.IntegerCoordinateSplit2(t),this.Frame.HorizontalInfo=[];for(var\x20i=0,r=t.Min;i<t.Count;++i,r+=t.Interval){var\x20n=(r+1)*a;this.Frame.HorizontalInfo[i]=new\x20CoordinateInfo,this.Frame.HorizontalInfo[i].Value=n,this.IsShowLeftText&&(this.Frame.HorizontalInfo[i].Message[0]=n.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[i].Message[1]=(100*r).toFixed(2)+\x22%\x22)}t.Min=(1+t.Min)*a,t.Max=(1+t.Max)*a},this.SplitLogarithmic=function(t,e){var\x20a=g_JSChartResource.FromeLogarithmic.MinInterval,i=this.GetFirstOpenPrice();if(!IFrameSplitOperator.IsNumber(i))return!1;for(var\x20r=this.ChartBorder.GetHeightEx(),n=[.01,.02,.04,.08,.1,.2],s=n[n.length-1],o=0;o<n.length;++o){var\x20h=n[o];if(i*h*(r/(t.Max-t.Min))>a){s=h;break}}var\x20l=[],C=i;o=s;do{var\x20u={Start:C};C=i*(1+o),u.End=C,l.push(u),o+=s}while(C<t.Max);var\x20D=C,d=[];C=i,o=s;do{u={End:C};C=i*(1-o),u.Start=C,d.push(u),o+=s}while(C>t.Min);var\x20c=C;t.Max=D,t.Min=c,JSConsole.Chart.Log(\x22[FrameSplitKLinePriceY::SplitLogarithmic]\x20up,\x20down\x22,l,d),this.Frame.HorizontalInfo=[],(u=new\x20CoordinateInfo).Value=i,u.Font=g_JSChartResource.FromeLogarithmic.OpenPriceFont;var\x20m=u.Value.toFixed(e);for(var\x20o\x20in\x20this.IsShowLeftText&&(u.Message[0]=m),this.IsShowRightText&&(u.Message[1]=m),this.Frame.HorizontalInfo.push(u),l){(u=new\x20CoordinateInfo).Value=l[o].End;m=u.Value.toFixed(e);this.IsShowLeftText&&(u.Message[0]=m),this.IsShowRightText&&(u.Message[1]=m),this.Frame.HorizontalInfo.push(u)}for(var\x20o\x20in\x20d){(u=new\x20CoordinateInfo).Value=d[o].End;m=u.Value.toFixed(e);this.IsShowLeftText&&(u.Message[0]=m),this.IsShowRightText&&(u.Message[1]=m),this.Frame.HorizontalInfo.splice(0,0,u)}return\x20this.Frame.Logarithmic={Up:l,Down:d,OpenPrice:i},!0},this.SplitDefault=function(t,e){this.IntegerCoordinateSplit(t),this.Frame.HorizontalInfo=[];for(var\x20a=0,i=t.Min;a<t.Count;++a,i+=t.Interval)this.Frame.HorizontalInfo[a]=new\x20CoordinateInfo,this.Frame.HorizontalInfo[a].Value=i,this.IsShowLeftText&&(this.Frame.HorizontalInfo[a].Message[0]=i.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[a].Message[1]=i.toFixed(e))},this.SplitFixed=function(t,e){this.Frame.HorizontalInfo=[];for(var\x20a=0,i=t.Min;a<t.Count;++a,i+=t.Interval)this.Frame.HorizontalInfo[a]=new\x20CoordinateInfo,this.Frame.HorizontalInfo[a].Value=i,this.IsShowLeftText&&(this.Frame.HorizontalInfo[a].Message[0]=i.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[a].Message[1]=i.toFixed(e))},this.CustomCoordinate=function(t){for(var\x20e\x20in\x20this.Frame.CustomHorizontalInfo=[],this.Custom){var\x20a=this.Custom[e];if(0==a.Type){var\x20i=t;IFrameSplitOperator.IsNumber(a.FloatPrecision)&&a.FloatPrecision>=0&&(i=a.FloatPrecision);var\x20r=this.GetLatestPrice(i,a);r&&this.Frame.CustomHorizontalInfo.push(r)}else\x201==a.Type&&this.CustomFixedCoordinate(a)}},this.GetLatestPrice=function(t,e){if(!this.Data||!this.Data.Data)return\x20null;if(this.Data.Data.length<=0)return\x20null;var\x20a=this.Data.Data[this.Data.Data.length-1],i=new\x20CoordinateInfo;return\x20i.Type=0,i.Value=a.Close,i.TextColor=g_JSChartResource.FrameLatestPrice.TextColor,i.LineType=2,\x22left\x22==e.Position?i.Message[0]=a.Close.toFixed(t):i.Message[1]=a.Close.toFixed(t),a.Close>a.Open?i.LineColor=g_JSChartResource.FrameLatestPrice.UpBarColor:a.Close<a.Open?i.LineColor=g_JSChartResource.FrameLatestPrice.DownBarColor:i.LineColor=g_JSChartResource.FrameLatestPrice.UnchagneBarColor,IFrameSplitOperator.IsNumber(e.LineType)&&(i.LineType=e.LineType),0==e.IsShowLine&&(i.LineType=-1),i},this.GetFirstOpenPrice=function(){if(!this.Data)return\x20null;for(var\x20t=this.Frame.XPointCount,e=this.Data.DataOffset,a=0;e<this.Data.Data.length&&a<t;++e,++a){var\x20i=this.Data.Data[e];if(null!=i.Open&&null!=i.High&&null!=i.Low&&null!=i.Close)return\x20i.Open}return\x20null},this.CustomFixedCoordinate=function(t){var\x20e=GetfloatPrecision(this.Symbol);for(var\x20a\x20in\x20t.Data){var\x20i,r=t.Data[a],n=new\x20CoordinateInfo;n.Type=1,n.TextColor=r.TextColor,n.LineColor=r.Color,n.LineType=2,IFrameSplitOperator.IsNumber(t.LineType)&&(n.LineType=t.LineType),0==t.IsShowLine&&(n.LineType=-1),n.Value=r.Value,i=r.Text?r.Text:n.Value.toFixed(e),\x22left\x22==t.Position?n.Message[0]=i:n.Message[1]=i,this.Frame.CustomHorizontalInfo.push(n)}},this.IntegerCoordinateSplit2=function(t){var\x20e=this.FrameSplitData2.Find(t.Interval);if(!e)return!1;if(t.Interval==e.FixInterval)return!0;var\x20a=parseInt((t.Max/e.FixInterval+.5).toFixed(0))*e.FixInterval,i=parseInt((t.Min/e.FixInterval-.5).toFixed(0))*e.FixInterval;0==t.Min&&(i=0),i<0&&t.Min>0&&(i=0);for(var\x20r=0,n=i;n-a<1e-8;n+=e.FixInterval)++r;return\x20t.Interval=e.FixInterval,t.Max=a,t.Min=i,t.Count=r,!0}}function\x20FrameSplitY(){this.newMethod=IFrameSplitOperator,this.newMethod(),delete\x20this.newMethod,this.SplitCount=3,this.FloatPrecision=2,this.FLOATPRECISION_RANGE=[1,.1,.01,.001,1e-4],this.SplitType=0,this.Custom=[],this.DefaultYMaxMin,this.EnableRemoveZero=!0,this.GetFloatPrecision=function(t,e){if(t>this.FLOATPRECISION_RANGE[0])return\x20e;if(e<0)return\x202;for(;e<this.FLOATPRECISION_RANGE.length&&!(t>this.FLOATPRECISION_RANGE[e]);++e);return\x20e},this.Operator=function(){var\x20t={};if(t.Max=this.Frame.HorizontalMax,t.Min=this.Frame.HorizontalMin,this.DefaultYMaxMin){var\x20e=this.DefaultYMaxMin;IFrameSplitOperator.IsNumber(e.Max)&&(t.Min>e.Max?t.Min=e.Max:t.Max<e.Max&&(t.Max=e.Max)),IFrameSplitOperator.IsNumber(e.Min)&&(t.Max<e.Min?t.Max=e.Min:t.Min>e.Min&&(t.Min=e.Min))}if(this.Frame.YSpecificMaxMin?(t.Count=this.Frame.YSpecificMaxMin.Count,t.Interval=(t.Max-t.Min)/(t.Count-1)):1==this.SplitType?(t.Count=this.SplitCount,t.Interval=(t.Max-t.Min)/(t.Count-1)):(t.Count=this.SplitCount,t.Interval=(t.Max-t.Min)/(t.Count-1),this.IntegerCoordinateSplit(t)),this.Frame.HorizontalInfo=[],this.Frame.YSplitScale)for(var\x20a\x20in\x20this.Frame.YSplitScale){var\x20i=this.Frame.YSplitScale[a],r=new\x20CoordinateInfo;if(r.Value=i,(s=Math.abs(i))<1e-10)r.Message[1]=0;else\x20if(s<this.FLOATPRECISION_RANGE[this.FLOATPRECISION_RANGE.length-1])r.Message[1]=i.toExponential(2).toString();else{var\x20n=this.GetFloatPrecision(s,this.FloatPrecision);r.Message[1]=IFrameSplitOperator.FormatValueString(i,n,this.LanguageID)}r.Message[0]=r.Message[1],0==this.IsShowLeftText&&(this.Frame.HorizontalInfo[a].Message[0]=null),0==this.IsShowRightText&&(this.Frame.HorizontalInfo[a].Message[1]=null),this.Frame.HorizontalInfo.push(r)}else\x20for(a=0,i=t.Min;a<t.Count;++a,i+=t.Interval){if(this.Frame.HorizontalInfo[a]=new\x20CoordinateInfo,this.Frame.HorizontalInfo[a].Value=i,1==this.StringFormat){n=this.FloatPrecision;!isNaN(i)&&Math.abs(i)>1e3&&(n=0),this.Frame.HorizontalInfo[a].Message[1]=IFrameSplitOperator.FormatValueString(i,n,this.LanguageID)}else{var\x20s;if((s=Math.abs(i))<1e-10)this.Frame.HorizontalInfo[a].Message[1]=0;else\x20if(s<this.FLOATPRECISION_RANGE[this.FLOATPRECISION_RANGE.length-1])this.Frame.HorizontalInfo[a].Message[1]=i.toExponential(2).toString();else{n=this.GetFloatPrecision(s,this.FloatPrecision);this.Frame.HorizontalInfo[a].Message[1]=IFrameSplitOperator.FormatValueString(i,n,this.LanguageID)}}this.Frame.HorizontalInfo[a].Message[0]=this.Frame.HorizontalInfo[a].Message[1],0==this.IsShowLeftText&&(this.Frame.HorizontalInfo[a].Message[0]=null),0==this.IsShowRightText&&(this.Frame.HorizontalInfo[a].Message[1]=null)}this.CustomCoordinate(),1!=this.SplitType&&(this.Frame.HorizontalInfo=this.Filter(this.Frame.HorizontalInfo,t.Max>0&&t.Min<0)),this.EnableRemoveZero&&this.RemoveZero(this.Frame.HorizontalInfo),this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min,this.RightFrameSplitY()},this.RightFrameSplitY=function(){if(this.Frame.RightFrame){var\x20t=this.Frame.RightFrame;for(var\x20e\x20in\x20this.Frame.HorizontalInfo){var\x20a=this.Frame.HorizontalInfo[e],i=this.Frame.GetYFromData(a.Value),r=t.GetYData(i);a.Message[1]=IFrameSplitOperator.FormatValueString(r,this.FloatPrecision,this.LanguageID)}}},this.CustomCoordinate=function(){for(var\x20t\x20in\x20this.Frame.CustomHorizontalInfo=[],this.Custom){var\x20e=this.Custom[t];0==e.Type||1==e.Type&&this.CustomFixedCoordinate(e)}},this.CustomFixedCoordinate=function(t){for(var\x20e\x20in\x20t.Data){var\x20a,i=t.Data[e],r=new\x20CoordinateInfo;r.Type=1,r.TextColor=i.TextColor,r.LineColor=i.Color,r.LineType=2,IFrameSplitOperator.IsNumber(t.LineType)&&(r.LineType=t.LineType),0==t.IsShowLine&&(r.LineType=-1),r.Value=i.Value,a=i.Text?i.Text:r.Value.toFixed(2),\x22left\x22==t.Position?r.Message[0]=a:r.Message[1]=a,this.Frame.CustomHorizontalInfo.push(r)}}}function\x20FrameSplitKLineX(){this.newMethod=IFrameSplitOperator,this.newMethod(),delete\x20this.newMethod,this.ShowText=!0,this.Period,this.Symbol,this.MinTextDistance=50*GetDevicePixelRatio(),this.MinBarDistance=5,this.SplitDateTime=function(){this.Frame.VerticalInfo=[];var\x20t=this.Frame.DistanceWidth+this.Frame.DataWidth,e=this.Frame.Data.DataOffset,a=this.Frame.XPointCount,i=0,r=0;debug&&console.log(\x22Frame\x22,this,this.Frame);for(var\x20n=0,s=e;n<a&&s<this.Frame.Data.Data.length;++n,++s){i+=t,++r;var\x20o=null;if(0==n){var\x20h=IFrameSplitOperator.FormatDateString(this.Frame.Data.Data[s].Date,\x22MM-DD\x22);o={Value:s-e,Text:h}}else\x20if(i>this.MinTextDistance&&r>=this.MinBarDistance){var\x20l=IFrameSplitOperator.FormatDateString(this.Frame.Data.Data[s].Date,\x22MM-DD\x22);if(l==h)o={Value:s-e,Text:IFrameSplitOperator.FormatTimeString(this.Frame.Data.Data[s].Time)};else\x20o={Value:s-e,Text:h=l}}if(o){var\x20C=new\x20CoordinateInfo;C.Value=o.Value,this.ShowText&&(C.Message[0]=o.Text),this.Frame.VerticalInfo.push(C),i=0,r=0,0==n&&(i=-this.MinTextDistance/2)}}},this.SplitSecond=function(){this.Frame.VerticalInfo=[];for(var\x20t=this.Frame.DistanceWidth+this.Frame.DataWidth,e=this.Frame.Data.DataOffset,a=this.Frame.XPointCount,i=0,r=0,n=0,s=e;n<a&&s<this.Frame.Data.Data.length;++n,++s){i+=t,++r;var\x20o=null;if(0==n)o={Value:s-e,Text:IFrameSplitOperator.FormatDateString(this.Frame.Data.Data[s].Date,\x22MM-DD\x22)};else\x20if(i>this.MinTextDistance&&r>=this.MinBarDistance){o={Value:s-e,Text:IFrameSplitOperator.FormatTimeString(this.Frame.Data.Data[s].Time,\x22HH:MM:SS\x22)}}if(o){var\x20h=new\x20CoordinateInfo;h.Value=o.Value,this.ShowText&&(h.Message[0]=o.Text),this.Frame.VerticalInfo.push(h),i=0,r=0,0==n&&(i=-this.MinTextDistance/2)}}},this.SplitDate=function(){this.Frame.VerticalInfo=[];for(var\x20t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=null,i=null,r=0,n=0,s=t,o=12;n<e&&s<this.Frame.Data.Data.length;++n,++s){var\x20h=parseInt(this.Frame.Data.Data[s].Date/1e4),l=parseInt(this.Frame.Data.Data[s].Date/100)%100;if(i!=l&&++r,o<12||null!=a&&a==h&&null!=i&&i==l)i=l,++o;else{var\x20C,u=new\x20CoordinateInfo;u.Value=s-t,null==a||a!=h?C=h.toString():null!=i&&i==l||(C=l.toString()+\x22月\x22,C=g_JSChartLocalization.GetText(C,this.LanguageID)),a=h,i=l,this.ShowText&&(u.Message[0]=C),this.Frame.VerticalInfo.push(u),o=0}}0==this.Period&&r<=2&&this.SplitShortDate()},this.SplitShortDate=function(){this.Frame.VerticalInfo=[];for(var\x20t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=!0,i=0,r=t,n=12;i<e&&r<this.Frame.Data.Data.length;++i,++r){var\x20s=parseInt(this.Frame.Data.Data[r].Date/1e4);if(n<12)++n;else{var\x20o,h=new\x20CoordinateInfo;h.Value=r-t,a?(o=s.toString(),a=!1):o=IFrameSplitOperator.FormatDateString(this.Frame.Data.Data[r].Date,\x22MM-DD\x22),this.ShowText&&(h.Message[0]=o),this.Frame.VerticalInfo.push(h),n=0}}},this.Operator=function(){null!=this.Frame.Data&&(FrameSplitKLineX.SplitCustom?FrameSplitKLineX.SplitCustom(this):ChartData.IsMinutePeriod(this.Period,!0)?this.SplitDateTime():ChartData.IsSecondPeriod(this.Period)?this.SplitSecond():this.SplitDate())},this.CreateCoordinateInfo=function(){return\x20new\x20CoordinateInfo}}function\x20FrameSplitMinutePriceY(){this.newMethod=IFrameSplitOperator,this.newMethod(),delete\x20this.newMethod,this.High=null,this.Low=null,this.YClose,this.Data,this.AverageData,this.SourceData,this.OverlayChartPaint,this.SplitCount=7,this.Symbol,this.SplitType=0,this.LimitPrice,this.Custom,this.RightTextFormat=0,this.Operator=function(){if(this.Frame.HorizontalInfo=[],this.Frame.CustomHorizontalInfo=[],this.Data){var\x20t=this.Data;if(t.Period=\x2200\x22,!window.chartdata[t.Period]&&(window.chartdata[t.Period]={}),t.Data.length>0){debug&&console.log(t.DataOffset,window.chartdata[t.Period].DataOffset);var\x20e=Math.max(0,t.Data.length-this.Frame.XPointCount),a=e-(null==window.chartdata[t.Period].DataOffset?e:window.chartdata[t.Period].DataOffset);0==t.DataOffset&&(t.DataOffset=a<0||a>3?window.chartdata[t.Period].DataOffset:e)}window.chartdata[t.Period].YClose=this.YClose=_yclose(0==t.DataOffset?0:t.DataOffset+this.Frame.XPointCount-1)||this.YClose,debug&&console.log(\x22FrameSplitMinutePriceY\x22,t.DataOffset,this.Frame.XPointCount,this.YClose,this);var\x20i=this.GetMaxMin();this.Symbol&&MARKET_SUFFIX_NAME.IsUSA(this.Symbol.toUpperCase())?this.USASplit(i):2==this.SplitType?this.USASplit(i):this.DefaultSplit(i),this.CustomCoordinate()}},this.CustomCoordinate=function(){if(this.Custom){var\x20t=GetfloatPrecision(this.Symbol);for(var\x20e\x20in\x20this.Custom){var\x20a=this.Custom[e];if(1==a.Type)this.CustomFixedCoordinate(a);else\x20if(0==a.Type){var\x20i=this.GetLatestPrice(t,a);i&&this.Frame.CustomHorizontalInfo.push(i)}}}},this.GetLatestPrice=function(t,e){if(!this.Data||!this.Data.Data)return\x20null;if(this.Data.Data.length<=0)return\x20null;var\x20a=this.Data.Data[this.Data.Data.length-1];if(!IFrameSplitOperator.IsNumber(a)||!IFrameSplitOperator.IsNumber(this.YClose))return\x20null;var\x20i=new\x20CoordinateInfo;return\x20i.Type=0,i.Value=a,i.TextColor=g_JSChartResource.FrameLatestPrice.TextColor,i.LineType=2,\x22left\x22==e.Position?i.Message[0]=a.toFixed(t):i.Message[1]=a.toFixed(t),a>this.YClose?i.LineColor=g_JSChartResource.FrameLatestPrice.UpBarColor:a<this.YClose?i.LineColor=g_JSChartResource.FrameLatestPrice.DownBarColor:i.LineColor=g_JSChartResource.FrameLatestPrice.UnchagneBarColor,IFrameSplitOperator.IsNumber(e.LineType)&&(i.LineType=e.LineType),0==e.IsShowLine&&(i.LineType=-1),i},this.CustomFixedCoordinate=function(t){var\x20e=GetfloatPrecision(this.Symbol);for(var\x20a\x20in\x20t.Data){var\x20i,r=t.Data[a],n=new\x20CoordinateInfo;n.Type=1,n.TextColor=r.TextColor,n.LineColor=r.Color,n.LineType=2,IFrameSplitOperator.IsNumber(t.LineType)&&(n.LineType=t.LineType),0==t.IsShowLine&&(n.LineType=-1),IFrameSplitOperator.IsNumber(r.Increase)?(IFrameSplitOperator.IsNumber(this.YClose)||conintue,n.Value=this.YClose*(1+r.Increase)):n.Value=r.Value,i=r.Text?r.Text:n.Value.toFixed(e),\x22left\x22==t.Position?n.Message[0]=i:n.Message[1]=i,this.Frame.CustomHorizontalInfo.push(n)}},this.GetMaxMin=function(){var\x20t=this.YClose,e=this.YClose,a=this.Data,i=!1;this.SourceData&&(a=this.SourceData,i=!0),debug&&console.log(\x22>>>>>>>>>>>>>>>>>>>>\x20GetMaxMin\x22,a.DataOffset,this.Frame.XPointCount);for(var\x20r=0,n=a.DataOffset;r<this.Frame.XPointCount&&n<a.Data.length;n++,r++){var\x20s=null;if(i){var\x20o=a.Data[n];s=o.Before?o.Before.Close:o.Close}else\x20s=a.Data[n];null!=s&&(t<s&&(t=s),e>s&&(e=s))}return{Max:t,Min:e}},this.USASplit=function(t){var\x20e=t.Max,a=t.Min;if(e==a)e+=.1*e,a-=.1*a;else{var\x20i=5*GetDevicePixelRatio()*(e-a)/this.Frame.ChartBorder.GetHeight();e+=i,(a-=i)<0&&(a=t.Min)}var\x20r=this.SplitCount,n=(e-a)/(r-1);const\x20s=[1,.1,.01,.001,1e-4];var\x20o=GetfloatPrecision(this.Symbol);n<s[o]&&(e=a+(n=s[o])*r);for(var\x20h=0;h<r;++h){var\x20l=a+n*h;if(!this.YClose||l!=this.YClose){(D=new\x20CoordinateInfo).Value=l;var\x20C=l.toFixed(o);if(this.IsShowLeftText&&(D.Message[0]=C),this.YClose){var\x20u=100*(l/this.YClose-1);u>0?D.TextColor=g_JSChartResource.UpTextColor:u<0&&(D.TextColor=g_JSChartResource.DownTextColor),this.IsShowRightText&&(1==this.RightTextFormat?D.Message[1]=C:D.Message[1]=IFrameSplitOperator.FormatValueString(u,2)+\x22%\x22)}this.Frame.HorizontalInfo.push(D)}}if(this.YClose>a&&this.YClose<e){var\x20D;(D=new\x20CoordinateInfo).Value=this.YClose,D.LineType=2,g_JSChartResource.FrameDotSplitPen&&(D.LineColor=g_JSChartResource.FrameDotSplitPen);C=this.YClose.toFixed(o);this.IsShowLeftText&&(D.Message[0]=C),this.IsShowRightText&&(1==this.RightTextFormat?D.Message[1]=C:D.Message[1]=\x220.00%\x22),this.Frame.HorizontalInfo.push(D)}this.Frame.HorizontalInfo.sort(function(t,e){return\x20t.Value-e.Value}),this.Frame.HorizontalMax=e,this.Frame.HorizontalMin=a},this.DefaultSplit=function(t){debug&&console.log(\x22>>>>>>>>>>>>>>>>>>>>>>>>>>>\x22,t);var\x20e=t.Max,a=t.Min;if(this.YClose==e&&this.YClose==a)e=this.YClose+.1*this.YClose,a=this.YClose-.1*this.YClose;else{var\x20i=Math.max(Math.abs(this.YClose-e),Math.abs(this.YClose-a));e=this.YClose+i,(a=this.YClose-i)<0&&(a=t.Min)}var\x20r=GetDevicePixelRatio(),n=this.Frame.ChartBorder.GetChartWidth()<450*r;JSConsole.Chart.Log(\x22[FrameSplitMinutePriceY]max=\x22+e+\x22\x20min=\x22+a+\x22\x20isPhoneModel=\x22+n);var\x20s=this.SplitCount,o=(e-a)/(s-1);const\x20h=[1,.1,.01,.001,1e-4];var\x20l=GetfloatPrecision(this.Symbol);n&&MARKET_SUFFIX_NAME.IsSHSZIndex(this.Symbol)&&(l=0),o<h[l]&&(o=h[l],e=this.YClose+o*(s-1)/2,a=this.YClose-o*(s-1)/2);for(var\x20C=0;C<s;++C){var\x20u=a+o*C,D=new\x20CoordinateInfo;this.Frame.HorizontalInfo[C]=D,D.Value=u;var\x20d=u.toFixed(l);if(this.IsShowLeftText&&(D.Message[0]=d),u==this.YClose&&(D.LineType=2,g_JSChartResource.FrameDotSplitPen&&(D.LineColor=g_JSChartResource.FrameDotSplitPen)),this.YClose){var\x20c=100*(u/this.YClose-1);c>0?D.TextColor=g_JSChartResource.UpTextColor:c<0&&(D.TextColor=g_JSChartResource.DownTextColor),this.IsShowRightText&&(1==this.RightTextFormat?D.Message[1]=d:D.Message[1]=IFrameSplitOperator.FormatValueString(c,2)+\x22%\x22)}}this.Frame.HorizontalMax=e,this.Frame.HorizontalMin=a}}function\x20FrameSplitMinuteX(){this.newMethod=IFrameSplitOperator,this.newMethod(),delete\x20this.newMethod,this.ShowText=!0,this.Symbol=null,this.DayCount=1,this.ShowDateFormate=1,this.IsBeforeData=!1,this.Operator=function(){this.Frame.VerticalInfo=[];this.Frame.XPointCount;var\x20t=this.Frame.ChartBorder.GetWidth();!0===this.Frame.IsHScreen&&(t=this.Frame.ChartBorder.GetHeight()),t/=GetDevicePixelRatio();var\x20e=g_MinuteCoordinateData.GetCoordinateData(this.Symbol,t),a=e.Count;a=t,a=Math.trunc(a/enlargeminutechart),debug&&console.log(\x22width,minuteCount\x22,t,a,this,this.Frame);var\x20i=e.MiddleCount>0?e.MiddleCount:parseInt(a/2),r=e.Data;if(this.Frame.XPointCount=a*this.DayCount,this.Frame.MinuteCount=a,this.Frame.VerticalInfo=[],this.DayCount<=1){if(!this.Frame.Data||!window.chartdata[\x2200\x22])return;var\x20n=window.chartdata[\x2200\x22].DataOffset,s=(this.Frame.XPointCount,0);debug&&console.log(\x22FrameSplitMinuteX\x22,n,this);for(var\x20o=0,h=n;o<a&&h<this.Frame.Data.Data.length;++o,++h){var\x20l=null;if(0==o){var\x20C=IFrameSplitOperator.FormatDateString(this.Frame.Data.Data[h].Date,\x22MM-DD\x22),u=IFrameSplitOperator.FormatTimeString(this.Frame.Data.Data[h].Time);l=this.Frame.Data.Data[h].Date!=this.Frame.Data.Data[this.Frame.Data.Data.length-1].Date?{Value:r[s][0],Text:C}:{Value:r[s][0],Text:u}}else\x20if(o==d){var\x20D=IFrameSplitOperator.FormatDateString(this.Frame.Data.Data[h].Date,\x22MM-DD\x22);if(D==C)l={Value:d,Text:u=IFrameSplitOperator.FormatTimeString(this.Frame.Data.Data[h].Time)};else\x20l={Value:d,Text:C=D}}if(l){(m=new\x20CoordinateInfo).Value=l.Value,this.ShowText&&(m.Message[0]=l.Text),this.Frame.VerticalInfo.push(m),++s;try{var\x20d=Math.trunc(r[s][0]/enlargeminutechart)}catch{}}}}else{o=this.DayData.length-1;for(var\x20c=0;o>=0;--o,++c){var\x20m;(m=new\x20CoordinateInfo).Value=c*a+i,m.LineType=-1,this.ShowText&&(m.Message[0]=IFrameSplitOperator.FormatDateString(this.DayData[o].Date,0==this.ShowFormate?\x22YYYY-MM-DD\x22:\x22MM-DD\x22)),this.Frame.VerticalInfo.push(m),(m=new\x20CoordinateInfo).Value=(c+1)*a,this.Frame.VerticalInfo.push(m)}}}}function\x20FrameSplitXData(){this.newMethod=IFrameSplitOperator,this.newMethod(),delete\x20this.newMethod,this.ShowText=!0,this.Operator=function(){if(null!=this.Frame.Data&&null!=this.Frame.XData){this.Frame.VerticalInfo=[];for(var\x20t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=0,i=t;a<e&&i<this.Frame.Data.Data.length;++a,++i){var\x20r=new\x20CoordinateInfo;r.Value=i-t,this.ShowText&&(r.Message[0]=this.Frame.XData[a]),this.Frame.VerticalInfo.push(r),distance=0}}}}function\x20ChartCorssCursor(){this.Frame,this.Canvas,this.HPenColor=g_JSChartResource.CorssCursorHPenColor,this.HPenType=0,this.VPenColor=g_JSChartResource.CorssCursorVPenColor,this.VPenType=0,this.Font=g_JSChartResource.CorssCursorTextFont,this.TextColor=g_JSChartResource.CorssCursorTextColor,this.TextBGColor=g_JSChartResource.CorssCursorBGColor,this.TextHeight=20,this.LastPoint,this.CursorIndex,this.IsOnlyDrawKLine=!1,this.IsOnlyDrawMinute=!1,this.PointX,this.PointY,this.StringFormatX,this.StringFormatY,this.ShowTextMode={Left:1,Right:1,Bottom:1},this.TextFormat={Right:0},this.IsShowCorss=!0,this.IsShow=!0,this.IsShowClose=!1,this.Close=null,this.Status=0,this.ReloadResource=function(t){this.Font=g_JSChartResource.CorssCursorTextFont,this.HPenColor=g_JSChartResource.CorssCursorHPenColor,this.VPenColor=g_JSChartResource.CorssCursorVPenColor,this.TextColor=g_JSChartResource.CorssCursorTextColor,this.TextBGColor=g_JSChartResource.CorssCursorBGColor},this.GetCloseYPoint=function(t){if(!this.StringFormatX.Data)return\x20null;var\x20e=this.StringFormatX.Data;if(!e.Data||e.Data.length<=0)return\x20null;var\x20a=e.DataOffset+t;if(a>=e.Data.length&&(a=e.Data.length-1),a<0)return\x20null;var\x20i=e.Data[a];return\x20i?(this.Close=i.Close,this.Frame.GetYFromData(this.Close)):null},this.GetMinuteCloseYPoint=function(t){if(!IFrameSplitOperator.IsNumber(t))return\x20null;if(t=parseInt(t),!this.StringFormatX.Data)return\x20null;var\x20e=this.StringFormatX.Data;if(!e.Data||e.Data.length<=0)return\x20null;var\x20a=e.DataOffset+t;if(a>=e.Data.length&&(a=e.Data.length-1),a<0)return\x20null;var\x20i=e.Data[a];return\x20IFrameSplitOperator.IsNumber(t)?(this.Close=i,this.Frame.GetYFromData(this.Close)):null},this.Draw=function(){if(debug&&console.log(\x22............ChartCorssCursor\x22,this),this.Status=0,this.LastPoint){this.Close=null;var\x20t,e=this.LastPoint.X,a=this.LastPoint.Y;if(this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),t=this.Canvas.isPointInPath(e,a),this.PointY=null,this.PointY,t)if(!0!==this.Frame.IsHScreen){var\x20i=this.Frame.ChartBorder.GetLeft(),r=this.Frame.ChartBorder.GetRight(),n=this.Frame.ChartBorder.GetTopTitle(),s=this.Frame.ChartBorder.GetBottom(),o=this.Frame.ChartBorder.Right,h=this.Frame.ChartBorder.GetChartWidth();if(this.IsOnlyDrawKLine){if(e=this.Frame.GetXFromIndex(this.CursorIndex),this.IsShowClose)null!=(l=this.GetCloseYPoint(this.CursorIndex))&&(a=l)}else\x20if(this.IsOnlyDrawMinute){var\x20l;null!=(l=this.GetMinuteCloseYPoint(this.CursorIndex))&&(a=l)}if(this.PointY=[[i,a],[r,a]],this.PointX=[[e,n],[e,s]],this.IsShowCorss){var\x20C=GetDevicePixelRatio();if(this.Canvas.save(),this.Canvas.strokeStyle=this.HPenColor,0==this.HPenType&&this.Canvas.setLineDash([3*C,2*C]),this.Canvas.beginPath(),this.Canvas.moveTo(i,ToFixedPoint(a)),this.Canvas.lineTo(r,ToFixedPoint(a)),this.Canvas.stroke(),this.Canvas.restore(),this.Canvas.save(),this.Canvas.strokeStyle=this.VPenColor,0==this.VPenType)this.Canvas.setLineDash([3*C,2*C]);else\x20if(2==this.VPenType){let\x20t=this.Frame.SubFrame[0].Frame.DataWidth;t>2*C&&(this.Canvas.lineWidth=t)}if(this.Canvas.beginPath(),this.Frame.SubFrame.length>0)for(var\x20u\x20in\x20this.Frame.SubFrame){n=(x=this.Frame.SubFrame[u].Frame).ChartBorder.GetTopTitle(),s=x.ChartBorder.GetBottom(),this.Canvas.moveTo(ToFixedPoint(e),n),this.Canvas.lineTo(ToFixedPoint(e),s)}else\x20this.Canvas.moveTo(ToFixedPoint(e),n),this.Canvas.lineTo(ToFixedPoint(e),s);this.Canvas.stroke(),this.Canvas.restore()}this.Frame.GetXData(e);var\x20D={},d=this.Frame.GetYData(a,D);if((this.IsOnlyDrawMinute||this.IsShowClose)&&null!=this.Close&&(d=this.Close),this.StringFormatX.Value=this.CursorIndex,this.StringFormatY.Value=d,this.StringFormatY.RValue=D.RightYValue,this.StringFormatY.FrameID=D.FrameID,(1==this.ShowTextMode.Left&&this.Frame.ChartBorder.Left>=30||2==this.ShowTextMode.Left||1==this.ShowTextMode.Right&&this.Frame.ChartBorder.Right>=30||2==this.ShowTextMode.Right)&&this.StringFormatY.Operator()){var\x20c=this.StringFormatY.Text;this.Canvas.font=this.Font;var\x20m=this.Canvas.measureText(c).width+4;if(this.Frame.ChartBorder.Left>=30&&1==this.ShowTextMode.Left?(this.Canvas.fillStyle=this.TextBGColor,i<m?(this.Canvas.fillRect(2,a-this.TextHeight/2,m,this.TextHeight),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(c,4,a,m)):(this.Canvas.fillRect(i-2,a-this.TextHeight/2,-m,this.TextHeight),this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(c,i-4,a,m))):2==this.ShowTextMode.Left&&(this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(i,a-this.TextHeight/2,m,this.TextHeight),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(c,i+2,a,m)),this.StringFormatY.PercentageText&&0==this.TextFormat.Right&&(c=this.StringFormatY.PercentageText+\x22%\x22,m=this.Canvas.measureText(c).width+4),this.StringFormatY.RText){c=this.StringFormatY.RText;m=this.Canvas.measureText(c).width+4}if(this.Frame.ChartBorder.Right>=30&&1==this.ShowTextMode.Right){var\x20f=!1,v=null;if(D.FrameID>=0)f=(x=this.Frame.SubFrame[D.FrameID]).OverlayIndex.length>0,v=x.Interval;if(this.Canvas.fillStyle=this.TextBGColor,f&&m>v){var\x20S=r+v;S>h&&(S=h),this.Canvas.fillRect(S-2-m,a-this.TextHeight/2,m,this.TextHeight),this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(c,S-4,a,m)}else\x20o<m?(this.Canvas.fillRect(h-2-m,a-this.TextHeight/2,m,this.TextHeight),this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(c,h-4,a,m)):(this.Canvas.fillRect(r+2,a-this.TextHeight/2,m,this.TextHeight),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(c,r+4,a,m));if(this.StringFormatY.RExtendText&&this.StringFormatY.RExtendText.length>0){var\x20T=0;for(var\x20u\x20in\x20this.StringFormatY.RExtendText){var\x20I=\x22--.--\x22;(M=this.StringFormatY.RExtendText[u]).YText?I=M.YText:IFrameSplitOperator.IsNumber(M.Y)&&(I=M.Y.toFixed(0));var\x20F=this.Canvas.measureText(I).width+4;this.Canvas.fillStyle=M.TextBGColor,o<F?(this.Canvas.fillRect(h-2-F,a+T+this.TextHeight/2,F,this.TextHeight),this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=M.TextColor,this.Canvas.fillText(I,h-4,a+T+this.TextHeight,F)):(this.Canvas.fillRect(r+2,a+T+this.TextHeight/2,F,this.TextHeight),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=M.TextColor,this.Canvas.fillText(I,r+4,a+T+this.TextHeight,F)),T+=this.TextHeight}}}else\x20if(2==this.ShowTextMode.Right){this.Canvas.fillStyle=this.TextBGColor;var\x20g=r-m;this.Canvas.fillRect(g,a-this.TextHeight/2,m,this.TextHeight),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(c,g+2,a,m)}}if(1==this.ShowTextMode.Bottom&&this.StringFormatX.Operator()){debug&&console.log(\x22X\x20label\x22,this.StringFormatX.constructor.name);c=this.StringFormatX.Text;this.Canvas.font=this.Font,this.Canvas.fillStyle=this.TextBGColor;m=this.Canvas.measureText(c).width+4;var\x20p=s+2+this.TextHeight/2;e-m/2<3?(this.Canvas.fillRect(e-1,s+2,m,this.TextHeight),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(c,e+1,p,m)):e+m/2>=r?(this.Canvas.fillRect(r-m,s+2,m,this.TextHeight),this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(c,r-2,p,m)):(this.Canvas.fillRect(e-m/2,s+2,m,this.TextHeight),this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(c,e,p,m))}if(D.FrameID>=0){var\x20x=this.Frame.SubFrame[D.FrameID],P=r;for(var\x20u\x20in\x20this.Canvas.font=this.Font,x.OverlayIndex){var\x20M;if(!1!==(M=x.OverlayIndex[u]).Frame.IsShow){if((P+=x.Interval)+30>h)break;for(d=M.Frame.GetYData(a),u=2;u>=0;--u){c=IFrameSplitOperator.FormatValueString(d,u);if((m=this.Canvas.measureText(c).width+4)<x.Interval)break}this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(P+2,a-this.TextHeight/2,m,this.TextHeight),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(c,P+4,a,m)}}}this.Status=1}else\x20this.HScreenDraw()}},this.HScreenDraw=function(){var\x20t=this.LastPoint.X,e=this.LastPoint.Y;this.IsOnlyDrawKLine&&(e=this.Frame.GetXFromIndex(this.CursorIndex));var\x20a=this.Frame.ChartBorder.GetLeft(),i=this.Frame.ChartBorder.GetRightEx(),r=this.Frame.ChartBorder.GetTop(),n=this.Frame.ChartBorder.GetBottom(),s=this.Frame.ChartBorder.Bottom;if(this.PointY=[[a,e],[i,e]],this.PointX=[[t,r],[t,n]],this.IsShowCorss){var\x20o=GetDevicePixelRatio();if(this.Canvas.save(),this.Canvas.strokeStyle=this.HPenColor,0==this.HPenType&&this.Canvas.setLineDash([3*o,2*o]),this.Canvas.beginPath(),this.Canvas.moveTo(ToFixedPoint(t),r),this.Canvas.lineTo(ToFixedPoint(t),n),this.Canvas.stroke(),this.Canvas.restore(),this.Canvas.save(),this.Canvas.strokeStyle=this.VPenColor,0==this.VPenType)this.Canvas.setLineDash([3*o,2*o]);else\x20if(2==this.VPenType){let\x20t=this.Frame.SubFrame[0].Frame.DataWidth;t>2*o&&(this.Canvas.lineWidth=t)}if(this.Canvas.beginPath(),this.Frame.SubFrame.length>0)for(var\x20h\x20in\x20this.Frame.SubFrame){var\x20l=this.Frame.SubFrame[h].Frame;this.Canvas.moveTo(l.ChartBorder.GetLeft(),ToFixedPoint(e)),this.Canvas.lineTo(l.ChartBorder.GetRightTitle(),ToFixedPoint(e))}else\x20this.Canvas.moveTo(a,ToFixedPoint(e)),this.Canvas.lineTo(i,ToFixedPoint(e));this.Canvas.stroke(),this.Canvas.restore()}var\x20C=this.Frame.GetXData(e),u={},D=this.Frame.GetYData(t,u);if(this.StringFormatX.Value=C,this.StringFormatY.Value=D,this.StringFormatY.FrameID=u.FrameID,(1==this.ShowTextMode.Left&&this.Frame.ChartBorder.Top>=30||2==this.ShowTextMode.Left||1==this.ShowTextMode.Right&&this.Frame.ChartBorder.Bottom>=30||2==this.ShowTextMode.Right)&&this.StringFormatY.Operator()){var\x20d=this.StringFormatY.Text;this.Canvas.font=this.Font;var\x20c=this.Canvas.measureText(d).width+4;if(this.Frame.ChartBorder.Top>=30&&1==this.ShowTextMode.Left){var\x20m=t,f=r;this.Canvas.save(),this.Canvas.translate(m,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,r>=c?(this.Canvas.fillRect(0,-this.TextHeight/2,-c,this.TextHeight),this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(d,-2,0,c)):(this.Canvas.fillRect(c-r,-this.TextHeight/2,-c,this.TextHeight),this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(d,c-r-2,0,c)),this.Canvas.restore()}else\x20if(2==this.ShowTextMode.Left){m=t,f=r;this.Canvas.save(),this.Canvas.translate(m,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(0,-this.TextHeight/2,c,this.TextHeight),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(d,2,0,c),this.Canvas.restore()}if(this.Frame.ChartBorder.Bottom>=30&&1==this.ShowTextMode.Right){m=t,f=n;if(this.Canvas.save(),this.Canvas.translate(m,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,s>c?(this.Canvas.fillRect(0,-this.TextHeight/2,c,this.TextHeight),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(d,2,0,c)):(this.Canvas.fillRect(s-c,-this.TextHeight/2,c,this.TextHeight),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(d,s-c+2,0,c)),this.StringFormatY.RExtendText&&this.StringFormatY.RExtendText.length>0){var\x20v=0;for(var\x20h\x20in\x20this.StringFormatY.RExtendText){var\x20S=this.StringFormatY.RExtendText[h],T=\x22--.--\x22;S.YText?T=S.YText:IFrameSplitOperator.IsNumber(S.Y)&&(T=S.Y.toFixed(0));var\x20I=this.Canvas.measureText(T).width+4;if(this.Canvas.fillStyle=S.TextBGColor,s>I)this.Canvas.fillRect(0,v+this.TextHeight/2,I,this.TextHeight),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=S.TextColor,this.Canvas.fillText(T,2,v+this.TextHeight,I);else{var\x20F=s-I;this.Canvas.fillRect(F,v+this.TextHeight/2,I,this.TextHeight),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=S.TextColor,this.Canvas.fillText(T,F+2,v+this.TextHeight,I)}v+=this.TextHeight}}this.Canvas.restore()}else\x20if(2==this.ShowTextMode.Right){m=t,f=n;this.Canvas.save(),this.Canvas.translate(m,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(0,-this.TextHeight/2,-c,this.TextHeight),this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(d,-2,0,c),this.Canvas.restore()}}if(1===this.ShowTextMode.Bottom&&this.StringFormatX.Operator()){d=this.StringFormatX.Text;if(this.Canvas.font=this.Font,this.Canvas.fillStyle=this.TextBGColor,e-(c=this.Canvas.measureText(d).width+4)/2<3){m=a,f=e;this.Canvas.save(),this.Canvas.translate(m,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillRect(0,0,c,this.TextHeight),this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(d,2,this.TextHeight/2,c),this.Canvas.restore()}else\x20if(e+c/2>=n){m=a,f=e;this.Canvas.save(),this.Canvas.translate(m,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillRect(-c,0,c,this.TextHeight),this.Canvas.textAlign=\x22right\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(d,-2,this.TextHeight/2,c),this.Canvas.restore()}else{m=a,f=e;this.Canvas.save(),this.Canvas.translate(m,f),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillRect(-c/2,0,c,this.TextHeight),this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(d,0,this.TextHeight/2,c),this.Canvas.restore()}}this.Status=1}}function\x20ChartSplashPaint(){this.Frame,this.Canvas,this.Font=g_JSChartResource.DefaultTextFont,this.TextColor=g_JSChartResource.DefaultTextColor,this.IsEnableSplash=!1,this.SplashTitle=\x22数据加载中\x22,this.HQChart,this.EnableSplash=function(t){if(this.IsEnableSplash=t,this.HQChart){var\x20e=this.HQChart.GetEventCallback(JSCHART_EVENT_ID.ON_ENABLE_SPLASH_DRAW);if(e){var\x20a={Enable:t};e.Callback(e,a,this)}}},this.Draw=function(){if(this.IsEnableSplash)if(!0!==this.Frame.IsHScreen){var\x20t=(this.Frame.ChartBorder.GetLeft()+this.Frame.ChartBorder.GetRight())/2,e=(this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.GetBottom())/2;this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.SplashTitle,t,e)}else\x20this.HScreenDraw()},this.HScreenDraw=function(){var\x20t=(this.Frame.ChartBorder.GetLeft()+this.Frame.ChartBorder.GetRight())/2,e=(this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.GetBottom())/2;this.Canvas.save(),this.Canvas.translate(t,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.SplashTitle,0,0),this.Canvas.restore()}}function\x20IChangeStringFormat(){this.Data,this.Value,this.Text,this.Operator=function(){return!1}}IFrameSplitOperator.FormatValueThousandsString=function(t,e){if(null==t||isNaN(t)){if(e>0){for(var\x20a=\x22-.\x22,i=0;i<e;++i)a+=\x22-\x22;return\x20a}return\x22--\x22}var\x20r=\x22\x22,n=t.toFixed(e);if(e>0){for(var\x20s=n.split(\x22.\x22)[1],o=n.split(\x22.\x22)[0];o.length>3;)r=\x22,\x22+o.slice(-3)+r,o=o.slice(0,o.length-3);o&&(r=o+r+\x22.\x22+s)}else{for(;n.length>3;)r=\x22,\x22+n.slice(-3)+r,n=n.slice(0,n.length-3);n&&(r=n+r)}return\x20r},IFrameSplitOperator.FormatValueString=function(t,e,a){if(null==t||isNaN(t)){if(e>0){for(var\x20i=\x22-.\x22,r=0;r<e;++r)i+=\x22-\x22;return\x20i}return\x22--\x22}if(t<1e-11&&t>-1e-11)return\x220\x22;var\x20n=Math.abs(t);return\x20a===JSCHART_LANGUAGE_ID.LANGUAGE_ENGLISH_ID?n<1e4?t.toFixed(e):n<1e6?(t/1e3).toFixed(e)+\x22K\x22:n<1e9?(t/1e6).toFixed(e)+\x22M\x22:n<1e12?(t/1e9).toFixed(e)+\x22B\x22:(t/1e12).toFixed(e)+\x22T\x22:n<1e4?t.toFixed(e):n<1e8?(t/1e4).toFixed(e)+\x22万\x22:n<1e12?(t/1e8).toFixed(e)+\x22亿\x22:(t/1e12).toFixed(e)+\x22万亿\x22},IFrameSplitOperator.FromatIntegerString=function(t,e,a){return\x20t<1e4&&IFrameSplitOperator.IsInteger(t)&&(e=0),IFrameSplitOperator.FormatValueString(t,e,a)},IFrameSplitOperator.NumberToString=function(t){return\x20t<10?\x220\x22+t.toString():t.toString()},IFrameSplitOperator.FormatDateString=function(t,e,a){var\x20i=parseInt(t/1e4),r=parseInt(t/100)%100,n=t%100;switch(e){case\x22MM-DD\x22:return\x20IFrameSplitOperator.NumberToString(r)+\x22-\x22+IFrameSplitOperator.NumberToString(n);case\x22YYYY/MM/DD\x22:return\x20i.toString()+\x22/\x22+IFrameSplitOperator.NumberToString(r)+\x22/\x22+IFrameSplitOperator.NumberToString(n);case\x22YYYY/MM/DD/W\x22:var\x20s=new\x20Date(i,r-1,n),o=g_JSChartLocalization.GetText(WEEK_NAME[s.getDay()],a);return\x20i.toString()+\x22/\x22+IFrameSplitOperator.NumberToString(r)+\x22/\x22+IFrameSplitOperator.NumberToString(n)+\x22/\x22+o.toString();default:return\x20i.toString()+\x22-\x22+IFrameSplitOperator.NumberToString(r)+\x22-\x22+IFrameSplitOperator.NumberToString(n)}},IFrameSplitOperator.FormatTimeString=function(t,e){if(\x22HH:MM:SS\x22==e){var\x20a=parseInt(t/1e4),i=parseInt(t%1e4/100),r=t%100;return\x20IFrameSplitOperator.NumberToString(a)+\x22:\x22+IFrameSplitOperator.NumberToString(i)+\x22:\x22+IFrameSplitOperator.NumberToString(r)}if(\x22HH:MM\x22==e){a=parseInt(t/100),i=t%100;return\x20IFrameSplitOperator.NumberToString(a)+\x22:\x22+IFrameSplitOperator.NumberToString(i)}if(t<1e4){a=parseInt(t/100),i=t%100;return\x20IFrameSplitOperator.NumberToString(a)+\x22:\x22+IFrameSplitOperator.NumberToString(i)}a=parseInt(t/1e4),i=parseInt(t%1e4/100),r=t%100;return\x20IFrameSplitOperator.NumberToString(a)+\x22:\x22+IFrameSplitOperator.NumberToString(i)+\x22:\x22+IFrameSplitOperator.NumberToString(r)},IFrameSplitOperator.FormatReportDateString=function(t){var\x20e,a=parseInt(t/1e4);switch(parseInt(t/100)%100){case\x203:e=\x22一季度报\x22;break;case\x206:e=\x22半年报\x22;break;case\x209:e=\x22三季度报\x22;break;case\x2012:e=\x22年报\x22}return\x20a.toString()+e},IFrameSplitOperator.FormatDateTimeString=function(t,e,a){var\x20i=t.split(\x22\x20\x22);if(i.length<2)return\x22\x22;var\x20r=\x22\x22;if(e){var\x20n=parseInt(i[0]),s=parseInt(n/1e4),o=parseInt(n%1e4/100),h=n%100;r+=D=s.toString()+\x22-\x22+(o<10?\x220\x22+o.toString():o.toString())+\x22-\x22+(h<10?\x220\x22+h.toString():h.toString())}if(a){var\x20l=parseInt(i[1]),C=l%100,u=parseInt(l/100),D=(u<10?\x220\x22+u.toString():u.toString())+\x22:\x22+(C<10?\x220\x22+C.toString():C.toString());r.length>0&&(r+=\x22\x20\x22),r+=D}return\x20r},IFrameSplitOperator.FormatValueColor=function(t,e){return\x20null!=t&&null==e?0==t?\x22PriceNull\x22:t>0?\x22PriceUp\x22:\x22PriceDown\x22:null==t||null==e?\x22PriceNull\x22:t==e?\x22PriceNull\x22:t>e?\x22PriceUp\x22:\x22PriceDown\x22},IFrameSplitOperator.IsNumber=function(t){return\x20null!=t&&!isNaN(t)},IFrameSplitOperator.IsPlusNumber=function(t){return\x20null!=t&&(!isNaN(t)&&t>0)},IFrameSplitOperator.IsInteger=function(t){return\x22number\x22==typeof\x20t&&t%1==0},IFrameSplitOperator.IsObjectExist=function(t){return\x20void\x200!==t&&null!=t},IFrameSplitOperator.IsBool=function(t){return!0===t||!1===t},IFrameSplitOperator.IsString=function(t){return!(!t||\x22string\x22!=typeof\x20t)},IFrameSplitOperator.RemoveZero=function(t){for(;t.length>0;){var\x20e=t.length-1,a=t[e];if(\x220\x22!=a){if(\x22.\x22==a){t=t.substr(0,e);break}break}t=t.substr(0,e)}return\x20t};var\x20ZOOM_VALUE=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10];function\x20HQPriceStringFormat(){this.newMethod=IChangeStringFormat,this.newMethod(),delete\x20this.newMethod,this.Symbol,this.FrameID,this.LanguageID=JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.YClose,this.PercentageText,this.RValue,this.RText,this.ExtendChartPaint,this.RExtendText=[],this.Operator=function(){if(this.RText=null,this.RExtendText=[],IFrameSplitOperator.IsString(this.RValue)&&(this.RText=this.RValue),!this.Value)return!1;this.PercentageText=null;var\x20t=2;if(0==this.FrameID){t=GetfloatPrecision(this.Symbol);this.Text=this.Value.toFixed(t),this.YClose>0&&(this.PercentageText=(100*(this.Value-this.YClose)/this.YClose).toFixed(2)),this.GetExtendPaintData(t)}else\x201==this.FrameID?(this.Text=IFrameSplitOperator.FormatValueString(this.Value,t,this.LanguageID),IFrameSplitOperator.IsNumber(this.RValue)&&(this.RText=IFrameSplitOperator.FormatValueString(this.RValue,t,this.LanguageID))):this.Text=IFrameSplitOperator.FormatValueString(this.Value,t,this.LanguageID);return!0},this.GetExtendPaintData=function(t){var\x20e=parseInt(this.Value*ZOOM_VALUE[t]);for(var\x20a\x20in\x20this.ExtendChartPaint){var\x20i=this.ExtendChartPaint[a];if(\x22DepthMapPaint\x22==i.ClassName&&i.FrameID==this.FrameID){var\x20r=i.GetYValueByXValue(e,t);for(var\x20n\x20in\x20r)this.RExtendText.push(r[n])}}}}function\x20HQDateStringFormat(){this.newMethod=IChangeStringFormat,this.newMethod(),delete\x20this.newMethod,this.DateFormatType=0,this.LanguageID=0,this.Operator=function(){if(!IFrameSplitOperator.IsNumber(this.Value))return!1;if(!this.Data)return!1;var\x20t=this.Value;if(t=parseInt(t.toFixed(0)),this.Data.DataOffset+t>=this.Data.Data.length)return!1;var\x20e=this.Data.Data[this.Data.DataOffset+t],a=\x22YYYY-MM-DD\x22;if(1==this.DateFormatType?a=\x22YYYY/MM/DD\x22:2==this.DateFormatType&&(a=\x22YYYY/MM/DD/W\x22),this.Text=IFrameSplitOperator.FormatDateString(e.Date,a,this.LanguageID),ChartData.IsMinutePeriod(this.Data.Period,!0)){var\x20i=IFrameSplitOperator.FormatTimeString(e.Time);this.Text=this.Text+\x22\x20\x20\x22+i}else\x20if(ChartData.IsSecondPeriod(this.Data.Period)){i=IFrameSplitOperator.FormatTimeString(e.Time,\x22HH:MM:SS\x22);this.Text=this.Text+\x22\x20\x20\x22+i}else\x20if(ChartData.IsTickPeriod(this.Data.Period)){i=IFrameSplitOperator.FormatTimeString(e.Time);this.Text=this.Text+\x22\x20\x20\x22+i}return!0}}function\x20HQMinuteTimeStringFormat(){this.newMethod=IChangeStringFormat,this.newMethod(),delete\x20this.newMethod,this.Frame,this.Symbol,this.IsBeforeData=!1,this.Operator=function(){if(null==this.Value||isNaN(this.Value))return!1;var\x20t=Math.abs(this.Value);t=parseInt(t.toFixed(0));var\x20e=this.Data.DataOffset+t;return!(e<0||e>=window.minutedata.length)&&(this.Text=IFrameSplitOperator.FormatDateTimeString(datetime(window.minutedata[e][0]),!0,!0),!0)}}var\x20WEEK_NAME=[\x22日\x22,\x22一\x22,\x22二\x22,\x22三\x22,\x22四\x22,\x22五\x22,\x22六\x22];function\x20HistoryDataStringFormat(){this.newMethod=IChangeStringFormat,this.newMethod(),delete\x20this.newMethod,this.Symbol,this.UpColor=g_JSChartResource.UpTextColor,this.DownColor=g_JSChartResource.DownTextColor,this.UnchagneColor=g_JSChartResource.UnchagneTextColor,this.VolColor=g_JSChartResource.Title.VolColor,this.AmountColor=g_JSChartResource.Title.AmountColor,this.TurnoverRateColor=g_JSChartResource.Title.TurnoverRateColor,this.PositionColor=g_JSChartResource.Title.PositionColor,this.LanguageID=JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.LineCount=0,this.LineHeight=g_JSChartResource.PCTooltip.LineHeight,this.Width=157,this.Height=5*this.LineHeight,this.Operator=function(){var\x20t=this.Value.Data;if(!t)return!1;this.Width=157,this.LanguageID==JSCHART_LANGUAGE_ID.LANGUAGE_ENGLISH_ID&&(this.Width=180);var\x20e=new\x20Date(parseInt(t.Date/1e4),t.Date/100%100-1,t.Date%100),a=IFrameSplitOperator.FormatDateString(t.Date),i=g_JSChartLocalization.GetText(WEEK_NAME[e.getDay()],this.LanguageID);ChartData.IsMinutePeriod(this.Value.ChartPaint.Data.Period,!0)?i=IFrameSplitOperator.FormatTimeString(t.Time):ChartData.IsSecondPeriod(this.Value.ChartPaint.Data.Period)&&(i=IFrameSplitOperator.FormatTimeString(t.Time,\x22HH:MM:SS\x22));var\x20r=this.Symbol.toUpperCase(),n=GetfloatPrecision(this.Symbol),s=null;t.YClose>0&&(s=(t.Close-t.YClose)/t.YClose*100);var\x20o=\x22<span\x20class=\x27tooltip-title\x27>\x22+a+\x22&nbsp&nbsp\x22+i+\x22</span><span\x20class=\x27tooltip-con\x27>\x22+g_JSChartLocalization.GetText(\x22DivTooltip-Open\x22,this.LanguageID)+\x22</span><span\x20class=\x27tooltip-num\x27\x20style=\x27color:\x22+this.GetColor(t.Open,t.YClose)+\x22;\x27>\x22+t.Open.toFixed(n)+\x22</span><br/><span\x20class=\x27tooltip-con\x27>\x22+g_JSChartLocalization.GetText(\x22DivTooltip-High\x22,this.LanguageID)+\x22</span><span\x20class=\x27tooltip-num\x27\x20style=\x27color:\x22+this.GetColor(t.High,t.YClose)+\x22;\x27>\x22+t.High.toFixed(n)+\x22</span><br/><span\x20class=\x27tooltip-con\x27>\x22+g_JSChartLocalization.GetText(\x22DivTooltip-Low\x22,this.LanguageID)+\x22</span><span\x20class=\x27tooltip-num\x27\x20style=\x27color:\x22+this.GetColor(t.Low,t.YClose)+\x22;\x27>\x22+t.Low.toFixed(n)+\x22</span><br/><span\x20class=\x27tooltip-con\x27>\x22+g_JSChartLocalization.GetText(\x22DivTooltip-Close\x22,this.LanguageID)+\x22</span><span\x20class=\x27tooltip-num\x27\x20style=\x27color:\x22+this.GetColor(t.Close,t.YClose)+\x22;\x27>\x22+t.Close.toFixed(n)+\x22</span><br/><span\x20class=\x27tooltip-con\x27>\x22+g_JSChartLocalization.GetText(\x22DivTooltip-Vol\x22,this.LanguageID)+\x22</span><span\x20class=\x27tooltip-num\x27\x20style=\x27color:\x22+this.VolColor+\x22;\x27>\x22+IFrameSplitOperator.FormatValueString(t.Vol,2,this.LanguageID)+\x22</span><br/><span\x20class=\x27tooltip-con\x27>\x22+g_JSChartLocalization.GetText(\x22DivTooltip-Amount\x22,this.LanguageID)+\x22</span><span\x20class=\x27tooltip-num\x27\x20style=\x27color:\x22+this.AmountColor+\x22;\x27>\x22+IFrameSplitOperator.FormatValueString(t.Amount,2,this.LanguageID)+\x22</span><br/><span\x20class=\x27tooltip-con\x27>\x22+g_JSChartLocalization.GetText(\x22DivTooltip-Increase\x22,this.LanguageID)+\x22</span>\x22+(null==s?\x22<span\x20class=\x27tooltip-num\x27\x20style=\x27color:\x22+this.GetColor(0,0)+\x22;\x27>--</span><br/>\x22:\x22<span\x20class=\x27tooltip-num\x27\x20style=\x27color:\x22+this.GetColor(s,0)+\x22;\x27>\x22+s.toFixed(2)+\x22%</span><br/>\x22);if(this.LineCount=8,MARKET_SUFFIX_NAME.IsSHSZStockA(this.Symbol)&&t.FlowCapital>0){var\x20h=t.Vol/t.FlowCapital*100;o+=\x22<span\x20class=\x27tooltip-con\x27>\x22+g_JSChartLocalization.GetText(\x22DivTooltip-Exchange\x22,this.LanguageID)+\x22</span><span\x20class=\x27tooltip-num\x27\x20style=\x27color:\x22+this.TurnoverRateColor+\x22;\x27>\x22+h.toFixed(2)+\x22%</span><br/>\x22,++this.LineCount}(MARKET_SUFFIX_NAME.IsFutures(r)&&IFrameSplitOperator.IsNumber(t.Position)&&(o+=\x22<span\x20class=\x27tooltip-con\x27>\x22+g_JSChartLocalization.GetText(\x22DivTooltip-Position\x22,this.LanguageID)+\x22</span><span\x20class=\x27tooltip-num\x27\x20style=\x27color:\x22+this.PositionColor+\x22;\x27>\x22+t.Position+\x22</span><br/>\x22,++this.LineCount),\x22Overlay-KLine\x22==this.Value.ChartPaint.Name)&&(o=\x22<span\x20style=\x27color:rgb(0,0,0);font:微软雅黑;font-size:12px;text-align:center;display:\x20block;\x27>\x22+this.Value.ChartPaint.Title+\x22</span>\x22+o,++this.LineCount);return\x20this.Text=o,this.Height=this.LineCount*this.LineHeight,!0},this.GetColor=function(t,e){return\x20t>e?this.UpColor:t<e?this.DownColor:this.UnchagneColor}}function\x20KLineInfoDataStringFormat(){this.newMethod=IChangeStringFormat,this.newMethod(),delete\x20this.newMethod,this.UpColor=g_JSChartResource.UpTextColor,this.DownColor=g_JSChartResource.DownTextColor,this.UnchagneColor=g_JSChartResource.UnchagneTextColor,this.Width=500,this.Operator=function(){if(!this.Value)return!1;var\x20t=this.Value.Data.Data,e=this.Value.Data.Type,a=\x22\x22;for(var\x20i\x20in\x20t){var\x20r=t[i],n=\x22\x22;switch(e){case\x20KLINE_INFO_TYPE.BLOCKTRADING:n=this.BlockTradingFormat(r);break;case\x20KLINE_INFO_TYPE.TRADEDETAIL:n=this.TradeDetailFormat(r);break;case\x20KLINE_INFO_TYPE.RESEARCH:n=this.ResearchFormat(r);break;case\x20KLINE_INFO_TYPE.PFORECAST:n=this.PerformanceForecastFormat(r);break;default:n=this.DefaultFormat(r)}a+=n}var\x20s=\x22<div\x20class=\x27title-length\x27>\x22+a+\x22</div>\x22;t.length>8&&(s+=\x22<div\x20class=\x27total-list\x27>共\x22+t.length+\x22条</div>\x22);return\x20this.Text=s,!0},this.DefaultFormat=function(t){return\x22<span>\x22+IFrameSplitOperator.FormatDateString(t.Date)+\x22&nbsp;&nbsp;&nbsp;\x22+t.Title+\x22</span>\x22},this.BlockTradingFormat=function(t){var\x20e=t.ExtendData;return\x22<span><i\x20class=\x27date-tipbox\x27>\x22+IFrameSplitOperator.FormatDateString(t.Date)+\x22</i>&nbsp;&nbsp;<i\x20class=\x27tipBoxTitle\x27>成交价:&nbsp;\x22+e.Price.toFixed(2)+\x22</i><i\x20class=\x27tipBoxTitle\x27>收盘价:&nbsp;\x22+e.ClosePrice.toFixed(2)+\x22</i><br/><i\x20class=\x27rate-discount\x20tipBoxTitle\x27>溢折价率:&nbsp;<strong\x20style=\x27color:\x22+this.GetColor(e.Premium.toFixed(2))+\x22\x27>\x22+e.Premium.toFixed(2)+\x22%</strong></i><i\x20class=\x27tipBoxTitle\x27>成交量(万股):&nbsp;\x22+e.Vol.toFixed(2)+\x22</i></span>\x22},this.TradeDetailFormat=function(t){var\x20e=t.ExtendData.Detail,a=IFrameSplitOperator.FormatDateString(t.Date),i=[];for(var\x20r\x20in\x20e)i+=\x22<i>\x22+e[r].TypeExplain+\x22</i><br/>\x22;return\x22<span><i\x20class=\x27trade-time\x27>\x22+a+\x22&nbsp;&nbsp;&nbsp;上榜原因:&nbsp;&nbsp;</i><i\x20class=\x27reason-list\x27>\x22+i+\x22</i><br/><i\x20class=\x27trade-detall\x27>一周后涨幅:&nbsp;<strong\x20style=\x27color:\x22+this.GetColor(t.ExtendData.FWeek.Week1.toFixed(2))+\x22\x27>\x22+t.ExtendData.FWeek.Week1.toFixed(2)+\x22%</strong>&nbsp;&nbsp;&nbsp;四周后涨幅:&nbsp;<strong\x20style=\x27color:\x22+this.GetColor(t.ExtendData.FWeek.Week4.toFixed(2))+\x22;\x27>\x22+t.ExtendData.FWeek.Week4.toFixed(2)+\x22%</strong></i></span>\x22},this.ResearchFormat=function(t){var\x20e=t.ExtendData.Level,a=\x22\x22;if(0==e.length)a=\x22<i>一般调研</i>\x22;else{for(var\x20i\x20in\x20e)0==e[i]?a+=\x22<i\x20style=\x27color:#00a0e9\x27>证券代表&nbsp;&nbsp;&nbsp;</i>\x22:1==e[i]?a+=\x22<i>董秘&nbsp;&nbsp;&nbsp;</i>\x22:2==e[i]?a+=\x22<i\x20style=\x27color:#00a0e9\x27>总经理&nbsp;&nbsp;&nbsp;</i>\x22:3==e[i]&&(a+=\x22<i\x20style=\x27color:#00a0e9\x27>董事长&nbsp;&nbsp;&nbsp;</i>\x22);a=\x22接待:&nbsp;&nbsp;&nbsp;\x22+a}var\x20r=\x22\x22;return\x20t.ExtendData.Type&&\x22其他\x22!=t.ExtendData.Type&&(r=\x22&nbsp;&nbsp;&nbsp;<i>\x22+t.ExtendData.Type+\x22</i>\x22,0==e.length&&(a=\x22\x22)),\x22<span>\x22+IFrameSplitOperator.FormatDateString(t.Date)+\x22&nbsp;&nbsp;&nbsp;\x22+r+a+\x22</span>\x22},this.PerformanceForecastFormat=function(t){var\x20e,a=t.ExtendData.ReportDate,i=parseInt(a/1e4),r=a%1e4;1231==r?e=\x22年报\x22:331==r?e=\x22一季度报\x22:630==r?e=\x22半年度报\x22:930==r&&(e=\x22三季度报\x22);var\x20n=\x22\x22;return\x20t.ExtendData.FWeek&&(null!=t.ExtendData.FWeek.Week1&&(n+=\x22一周后涨幅:<i\x20class=\x27increase\x27\x20style=\x27color:\x22+this.GetColor(t.ExtendData.FWeek.Week1.toFixed(2))+\x22\x27>\x22+t.ExtendData.FWeek.Week1.toFixed(2)+\x22%</i>\x22),null!=t.ExtendData.FWeek.Week4&&(n+=\x22&nbsp;四周后涨幅:<i\x20class=\x27increase\x27\x20style=\x27color:\x22+this.GetColor(t.ExtendData.FWeek.Week4.toFixed(2))+\x22\x27>\x22+t.ExtendData.FWeek.Week4.toFixed(2)+\x22%</i>\x22),n.length>0&&(n=\x22<br/>&nbsp;&nbsp;<i\x20class=\x27prorecast-week\x27>\x22+n+\x22</i>\x22)),\x22<span>\x22+IFrameSplitOperator.FormatDateString(t.Date)+\x22&nbsp;&nbsp;\x22+i+e+t.Title+\x22&nbsp;\x22+n+\x22</span>\x22},this.GetColor=function(t){return\x20t>0?this.UpColor:t<0?this.DownColor:this.UnchagneColor}}function\x20KLineTradeDataStringFormat(){this.newMethod=IChangeStringFormat,this.newMethod(),delete\x20this.newMethod,this.Width=100,this.Operator=function(){var\x20t=this.Value.Data;if(!t)return!1;var\x20e,a=t.Data,i=`<span\x20class=\x27tooltip-index-name\x27>${a.Name}${a.Param}:</span>`;return\x20e=1==a.Type?\x22<span\x20class=\x27tooltip-index-buy\x27>买入</span>\x22:\x22<span\x20class=\x27tooltip-index-sell\x27>卖出</span>\x22,this.Text=i+e,!0}}function\x20MinuteInfoDataStringFormat(){this.newMethod=IChangeStringFormat,this.newMethod(),delete\x20this.newMethod,this.Width=200,this.Operator=function(){var\x20t=this.Value.Data;if(!t)return!1;var\x20e=t.Data.Item,a=`<span\x20class=\x27tooltip-minuteinfo-time\x27>${IFrameSplitOperator.FormatTimeString(e.Time)}\x20</span>`,i=`<span\x20class=\x27tooltip-minuteinfo-content\x27>${e.Title}</span>`;return\x20e.Content&&(i=`<span\x20class=\x27tooltip-minuteinfo-content\x27>${e.Content}</span>`),this.Text=a+i,!0}}function\x20DivTooltipDataForamt(){this.DataMap=new\x20Map([[\x22KLineTradeDataStringFormat\x22,{Create:function(){return\x20new\x20KLineTradeDataStringFormat}}],[\x22MinuteInfoDataStringFormat\x22,{Create:function(){return\x20new\x20MinuteInfoDataStringFormat}}],[\x22HistoryDataStringFormat\x22,{Create:function(){return\x20new\x20HistoryDataStringFormat}}],[\x22KLineInfoDataStringFormat\x22,{Create:function(){return\x20new\x20KLineInfoDataStringFormat}}],[\x22CorssCursor_XStringFormat\x22,{Create:function(){return\x20new\x20HQDateStringFormat}}],[\x22CorssCursor_YStringFormat\x22,{Create:function(){return\x20new\x20HQPriceStringFormat}}]]),this.Create=function(t){return\x20this.DataMap.has(t)?this.DataMap.get(t).Create():null}}var\x20g_DivTooltipDataForamt=new\x20DivTooltipDataForamt;function\x20IChartTitlePainting(){this.Frame,this.Data=new\x20Array,this.Canvas,this.IsDynamic=!1,this.Position=0,this.CursorIndex,this.Font=g_JSChartResource.TitleFont,this.Title,this.TitleColor=g_JSChartResource.DefaultTextColor,this.ClassName=\x22IChartTitlePainting\x22,this.ReloadResource=function(){this.Font=g_JSChartResource.TitleFont,this.TitleColor=g_JSChartResource.DefaultTextColor}}var\x20RIGHT_NAME=[\x22不复权\x22,\x22前复权\x22,\x22后复权\x22];function\x20DynamicKLineTitlePainting(){this.newMethod=IChartTitlePainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22DynamicKLineTitlePainting\x22,this.IsDynamic=!0,this.IsShow=!0,this.Period,this.UpColor=g_JSChartResource.UpTextColor,this.DownColor=g_JSChartResource.DownTextColor,this.UnchagneColor=g_JSChartResource.UnchagneTextColor,this.VolColor=g_JSChartResource.Title.VolColor,this.AmountColor=g_JSChartResource.Title.AmountColor,this.DateTimeColor=g_JSChartResource.Title.DateTimeColor,this.NameColor=g_JSChartResource.Title.NameColor,this.SettingColor=g_JSChartResource.Title.SettingColor,this.TurnoverRateColor=g_JSChartResource.Title.TurnoverRateColor,this.PositionColor=g_JSChartResource.Title.PositionColor,this.Symbol,this.Name,this.SpaceWidth=2*GetDevicePixelRatio(),this.OverlayChartPaint,this.IsShowName=!0,this.IsShowSettingInfo=!0,this.IsShowDateTime=!0,this.LanguageID=JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.OnDrawEvent,this.ReloadResource=function(){this.Font=g_JSChartResource.TitleFont,this.TitleColor=g_JSChartResource.DefaultTextColor,this.UpColor=g_JSChartResource.UpTextColor,this.DownColor=g_JSChartResource.DownTextColor,this.UnchagneColor=g_JSChartResource.UnchagneTextColor,this.VolColor=g_JSChartResource.Title.VolColor,this.AmountColor=g_JSChartResource.Title.AmountColor,this.DateTimeColor=g_JSChartResource.Title.DateTimeColor,this.NameColor=g_JSChartResource.Title.NameColor,this.SettingColor=g_JSChartResource.Title.SettingColor,this.TurnoverRateColor=g_JSChartResource.Title.TurnoverRateColor,this.PositionColor=g_JSChartResource.Title.PositionColor},this.GetCurrentKLineData=function(){if(null==this.CursorIndex||!this.Data)return\x20null;if(this.Data.length<=0)return\x20null;var\x20t=this.CursorIndex;t=parseInt(t.toFixed(0));var\x20e=this.Data.DataOffset+t;return\x20e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0?null:this.Data.Data[e]},this.DrawItem=function(t){var\x20e=!0===this.Frame.IsHScreen,a=this.Frame.ChartBorder.GetLeft(),i=this.Frame.ChartBorder.GetTop()-this.Frame.ChartBorder.Top/2,r=(this.Frame.ChartBorder.GetRight(),GetfloatPrecision(this.Symbol)),n=this.Symbol.toUpperCase();if(e){if(this.Frame.ChartBorder.Right<5)return;a=2,i=this.Frame.ChartBorder.Right/2,this.Frame.ChartBorder.GetHeight();var\x20s=this.Frame.ChartBorder.GetChartWidth(),o=this.Frame.ChartBorder.GetTop();this.Canvas.translate(s,o),this.Canvas.rotate(90*Math.PI/180)}else\x20if(this.Frame.ChartBorder.Top<5*GetDevicePixelRatio())return;this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.font=this.Font;var\x20h={Left:a,Bottom:i,IsHScreen:e};if(!this.IsShowName||this.DrawText(this.Name,this.NameColor,h)){if(this.IsShowSettingInfo){var\x20l=\x22\x22,C=\x22(\x22+(l=this.Data.Period>CUSTOM_MINUTE_PERIOD_START&&this.Data.Period<=CUSTOM_MINUTE_PERIOD_END?this.Data.Period-CUSTOM_MINUTE_PERIOD_START+g_JSChartLocalization.GetText(\x22自定义分钟\x22,this.LanguageID):this.Data.Period>CUSTOM_DAY_PERIOD_START&&this.Data.Period<=CUSTOM_DAY_PERIOD_END?this.Data.Period-CUSTOM_DAY_PERIOD_START+g_JSChartLocalization.GetText(\x22自定义日线\x22,this.LanguageID):this.Data.Period>CUSTOM_SECOND_PERIOD_START&&this.Data.Period<=CUSTOM_SECOND_PERIOD_END?this.Data.Period-CUSTOM_SECOND_PERIOD_START+g_JSChartLocalization.GetText(\x22自定义秒\x22,this.LanguageID):g_JSChartLocalization.GetText(ChartData.GetPeriodName(this.Data.Period),this.LanguageID))+\x22\x20\x22+g_JSChartLocalization.GetText(RIGHT_NAME[this.Data.Right],this.LanguageID)+\x22)\x22,u=MARKET_SUFFIX_NAME.IsSHSZStockA(this.Symbol);if(null==t.Time&&u||(C=\x22(\x22+l+\x22)\x22),!this.DrawText(C,this.SettingColor,h))return}if(this.IsShowDateTime){C=IFrameSplitOperator.FormatDateString(t.Date);if(!this.DrawText(C,this.DateTimeColor,h))return}if(ChartData.IsMinutePeriod(this.Period,!0)&&t.Time){C=IFrameSplitOperator.FormatTimeString(t.Time);if(!this.DrawText(C,this.DateTimeColor,h))return}else\x20if(ChartData.IsSecondPeriod(this.Period)&&t.Time){C=IFrameSplitOperator.FormatTimeString(t.Time,\x22HH:MM:SS\x22);if(!this.DrawText(C,this.DateTimeColor,h))return}var\x20D=this.GetColor(t.Open,t.YClose);C=g_JSChartLocalization.GetText(\x22KTitle-Open\x22,this.LanguageID)+t.Open.toFixed(r);if(this.DrawText(C,D,h)){D=this.GetColor(t.High,t.YClose),C=g_JSChartLocalization.GetText(\x22KTitle-High\x22,this.LanguageID)+t.High.toFixed(r);if(this.DrawText(C,D,h)){D=this.GetColor(t.Low,t.YClose),C=g_JSChartLocalization.GetText(\x22KTitle-Low\x22,this.LanguageID)+t.Low.toFixed(r);if(this.DrawText(C,D,h)){D=this.GetColor(t.Close,t.YClose),C=g_JSChartLocalization.GetText(\x22KTitle-Close\x22,this.LanguageID)+t.Close.toFixed(r);if(this.DrawText(C,D,h)){if(t.YFClose>0&&MARKET_SUFFIX_NAME.IsChinaFutures(n)){var\x20d=(t.Close-t.YFClose)/t.YFClose*100;D=this.GetColor(d,0),C=g_JSChartLocalization.GetText(\x22KTitle-Increase\x22,this.LanguageID)+d.toFixed(2)+\x22%\x22;if(!this.DrawText(C,D,h))return}else\x20if(t.YClose>0){d=(t.Close-t.YClose)/t.YClose*100,D=this.GetColor(d,0),C=g_JSChartLocalization.GetText(\x22KTitle-Increase\x22,this.LanguageID)+d.toFixed(2)+\x22%\x22;if(!this.DrawText(C,D,h))return}C=g_JSChartLocalization.GetText(\x22KTitle-Vol\x22,this.LanguageID)+IFrameSplitOperator.FromatIntegerString(t.Vol,2,this.LanguageID);if(this.DrawText(C,this.VolColor,h)){if(IFrameSplitOperator.IsNumber(t.Amount)){C=g_JSChartLocalization.GetText(\x22KTitle-Amount\x22,this.LanguageID)+IFrameSplitOperator.FormatValueString(t.Amount,2,this.LanguageID);if(!this.DrawText(C,this.AmountColor,h))return}if(MARKET_SUFFIX_NAME.IsSHSZStockA(this.Symbol)&&t.FlowCapital>0){d=t.Vol/t.FlowCapital*100,C=g_JSChartLocalization.GetText(\x22KTitle-Exchange\x22,this.LanguageID)+IFrameSplitOperator.FormatValueString(d,2,this.LanguageID)+\x22%\x22;if(!this.DrawText(C,this.TurnoverRateColor,h))return}if(MARKET_SUFFIX_NAME.IsFutures(n)&&IFrameSplitOperator.IsNumber(t.Position)){C=g_JSChartLocalization.GetText(\x22KTitle-Position\x22,this.LanguageID)+t.Position;if(!this.DrawText(C,this.PositionColor,h))return}for(var\x20c\x20in\x20this.OverlayChartPaint){if((t=this.OverlayChartPaint[c]).Symbol&&t.Title){var\x20m=t.Title,f=t.Color;C=\x22[\x22+m+\x22]\x22;if(!this.DrawText(C,f,h))return}}}}}}}}},this.Draw=function(){if(this.IsShow)if(null==this.CursorIndex||!this.Data||this.Data.length<=0)this.OnDrawEventCallback(null);else{this.Canvas.font=this.Font,this.SpaceWidth=this.Canvas.measureText(\x220\x22).width;var\x20t=this.CursorIndex;t=parseInt(t.toFixed(0));var\x20e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0)this.OnDrawEventCallback(null);else{var\x20a=this.Data.Data[e];this.OnDrawEventCallback(a),this.Canvas.save(),this.DrawItem(a),this.Canvas.restore()}}},this.OnDrawEventCallback=function(t){if(this.OnDrawEvent&&this.OnDrawEvent.Callback){var\x20e={Draw:t,Name:this.ClassName};if(this.Data&&this.Data.Data){var\x20a=Math.abs(this.CursorIndex);a=parseInt(a.toFixed(0));var\x20i=this.Data.DataOffset+a,r=this.Data.Data.length;e.DataIndex=i,e.DataCount=r}this.OnDrawEvent.Callback(this.OnDrawEvent,e,this)}},this.GetColor=function(t,e){return\x20t>e?this.UpColor:t<e?this.DownColor:this.UnchagneColor},this.DrawText=function(t,e,a){if(!t)return!0;var\x20i=!0===this.Frame.IsHScreen,r=this.Frame.ChartBorder.GetRight();i&&(r=this.Frame.ChartBorder.GetHeight()),this.Canvas.fillStyle=e;var\x20n=this.Canvas.measureText(t).width;return!(a.Left+n>r)&&(this.Canvas.fillText(t,a.Left,a.Bottom,n),a.Left+=n+this.SpaceWidth,!0)}}function\x20DynamicMinuteTitlePainting(){this.newMethod=DynamicKLineTitlePainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22DynamicMinuteTitlePainting\x22,this.SpaceWidth=1*GetDevicePixelRatio(),this.YClose,this.IsShowDate=!1,this.IsShowTime=!0,this.IsShowName=!0,this.IsShowAveragePrice=!0,this.OverlayChartPaint,this.LanguageID=JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.LastShowData,this.OnDrawEvent,this.GetCurrentKLineData=function(){if(this.LastShowData)return\x20this.LastShowData;if(null==this.CursorIndex||!this.Data)return\x20null;if(this.Data.Data.length<=0)return\x20null;var\x20t=Math.abs(this.CursorIndex);t=parseInt(t.toFixed(0));var\x20e=this.Data.DataOffset+t;return\x20e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0?null:this.Data.Data[e]},this.DrawItem=function(t){var\x20e=!0===this.Frame.IsHScreen,a=this.Frame.ChartBorder.GetLeft(),i=this.Frame.ChartBorder.GetTop()-this.Frame.ChartBorder.Top/2,r=(this.Frame.ChartBorder.GetRight(),GetfloatPrecision(this.Symbol));if(e){if(this.Frame.ChartBorder.Right<5)return;a=2,i=this.Frame.ChartBorder.Right/2,this.Frame.ChartBorder.GetHeight();var\x20n=this.Frame.ChartBorder.GetChartWidth(),s=this.Frame.ChartBorder.GetTop();this.Canvas.translate(n,s),this.Canvas.rotate(90*Math.PI/180)}else\x20if(this.Frame.ChartBorder.Top<5)return;this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.font=this.Font;var\x20o={Left:a,Bottom:i,IsHScreen:e};if(!this.IsShowName||this.DrawText(this.Name,this.NameColor,o)){if(this.IsShowDate||this.IsShowTime){var\x20h=IFrameSplitOperator.FormatDateTimeString(t.DateTime,this.IsShowDate,this.IsShowTime);if(!this.DrawText(h,this.DateTimeColor,o))return}var\x20l=t.Close,C=t.Increase,u=t.Vol,D=t.Amount;if(t.Before&&(l=t.Before.Close,C=t.Before.Increase,u=t.Before.Vol,D=t.Before.Amount),window.chartdata[\x2200\x22]&&window.chartdata[\x2200\x22].YClose&&(this.YClose=window.chartdata[\x2200\x22].YClose),l){var\x20d=this.GetColor(l,this.YClose);h=g_JSChartLocalization.GetText(\x22MTitle-Close\x22,this.LanguageID)+l.toFixed(r);if(!this.DrawText(h,d,o))return}if(null!=(C=(l-this.YClose)/this.YClose*100)){d=this.GetColor(C,0),h=g_JSChartLocalization.GetText(\x22MTitle-Increase\x22,this.LanguageID)+C.toFixed(2)+\x22%\x22;if(!this.DrawText(h,d,o))return}var\x20c=!0,m=this.Symbol.toUpperCase();if(MARKET_SUFFIX_NAME.IsET(m)&&!MARKET_SUFFIX_NAME.IsETShowAvPrice(m)&&(c=!1),t.AvPrice&&c&&this.IsShowAveragePrice){d=this.GetColor(t.AvPrice,this.YClose),h=g_JSChartLocalization.GetText(\x22MTitle-AvPrice\x22,this.LanguageID)+t.AvPrice.toFixed(r);if(!this.DrawText(h,d,o))return}h=g_JSChartLocalization.GetText(\x22MTitle-Vol\x22,this.LanguageID)+IFrameSplitOperator.FromatIntegerString(u,2);if(this.DrawText(h,this.VolColor,o)){if(IFrameSplitOperator.IsNumber(D)){h=g_JSChartLocalization.GetText(\x22MTitle-Amount\x22,this.LanguageID)+IFrameSplitOperator.FormatValueString(D,2);if(!this.DrawText(h,this.AmountColor,o))return}if(IFrameSplitOperator.IsNumber(t.Position)){h=g_JSChartLocalization.GetText(\x22MTitle-Position\x22,this.LanguageID)+IFrameSplitOperator.FromatIntegerString(t.Position,2);if(!this.DrawText(h,this.VolColor,o))return}for(var\x20f\x20in\x20this.OverlayChartPaint){if((t=this.OverlayChartPaint[f]).Symbol&&t.Title){var\x20v=t.Title,S=t.Color;h=\x22[\x22+v+\x22]\x22;if(!this.DrawText(h,S,o))return}}}}},this.Draw=function(){if(this.Canvas.canvas.JSChartContainer.Frame.Data&&(this.Data.DataOffset=this.Canvas.canvas.JSChartContainer.Frame.Data.DataOffset,this.LastShowData=null,this.IsShow))if(null==this.CursorIndex||!this.Data||!this.Data.Data||this.Data.Data.length<=0)this.OnDrawEventCallback(null);else{this.Canvas.font=this.Font,this.SpaceWidth=this.Canvas.measureText(\x220\x22).width;var\x20t=this.CursorIndex;t=parseInt(t.toFixed(0)),debug&&console.log(\x22DynamicMinuteTitlePainting\x22,this);var\x20e=this.Canvas.canvas.JSChartContainer.IsOnTouch?this.Data.DataOffset+t:this.Data.DataOffset+this.Frame.MinuteCount-1;e>=this.Data.Data.length&&(e=this.Data.Data.length-1);var\x20a=this.Data.Data[e];this.LastShowData=a,this.Canvas.save(),this.OnDrawEventCallback(a),this.DrawItem(a),this.Canvas.restore()}}}var\x20STRING_FORMAT_TYPE={DEFAULT:1,ORIGINAL:2,INTEGER:3,THOUSANDS:21};function\x20DynamicTitleData(t,e,a){this.Data=t,this.Name=e,this.Color=a,this.DataType,this.StringFormat=STRING_FORMAT_TYPE.DEFAULT,this.FloatPrecision=2}function\x20DynamicChartTitlePainting(){this.newMethod=IChartTitlePainting,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22DynamicChartTitlePainting\x22,this.IsDynamic=!0,this.Data=new\x20Array,this.Explain,this.ColorIndex,this.IsShowColorIndexTitle=!0,this.IsShowUpDownArrow=!0,this.IsShowIndexName=!0,this.TradeIndex,this.IsShowTradeIndexTitle=!0,this.OverlayIndex=new\x20Map,this.LanguageID=JSCHART_LANGUAGE_ID.LANGUAGE_CHINESE_ID,this.TitleRect,this.IsDrawTitleBG=!1,this.BGColor=g_JSChartResource.IndexTitleBGColor,this.OnDrawEvent,this.ParamSpace=2,this.IsKLineFrame=!1,this.OutName=null,this.SetDynamicOutName=function(t,e){this.OutName?this.OutName.clear():this.OutName=new\x20Map;var\x20a=new\x20Map;for(var\x20i\x20in\x20e){var\x20r=e[i];a.set(`{${r.Name}}`,r)}for(var\x20i\x20in\x20t){var\x20n=(r=t[i]).DynamicName.match(/{w*}/i);if(!n||n.length<=0)this.OutName.set(r.Name,r.DynamicName);else{for(var\x20s=r.DynamicName,o=!0,h=0;h<n.length;++h){var\x20l=n[h];if(!a.has(l)){o=!1;break}var\x20C=a.get(l).Value;s=s.replace(l,C.toString())}o&&this.OutName.set(r.Name,s)}}},this.GetDynamicOutName=function(t){return!this.OutName||this.OutName.size<=0?null:this.OutName.has(t)?this.OutName.get(t):null},this.IsClickTitle=function(t,e){return!!this.TitleRect&&(t>this.TitleRect.Left&&t<this.TitleRect.Left+this.TitleRect.Width&&e>this.TitleRect.Top&&e<this.TitleRect.Top+this.TitleRect.Height)},this.FormatValue=function(t,e){return\x20e.StringFormat==STRING_FORMAT_TYPE.DEFAULT?IFrameSplitOperator.FormatValueString(t,e.FloatPrecision,this.LanguageID):e.StringFormat==STRING_FORMAT_TYPE.THOUSANDS?IFrameSplitOperator.FormatValueThousandsString(t,e.FloatPrecision):e.StringFormat==STRING_FORMAT_TYPE.ORIGINAL?t.toFixed(e.FloatPrecision).toString():e.StringFormat==STRING_FORMAT_TYPE.INTEGER?IFrameSplitOperator.FromatIntegerString(t,e.FloatPrecision,this.LanguageID):void\x200},this.FormatMultiReport=function(t,e){var\x20a=\x22\x22;for(var\x20i\x20in\x20t){var\x20r=t[i];let\x20n=r.Quarter,s=r.Year,o=r.Value;switch(a.length>0&&(a+=\x22,\x22),a+=s.toString(),n){case\x201:a+=\x22一季报\x20\x22;break;case\x202:a+=\x22半年报\x20\x22;break;case\x203:a+=\x22三季报\x20\x22;break;case\x204:a+=\x22年报\x20\x22}a+=this.FormatValue(o,e)}return\x20a},this.Draw=function(){if(this.IsKLineFrame=\x22KLineFrame\x22==this.Frame.ClassName||\x22KLineHScreenFrame\x22==this.Frame.ClassName,this.IsDrawTitleBG=this.Frame.IsDrawTitleBG,this.IsShowUpDownArrow=this.Frame.IsShowTitleArraw,this.IsShowIndexName=this.Frame.IsShowIndexName,this.ParamSpace=this.Frame.IndexParamSpace,this.TitleRect=null,null!=this.CursorIndex&&this.Data&&!(this.Frame.ChartBorder.TitleHeight<5)){if(!0===this.Frame.IsHScreen)return\x20this.Canvas.save(),this.HScreenDraw(),void\x20this.Canvas.restore();var\x20t=this.Frame.ChartBorder.GetLeft()+1,e=this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.TitleHeight/2,a=this.Frame.ChartBorder.GetRight();if(this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.font=this.Font,this.Title&&this.IsShowIndexName){var\x20i=this.Canvas.measureText(this.Title).width+2;if(this.IsDrawTitleBG){var\x20r=2*GetDevicePixelRatio();this.Canvas.fillStyle=this.BGColor,this.TitleRect={Left:t,Top:this.Frame.ChartBorder.GetTop()+r,Width:i,Height:this.Frame.ChartBorder.TitleHeight-2*r},this.Canvas.fillRect(this.TitleRect.Left,this.TitleRect.Top,this.TitleRect.Width,this.TitleRect.Height)}this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(this.Title,t,e,i),t+=i}var\x20n=this.Frame.GetLockRect();if(n){var\x20s=Math.abs(this.CursorIndex-.5);if(this.IsKLineFrame&&(s=this.CursorIndex),this.Frame.GetXFromIndex(s.toFixed(0))>=n.Left)return}for(var\x20o\x20in\x20this.Data){var\x20h=this.Data[o];if(h&&h.Data&&h.Data.Data&&!(h.Data.Data.length<=0)){var\x20l=null,C=null;if(\x22StraightLine\x22==h.DataType)l=h.Data.Data[0],C=this.FormatValue(l,h);else{s=Math.abs(this.CursorIndex-.5);s=parseInt(s.toFixed(0)),this.IsKLineFrame&&(s=this.CursorIndex);var\x20u=h.Data.DataOffset+s;if(u>=h.Data.Data.length&&(u=h.Data.Data.length-1),u<0)continue;if(null==(l=h.Data.Data[u]))continue;if(\x22HistoryData-Vol\x22==h.DataType)l=l.Vol,C=this.FormatValue(l,h);else\x20if(\x22MultiReport\x22==h.DataType)C=this.FormatMultiReport(l,h);else{var\x20D=null;if(this.IsShowUpDownArrow){var\x20d=null;u-1>=0&&(d=h.Data.Data[u-1]),IFrameSplitOperator.IsNumber(d)&&(D=d>l?\x22↓\x22:d<l?\x22↑\x22:\x22→\x22)}C=this.FormatValue(l,h),D&&(C+=D)}}this.Canvas.fillStyle=h.Color;var\x20c=C;if(h.Name){var\x20m=this.GetDynamicOutName(h.Name);c=m?m+\x22:\x22+C:h.Name+\x22:\x22+C}var\x20f=this.ParamSpace*GetDevicePixelRatio();i=this.Canvas.measureText(c).width+f;this.Canvas.fillText(c,t,e,i),t+=i}}if(this.Explain){this.Canvas.fillStyle=this.TitleColor;c=\x22说明:\x22+this.Explain;t+(i=this.Canvas.measureText(c).width+2)<a&&(this.Canvas.fillText(c,t,e,i),t+=i)}if(this.ColorIndex&&this.IsShowColorIndexTitle){this.Canvas.fillStyle=g_JSChartResource.Title.ColorIndexColor;var\x20v=this.ColorIndex.Name+this.ColorIndex.Param;i=this.Canvas.measureText(v).width+2;this.Canvas.fillText(v,t,e,i),t+=i}if(this.TradeIndex&&this.IsShowTradeIndexTitle){this.Canvas.fillStyle=g_JSChartResource.Title.TradeIndexColor;v=this.TradeIndex.Name+this.TradeIndex.Param,i=this.Canvas.measureText(v).width+2;this.Canvas.fillText(v,t,e,i),t+=i}this.DrawOverlayIndex(t+10*GetDevicePixelRatio())}},this.DrawOverlayIndex=function(t){var\x20e=this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.TitleHeight/2,a=this.Frame.ChartBorder.GetRight();if(!0===this.Frame.IsHScreen&&(e=-this.Frame.ChartBorder.TitleHeight/2,a=this.Frame.ChartBorder.GetHeight()),!(t>a)){var\x20i=5*GetDevicePixelRatio(),r=t;for(o\x20of\x20this.OverlayIndex){t+=i;var\x20n=o[1];if(n.Title){if(this.Canvas.fillStyle=this.TitleColor,r=t,(t+=D=this.Canvas.measureText(n.Title).width+2)>a)break;this.Canvas.fillText(n.Title,r,e,D)}for(var\x20s\x20in\x20n.Data){var\x20o=n.Data[s];if(o&&o.Data&&o.Data.Data&&o.Name&&!(o.Data.Data.length<=0)){var\x20h=null,l=null;if(\x22StraightLine\x22==o.DataType)h=o.Data.Data[0],l=this.FormatValue(h,o);else{var\x20C=Math.abs(this.CursorIndex-.5);C=parseInt(C.toFixed(0)),this.IsKLineFrame&&(C=this.CursorIndex);var\x20u=o.Data.DataOffset+C;if(u>=o.Data.Data.length&&(u=o.Data.Data.length-1),u<0)continue;if(null==(h=o.Data.Data[u]))continue;\x22HistoryData-Vol\x22==o.DataType?(h=h.Vol,l=this.FormatValue(h,o)):l=\x22MultiReport\x22==o.DataType?this.FormatMultiReport(h,o):this.FormatValue(h,o)}this.Canvas.fillStyle=o.Color;var\x20D,d=o.Name+\x22:\x22+l;if(r=t,(t+=D=this.Canvas.measureText(d).width+2)>a)break;this.Canvas.fillText(d,r,e,D)}}if(t>a)break}}},this.HScreenDraw=function(){var\x20t=this.Frame.ChartBorder.GetRightTitle(),e=this.Frame.ChartBorder.GetTop();this.Canvas.translate(t,e),this.Canvas.rotate(90*Math.PI/180);var\x20a=1,i=-this.Frame.ChartBorder.TitleHeight/2,r=this.Frame.ChartBorder.GetHeight();if(this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.font=this.Font,this.Title&&this.IsShowIndexName){var\x20n=this.Canvas.measureText(this.Title).width+2;if(this.IsDrawTitleBG){var\x20s=2*GetDevicePixelRatio();this.Canvas.fillStyle=this.BGColor,this.TitleRect={Left:this.Frame.ChartBorder.GetRightTitle(),Top:this.Frame.ChartBorder.GetTop(),Width:this.Frame.ChartBorder.TitleHeight,Height:n};let\x20t={Left:a,Top:-this.Frame.ChartBorder.TitleHeight+s,Width:n,Height:this.Frame.ChartBorder.TitleHeight-2*s};this.Canvas.fillRect(t.Left,t.Top,t.Width,t.Height)}this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(this.Title,a,i,n),a+=n}var\x20o=this.Frame.GetLockRect();if(o){var\x20h=Math.abs(this.CursorIndex-.5);if(this.IsKLineFrame&&(h=this.CursorIndex),this.Frame.GetXFromIndex(h.toFixed(0))>=o.Top)return}for(var\x20l\x20in\x20this.Data){var\x20C=this.Data[l];if(C&&C.Data&&C.Data.Data&&C.Name&&!(C.Data.Data.length<=0)){var\x20u=null,D=null;if(\x22StraightLine\x22==C.DataType)u=C.Data.Data[0],D=this.FormatValue(u,C);else{h=Math.abs(this.CursorIndex-.5);h=parseInt(h.toFixed(0)),this.IsKLineFrame&&(h=this.CursorIndex);var\x20d=C.Data.DataOffset+h;if(d>=C.Data.Data.length&&(d=C.Data.Data.length-1),d<0)continue;if(null==(u=C.Data.Data[d]))continue;\x22HistoryData-Vol\x22==C.DataType?(u=u.Vol,D=this.FormatValue(u,C)):D=\x22MultiReport\x22==C.DataType?this.FormatMultiReport(u,C):this.FormatValue(u,C)}this.Canvas.fillStyle=C.Color;var\x20c=C.Name+\x22:\x22+D;n=this.Canvas.measureText(c).width+2;this.Canvas.fillText(c,a,i,n),a+=n}}if(this.Explain){this.Canvas.fillStyle=this.TitleColor;c=\x22说明:\x22+this.Explain;a+(n=this.Canvas.measureText(c).width+2)<r&&(this.Canvas.fillText(c,a,i,n),a+=n)}this.DrawOverlayIndex(a+5*GetDevicePixelRatio())},this.OnDrawEventCallback=function(t){if(this.OnDrawEvent&&this.OnDrawEvent.Callback){var\x20e={Draw:t,Name:\x22DynamicChartTitlePainting\x22};this.OnDrawEvent.Callback(this.OnDrawEvent,e,this)}}}function\x20IChartDrawPicture(){this.Frame,this.Canvas,this.Point=new\x20Array,this.Value=new\x20Array,this.LinePoint=[],this.PointCount=2,this.Status=0,this.PointStatus=0,this.MovePointIndex=null,this.ClassName=\x22IChartDrawPicture\x22,this.FinishedCallback,this.Guid=Guid(),this.Symbol,this.Period,this.IsSelected=!1,this.Option,this.LineColor=\x22#1e90ff\x22,this.LineWidth=2,this.BackupLineWidth=null,this.AreaColor=\x22rgba(25,25,25,0.4)\x22,this.PointColor=g_JSChartResource.DrawPicture.PointColor[0],this.SetLastPoint=null,this.Update=null,this.Draw=function(){},this.SetOption=function(t){t&&(t.LineColor&&(this.LineColor=t.LineColor),t.LineWidth>0&&(this.LineWidth=t.LineWidth),t.AreaColor&&(this.AreaColor=t.AreaColor),t.PointColor&&(this.PointColor=t.PointColor))},this.SetLineWidth=function(){this.BackupLineWidth=null,this.LineWidth>0&&(this.BackupLineWidth=this.Canvas.lineWidth,this.Canvas.lineWidth=this.LineWidth*GetDevicePixelRatio())},this.RestoreLineWidth=function(){null!=this.BackupLineWidth&&(this.Canvas.lineWidth=this.BackupLineWidth)},this.PointToValue=function(){return!!this.Frame&&(\x22MinuteFrame\x22==this.Frame.ClassName||\x22MinuteHScreenFrame\x22==this.Frame.Class?this.PointToValue_Minute():this.PointToValue_KLine())},this.PointToValue_KLine=function(){if(!this.Frame)return!1;var\x20t=this.Frame.Data;if(!t)return!1;if(this.Frame.IsHScreen)for(var\x20e\x20in\x20this.Point){var\x20a=this.Point[e],i={XValue:n=parseInt(this.Frame.GetXData(a.Y))+t.DataOffset,YValue:this.Frame.GetYData(a.X)},r=t.Data[n];i.DateTime={Date:r.Date},IFrameSplitOperator.IsNumber(r.Time)&&(i.DateTime.Time=r.Time),this.Value[e]=i}else\x20for(var\x20e\x20in\x20this.Point){var\x20n;a=this.Point[e];(n=parseInt(this.Frame.GetXData(a.X,!1))+t.DataOffset)<0&&(n=0);i={XValue:n,YValue:this.Frame.GetYData(a.Y,!1)},r=t.Data[n];i.DateTime={Date:r.Date},IFrameSplitOperator.IsNumber(r.Time)&&(i.DateTime.Time=r.Time),this.Value[e]=i}return!0},this.PointToValue_Minute=function(){if(!this.Frame)return!1;var\x20t=this.Frame.Data;if(!t)return!1;if(this.Frame.IsHScreen)for(var\x20e\x20in\x20this.Point){var\x20a=this.Point[e],i={XValue:n=parseInt(this.Frame.GetXData(a.Y)),YValue:this.Frame.GetYData(a.X)},r=t.Data[n];i.DateTime={Date:r.Date,Time:r.Time},this.Value[e]=i}else\x20for(var\x20e\x20in\x20this.Point){var\x20n;a=this.Point[e],i={XValue:n=parseInt(this.Frame.GetXData(a.X)),YValue:this.Frame.GetYData(a.Y)},r=t.Data[n];i.DateTime={Date:r.Date,Time:r.Time},this.Value[e]=i}return!0},this.IsPointIn=function(t,e){return!1},this.ValueToPoint=function(){if(!this.Frame)return!1;var\x20t=this.Frame.Data;if(!t)return!1;var\x20e=this.Frame.IsHScreen;for(var\x20a\x20in\x20this.Point=[],this.Value){var\x20i=this.Value[a],r=new\x20Point;e?(r.Y=this.Frame.GetXFromIndex(i.XValue-t.DataOffset),r.X=this.Frame.GetYFromData(i.YValue)):(r.X=this.Frame.GetXFromIndex(i.XValue-t.DataOffset,!1),r.Y=this.Frame.GetYFromData(i.YValue,!1)),this.Point[a]=r}},this.UpdateXValue=function(){if(!this.Frame)return!1;var\x20t=this.Frame.Data;if(!t)return!1;var\x20e=[];for(var\x20a\x20in\x20this.Value){var\x20i=this.Value[a],r={Date:i.DateTime.Date};IFrameSplitOperator.IsNumber(i.DateTime.Time)&&(r.Time=i.DateTime.Time),e[a]=r}for(var\x20a\x20in\x20t.FindDataIndexByDateTime(e),e){var\x20n=e[a],s=this.Value[a];n.Index>=0&&(s.XValue=n.Index)}},this.Move=function(t,e){if(20!=this.Status)return\x20fasle;if(!this.Frame)return!1;if(!this.Frame.Data)return!1;if(null==this.MovePointIndex)return!1;var\x20a=parseInt(this.MovePointIndex);if(100===a)for(var\x20i\x20in\x20this.Point)this.Point[i].X+=t,this.Point[i].Y+=e;else{if(0!==a&&1!==a&&2!==a&&3!==a&&4!==a&&5!==a)return!1;a<this.Point.length&&(this.Point[a].X+=t,this.Point[a].Y+=e)}},this.ClipFrame=function(){if(this.Frame.IsHScreen)var\x20t=this.Frame.ChartBorder.GetLeftEx(),e=this.Frame.ChartBorder.GetTop(),a=this.Frame.ChartBorder.GetWidthEx(),i=this.Frame.ChartBorder.GetHeight();else\x20t=this.Frame.ChartBorder.GetLeft(),e=this.Frame.ChartBorder.GetTopEx(),a=this.Frame.ChartBorder.GetWidth(),i=this.Frame.ChartBorder.GetHeightEx();this.Canvas.save(),this.Canvas.beginPath(),this.Canvas.rect(t,e,a,i),this.Canvas.clip()},this.CalculateDrawPoint=function(t){if(this.Status<2)return\x20null;if(!this.Point.length||!this.Frame)return\x20null;var\x20e=new\x20Array;if(10==this.Status){var\x20a=this.Frame.Data;if(!a)return\x20null;var\x20i=this.Frame.XPointCount,r=0,n=this.Frame.IsHScreen;for(var\x20s\x20in\x20this.Value){var\x20o=this.Value[s],h=o.XValue-a.DataOffset;(h<0||h>=i)&&++r;var\x20l=new\x20Point;n?(l.Y=this.Frame.GetXFromIndex(o.XValue-a.DataOffset,!1),l.X=this.Frame.GetYFromData(o.YValue,!1)):(l.X=this.Frame.GetXFromIndex(o.XValue-a.DataOffset,!1),l.Y=this.Frame.GetYFromData(o.YValue,!1)),e.push(l)}if(t&&!0===t.IsCheckX&&r==this.Value.length)return\x20null}else\x20e=this.Point;return\x20e},this.IsYValueInFrame=function(t){return!!this.Frame&&!(t>this.Frame.HorizontalMax||t<this.Frame.HorizontalMin)},this.DrawPoint=function(t){if(t&&!(t.length<=0)){this.ClipFrame();var\x20e=GetDevicePixelRatio();for(var\x20a\x20in\x20t){var\x20i=t[a];this.Canvas.beginPath(),this.Canvas.arc(i.X,i.Y,5*e,0,360,!1),this.Canvas.fillStyle=this.PointColor,this.Canvas.fill(),this.Canvas.closePath()}this.Canvas.restore()}},this.CalculateExtendLinePoint=function(t,e){var\x20a={},i=(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetRight(),this.Frame.ChartBorder.GetTopEx()),r=this.Frame.ChartBorder.GetBottom(),n=e.X-t.X,s=e.Y-t.Y;if(n>0){var\x20o=n*(l=r-t.Y)/s;(h=new\x20Point).X=t.X+o,h.Y=r,a.End=h;o=n*(l=e.Y-i)/s;(C=new\x20Point).Y=i,C.X=e.X-o,a.Start=C}else{var\x20h,l=r-t.Y;o=Math.abs(n)*l/s;(h=new\x20Point).X=t.X-o,h.Y=r,a.End=h;var\x20C;l=e.Y-i,o=Math.abs(n)*l/s;(C=new\x20Point).Y=i,C.X=e.X+o,a.Start=C}return\x20a},this.IsPointInXYValue=function(t,e){if(!this.Frame)return-1;var\x20a=this.Frame.Data;if(!a)return-1;if(!this.Value)return-1;var\x20i=5;this.Option&&(i+=this.Option.Zoom);var\x20r=this.Frame.IsHScreen;i*=GetDevicePixelRatio();for(var\x20n=0;n<this.Value.length;++n){var\x20s=this.Value[n],o=new\x20Point;if(r?(o.Y=this.Frame.GetXFromIndex(s.XValue-a.DataOffset),o.X=this.Frame.GetYFromData(s.YValue)):(o.X=this.Frame.GetXFromIndex(s.XValue-a.DataOffset),o.Y=this.Frame.GetYFromData(s.YValue)),this.Canvas.beginPath(),this.Canvas.arc(o.X,o.Y,i,0,360),this.Canvas.isPointInPath(t,e))return\x20n}return-1},this.IsPointInLine=function(t,e){if(!this.LinePoint)return-1;var\x20a=5;this.Option&&(a+=this.Option.Zoom);var\x20i=GetDevicePixelRatio();for(var\x20r\x20in\x20a*=i,this.LinePoint){var\x20n=this.LinePoint[r],s=n.Start,o=n.End;if(this.Canvas.beginPath(),s.X==o.X?(this.Canvas.moveTo(s.X-a,s.Y),this.Canvas.lineTo(s.X+a,s.Y),this.Canvas.lineTo(o.X+a,o.Y),this.Canvas.lineTo(o.X-a,o.Y)):(this.Canvas.moveTo(s.X,s.Y+a),this.Canvas.lineTo(s.X,s.Y-a),this.Canvas.lineTo(o.X,o.Y-a),this.Canvas.lineTo(o.X,o.Y+a)),this.Canvas.closePath(),this.Canvas.isPointInPath(t,e))return\x20r}return-1},this.IsPointIn_XYValue_Line=function(t,e){if(10!=this.Status)return-1;var\x20a=this.IsPointInXYValue(t,e);return\x20a>=0?a:(a=this.IsPointInLine(t,e))>=0?100:-1},this.DrawLine=function(t,e,a){a&&this.Canvas.setLineDash([5,10]),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.stroke(),a&&this.Canvas.setLineDash([])},this.CreateLineData=function(t,e){var\x20a={Start:new\x20Point,End:new\x20Point};return\x20a.Start.Y=t.Y,a.Start.X=t.X,a.End.Y=e.Y,a.End.X=e.X,a},this.ExportStorageData=function(){var\x20t={ClassName:this.ClassName,Symbol:this.Symbol,Guid:this.Guid,Period:this.Period,Value:[],FrameID:this.Frame.Identify,LineColor:this.LineColor,AreaColor:this.AreaColor,LineWidth:this.LineWidth};for(var\x20e\x20in\x20this.Value){var\x20a=this.Value[e];t.Value.push({XValue:a.XValue,YValue:a.YValue,DateTime:a.DateTime})}return\x20this.Text&&(t.Text=this.Text),this.FontOption&&(t.FontOption=this.FontOption),t}}function\x20ChartDrawPictureLine(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureLine\x22,this.IsPointIn=this.IsPointIn_XYValue_Line,this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame();var\x20e=t[0],a=t[1];this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.stroke(),this.RestoreLineWidth();var\x20i={Start:e,End:a};this.LinePoint.push(i),this.DrawPoint(t),this.Canvas.restore()}}}function\x20ChartDrawPictureHaflLine(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureHaflLine\x22,this.IsPointIn=this.IsPointIn_XYValue_Line,this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){var\x20e=t[0],a=t[1];this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y),this.Canvas.lineTo(t[1].X,t[1].Y);var\x20i=this.CalculateEndPoint(t);this.Canvas.lineTo(i.X,i.Y),this.Canvas.stroke(),this.RestoreLineWidth();var\x20r={Start:e,End:a};this.LinePoint.push(r),this.DrawPoint(t),this.Canvas.restore()}},this.CalculateEndPoint=function(t){var\x20e=this.Frame.ChartBorder.GetLeft(),a=this.Frame.ChartBorder.GetRight(),i=t[1].X-t[0].X,r=t[1].Y-t[0].Y;if(i>0){var\x20n=(a-t[0].X)*r/i+t[0].Y;return(s=new\x20Point).X=a,s.Y=n,s}var\x20s;n=(t[0].X-e)*r/Math.abs(i)+t[0].Y;return(s=new\x20Point).X=e,s.Y=n,s}}function\x20ChartDrawPictureHorizontalLine(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.Super_SetOption=this.SetOption,this.Super_ExportStorageData=this.ExportStorageData,this.Label,this.SetOption=function(t){this.Super_SetOption&&this.Super_SetOption(t),t&&t.Label&&(this.Label=t.Label)},this.ExportStorageData=function(){var\x20t;return\x20this.Super_ExportStorageData&&(t=this.Super_ExportStorageData(),this.Label&&(t.Label=this.Label)),t},this.PointCount=1,this.ClassName=\x22ChartDrawPictureHorizontalLine\x22,this.IsPointIn=this.IsPointIn_XYValue_Line,this.Font=16*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint();if(t&&1==t.length&&this.Frame&&1==this.Value.length){if(!this.IsYValueInFrame(this.Value[0].YValue))return\x20null;var\x20e=this.Frame.IsHScreen,a=this.Frame.ChartBorder.GetLeft(),i=this.Frame.ChartBorder.GetRight();e&&(a=this.Frame.ChartBorder.GetTop(),i=this.Frame.ChartBorder.GetBottom()),this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),e?(this.Canvas.moveTo(t[0].X,a),this.Canvas.lineTo(t[0].X,i)):(this.Canvas.moveTo(a,t[0].Y),this.Canvas.lineTo(i,t[0].Y)),this.Canvas.stroke(),this.RestoreLineWidth();var\x20r={Start:new\x20Point,End:new\x20Point};if(e?(r.Start.X=t[0].X,r.Start.Y=a,r.End.X=t[0].X,r.End.Y=i):(r.Start.X=a,r.Start.Y=t[0].Y,r.End.X=i,r.End.Y=t[0].Y),this.LinePoint.push(r),this.DrawPoint(t),this.Canvas.fillStyle=this.LineColor,this.Canvas.font=this.Font,e){this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22bottom\x22;var\x20n=t[0].X,s=a;this.Canvas.translate(n,s),this.Canvas.rotate(90*Math.PI/180);var\x20o=(h=this.Frame.GetYData(t[0].X)).toFixed(2);this.Label&&(0==this.Label.Position?o=this.Label.Text+h.toFixed(2):1==this.Label.Position&&(o=h.toFixed(2)+this.Label.Text)),this.Canvas.fillText(o,0,0)}else{this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22bottom\x22;var\x20h;o=(h=this.Frame.GetYData(t[0].Y)).toFixed(2);this.Label&&(0==this.Label.Position?o=this.Label.Text+h.toFixed(2):1==this.Label.Position&&(o=h.toFixed(2)+this.Label.Text)),this.Canvas.fillText(o,a,t[0].Y)}this.Canvas.restore()}}}function\x20ChartDrawPictureTrendLine(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureTrendLine\x22,this.IsPointIn=this.IsPointIn_XYValue_Line,this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){var\x20e=t[0],a=t[1],i=this.CalculateExtendLinePoint(e,a);this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),this.Canvas.moveTo(i.Start.X,i.Start.Y),this.Canvas.lineTo(i.End.X,i.End.Y),this.Canvas.stroke(),this.RestoreLineWidth();var\x20r={Start:e,End:a};this.LinePoint.push(r),this.DrawPoint(t),this.Canvas.restore()}}}function\x20ChartDrawPictureRect(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureRect\x22,this.Draw=function(){var\x20t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});t&&2==t.length&&(this.AreaColor=IChartDrawPicture.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),this.Canvas.rect(t[0].X,t[0].Y,t[1].X-t[0].X,t[1].Y-t[0].Y),this.Canvas.stroke(),this.RestoreLineWidth(),this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.fillRect(t[0].X,t[0].Y,t[1].X-t[0].X,t[1].Y-t[0].Y),this.Canvas.restore(),this.DrawPoint(t))},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;if(!this.Frame.Data)return-1;var\x20a=this.IsPointInXYValue(t,e);if(a>=0)return\x20a;var\x20i=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(!i||2!=i.length)return-1;var\x20r=[{X:i[0].X,Y:i[0].Y},{X:i[1].X,Y:i[0].Y}];return\x20this.IsPointInLine(r,t,e)?100:(r=[{X:i[1].X,Y:i[0].Y},{X:i[1].X,Y:i[1].Y}],this.IsPointInLine2(r,t,e)?100:(r=[{X:i[1].X,Y:i[1].Y},{X:i[0].X,Y:i[1].Y}],this.IsPointInLine(r,t,e)?100:(r=[{X:i[0].X,Y:i[1].Y},{X:i[0].X,Y:i[0].Y}],this.IsPointInLine2(r,t,e)?100:-1)))},this.IsPointInLine=function(t,e,a){var\x20i=5;if(this.Option&&(i+=this.Option.Zoom),i*=GetDevicePixelRatio(),this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y+i),this.Canvas.lineTo(t[0].X,t[0].Y-i),this.Canvas.lineTo(t[1].X,t[1].Y-i),this.Canvas.lineTo(t[1].X,t[1].Y+i),this.Canvas.closePath(),this.Canvas.isPointInPath(e,a))return!0},this.IsPointInLine2=function(t,e,a){var\x20i=5;if(this.Option&&(i+=this.Option.Zoom),i*=GetDevicePixelRatio(),this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X-i,t[0].Y),this.Canvas.lineTo(t[0].X+i,t[0].Y),this.Canvas.lineTo(t[1].X+i,t[1].Y),this.Canvas.lineTo(t[1].X-i,t[1].Y),this.Canvas.closePath(),this.Canvas.isPointInPath(e,a))return!0}}function\x20ChartDrawPictureArc(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureArc\x22,this.Draw=function(){var\x20t=this.CalculateDrawPoint();if(t&&2==t.length){if(this.ClipFrame(),this.SetLineWidth(),t[0].X<t[1].X&&t[0].Y>t[1].Y){var\x20e=(s=t[1].X-t[0].X)>(o=t[0].Y-t[1].Y)?1/s:1/o,a=t[0].X,i=t[1].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(var\x20r=1.5*Math.PI;r<2*Math.PI;r+=e)this.Canvas.lineTo(a+s*Math.cos(r),i+o*Math.sin(r)*-1);for(var\x20n=0;n<=.5*Math.PI;n+=e)this.Canvas.lineTo(a+s*Math.cos(n),i+o*Math.sin(n)*-1)}else\x20if(t[0].X>t[1].X&&t[0].Y>t[1].Y){e=(s=t[0].X-t[1].X)>(o=t[0].Y-t[1].Y)?1/s:1/o,a=t[1].X,i=t[0].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(r=0;r<=Math.PI;r+=e)this.Canvas.lineTo(a+s*Math.cos(r),i+o*Math.sin(r)*-1)}else\x20if(t[0].X>t[1].X&&t[0].Y<t[1].Y){e=(s=t[0].X-t[1].X)>(o=t[1].Y-t[0].Y)?1/s:1/o,a=t[0].X,i=t[1].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(r=.5*Math.PI;r<=1.5*Math.PI;r+=e)this.Canvas.lineTo(a+s*Math.cos(r),i+o*Math.sin(r)*-1)}else\x20if(t[0].X<t[1].X&&t[0].Y<t[1].Y){var\x20s,o;e=(s=t[1].X-t[0].X)>(o=t[1].Y-t[0].Y)?1/s:1/o,a=t[1].X,i=t[0].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(r=Math.PI;r<=2*Math.PI;r+=e)this.Canvas.lineTo(a+s*Math.cos(r),i+o*Math.sin(r)*-1)}this.Canvas.strokeStyle=this.LineColor,this.Canvas.stroke(),this.RestoreLineWidth(),this.Canvas.restore(),this.DrawPoint(t)}},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;if(!this.Frame.Data)return-1;var\x20a=this.IsPointInXYValue(t,e);if(a>=0)return\x20a;var\x20i=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(!i||2!=i.length)return-1;var\x20r=[{X:i[0].X,Y:i[0].Y},{X:i[1].X,Y:i[1].Y}];return\x20this.IsPointInArc(r,t,e)?100:-1},this.IsPointInArc=function(t,e,a){if(2!=t.length)return!1;if(t[0].X<t[1].X&&t[0].Y>t[1].Y){var\x20i=(u=t[1].X-t[0].X)>(D=t[0].Y-t[1].Y)?1/u:1/D,r=(d=.8*u)>(c=.8*D)?1/d:1/c,n=t[0].X,s=t[1].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(var\x20o=1.5*Math.PI;o<2*Math.PI;o+=i)this.Canvas.lineTo(n+u*Math.cos(o),s+D*Math.sin(o)*-1);for(var\x20h=0;h<=.5*Math.PI;h+=i)this.Canvas.lineTo(n+u*Math.cos(h),s+D*Math.sin(h)*-1);for(var\x20l=.5*Math.PI;l>=0;l-=r)this.Canvas.lineTo(n+d*Math.cos(l),s+c*Math.sin(h)*-1);for(var\x20C=2*Math.PI;C>=1.5*Math.PI;C-=r)this.Canvas.lineTo(n+d*Math.cos(C),s+c*Math.sin(C)*-1);this.Canvas.closePath()}else\x20if(t[0].X>t[1].X&&t[0].Y>t[1].Y){i=(u=t[0].X-t[1].X)>(D=t[0].Y-t[1].Y)?1/u:1/D,r=(d=.8*u)>(c=.8*D)?1/d:1/c,n=t[1].X,s=t[0].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(o=0;o<=Math.PI;o+=i)this.Canvas.lineTo(n+u*Math.cos(o),s+D*Math.sin(o)*-1);for(h=Math.PI;h>=0;h-=r)this.Canvas.lineTo(n+d*Math.cos(h),s+c*Math.sin(h)*-1);this.Canvas.closePath()}else\x20if(t[0].X>t[1].X&&t[0].Y<t[1].Y){i=(u=t[0].X-t[1].X)>(D=t[1].Y-t[0].Y)?1/u:1/D,r=(d=.8*u)>(c=.8*D)?1/d:1/c,n=t[0].X,s=t[1].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(o=.5*Math.PI;o<=1.5*Math.PI;o+=i)this.Canvas.lineTo(n+u*Math.cos(o),s+D*Math.sin(o)*-1);for(h=1.5*Math.PI;h>=.5*Math.PI;h-=r)this.Canvas.lineTo(n+d*Math.cos(h),s+c*Math.sin(h)*-1);this.Canvas.closePath()}else\x20if(t[0].X<t[1].X&&t[0].Y<t[1].Y){var\x20u,D,d,c;i=(u=t[1].X-t[0].X)>(D=t[1].Y-t[0].Y)?1/u:1/D,r=(d=.8*u)>(c=.8*D)?1/d:1/c,n=t[1].X,s=t[0].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(o=Math.PI;o<=2*Math.PI;o+=i)this.Canvas.lineTo(n+u*Math.cos(o),s+D*Math.sin(o)*-1);for(h=2*Math.PI;h>=Math.PI;h-=r)this.Canvas.lineTo(n+d*Math.cos(h),s+c*Math.sin(h)*-1);this.Canvas.closePath()}return!!this.Canvas.isPointInPath(e,a)}}function\x20ChartDrawPictureWaveMW(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureWaveMW\x22,this.PointCount=5,this.IsPointIn=this.IsPointIn_XYValue_Line,this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){for(var\x20e\x20in\x20this.AreaColor=IChartDrawPicture.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.CalculateLines(t),this.SetLineWidth(),this.LinePoint){var\x20a=this.LinePoint[e];this.DrawLine(a.Start,a.End)}this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}},this.CalculateLines=function(t){if(this.Frame&&!(t.length<2))if(2==this.Status){(r={Start:new\x20Point,End:new\x20Point}).Start.Y=t[0].Y,r.Start.X=t[0].X,r.End.Y=t[1].Y,r.End.X=t[1].X,this.LinePoint.push(r);var\x20e=t[1].X-t[0].X;(r={Start:new\x20Point,End:new\x20Point}).Start.Y=t[1].Y,r.Start.X=t[1].X,r.End.Y=t[0].Y,r.End.X=t[1].X+e,this.LinePoint.push(r);var\x20a=r.End;(i=new\x20Point).X=a.X,i.Y=a.Y,this.Point[2]=i,(r={Start:new\x20Point,End:new\x20Point}).Start.Y=a.Y,r.Start.X=a.X,r.End.Y=t[1].Y,r.End.X=a.X+e,this.LinePoint.push(r);a=r.End;(i=new\x20Point).X=a.X,i.Y=a.Y,this.Point[3]=i,(r={Start:new\x20Point,End:new\x20Point}).Start.Y=a.Y,r.Start.X=a.X,r.End.Y=t[0].Y,r.End.X=a.X+e,this.LinePoint.push(r);var\x20i;a=r.End;(i=new\x20Point).X=a.X,i.Y=a.Y,this.Point[4]=i,this.PointCount=this.Point.length}else\x20if(5==t.length){var\x20r;(r={Start:new\x20Point,End:new\x20Point}).Start.Y=t[0].Y,r.Start.X=t[0].X,r.End.Y=t[1].Y,r.End.X=t[1].X,this.LinePoint.push(r),(r={Start:new\x20Point,End:new\x20Point}).Start.Y=t[1].Y,r.Start.X=t[1].X,r.End.Y=t[2].Y,r.End.X=t[2].X,this.LinePoint.push(r),(r={Start:new\x20Point,End:new\x20Point}).Start.Y=t[2].Y,r.Start.X=t[2].X,r.End.Y=t[3].Y,r.End.X=t[3].X,this.LinePoint.push(r),(r={Start:new\x20Point,End:new\x20Point}).Start.Y=t[3].Y,r.Start.X=t[3].X,r.End.Y=t[4].Y,r.End.X=t[4].X,this.LinePoint.push(r)}}}function\x20ChartDrawPictureParallelLines(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureParallelLines\x22,this.IsPointIn=this.IsPointIn_XYValue_Line,this.PointCount=3,this.LastPoint,this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){this.AreaColor=IChartDrawPicture.ColorToRGBA(this.LineColor,.3);var\x20e=t.slice(0);for(var\x20a\x20in\x20this.CalculateLines(e),this.ClipFrame(),this.LinePoint){var\x20i=this.LinePoint[a];this.DrawLine(i.Start,i.End)}this.DrawArea(),this.DrawPoint(e),this.Canvas.restore()}},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.DrawArea=function(){2==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.lineTo(this.LinePoint[0].End.X,this.LinePoint[0].End.Y),this.Canvas.lineTo(this.LinePoint[1].End.X,this.LinePoint[1].End.Y),this.Canvas.lineTo(this.LinePoint[1].Start.X,this.LinePoint[1].Start.Y),this.Canvas.closePath(),this.Canvas.fill())},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var\x20e=new\x20Point;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2==t.length){var\x20a=this.CalculateExtendLinePoint(t[0],t[1]);this.LinePoint.push(a)}else\x20if(3==t.length){a=this.CalculateExtendLinePoint(t[0],t[1]);this.LinePoint.push(a);var\x20i=t[2].X-t[1].X,r=t[2].Y-t[1].Y,n=new\x20Point,s=new\x20Point;n.X=t[0].X+i,n.Y=t[0].Y+r,s.X=t[1].X+i,s.Y=t[1].Y+r,a=this.CalculateExtendLinePoint(n,s),this.LinePoint.push(a)}}}function\x20ChartDrawPicturePriceChannel(){this.newMethod=ChartDrawPictureParallelLines,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPicturePriceChannel\x22,this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var\x20e=new\x20Point;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2==t.length){var\x20a=this.CalculateExtendLinePoint(t[0],t[1]);this.LinePoint.push(a)}else\x20if(3==t.length){a=this.CalculateExtendLinePoint(t[0],t[1]);this.LinePoint.push(a);var\x20i=t[2].X-t[1].X,r=t[2].Y-t[1].Y,n=new\x20Point,s=new\x20Point;n.X=t[0].X+i,n.Y=t[0].Y+r,s.X=t[1].X+i,s.Y=t[1].Y+r,a=this.CalculateExtendLinePoint(n,s),this.LinePoint.push(a);n=new\x20Point,s=new\x20Point;n.X=t[0].X-i,n.Y=t[0].Y-r,s.X=t[1].X-i,s.Y=t[1].Y-r,a=this.CalculateExtendLinePoint(n,s),this.LinePoint.push(a)}},this.DrawArea=function(){3==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[1].Start.X,this.LinePoint[1].Start.Y),this.Canvas.lineTo(this.LinePoint[1].End.X,this.LinePoint[1].End.Y),this.Canvas.lineTo(this.LinePoint[2].End.X,this.LinePoint[2].End.Y),this.Canvas.lineTo(this.LinePoint[2].Start.X,this.LinePoint[2].Start.Y),this.Canvas.closePath(),this.Canvas.fill())}}function\x20ChartDrawPictureParallelChannel(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureParallelChannel\x22,this.ChannelWidth=50,this.AreaColor=\x22rgba(25,25,25,0.4)\x22,this.LinePoint=[],this.CalculateDrawPoint=function(){if(this.Status<2)return\x20null;if(!this.Point.length||!this.Frame)return\x20null;var\x20t=this.Frame.Data;if(!t)return\x20null;var\x20e=[];if(10==this.Status)for(var\x20a=0;a<2;++a){var\x20i=this.Value[a];(r=new\x20Point).X=this.Frame.GetXFromIndex(i.XValue-t.DataOffset),r.Y=this.Frame.GetYFromData(i.YValue),e.push(r)}else\x20for(a=0;a<this.Point.length;++a){var\x20r;i=this.Point[a];(r=new\x20Point).X=i.X,r.Y=i.Y,e.push(r)}if(e.length>=2){var\x20n={Start:new\x20Point,End:new\x20Point};if(n.Start.X=e[0].X,n.Start.Y=e[0].Y,n.End.X=e[1].X,n.End.Y=e[1].Y,this.LinePoint.push(n),3==e.length||10==this.Status){var\x20s=n.End.X-n.Start.X,o=n.End.Y-n.Start.Y,h=Math.atan(Math.abs(s/o)),l=this.ChannelWidth/Math.sin(h);(n={Start:new\x20Point,End:new\x20Point}).Start.X=e[0].X,n.Start.Y=e[0].Y-l,n.End.X=e[1].X,n.End.Y=e[1].Y-l,this.LinePoint.push(n);var\x20C=new\x20Point;C.X=n.Start.X+(n.End.X-n.Start.X)/2,C.Y=n.Start.Y+(n.End.Y-n.Start.Y)/2,e[3]=C,this.Point[2]=C;var\x20u=parseInt(this.Frame.GetXData(C.X))+t.DataOffset,D=this.Frame.GetYData(C.Y);this.Value[2]={XValue:u,YValue:D},this.PointCount=this.Point.length}}return\x20e},this.DrawLine=function(t,e){this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.stroke()},this.DrawArea=function(t,e,a,i){this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.lineTo(i.X,i.Y),this.Canvas.closePath(),this.Canvas.fill()},this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint();if(t){for(var\x20e\x20in\x20this.AreaColor=IChartDrawPicture.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.LinePoint){var\x20a=this.LinePoint[e];this.DrawLine(a.Start,a.End)}2==this.LinePoint.length&&this.DrawArea(this.LinePoint[0].Start,this.LinePoint[0].End,this.LinePoint[1].End,this.LinePoint[1].Start),this.Canvas.restore(),this.DrawPoint(t)}},this.Move=function(t,e){if(20!=this.Status)return\x20fasle;if(!this.Frame)return!1;if(!this.Frame.Data)return!1;if(100==this.MovePointIndex)for(var\x20a\x20in\x20this.Point)this.Point[a].X+=t,this.Point[a].Y+=e;else\x20if(0==this.MovePointIndex||1==this.MovePointIndex)this.MovePointIndex<this.Point.length&&(this.Point[this.MovePointIndex].X+=t,this.Point[this.MovePointIndex].Y+=e);else\x20if(2==this.MovePointIndex){this.Point[this.MovePointIndex].X+=t,this.Point[this.MovePointIndex].Y+=e;var\x20i=this.Point[1].X-this.Point[0].X,r=this.Point[1].Y-this.Point[0].Y,n=Math.atan(Math.abs(i/r)),s=this.ChannelWidth/Math.sin(n)-e;this.ChannelWidth=Math.sin(n)*s}},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;var\x20a=this.Frame.Data;if(!a)return-1;for(var\x20i=0;i<this.Value.length;++i){var\x20r=this.Value[i],n=new\x20Point;if(i<2)n.X=this.Frame.GetXFromIndex(r.XValue-a.DataOffset),n.Y=this.Frame.GetYFromData(r.YValue);else{if(i>=this.Point.length)continue;n.X=this.Point[i].X,n.Y=this.Point[i].Y}if(this.Canvas.beginPath(),this.Canvas.arc(n.X,n.Y,5,0,360),this.Canvas.isPointInPath(t,e))return\x20i}for(var\x20i\x20in\x20this.LinePoint){var\x20s=(r=this.LinePoint[i]).Start,o=r.End;if(this.Canvas.beginPath(),this.Canvas.moveTo(s.X,s.Y+5),this.Canvas.lineTo(s.X,s.Y-5),this.Canvas.lineTo(o.X,o.Y-5),this.Canvas.lineTo(o.X,o.Y+5),this.Canvas.closePath(),this.Canvas.isPointInPath(t,e))return\x20100}return-1}}function\x20ChartDrawPictureText(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureText\x22,this.Text=\x22文本\x22,this.PointCount=1,this.FontOption={Family:\x22微软雅黑\x22,Size:20,Weight:null,Style:null},this.TextRect=null,this.IsInitialized=!1,this.SettingMenu,this.HQChart,this.SetOption=function(t){t&&(t.LineColor&&(this.LineColor=t.LineColor),t.Text&&(this.Text=t.Text),t.FontOption&&(this.FontOption=t.FontOption))},this.Draw=function(t){this.TextRect=null;var\x20e=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(e&&1==e.length){this.ClipFrame(),this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22bottom\x22,this.Canvas.font=this.GetTextFont(),this.Canvas.fillText(this.Text,e[0].X,e[0].Y);var\x20a=this.Canvas.measureText(this.Text).width,i=this.FontOption.Size*GetDevicePixelRatio();this.TextRect={},this.TextRect.Left=e[0].X-a/2,this.TextRect.Top=e[0].Y-i,this.TextRect.Width=a,this.TextRect.Height=i,this.Canvas.restore(),!1===this.IsInitialized&&(this.SetTextOption(),this.IsInitialized=!0)}},this.GetTextFont=function(){const\x20t=16*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22;if(!this.FontOption||!this.FontOption.Family||this.FontOption.Size<=0)return\x20t;var\x20e=\x22\x22;return\x20this.FontOption.Color&&(e+=this.FontOption.Color+\x22\x20\x22),this.FontOption.Style&&(e+=this.FontOption.Style+\x22\x20\x22),this.FontOption.Weight&&(e+=this.FontOption.Weight+\x22\x20\x22),this.FontOption.Size>=0&&(e+=this.FontOption.Size*GetDevicePixelRatio()+\x22px\x20\x22),e+=this.FontOption.Family},this.SetTextOption=function(){JSConsole.Chart.Log(\x22[ChartDrawPictureText::SetTextOption]\x22),this.SettingMenu||(this.SettingMenu=new\x20ChartPictureTextSettingMenu(this.Frame.ChartBorder.UIElement.parentNode)),this.SettingMenu.ChartPicture=this,this.SettingMenu.HQChart=this.HQChart,this.SettingMenu.Position={Left:this.TextRect.Left+this.TextRect.Width,Top:this.TextRect.Top},this.SettingMenu.DoModal()},this.IsPointIn=function(t,e){return\x20this.Frame&&10==this.Status&&this.Frame.Data&&this.TextRect?(this.Canvas.beginPath(),this.Canvas.rect(this.TextRect.Left,this.TextRect.Top,this.TextRect.Width,this.TextRect.Height),this.Canvas.isPointInPath(t,e)?100:-1):-1}}function\x20ChartDrawPictureIconFont(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureIconFont\x22,this.PointCount=1,this.Text=\x22\x22,this.FontOption={Family:\x22iconfont\x22,Size:24},this.TextRect=null,this.SettingMenu,this.Angle=0,this.SetOption=function(t){t&&(t.LineColor&&(this.LineColor=t.LineColor),t.FontOption&&t.FontOption.Size>0&&(this.FontOption.Size=t.FontOption.Size),IFrameSplitOperator.IsNumber(t.Angle)&&(this.Angle=t.Angle))},this.Draw=function(){this.TextRect=null;var\x20t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&1==t.length){var\x20e=this.GetTextFont();if(e){this.ClipFrame();var\x20a=this.Frame.IsHScreen,i=GetDevicePixelRatio();this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign=\x22center\x22,this.Canvas.textBaseline=\x22middle\x22,this.Canvas.font=e,a?(this.Canvas.translate(t[0].X,t[0].Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.Text,0,0)):0!=this.Angle?(this.Canvas.translate(t[0].X,t[0].Y),this.Canvas.rotate(this.Angle*(Math.PI/180)),this.Canvas.fillText(this.Text,0,0)):this.Canvas.fillText(this.Text,t[0].X,t[0].Y);var\x20r=this.Canvas.measureText(this.Text).width;this.TextRect={},this.TextRect.Left=t[0].X-r/2,this.TextRect.Top=t[0].Y-this.FontOption.Size*i,this.TextRect.Width=r,this.TextRect.Height=this.FontOption.Size*i,this.Canvas.restore()}}},this.GetTextFont=function(){if(!this.FontOption||!this.FontOption.Family||this.FontOption.Size<=0)return\x20null;var\x20t=\x22\x22;return\x20this.FontOption.Size>=0&&(t+=this.FontOption.Size*GetDevicePixelRatio()+\x22px\x20\x22),t+=this.FontOption.Family},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;if(!this.Frame.Data)return-1;if(!this.TextRect)return-1;var\x20a=0;return\x20this.Option&&this.Option.Zoom>=1&&(a=this.Option.Zoom*GetDevicePixelRatio()),this.Canvas.beginPath(),this.Canvas.rect(this.TextRect.Left-a,this.TextRect.Top-a,this.TextRect.Width+2*a,this.TextRect.Height+2*a),this.Canvas.isPointInPath(t,e)?100:-1}}function\x20ChartDrawPictureGannFan(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureGannFan\x22,this.IsPointIn=this.IsPointIn_XYValue_Line,this.LinePoint=[],this.Font=16*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.AreaColor=IChartDrawPicture.ColorToRGBA(this.LineColor,.3),this.ClipFrame();var\x20e=this.GetQuadrant(t[0],t[1]);if(this.SetLineWidth(),1===e||4===e){for(var\x20a\x20in\x20this.CalculateLines(t[0],t[1],e),this.DrawArea(),this.LinePoint){var\x20i=this.LinePoint[a];this.DrawLine(i.Start,i.End,i.IsDottedLine)}for(var\x20a\x20in\x20this.LinePoint){(i=this.LinePoint[a]).Text&&i.PtEnd&&this.DrawTitle(i.PtEnd,i.Text)}}else\x20this.DrawLine(t[0],t[1],!1);this.RestoreLineWidth(),this.Canvas.restore(),this.DrawPoint(t)}},this.GetQuadrant=function(t,e){return\x20t.X<e.X&&t.Y>e.Y?1:t.X<e.X&&t.Y>e.Y?2:t.X<e.X&&t.Y<e.Y?4:3},this.DrawLine=function(t,e,a){a&&this.Canvas.setLineDash([5,10]),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.stroke(),a&&this.Canvas.setLineDash([])},this.DrawTitle=function(t,e){this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22bottom\x22,this.Canvas.font=this.Font,this.Canvas.fillText(e,t.X,t.Y)},this.DrawArea=function(){var\x20t=null,e=null;for(var\x20a\x20in\x20this.LinePoint){var\x20i=this.LinePoint[a];\x221:8\x22==i.Text?t=this.LinePoint[a]:\x228:1\x22==i.Text&&(e=this.LinePoint[a])}t&&e&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.End.X,t.End.Y),this.Canvas.lineTo(t.Start.X,t.Start.Y),this.Canvas.lineTo(e.End.X,e.End.Y),this.Canvas.closePath(),this.Canvas.fill())},this.CalculateLines=function(t,e,a){if(!this.Frame)return!1;this.Frame.ChartBorder.GetTopEx(),this.Frame.ChartBorder.GetRight(),this.Frame.ChartBorder.GetBottom();const\x20i=[.5,1/3,.25,.125,2/3],r=[\x221:2\x22,\x221:3\x22,\x221:4\x22,\x221:8\x22,\x222:3\x22],n=[\x222:1\x22,\x223:1\x22,\x224:1\x22,\x228:1\x22,\x223:2\x22];var\x20s=new\x20Point,o=new\x20Point;s.X=t.X,s.Y=t.Y,o.X=e.X,o.Y=e.Y;var\x20h=Math.abs(t.X-e.X),l=Math.abs(t.Y-e.Y);if(1===a){var\x20C={Start:s,End:(D=this.CalculateExtendLinePoint(t,e)).Start,IsDottedLine:!1,PtEnd:o,Text:\x221:1\x22};for(var\x20u\x20in\x20this.LinePoint.push(C),i){if(h>5){(C={Start:s,End:null,IsDottedLine:!1,PtEnd:new\x20Point,Text:r[u]}).PtEnd.Y=e.Y,C.PtEnd.X=t.X+h*i[u];var\x20D=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=D.Start,this.LinePoint.push(C)}if(l>5){(C={Start:s,End:null,IsDottedLine:!1,PtEnd:new\x20Point,Text:n[u]}).PtEnd.Y=t.Y-l*i[u],C.PtEnd.X=e.X;D=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=D.Start,this.LinePoint.push(C)}}}else{if(4!=a)return!1;C={Start:s,End:(D=this.CalculateExtendLinePoint(t,e)).End,IsDottedLine:!1,PtEnd:o,Text:\x221:1\x22};for(var\x20u\x20in\x20this.LinePoint.push(C),i){if(h>5){(C={Start:s,End:null,IsDottedLine:!1,PtEnd:new\x20Point,Text:r[u]}).PtEnd.Y=e.Y,C.PtEnd.X=t.X+h*i[u];D=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=D.End,this.LinePoint.push(C)}if(l>5){(C={Start:s,End:null,IsDottedLine:!1,PtEnd:new\x20Point,Text:n[u]}).PtEnd.Y=t.Y+l*i[u],C.PtEnd.X=e.X;D=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=D.End,this.LinePoint.push(C)}}}return!0}}function\x20ChartDrawPictureResistanceLine(){this.newMethod=ChartDrawPictureGannFan,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureResistanceLine\x22,this.CalculateLines=function(t,e,a){if(!this.Frame)return!1;this.Frame.ChartBorder.GetTopEx(),this.Frame.ChartBorder.GetRight(),this.Frame.ChartBorder.GetBottom();const\x20i=[1/3,2/3],r=[\x223:1\x22,\x223:2\x22];var\x20n=new\x20Point,s=new\x20Point;n.X=t.X,n.Y=t.Y,s.X=e.X,s.Y=e.Y;Math.abs(t.X-e.X);var\x20o=Math.abs(t.Y-e.Y);if(1===a){var\x20h={Start:n,End:(C=this.CalculateExtendLinePoint(t,e)).Start,IsDottedLine:!1,PtEnd:s,Text:\x221:1\x22};for(var\x20l\x20in\x20this.LinePoint.push(h),i)if(o>5){(h={Start:n,End:null,IsDottedLine:!1,PtEnd:new\x20Point,Text:r[l]}).PtEnd.Y=t.Y-o*i[l],h.PtEnd.X=e.X;var\x20C=this.CalculateExtendLinePoint(h.Start,h.PtEnd);h.End=C.Start,this.LinePoint.push(h)}}else{if(4!=a)return!1;h={Start:n,End:(C=this.CalculateExtendLinePoint(t,e)).End,IsDottedLine:!1,PtEnd:s,Text:\x221:1\x22};for(var\x20l\x20in\x20this.LinePoint.push(h),i)if(o>5){(h={Start:n,End:null,IsDottedLine:!1,PtEnd:new\x20Point,Text:r[l]}).PtEnd.Y=t.Y+o*i[l],h.PtEnd.X=e.X;C=this.CalculateExtendLinePoint(h.Start,h.PtEnd);h.End=C.End,this.LinePoint.push(h)}}return!0},this.DrawArea=function(){var\x20t=null,e=null;for(var\x20a\x20in\x20this.LinePoint){var\x20i=this.LinePoint[a];\x221:1\x22==i.Text?t=this.LinePoint[a]:\x223:1\x22==i.Text&&(e=this.LinePoint[a])}t&&e&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.End.X,t.End.Y),this.Canvas.lineTo(t.Start.X,t.Start.Y),this.Canvas.lineTo(e.End.X,e.End.Y),this.Canvas.closePath(),this.Canvas.fill())}}function\x20ChartDrawPictureGoldenSection(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureGoldenSectionLine\x22,this.IsPointIn=this.IsPointIn_XYValue_Line,this.Font=14*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,this.GetSectionData=function(){return[0,.236,.382,.5,.618,.8,1,1.236,1.382,1.5,1.618,1.8,2]},this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint();if(t&&2==t.length){for(var\x20e\x20in\x20this.AreaColor=IChartDrawPicture.ColorToRGBA(this.LineColor,.3),this.CalculateLines(t[0],t[1]),this.ClipFrame(),this.SetLineWidth(),this.LinePoint){var\x20a=this.LinePoint[e];this.DrawLine(a.Start,a.End,a.IsDottedLine)}for(var\x20e\x20in\x20this.RestoreLineWidth(),this.LinePoint){(a=this.LinePoint[e]).Text&&this.DrawTitle(a.Start,a.Text)}this.DrawPoint(t),this.Canvas.restore()}},this.CalculateHSCreenLines=function(t,e){for(var\x20a=this.GetSectionData(),i=this.Frame.ChartBorder.GetTop(),r=this.Frame.ChartBorder.GetBottom(),n=t.X-e.X,s=0;s<a.length;++s){var\x20o=n*a[s],h={Start:new\x20Point,End:new\x20Point};h.Start.X=t.X-o,h.Start.Y=i,h.End.X=t.X-o,h.End.Y=r;var\x20l=\x22\x22;l=0==s?\x22Base\x20\x22:(100*a[s]).toFixed(2)+\x22%\x20\x22,l+=this.Frame.GetYData(h.Start.Y).toFixed(2),h.Text=l,this.LinePoint.push(h)}},this.CalculateLines=function(t,e){if(this.Frame.IsHScreen)this.CalculateHSCreenLines(t,e);else\x20for(var\x20a=this.GetSectionData(),i=this.Frame.ChartBorder.GetLeft(),r=this.Frame.ChartBorder.GetRight(),n=t.Y-e.Y,s=0;s<a.length;++s){var\x20o=n*a[s],h={Start:new\x20Point,End:new\x20Point};h.Start.Y=t.Y-o,h.Start.X=i,h.End.Y=t.Y-o,h.End.X=r;var\x20l=\x22\x22;l=0==s?\x22Base\x20\x22:(100*a[s]).toFixed(2)+\x22%\x20\x22,l+=this.Frame.GetYData(h.Start.Y).toFixed(2),h.Text=l,this.LinePoint.push(h)}},this.DrawLine=function(t,e){this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.stroke()},this.DrawTitle=function(t,e){this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22bottom\x22,this.Canvas.font=this.Font,this.Frame.IsHScreen?(this.Canvas.save(),this.Canvas.translate(t.X,t.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(e,0,0),this.Canvas.restore()):this.Canvas.fillText(e,t.X,t.Y)}}function\x20ChartDrawPicturePercentage(){this.newMethod=ChartDrawPictureGoldenSection,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPicturePercentage\x22,this.GetSectionData=function(){return[0,.25,.333,.5,1]}}function\x20ChartDrawPictureWaveBand(){this.newMethod=ChartDrawPictureGoldenSection,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureWaveBand\x22,this.GetSectionData=function(){return[0,.125,.25,.375,.5,.625,.75,.875,1]}}function\x20ChartDrawPictureTriangle(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureTriangle\x22,this.PointCount=3,this.Font=16*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,this.IsPointIn=this.IsPointIn_XYValue_Line,this.LastPoint,this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){var\x20e=t.slice(0);for(var\x20a\x20in\x20this.AreaColor=IChartDrawPicture.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.CalculateLines(e),this.LinePoint){var\x20i=this.LinePoint[a];this.DrawLine(i.Start,i.End)}this.DrawArea(e),this.DrawPoint(e),this.DrawTitle(e),this.Canvas.restore()}},this.DrawArea=function(t){3==t.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y),this.Canvas.lineTo(t[1].X,t[1].Y),this.Canvas.lineTo(t[2].X,t[2].Y),this.Canvas.lineTo(t[0].X,t[0].Y),this.Canvas.closePath(),this.Canvas.fill())},this.DrawTitle=function(t){this.Status},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var\x20e=new\x20Point;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2===t.length)(a={Start:new\x20Point,End:new\x20Point}).Start.Y=t[0].Y,a.Start.X=t[0].X,a.End.Y=t[1].Y,a.End.X=t[1].X,this.LinePoint.push(a);else\x20if(3===t.length){var\x20a;(a={Start:new\x20Point,End:new\x20Point}).Start.Y=t[0].Y,a.Start.X=t[0].X,a.End.Y=t[1].Y,a.End.X=t[1].X,this.LinePoint.push(a),(a={Start:new\x20Point,End:new\x20Point}).Start.Y=t[1].Y,a.Start.X=t[1].X,a.End.Y=t[2].Y,a.End.X=t[2].X,this.LinePoint.push(a),(a={Start:new\x20Point,End:new\x20Point}).Start.Y=t[2].Y,a.Start.X=t[2].X,a.End.Y=t[0].Y,a.End.X=t[0].X,this.LinePoint.push(a)}}}function\x20ChartDrawPictureSymmetryAngle(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureSymmetryAngle\x22,this.PointCount=2,this.Font=16*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,this.IsPointIn=this.IsPointIn_XYValue_Line,this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){for(var\x20e\x20in\x20this.AreaColor=IChartDrawPicture.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.CalculateLines(t),this.LinePoint){var\x20a=this.LinePoint[e];this.DrawLine(a.Start,a.End)}this.DrawArea(),this.DrawPoint(t),this.DrawTitle(t),this.Canvas.restore()}},this.CalculateLines=function(t){if(2==t.length&&this.Frame){var\x20e={Start:new\x20Point,End:new\x20Point};e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[1].X,this.LinePoint.push(e),(e={Start:new\x20Point,End:new\x20Point}).Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[0].X,this.LinePoint.push(e);var\x20a=t[0].X-t[1].X;(e={Start:new\x20Point,End:new\x20Point}).Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[0].X+a,this.LinePoint.push(e)}},this.DrawArea=function(){3==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.lineTo(this.LinePoint[0].End.X,this.LinePoint[0].End.Y),this.Canvas.lineTo(this.LinePoint[2].End.X,this.LinePoint[2].End.Y),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.closePath(),this.Canvas.fill())},this.DrawTitle=function(t){this.Status}}function\x20ChartDrawPictureCircle(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureCircle\x22,this.PointCount=2,this.CircleData,this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.AreaColor=IChartDrawPicture.ColorToRGBA(this.LineColor,.3),this.ClipFrame();var\x20e=t[0].X-t[1].X,a=t[0].Y-t[1].Y,i=Math.sqrt(e*e+a*a);this.Canvas.fillStyle=this.AreaColor,this.Canvas.strokeStyle=this.LineColor,this.DrawLine(t[0],t[1]),this.Canvas.beginPath(),this.Canvas.arc(t[0].X,t[0].Y,i,0,2*Math.PI),this.Canvas.stroke(),this.Canvas.fill(),this.CircleData={X:t[0].X,Y:t[0].Y,R:i},this.DrawPoint(t),this.Canvas.restore()}},this.IsPointIn=function(t,e){if(10!=this.Status)return-1;var\x20a=this.IsPointInXYValue(t,e);if(a>=0)return\x20a;if(this.CircleData&&this.CircleData.R>8){var\x20i=this.CircleData.X-t,r=this.CircleData.Y-e,n=Math.sqrt(i*i+r*r);if(n<this.CircleData.R&&n>this.CircleData.R-8)return\x20100}return-1}}function\x20ChartDrawPictureQuadrangle(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureQuadrangle\x22,this.IsPointIn=this.IsPointIn_XYValue_Line,this.PointCount=3,this.LastPoint,this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){this.AreaColor=IChartDrawPicture.ColorToRGBA(this.LineColor,.3);var\x20e=t.slice(0);for(var\x20a\x20in\x20this.CalculateLines(e),this.ClipFrame(),this.LinePoint){var\x20i=this.LinePoint[a];this.DrawLine(i.Start,i.End)}this.DrawArea(),this.DrawPoint(e),this.Canvas.restore()}},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.DrawArea=function(){4==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.lineTo(this.LinePoint[0].End.X,this.LinePoint[0].End.Y),this.Canvas.lineTo(this.LinePoint[1].End.X,this.LinePoint[1].End.Y),this.Canvas.lineTo(this.LinePoint[2].End.X,this.LinePoint[2].End.Y),this.Canvas.closePath(),this.Canvas.fill())},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var\x20e=new\x20Point;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2==t.length){var\x20a=this.CreateLineData(t[0],t[1]);this.LinePoint.push(a)}else\x20if(3==t.length){a=this.CreateLineData(t[0],t[1]);this.LinePoint.push(a);a=this.CreateLineData(t[1],t[2]);this.LinePoint.push(a);var\x20i=t[2].X-t[1].X,r=t[2].Y-t[1].Y,n=new\x20Point;n.X=t[0].X+i,n.Y=t[0].Y+r;a=this.CreateLineData(t[2],n);this.LinePoint.push(a);a=this.CreateLineData(n,t[0]);this.LinePoint.push(a)}}}function\x20ChartDrawPictureFibonacci(){this.newMethod=IChartDrawPicture,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ChartDrawPictureFibonacci\x22,this.PointCount=1,this.Font=14*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,this.IsPointIn=this.IsPointIn_XYValue_Line,this.Draw=function(){this.LinePoint=[];var\x20t=this.CalculateDrawPoint();if(t&&(this.CalculateLines(),!(this.LinePoint.length<=0))){for(var\x20e\x20in\x20this.ClipFrame(),this.SetLineWidth(),this.LinePoint){var\x20a=this.LinePoint[e];this.DrawLine(a.Start,a.End),this.DrawTitle(a.Start,a.Title)}this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}},this.DrawTitle=function(t,e){this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign=\x22left\x22,this.Canvas.textBaseline=\x22top\x22,this.Canvas.font=this.Font,this.Frame.IsHScreen?(this.Canvas.save(),this.Canvas.translate(t.X,t.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(e,2,10),this.Canvas.restore()):this.Canvas.fillText(e,t.X+2,t.Y+10)},this.CalculateHSCreenLines=function(){var\x20t=this.Frame.Data;if(!t)return;var\x20e=null;if(10==this.Status){if(1!=this.Value.length)return;e=this.Value[0].XValue}else{if(1!=this.Point.length)return;e=parseInt(this.Frame.GetXData(this.Point[0].Y))+t.DataOffset}var\x20a=this.Frame.ChartBorder.GetRightEx(),i=this.Frame.ChartBorder.GetLeftEx(),r=this.Frame.XPointCount;const\x20n=[1,2,3,5,8,13,21,34,55,89,144,233];for(var\x20s=0;s<n.length;++s){var\x20o=e+n[s],h=o-t.DataOffset;if(!(h<0||h>=r)){var\x20l=this.Frame.GetXFromIndex(o-t.DataOffset,!1),C={Start:new\x20Point,End:new\x20Point,Title:n[s]};C.Start.X=a,C.Start.Y=l,C.End.X=i,C.End.Y=l,this.LinePoint.push(C)}}},this.CalculateLines=function(){if(this.Status<2)return;if(!this.Frame)return;var\x20t=this.Frame.Data;if(!t)return;if(this.Frame.IsHScreen)return\x20void\x20this.CalculateHSCreenLines();var\x20e=null;if(10==this.Status){if(1!=this.Value.length)return;e=this.Value[0].XValue}else{if(1!=this.Point.length)return;e=parseInt(this.Frame.GetXData(this.Point[0].X))+t.DataOffset}var\x20a=this.Frame.ChartBorder.GetTopEx(),i=this.Frame.ChartBorder.GetBottom(),r=this.Frame.XPointCount;const\x20n=[1,2,3,5,8,13,21,34,55,89,144,233];for(var\x20s=0;s<n.length;++s){var\x20o=e+n[s],h=o-t.DataOffset;if(!(h<0||h>=r)){var\x20l=this.Frame.GetXFromIndex(o-t.DataOffset,!1),C={Start:new\x20Point,End:new\x20Point,Title:n[s]};C.Start.Y=a,C.Start.X=l,C.End.Y=i,C.End.X=l,this.LinePoint.push(C)}}}}function\x20ChartDrawStorage(){this.DrawData=new\x20Map,this.StorageKey,this.Load=function(t){if(t){this.StorageKey=t;var\x20e=localStorage[this.StorageKey];if(JSConsole.Chart.Log(`[ChartDrawStorage::Save]\x20Load\x20to\x20localStorage,\x20key=${this.StorageKey},\x20cache=${e}`),e&&\x22string\x22==typeof\x20e){var\x20a=JSON.parse(e);for(var\x20i\x20in\x20a){var\x20r=a[i],n=new\x20Map;for(var\x20s\x20in\x20r.Value){var\x20o=r.Value[s];n.set(o.Key,o.Value)}this.DrawData.set(r.Key,n)}}}},this.Save=function(){if(this.StorageKey){var\x20t=[];for(var\x20e\x20of\x20this.DrawData){var\x20a=e[0],i=e[1],r={Key:a,Value:[]};for(var\x20n\x20of\x20i)r.Value.push({Key:n[0],Value:n[1]});t.push(r)}JSConsole.Chart.Log(`[ChartDrawStorage::Save]\x20save\x20to\x20localStorage,\x20key=${this.StorageKey}`);var\x20s=JSON.stringify(t);localStorage[this.StorageKey]=s}},this.SaveDrawData=function(t){var\x20e=t.Symbol+\x22-\x22+t.Period,a=t.ExportStorageData();if(a){if(this.DrawData.has(e))JSConsole.Chart.Log(\x22[ChartDrawStorage::SaveDrawData]\x20Upate:\x20key,\x20drawPicture,\x20data\x22,e,t,a),this.DrawData.get(e).set(a.Guid,a);else{JSConsole.Chart.Log(\x22[ChartDrawStorage::SaveDrawData]\x20Insert:\x20key,\x20drawPicture,\x20data\x22,e,t,a);var\x20i=new\x20Map;i.set(a.Guid,a),this.DrawData.set(e,i)}JSConsole.Chart.Log(\x22[ChartDrawStorage::SaveDrawData]\x20All\x20draw\x20data：\x20\x22,this.DrawData),this.Save()}},this.DeleteDrawData=function(t){var\x20e=t.Symbol+\x22-\x22+t.Period;if(this.DrawData.has(e)){var\x20a=this.DrawData.get(e);a.has(t.Guid)&&(a.delete(t.Guid),this.Save())}},this.Clear=function(){this.DrawData=new\x20Map,this.Save()},this.GetDrawData=function(t){var\x20e=[],a=t.Symbol+\x22-\x22+t.Period;if(!this.DrawData.has(a))return\x20e;var\x20i=this.DrawData.get(a);for(var\x20r\x20of\x20i)e.push(r[1]);return\x20e}}function\x20SplitData(){this.Data=[[1e-6,2e-6,1e-6,1e-7],[2e-6,4e-6,2e-6,2e-7],[4e-6,5e-6,4e-6,1e-7],[5e-6,1e-5,5e-6,5e-7],[1e-5,2e-5,1e-5,1e-6],[2e-5,4e-5,2e-5,2e-6],[4e-5,5e-5,4e-5,1e-6],[5e-5,1e-4,5e-5,5e-6],[1e-4,2e-4,1e-4,1e-5],[2e-4,4e-4,2e-4,2e-5],[4e-4,5e-4,4e-4,1e-5],[5e-4,.001,5e-4,5e-5],[.001,.002,.001,1e-4],[.002,.004,.002,2e-4],[.004,.005,.004,1e-4],[.005,.01,.005,5e-4],[.01,.02,.01,.001],[.02,.04,.02,.002],[.04,.05,.04,.001],[.05,.1,.05,.005],[.1,.2,.1,.01],[.2,.4,.2,.02],[.4,.5,.4,.01],[.5,1,.5,.05],[1,2,.5,.05],[2,4,.5,.05],[4,5,.5,.05],[5,10,.5,.05],[10,20,10,2],[20,40,20,5],[40,50,40,2],[50,100,50,10],[100,200,100,10],[200,400,200,20],[400,500,400,10],[500,1e3,500,50],[1e3,2e3,1e3,50],[2e3,4e3,2e3,50],[4e3,5e3,4e3,50],[5e3,1e4,5e3,100],[1e4,2e4,1e4,1e3],[2e4,4e4,1e4,1e3],[4e4,5e4,1e4,1e3],[5e4,1e5,1e4,1e3],[1e5,2e5,1e5,1e4],[2e5,4e5,1e5,1e4],[4e5,5e5,1e5,1e4],[5e5,1e6,1e5,1e4],[1e6,2e6,1e6,1e5],[2e6,4e6,1e6,1e5],[4e6,5e6,1e6,1e5],[5e6,1e7,1e6,1e5],[1e7,2e7,1e7,1e6],[2e7,4e7,1e7,1e6],[4e7,5e7,1e7,1e6],[5e7,1e8,1e7,1e6],[1e8,2e8,1e8,1e7],[2e8,4e8,1e8,1e7],[4e8,5e8,1e8,1e7],[5e8,1e9,1e8,1e7],[1e9,2e9,1e9,1e8],[2e9,4e9,1e9,1e8],[4e9,5e9,1e9,1e8],[5e9,1e10,1e9,1e8]],this.Find=function(t){for(var\x20e\x20in\x20this.Data){var\x20a=this.Data[e];if(t>a[0]&&t<=a[1]){var\x20i={};return\x20i.FixInterval=a[2],i.Increase=a[3],i}}return\x20null}}function\x20PriceSplitData(){this.newMethod=SplitData,this.newMethod(),delete\x20this.newMethod,this.Data=[[1e-6,2e-6,1e-6,1e-7],[2e-6,4e-6,2e-6,2e-7],[4e-6,5e-6,4e-6,1e-7],[5e-6,1e-5,5e-6,5e-7],[1e-5,2e-5,1e-5,1e-6],[2e-5,4e-5,2e-5,2e-6],[4e-5,5e-5,4e-5,1e-6],[5e-5,1e-4,5e-5,5e-6],[1e-4,2e-4,1e-4,1e-5],[2e-4,4e-4,2e-4,2e-5],[4e-4,5e-4,4e-4,1e-5],[5e-4,.001,5e-4,5e-5],[.001,.002,.001,1e-4],[.002,.004,.002,1e-4],[.004,.005,.004,1e-4],[.005,.01,.005,5e-4],[.01,.02,.01,.001],[.02,.04,.02,.001],[.04,.05,.04,.001],[.05,.1,.05,.001],[.1,.2,.1,.01],[.2,.4,.2,.01],[.4,.5,.2,.01],[.5,.8,.2,.01],[.8,1,.5,.01],[1,2,.5,.05],[2,4,.5,.05],[4,5,.5,.05],[5,10,.5,.05],[10,12,10,2],[20,40,20,5],[40,50,40,2],[50,100,50,10],[100,200,100,10],[200,400,200,20],[400,500,400,10],[500,1e3,500,50],[1e3,2e3,1e3,50],[2e3,4e3,2e3,50],[4e3,5e3,4e3,50],[5e3,1e4,5e3,100],[1e4,2e4,1e4,1e3],[2e4,4e4,2e4,2e3],[4e4,5e4,4e4,1e3],[5e4,1e5,5e4,5e3],[1e5,2e5,1e5,1e4],[2e5,4e5,2e5,2e4],[4e5,5e5,4e5,1e4],[5e5,1e6,5e5,5e4],[1e6,2e6,1e6,1e5],[2e6,4e6,2e6,2e5],[4e6,5e6,4e6,1e5],[5e6,1e7,5e6,5e5],[1e7,2e7,1e7,1e6],[2e7,4e7,2e7,2e6],[4e7,5e7,4e7,1e6],[5e7,1e8,5e7,5e6],[1e8,2e8,1e8,1e7],[2e8,4e8,2e8,2e7],[4e8,5e8,4e8,1e7],[5e8,1e9,5e8,5e7],[1e9,2e9,1e9,1e8],[2e9,4e9,2e9,2e8],[4e9,5e9,4e9,1e8],[5e9,1e10,5e9,5e8]]}function\x20JSChartResource(){this.TooltipBGColor=\x22rgb(255,\x20255,\x20255)\x22,this.TooltipAlpha=.92,this.SelectRectBGColor=\x22rgba(1,130,212,0.06)\x22,this.UpBarColor=\x22rgb(238,21,21)\x22,this.DownBarColor=\x22rgb(25,158,0)\x22,this.UnchagneBarColor=\x22rgb(0,0,0)\x22,this.Minute={},this.Minute.VolBarColor=\x22rgb(238,127,9)\x22,this.Minute.PriceColor=\x22rgb(50,171,205)\x22,this.Minute.AreaPriceColor=\x22rgba(50,171,205,0.1)\x22,this.Minute.AvPriceColor=\x22rgb(238,127,9)\x22,this.Minute.BeforeBGColor=\x22rgba(240,240,240,0.7)\x22,this.Minute.PositionColor=\x22rgb(218,165,32)\x22,this.DefaultTextColor=\x22rgb(43,54,69)\x22,this.DefaultTextFont=14*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,this.TitleFont=13*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,this.IndexTitleBGColor=\x22rgb(217,219,220)\x22,this.Title={TradeIndexColor:\x22rgb(105,105,105)\x22,ColorIndexColor:\x22rgb(112,128,144)\x22,VolColor:\x22rgb(43,54,69)\x22,AmountColor:\x22rgb(43,54,69)\x22,DateTimeColor:\x22rgb(43,54,69)\x22,SettingColor:\x22rgb(43,54,69)\x22,NameColor:\x22rgb(43,54,69)\x22,TurnoverRateColor:\x22rgb(43,54,69)\x22,PositionColor:\x22rgb(43,54,69)\x22},this.UpTextColor=\x22rgb(238,21,21)\x22,this.DownTextColor=\x22rgb(25,158,0)\x22,this.UnchagneTextColor=\x22rgb(0,0,0)\x22,this.CloseLineColor=\x22rgb(0,191,255)\x22,this.CloseLineAreaColor=[\x22rgba(0,191,255,0.8)\x22,\x22rgba(0,191,255,0.2)\x22],this.FrameBorderPen=\x22rgb(225,236,242)\x22,this.FrameSplitPen=\x22rgb(225,236,242)\x22,this.FrameDotSplitPen=\x22rgb(105,105,105)\x22,this.FrameYLineDash=null,this.FrameSplitTextColor=\x22rgb(117,125,129)\x22,this.FrameSplitTextFont=14*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,this.FrameTitleBGColor=\x22rgb(246,251,253)\x22,this.Frame={XBottomOffset:1*GetDevicePixelRatio(),YTopOffset:2*GetDevicePixelRatio()},this.FromeLogarithmic={OpenPriceFont:\x22bold\x20\x22+14*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,MinInterval:45*GetDevicePixelRatio()},this.FrameLatestPrice={TextColor:\x22rgb(255,255,255)\x22,UpBarColor:\x22rgb(238,21,21)\x22,DownBarColor:\x22rgb(25,158,0)\x22,UnchagneBarColor:\x22rgb(0,0,0)\x22,BGAlpha:.6},this.FrameMargin=4,this.FrameLeftMargin=2,this.FrameRightMargin=2,this.DragSubFrameBorder={TopBorderHeight:6*GetDevicePixelRatio(),MinFrameHeight:50*GetDevicePixelRatio()},this.OverlayFrame={BolderPen:\x22rgb(190,190,190)\x22,TitleColor:\x22rgb(105,105,105)\x22,TitleFont:11*GetDevicePixelRatio()+\x22px\x20arial\x22},this.CorssCursorBGColor=\x22rgb(43,54,69)\x22,this.CorssCursorTextColor=\x22rgb(255,255,255)\x22,this.CorssCursorTextFont=14*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,this.CorssCursorHPenColor=\x22rgb(130,130,130)\x22,this.CorssCursorVPenColor=\x22rgb(130,130,130)\x22,this.LockBGColor=\x22rgb(220,\x20220,\x20220)\x22,this.LockTextColor=\x22rgb(210,\x2034,\x2034)\x22,this.Domain=\x22https://opensource.zealink.com\x22,this.CacheDomain=\x22https://opensourcecache.zealink.com\x22,this.PyIndexDomain=\x22https://py.zealink.com\x22,this.KLine={MaxMin:{Font:12*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,Color:\x22rgb(43,54,69)\x22},Info:{Investor:{ApiUrl:\x22https://opensource.zealink.com/API/NewsInteract\x22,IconFont:{Family:\x22iconfont\x22,Text:\x22\x22,HScreenText:\x22\x22,Color:\x22#1c65db\x22}},Announcement:{ApiUrl:\x22https://opensource.zealink.com/API/ReportList\x22,IconFont:{Family:\x22iconfont\x22,Text:\x22\x22,HScreenText:\x22\x22,Color:\x22#f5a521\x22},IconFont2:{Family:\x22iconfont\x22,Text:\x22\x22,HScreenText:\x22\x22,Color:\x22#ed7520\x22}},Pforecast:{ApiUrl:\x22https://opensource.zealink.com/API/StockHistoryDay\x22,IconFont:{Family:\x22iconfont\x22,Text:\x22\x22,HScreenText:\x22\x22,Color:\x22#986cad\x22}},Research:{ApiUrl:\x22https://opensource.zealink.com/API/InvestorRelationsList\x22,IconFont:{Family:\x22iconfont\x22,Text:\x22\x22,HScreenText:\x22\x22,Color:\x22#19b1b7\x22}},BlockTrading:{ApiUrl:\x22https://opensource.zealink.com/API/StockHistoryDay\x22,IconFont:{Family:\x22iconfont\x22,Text:\x22\x22,HScreenText:\x22\x22,Color:\x22#f39f7c\x22}},TradeDetail:{ApiUrl:\x22https://opensource.zealink.com/API/StockHistoryDay\x22,IconFont:{Family:\x22iconfont\x22,Text:\x22\x22,HScreenText:\x22\x22,Color:\x22#b22626\x22}},IconLibrary:{Family:\x22iconfont\x22,Icon:[{Text:\x22\x22,HScreenText:\x22\x22,Color:\x22#f39f7c\x22},{Text:\x22\x22,HScreenText:\x22\x22,Color:\x22#19b1b7\x22},{Text:\x22\x22,HScreenText:\x22\x22,Color:\x22#b22626\x22},{Text:\x22\x22,HScreenText:\x22\x22,Color:\x22#ed7520\x22}]}},NumIcon:{Color:\x22rgb(251,80,80)\x22,Family:\x22iconfont\x22,Text:[\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22,\x22\x22]},TradeIcon:{Family:\x22iconfont\x22,Buy:{Color:\x22rgb(255,15,4)\x22,Text:\x22\x22,HScreenText:\x22\x22},Sell:{Color:\x22rgb(64,122,22)\x22,Text:\x22\x22,HScreenText:\x22\x22}}},this.Index={},this.Index.LineColor=[\x22rgb(255,174,0)\x22,\x22rgb(25,199,255)\x22,\x22rgb(175,95,162)\x22,\x22rgb(236,105,65)\x22,\x22rgb(68,114,196)\x22,\x22rgb(229,0,79)\x22,\x22rgb(0,128,255)\x22,\x22rgb(252,96,154)\x22,\x22rgb(42,230,215)\x22,\x22rgb(24,71,178)\x22],this.OverlaySymbol={Random:0},this.OverlaySymbol.Color=[\x22rgb(38,198,218)\x22,\x22rgb(103,58,183)\x22,\x22rgb(0,191,165)\x22,\x22rgb(130,177,255)\x22],this.Index.StockHistoryDayApiUrl=\x22https://opensource.zealink.com/API/StockHistoryDay\x22,this.Index.MarketLongShortApiUrl=\x22https://opensource.zealink.com/API/FactorTiming\x22,this.Index.MarketAttentionApiUrl=\x22https://opensource.zealink.com/API/MarketAttention\x22,this.Index.MarketHeatApiUrl=\x22https://opensource.zealink.com/API/MarketHeat\x22,this.Index.CustomIndexHeatApiUrl=\x22https://opensource.zealink.com/API/QuadrantCalculate\x22,this.Index.NotSupport={Font:\x2214px\x20微软雅黑\x22,TextColor:\x22rgb(52,52,52)\x22},this.DrawPicture={},this.DrawPicture.LineColor=[\x22rgb(30,144,255)\x22],this.DrawPicture.PointColor=[\x22rgb(105,105,105)\x22],this.KLineTrain={Font:\x22bold\x2014px\x20arial\x22,LastDataIcon:{Color:\x22rgb(0,0,205)\x22,Text:\x22⬇\x22},BuyIcon:{Color:\x22rgb(0,205,102\x20)\x22,Text:\x22B\x22},SellIcon:{Color:\x22rgb(255,127,36\x20)\x22,Text:\x22S\x22},IconFont:{Family:\x22iconfont\x22,Buy:{Text:\x22\x22,HScreenText:\x22\x22,Color:\x22rgb(255,140,0)\x22},Sell:{Text:\x22\x22,HScreenText:\x22\x22,Color:\x22rgb(6,79,18)\x22},Last:{Text:\x22\x22,HScreenText:\x22\x22,Color:\x22rgb(55,0,255)\x22}}},this.TooltipPaint={BGColor:\x22rgba(250,250,250,0.8)\x22,BorderColor:\x22rgb(120,120,120)\x22,TitleColor:\x22rgb(120,120,120)\x22,TitleFont:13*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22},this.PCTooltip={LineHeight:25},this.Barrage={Font:16*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,Height:20,Color:\x22RGB(109,109,109)\x22},this.MinuteInfo={TextColor:\x22rgb(84,143,255)\x22,Font:14*GetDevicePixelRatio()+\x22px\x20微软雅黑\x22,PointColor:\x22rgb(38,113,254)\x22,LineColor:\x22rgb(120,167,255)\x22,TextBGColor:\x22rgba(255,255,255,0.8)\x22},this.DRAWICON={Icon:{MaxSize:24,MinSize:12,Zoom:{Type:1,Value:1}},Text:{MaxSize:50,MinSize:12,Zoom:{Type:1,Value:1},FontName:\x22Arial\x22}},this.DRAWTEXT={MaxSize:30,MinSize:20,Zoom:{Type:1,Value:1},FontName:\x22微软雅黑\x22},this.DOTLINE={LineDash:[3,5]},this.DRAWSL={PixelWidth:15},this.SetStyle=function(t){if(t.TooltipBGColor&&(this.TooltipBGColor=t.TooltipBGColor),t.TooltipAlpha&&(this.TooltipAlpha=t.TooltipAlpha),t.SelectRectBGColor&&(this.SelectRectBGColor=t.SelectRectBGColor),t.UpBarColor&&(this.UpBarColor=t.UpBarColor),t.DownBarColor&&(this.DownBarColor=t.DownBarColor),t.UnchagneBarColor&&(this.UnchagneBarColor=t.UnchagneBarColor),t.Minute&&(t.Minute.VolBarColor&&(this.Minute.VolBarColor=t.Minute.VolBarColor),t.Minute.PriceColor&&(this.Minute.PriceColor=t.Minute.PriceColor),t.Minute.AvPriceColor&&(this.Minute.AvPriceColor=t.Minute.AvPriceColor),t.Minute.AreaPriceColor&&(this.Minute.AreaPriceColor=t.Minute.AreaPriceColor),t.Minute.PositionColor&&(this.Minute.PositionColor=t.Minute.PositionColor)),t.DefaultTextColor&&(this.DefaultTextColor=t.DefaultTextColor),t.DefaultTextFont&&(this.DefaultTextFont=t.DefaultTextFont),t.TitleFont&&(this.TitleFont=t.TitleFont),t.IndexTitleBGColor&&(this.IndexTitleBGColor=t.IndexTitleBGColor),t.UpTextColor&&(this.UpTextColor=t.UpTextColor),t.DownTextColor&&(this.DownTextColor=t.DownTextColor),t.UnchagneTextColor&&(this.UnchagneTextColor=t.UnchagneTextColor),t.CloseLineColor&&(this.CloseLineColor=t.CloseLineColor),t.CloseLineAreaColor&&(this.CloseLineAreaColor=t.CloseLineAreaColor),t.FrameBorderPen&&(this.FrameBorderPen=t.FrameBorderPen),t.FrameSplitPen&&(this.FrameSplitPen=t.FrameSplitPen),t.FrameDotSplitPen&&(this.FrameDotSplitPen=t.FrameDotSplitPen),t.FrameSplitTextColor&&(this.FrameSplitTextColor=t.FrameSplitTextColor),t.FrameSplitTextFont&&(this.FrameSplitTextFont=t.FrameSplitTextFont),t.FrameTitleBGColor&&(this.FrameTitleBGColor=t.FrameTitleBGColor),t.Frame&&(t.Frame.XBottomOffset&&(this.Frame.XBottomOffset=t.Frame.XBottomOffset),t.Frame.YTopOffset&&(this.Frame.YTopOffset=t.Frame.YTopOffset)),t.FrameLatestPrice&&(t.FrameLatestPrice.TextColor&&(this.FrameLatestPrice.TextColor=t.FrameLatestPrice.TextColor),t.FrameLatestPrice.UpBarColor&&(this.FrameLatestPrice.UpBarColor=t.FrameLatestPrice.UpBarColor),t.FrameLatestPrice.DownBarColor&&(this.FrameLatestPrice.DownBarColor=t.FrameLatestPrice.DownBarColor),t.FrameLatestPrice.UnchagneBarColor&&(this.FrameLatestPrice.UnchagneBarColor=t.FrameLatestPrice.UnchagneBarColor),t.FrameLatestPrice.BGAlpha&&(this.FrameLatestPrice.BGAlpha=t.FrameLatestPrice.BGAlpha)),t.CorssCursorBGColor&&(this.CorssCursorBGColor=t.CorssCursorBGColor),t.CorssCursorTextColor&&(this.CorssCursorTextColor=t.CorssCursorTextColor),t.CorssCursorTextFont&&(this.CorssCursorTextFont=t.CorssCursorTextFont),t.CorssCursorVPenColor&&(this.CorssCursorVPenColor=t.CorssCursorVPenColor),t.CorssCursorHPenColor&&(this.CorssCursorHPenColor=t.CorssCursorHPenColor),t.KLine&&(this.KLine=t.KLine),t.Index&&(t.Index.LineColor&&(this.Index.LineColor=t.Index.LineColor),t.Index.NotSupport&&(this.Index.NotSupport=t.Index.NotSupport)),t.ColorArray&&(this.ColorArray=t.ColorArray),t.DrawPicture&&(this.DrawPicture.LineColor=t.DrawPicture.LineColor,this.DrawPicture.PointColor=t.DrawPicture.PointColor),t.TooltipPaint&&(t.TooltipPaint.BGColor&&(this.TooltipPaint.BGColor=t.TooltipPaint.BGColor),t.TooltipPaint.BorderColor&&(this.TooltipPaint.BorderColor=t.TooltipPaint.BorderColor),t.TooltipPaint.TitleColor&&(this.TooltipPaint.TitleColor=t.TooltipPaint.TitleColor),t.TooltipPaint.TitleFont&&(this.TooltipPaint.TitleFont=t.TooltipPaint.TitleFont)),t.MinuteInfo&&(t.MinuteInfo.TextColor&&(this.MinuteInfo.TextColor=t.MinuteInfo.TextColor),t.MinuteInfo.Font&&(this.MinuteInfo.Font=t.MinuteInfo.Font),t.MinuteInfo.PointColor&&(this.MinuteInfo.PointColor=t.MinuteInfo.PointColor),t.MinuteInfo.LineColor&&(this.MinuteInfo.LineColor=t.MinuteInfo.LineColor),t.MinuteInfo.TextBGColor&&(this.MinuteInfo.TextBGColor=t.MinuteInfo.TextBGColor)),t.Title&&(t.Title.TradeIndexColor&&(this.Title.TradeIndexColor=t.Title.TradeIndexColor),t.Title.ColorIndexColor&&(this.Title.ColorIndexColor=t.Title.ColorIndexColor),t.Title.VolColor&&(this.Title.VolColor=t.Title.VolColor),t.Title.AmountColor&&(this.Title.AmountColor=t.Title.AmountColor),t.Title.DateTimeColor&&(this.Title.DateTimeColor=t.Title.DateTimeColor),t.Title.NameColor&&(this.Title.NameColor=t.Title.NameColor),t.Title.SettingColor&&(this.Title.SettingColor=t.Title.SettingColor),t.Title.TurnoverRateColor&&(this.Title.TurnoverRateColor=t.Title.TurnoverRateColor),t.Title.PositionColor&&(this.Title.PositionColor=t.Title.PositionColor)),t.DRAWICON){if(t.DRAWICON.Icon){var\x20e=t.DRAWICON.Icon;IFrameSplitOperator.IsPlusNumber(e.MaxSize)&&(this.DRAWICON.Icon.MaxSize=e.MaxSize),IFrameSplitOperator.IsPlusNumber(e.MinSize)&&(this.DRAWICON.Icon.MinSize=e.MinSize),e.Zoom&&(this.DRAWICON.Icon.Zoom=e.Zoom)}if(t.DRAWICON.Text){e=t.DRAWICON.Text;IFrameSplitOperator.IsPlusNumber(e.MaxSize)&&(this.DRAWICON.Text.MaxSize=e.MaxSize),IFrameSplitOperator.IsPlusNumber(e.MinSize)&&(this.DRAWICON.Text.MinSize=e.MinSize),e.Zoom&&(this.DRAWICON.Text.Zoom=e.Zoom),e.FontName&&(this.DRAWICON.Text.FontName=e.FontName)}}if(t.DRAWTEXT){e=t.DRAWTEXT;IFrameSplitOperator.IsPlusNumber(e.MaxSize)&&(this.DRAWICON.MaxSize=e.MaxSize),IFrameSplitOperator.IsPlusNumber(e.MinSize)&&(this.DRAWICON.MinSize=e.MinSize),e.Zoom&&(this.DRAWICON.Zoom=e.Zoom),e.FontName&&(this.DRAWICON.FontName=e.FontName)}t.DOTLINE&&(this.DOTLINE=t.DOTLINE),t.DRAWSL&&(this.DOTLINE=t.DRAWSL),t.DragSubFrameBorder&&(this.DragSubFrameBorder=t.DragSubFrameBorder)}}IChartDrawPicture.ColorToRGBA=function(t,e){if(/^(rgb|RGB)/.test(t)){for(var\x20a=\x22#\x22,i=t.replace(/(?:(|)|rgb|RGB)*/g,\x22\x22).split(\x22,\x22),r=0;r<i.length;r++){var\x20n=Number(i[r]).toString(16);\x220\x22===n&&(n+=n),a+=n}t=a}return\x22rgba(\x22+parseInt(\x220x\x22+t.slice(1,3))+\x22,\x22+parseInt(\x220x\x22+t.slice(3,5))+\x22,\x22+parseInt(\x220x\x22+t.slice(5,7))+\x22,\x22+e+\x22)\x22},IChartDrawPicture.ArrayDrawPricture=[{Name:\x22线段\x22,ClassName:\x22ChartDrawPictureLine\x22,Create:function(){return\x20new\x20ChartDrawPictureLine}},{Name:\x22射线\x22,ClassName:\x22ChartDrawPictureHaflLine\x22,Create:function(){return\x20new\x20ChartDrawPictureHaflLine}},{Name:\x22水平线\x22,ClassName:\x22ChartDrawPictureHorizontalLine\x22,Create:function(){return\x20new\x20ChartDrawPictureHorizontalLine}},{Name:\x22趋势线\x22,ClassName:\x22ChartDrawPictureTrendLine\x22,Create:function(){return\x20new\x20ChartDrawPictureTrendLine}},{Name:\x22矩形\x22,ClassName:\x22ChartDrawPictureRect\x22,Create:function(){return\x20new\x20ChartDrawPictureRect}},{Name:\x22圆弧线\x22,ClassName:\x22ChartDrawPictureArc\x22,Create:function(){return\x20new\x20ChartDrawPictureArc}},{Name:\x22M头W底\x22,ClassName:\x22ChartDrawPictureWaveMW\x22,Create:function(){return\x20new\x20ChartDrawPictureWaveMW}},{Name:\x22平行线\x22,ClassName:\x22ChartDrawPictureParallelLines\x22,Create:function(){return\x20new\x20ChartDrawPictureParallelLines}},{Name:\x22平行通道\x22,ClassName:\x22ChartDrawPictureParallelChannel\x22,Create:function(){return\x20new\x20ChartDrawPictureParallelChannel}},{Name:\x22价格通道线\x22,ClassName:\x22ChartDrawPicturePriceChannel\x22,Create:function(){return\x20new\x20ChartDrawPicturePriceChannel}},{Name:\x22文本\x22,ClassName:\x22ChartDrawPictureText\x22,Create:function(){return\x20new\x20ChartDrawPictureText}},{Name:\x22江恩角度线\x22,ClassName:\x22ChartDrawPictureGannFan\x22,Create:function(){return\x20new\x20ChartDrawPictureGannFan}},{Name:\x22阻速线\x22,ClassName:\x22ChartDrawPictureResistanceLine\x22,Create:function(){return\x20new\x20ChartDrawPictureResistanceLine}},{Name:\x22黄金分割\x22,ClassName:\x22ChartDrawPictureGoldenSection\x22,Create:function(){return\x20new\x20ChartDrawPictureGoldenSection}},{Name:\x22百分比线\x22,ClassName:\x22ChartDrawPicturePercentage\x22,Create:function(){return\x20new\x20ChartDrawPicturePercentage}},{Name:\x22波段线\x22,ClassName:\x22ChartDrawPictureWaveBand\x22,Create:function(){return\x20new\x20ChartDrawPictureWaveBand}},{Name:\x22三角形\x22,ClassName:\x22ChartDrawPictureTriangle\x22,Create:function(){return\x20new\x20ChartDrawPictureTriangle}},{Name:\x22对称角度\x22,ClassName:\x22ChartDrawPictureSymmetryAngle\x22,Create:function(){return\x20new\x20ChartDrawPictureSymmetryAngle}},{Name:\x22圆\x22,ClassName:\x22ChartDrawPictureCircle\x22,Create:function(){return\x20new\x20ChartDrawPictureCircle}},{Name:\x22平行四边形\x22,ClassName:\x22ChartDrawPictureQuadrangle\x22,Create:function(){return\x20new\x20ChartDrawPictureQuadrangle}},{Name:\x22斐波那契周期线\x22,ClassName:\x22ChartDrawPictureFibonacci\x22,Create:function(){return\x20new\x20ChartDrawPictureFibonacci}},{ClassName:\x22ChartDrawPictureIconFont\x22,Create:function(){return\x20new\x20ChartDrawPictureIconFont}}],IChartDrawPicture.MapIonFont=new\x20Map([[\x22icon-arrow_up\x22,{Text:\x22\x22,Color:\x22#318757\x22,Family:\x22iconfont\x22}],[\x22icon-arrow_down\x22,{Text:\x22\x22,Color:\x22#db563e\x22,Family:\x22iconfont\x22}],[\x22icon-arrow_right\x22,{Text:\x22\x22,Color:\x22#318757\x22,Family:\x22iconfont\x22}],[\x22icon-arrow_left\x22,{Text:\x22\x22,Color:\x22#318757\x22,Family:\x22iconfont\x22}]]),IChartDrawPicture.GetDrawPictureByName=function(t){for(var\x20e\x20in\x20IChartDrawPicture.ArrayDrawPricture){var\x20a=IChartDrawPicture.ArrayDrawPricture[e];if(a.Name==t)return\x20a}return\x20null},IChartDrawPicture.GetDrawPictureByClassName=function(t){for(var\x20e\x20in\x20IChartDrawPicture.ArrayDrawPricture){var\x20a=IChartDrawPicture.ArrayDrawPricture[e];if(a.ClassName==t)return\x20a}return\x20null},IChartDrawPicture.RegisterDrawPicture=function(t){if(!t.Name||!t.ClassName||!t.Create)return!1;var\x20e={Name:t.Name,ClassName:t.ClassName,Create:t.Create};return\x20IChartDrawPicture.ArrayDrawPricture.push(e),JSConsole.Chart.Log(\x22[IChartDrawPicture.RegisterDrawPicture]\x20registered\x20new\x20draw\x20picture\x20class.\x20item=\x22,e),!0},IChartDrawPicture.RegisterIonFont=function(t){if(!t.Name||!t.Text||!t.Family)return!1;var\x20e=IChartDrawPicture.MapIonFont.has(t.Name);return\x20IChartDrawPicture.MapIonFont.set(t.Name,t),JSConsole.Chart.Log(\x22[IChartDrawPicture.RegisterIonFont]\x20registered\x20new\x20icon\x20font,\x20obj=,\x20isOverwirte=\x22,t,e),!0},IChartDrawPicture.CreateChartDrawPicture=function(t){var\x20e=IChartDrawPicture.GetDrawPictureByClassName(t.ClassName);if(!e)return\x20null;var\x20a=e.Create();return\x20t.Period>=0&&(a.Period=t.Period),t.Guid&&(a.Guid=t.Guid),t.Symbol&&(a.Symbol=t.Symbol),t.Value&&(a.Value=t.Value),t.Text&&(a.Text=t.Text),t.LineColor&&(a.LineColor=t.LineColor),t.AreaColor&&(a.AreaColor=t.AreaColor),t.FontOption&&(a.FontOption=t.FontOption),t.Label&&(a.Label=t.Label),t.LineWidth>0&&(a.LineWidth=t.LineWidth),a};var\x20g_JSChartResource=new\x20JSChartResource,JSCHART_LANGUAGE_ID={LANGUAGE_CHINESE_ID:0,LANGUAGE_ENGLISH_ID:1};function\x20JSChartLocalization(){this.TextResource=new\x20Map([[\x22Tooltip-Open\x22,{CN:\x22开:\x22,EN:\x22O:\x22}],[\x22Tooltip-High\x22,{CN:\x22高:\x22,EN:\x22H:\x22}],[\x22Tooltip-Low\x22,{CN:\x22低:\x22,EN:\x22L:\x22}],[\x22Tooltip-Close\x22,{CN:\x22收:\x22,EN:\x22C:\x22}],[\x22Tooltip-Increase\x22,{CN:\x22幅:\x22,EN:\x22I:\x22}],[\x22Tooltip-Vol\x22,{CN:\x22量:\x22,EN:\x22V:\x22}],[\x22Tooltip-Amount\x22,{CN:\x22额:\x22,EN:\x22A:\x22}],[\x22Tooltip-AvPrice\x22,{CN:\x22均:\x22,EN:\x22AP:\x22}],[\x22Tooltip-Price\x22,{CN:\x22价:\x22,EN:\x22P:\x22}],[\x22Tooltip-Exchange\x22,{CN:\x22换:\x22,EN:\x22E:\x22}],[\x22Tooltip-Position\x22,{CN:\x22持:\x22,EN:\x22P:\x22}],[\x22DivTooltip-Open\x22,{CN:\x22开盘:\x22,EN:\x22Open:\x22}],[\x22DivTooltip-High\x22,{CN:\x22最高:\x22,EN:\x22High:\x22}],[\x22DivTooltip-Low\x22,{CN:\x22最低:\x22,EN:\x22Low:\x22}],[\x22DivTooltip-Close\x22,{CN:\x22收盘:\x22,EN:\x22Close:\x22}],[\x22DivTooltip-Increase\x22,{CN:\x22涨幅:\x22,EN:\x22Increase:\x22}],[\x22DivTooltip-Vol\x22,{CN:\x22数量:\x22,EN:\x22Volume:\x22}],[\x22DivTooltip-Amount\x22,{CN:\x22金额:\x22,EN:\x22Amount:\x22}],[\x22DivTooltip-Exchange\x22,{CN:\x22换手:\x22,EN:\x22Exchange:\x22}],[\x22DivTooltip-Position\x22,{CN:\x22持仓:\x22,EN:\x22Position:\x22}],[\x22KTitle-Open\x22,{CN:\x22开:\x22,EN:\x22O:\x22}],[\x22KTitle-High\x22,{CN:\x22高:\x22,EN:\x22H:\x22}],[\x22KTitle-Low\x22,{CN:\x22低:\x22,EN:\x22L:\x22}],[\x22KTitle-Close\x22,{CN:\x22收:\x22,EN:\x22C:\x22}],[\x22KTitle-Increase\x22,{CN:\x22幅:\x22,EN:\x22I:\x22}],[\x22KTitle-Vol\x22,{CN:\x22量:\x22,EN:\x22V:\x22}],[\x22KTitle-Amount\x22,{CN:\x22额:\x22,EN:\x22A:\x22}],[\x22KTitle-Exchange\x22,{CN:\x22换:\x22,EN:\x22E:\x22}],[\x22KTitle-Position\x22,{CN:\x22持:\x22,EN:\x22P:\x22}],[\x22MTitle-Close\x22,{CN:\x22价:\x22,EN:\x22C:\x22}],[\x22MTitle-AvPrice\x22,{CN:\x22均:\x22,EN:\x22AC:\x22}],[\x22MTitle-Increase\x22,{CN:\x22幅:\x22,EN:\x22I:\x22}],[\x22MTitle-Vol\x22,{CN:\x22量:\x22,EN:\x22V:\x22}],[\x22MTitle-Amount\x22,{CN:\x22额:\x22,EN:\x22A:\x22}],[\x22MTitle-Position\x22,{CN:\x22持:\x22,EN:\x22P:\x22}],[\x22日线\x22,{CN:\x22日线\x22,EN:\x221D\x22}],[\x22周线\x22,{CN:\x22周线\x22,EN:\x221W\x22}],[\x22双周\x22,{CN:\x22双周\x22,EN:\x222W\x22}],[\x22月线\x22,{CN:\x22月线\x22,EN:\x221M\x22}],[\x22年线\x22,{CN:\x22年线\x22,EN:\x221Y\x22}],[\x221分\x22,{CN:\x221分\x22,EN:\x221Min\x22}],[\x225分\x22,{CN:\x225分\x22,EN:\x225Min\x22}],[\x2215分\x22,{CN:\x2215分\x22,EN:\x2215Min\x22}],[\x2230分\x22,{CN:\x2230分\x22,EN:\x2230Min\x22}],[\x2260分\x22,{CN:\x2260分\x22,EN:\x2260Min\x22}],[\x22季线\x22,{CN:\x22季线\x22,EN:\x221Q\x22}],[\x22分笔\x22,{CN:\x22分笔\x22,EN:\x22Tick\x22}],[\x222小时\x22,{CN:\x222小时\x22,EN:\x222H\x22}],[\x224小时\x22,{CN:\x224小时\x22,EN:\x224H\x22}],[\x22不复权\x22,{CN:\x22不复权\x22,EN:\x22No\x20Right\x22}],[\x22前复权\x22,{CN:\x22前复权\x22,EN:\x22Pro\x20Right\x22}],[\x22后复权\x22,{CN:\x22后复权\x22,EN:\x22Post\x20Right\x22}],[\x22日\x22,{CN:\x22日\x22,EN:\x22Sun.\x22}],[\x22一\x22,{CN:\x22一\x22,EN:\x22Mon.\x22}],[\x22二\x22,{CN:\x22二\x22,EN:\x22Tues.\x22}],[\x22三\x22,{CN:\x22三\x22,EN:\x22Wed.\x22}],[\x22四\x22,{CN:\x22四\x22,EN:\x22Thur.\x22}],[\x22五\x22,{CN:\x22五\x22,EN:\x22Fri.\x22}],[\x22六\x22,{CN:\x22六\x22,EN:\x22Sat.\x22}],[\x221月\x22,{CN:\x221月\x22,EN:\x22Jan\x22}],[\x222月\x22,{CN:\x222月\x22,EN:\x22Feb\x22}],[\x223月\x22,{CN:\x223月\x22,EN:\x22Mar\x22}],[\x224月\x22,{CN:\x224月\x22,EN:\x22Apr\x22}],[\x225月\x22,{CN:\x225月\x22,EN:\x22May\x22}],[\x226月\x22,{CN:\x226月\x22,EN:\x22Jun\x22}],[\x227月\x22,{CN:\x227月\x22,EN:\x22Jul\x22}],[\x228月\x22,{CN:\x228月\x22,EN:\x22Aug\x22}],[\x229月\x22,{CN:\x229月\x22,EN:\x22Sept\x22}],[\x2210月\x22,{CN:\x2210月\x22,EN:\x22Oct\x22}],[\x2211月\x22,{CN:\x2211月\x22,EN:\x22Nov\x22}],[\x2212月\x22,{CN:\x2212月\x22,EN:\x22Dec\x22}],[\x22自定义分钟\x22,{CN:\x22分\x22,EN:\x22Min\x22}],[\x22自定义日线\x22,{CN:\x22日\x22,EN:\x22D\x22}],[\x22自定义秒\x22,{CN:\x22秒\x22,EN:\x22S\x22}]]),this.GetText=function(t,e){var\x20a=this.TextResource.get(t);return\x20a?lang?a[lang]:a.CN:\x22\x22},this.SetTextResource=function(t,e){this.TextResource.set(t,e)}}var\x20g_JSChartLocalization=new\x20JSChartLocalization;function\x20JSIndexMap(){}function\x20HQIndexFormula(){}function\x20KLineChartContainer(t,e){this.newMethod=JSChartContainer,this.newMethod(t,e),delete\x20this.newMethod,this.ClassName=\x22KLineChartContainer\x22,this.WindowIndex=new\x20Array,this.ColorIndex,this.TradeIndex,this.Symbol,this.Name,this.Period=0,this.IsApiPeriod=!1,this.Right=0,this.SourceData,this.MaxReqeustDataCount=3e3,this.MaxRequestMinuteDayCount=5,this.PageSize=200,this.KLineDrawType=0,this.ScriptErrorCallback,this.FlowCapitalReady=!1,this.EnableFlowCapital={},this.ChartDrawStorage=new\x20ChartDrawStorage,this.ChartDrawStorageCache=null,this.RightSpaceCount=0,this.SourceDataLimit=new\x20Map,this.CustomShow=null,this.OverlayIndexFrameWidth=60,this.ZoomType=0,this.KLineSize=null,this.Page={Day:{Enable:!1,Index:0,Finish:!1},Minute:{Enable:!1,Index:0,Finish:!1}},this.DragDownload={Day:{Enable:!1,IsEnd:!1,Status:0},Minute:{Enable:!1,IsEnd:!1,status:0}},this.IsAutoUpdate=!1,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer,this.KLineApiUrl=g_JSChartResource.Domain+\x22/API/KLine2\x22,this.MinuteKLineApiUrl=g_JSChartResource.Domain+\x22/API/KLine3\x22,this.DragMinuteKLineApiUrl=g_JSChartResource.Domain+\x22/API/KLine4\x22,this.DragKLineApiUrl=g_JSChartResource.Domain+\x22/API/KLine5\x22,this.RealtimeApiUrl=g_JSChartResource.Domain+\x22/API/Stock\x22,this.KLineMatchUrl=g_JSChartResource.Domain+\x22/API/KLineMatch\x22,this.StockHistoryDayApiUrl=g_JSChartResource.Domain+\x22/API/StockHistoryDay\x22,this.TickApiUrl=g_JSChartResource.Domain+\x22/API/StockDetail\x22,this.MinuteDialog,this.RightMenu,this.BeforeBindMainData=null,this.AfterBindMainData=null,this.ResetDragDownload=function(){this.DragDownload.Day.Status=0,this.DragDownload.Day.IsEnd=!1,this.DragDownload.Minute.Status=0,this.DragDownload.Minute.IsEnd=!1},this.ResetPage=function(){this.Page.Day.Finish=!1,this.Page.Day.Index=0,this.Page.Minute.Finish=!1,this.Page.Minute.Index=0},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,\x22KLineChartContainer::StopAutoUpdate\x22),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.SandTableOperator=function(t){switch(t.ID){case\x201:this.StopAutoUpdate(),t.Data&&this.ManualUpdateKData(t);break;case\x202:this.ManualUpdateKData(t);break;case\x203:t.IsAutoUpdate&&(this.IsAutoUpdate=t.IsAutoUpdate),this.ChangeSymbol(this.Symbol)}},this.ManualUpdateKData=function(t){var\x20e=t.Data,a=e.length,i=new\x20ChartData;i.Data=e,i.Period=this.Period,i.Right=this.Right,i.Symbol=this.Symbol,this.UpdateMainData(i,a),this.BindInstructionIndexData(i);for(var\x20r=0;r<this.Frame.SubFrame.length;++r)this.BindIndexData(r,i);if(IFrameSplitOperator.IsNumber(t.DataOffset)&&t.DataOffset>=0){var\x20n=null;(n=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data)&&(n.DataOffset=t.DataOffset)}this.UpdataDataoffset(),this.UpdatePointByCursorIndex(1),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendManualKLineUpdateEvent(i)},this.GetKDataInfo=function(){if(!this.ChartPaint[0])return\x20null;var\x20t=this.ChartPaint[0],e={};return\x20t.Data&&t.Data.Data&&(e.Data=t.Data.CloneData(\x22HistoryData\x22)),e.ShowRange=t.ShowRange,e.Period=this.Period,e.RightSpaceCount=this.RightSpaceCount,e},this.ChartOperator=function(t){var\x20e=t.ID;if(e===JSCHART_OPERATOR_ID.OP_SCROLL_LEFT||e===JSCHART_OPERATOR_ID.OP_SCROLL_RIGHT){var\x20a=e===JSCHART_OPERATOR_ID.OP_SCROLL_LEFT,i=1;t.Step>0&&(i=t.Step),this.DataMove(i*this.StepPixel,a)&&(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw())}else\x20if(e===JSCHART_OPERATOR_ID.OP_ZOOM_IN||e===JSCHART_OPERATOR_ID.OP_ZOOM_OUT){var\x20r={};if(r.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),e===JSCHART_OPERATOR_ID.OP_ZOOM_IN){if(!this.Frame.ZoomUp(r))return}else\x20if(!this.Frame.ZoomDown(r))return;this.CursorIndex=r.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw()}else\x20if(e===JSCHART_OPERATOR_ID.OP_GOTO_HOME){if(!(u=this.ChartOperator_Temp_GetHistroyData()))return;var\x20n=this.Frame.SubFrame[0].Frame.XPointCount;n-=this.RightSpaceCount;var\x20s=u.Data.length-n;u.DataOffset=s,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,JSConsole.Chart.Log(`[KLineChartContainer::ChartOperator]\x20OP_GOTO_HOME,\x20dataOffset=${u.DataOffset}\x20CursorIndex=${this.CursorIndex}\x20PageSize=${n}`),this.ChartOperator_Temp_Update()}else\x20if(e===JSCHART_OPERATOR_ID.OP_GOTO_END){if(!(u=this.ChartOperator_Temp_GetHistroyData()))return;u.DataOffset=0,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,JSConsole.Chart.Log(\x22[KLineChartContainer::ChartOperator]\x20OP_GOTO_END\x20\x22),this.ChartOperator_Temp_Update()}else\x20if(e==JSCHART_OPERATOR_ID.OP_LEFT_ZOOM_IN||e==JSCHART_OPERATOR_ID.OP_LEFT_ZOOM_OUT){if(!(u=this.ChartOperator_Temp_GetHistroyData()))return;var\x20o=u.Data.length,h=(n=this.Frame.SubFrame[0].Frame.XPointCount,u.DataOffset);if(e==JSCHART_OPERATOR_ID.OP_LEFT_ZOOM_IN){if(IFrameSplitOperator.IsNumber(t.Step)){if(n>=o)return;if((i=t.Step)>h&&(i=h),n+i>o&&(i=o-n),i<=0)return;n+=i,u.DataOffset-=i}}else\x20if(e==JSCHART_OPERATOR_ID.OP_LEFT_ZOOM_OUT){var\x20l=this.GetMaxMinPageSize().Min;if(IFrameSplitOperator.IsNumber(t.Step)){if(n<l)return;if(n-(i=t.Step)<l&&(i=n-l),i<=0)return;n-=i,u.DataOffset-=i}}for(var\x20C\x20in\x20this.Frame.SubFrame){this.Frame.SubFrame[C].Frame.XPointCount=n}u.DataOffset<0&&(u.DataOffset=0),this.ChartOperator_Temp_Update()}else\x20if(e==JSCHART_OPERATOR_ID.OP_RIGHT_ZOOM_IN||e==JSCHART_OPERATOR_ID.OP_RIGHT_ZOOM_OUT){var\x20u;if(!(u=this.ChartOperator_Temp_GetHistroyData()))return;o=u.Data.length,n=this.Frame.SubFrame[0].Frame.XPointCount,h=u.DataOffset;if(e==JSCHART_OPERATOR_ID.OP_RIGHT_ZOOM_IN){if(IFrameSplitOperator.IsNumber(t.Step)){if(n>=o)return;var\x20D=o-(h+n);if(D<=0)return;if((i=t.Step)>D&&(i=D),i<=0)return;n+=i}}else\x20if(e==JSCHART_OPERATOR_ID.OP_RIGHT_ZOOM_OUT){l=this.GetMaxMinPageSize().Min;if(IFrameSplitOperator.IsNumber(t.Step)){if(n<l)return;if((i=t.Step)>n&&(i=n),n-i<l&&(i=n-l),i<=0)return;n-=i}}for(var\x20C\x20in\x20this.Frame.SubFrame){this.Frame.SubFrame[C].Frame.XPointCount=n}u.DataOffset<0&&(u.DataOffset=0),this.ChartOperator_Temp_Update()}},this.ChartOperator_Temp_GetHistroyData=function(){return(this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data)||null},this.ChartOperator_Temp_Update=function(){this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex()},this.OnWheel=function(t){JSConsole.Chart.Log(\x22[KLineChartContainer::OnWheel]\x22,t);var\x20e,a=t.clientX-this.UIElement.getBoundingClientRect().left,i=t.clientY-this.UIElement.getBoundingClientRect().top;this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),e=this.Canvas.isPointInPath(a,i);var\x20r=t.wheelDelta;if(IFrameSplitOperator.IsObjectExist(t.wheelDelta)||(r=-.01*t.deltaY),this.SourceData&&this.SourceData.Data)if(e&&r<0)(n={ZoomType:this.ZoomType}).Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),this.Frame.ZoomDown(n)&&(this.CursorIndex=n.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw());else\x20if(e&&r>0){var\x20n;(n={ZoomType:this.ZoomType}).Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),this.Frame.ZoomUp(n)&&(JSConsole.Chart.Log(\x22[KLineChartContainer::OnWheel]\x20cursorIndex\x20\x22,n),this.CursorIndex=n.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw())}t.preventDefault?t.preventDefault():t.returnValue=!1},this.Create=function(t,e){for(var\x20a\x20in\x20this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new\x20ChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=g_DivTooltipDataForamt.Create(\x22CorssCursor_XStringFormat\x22),this.ChartCorssCursor.StringFormatX.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY=g_DivTooltipDataForamt.Create(\x22CorssCursor_YStringFormat\x22),this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY.ExtendChartPaint=this.ExtendChartPaint,this.ChartSplashPaint=new\x20ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new\x20HQTradeFrame,this.Frame.ChartBorder=new\x20ChartBorder,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var\x20i=new\x20DynamicChartTitlePainting;i.Frame=this.Frame.SubFrame[a].Frame,i.Canvas=this.Canvas,i.LanguageID=this.LanguageID,this.TitlePaint.push(i)}var\x20r=!0,n=!0;e&&(!1===e.KeyDown&&(r=!1,JSConsole.Chart.Log(\x22[KLineChartContainer::Create]\x20not\x20register\x20keydown\x20event.\x22)),!1===e.Wheel&&(n=!1,JSConsole.Chart.Log(\x22[KLineChartContainer::Create]\x20not\x20register\x20wheel\x20event.\x22))),r&&this.UIElement.addEventListener(\x22keydown\x22,t=>{this.OnKeyDown(t)},!0),n&&this.UIElement.addEventListener(\x22wheel\x22,t=>{this.OnWheel(t)},!0)},this.CreateChildWindow=function(t){for(var\x20e=0;e<t;++e){var\x20a=new\x20ChartBorder;a.UIElement=this.UIElement;var\x20i=new\x20KLineFrame;if(i.Canvas=this.Canvas,i.ChartBorder=a,i.Identify=e,i.RightSpaceCount=this.RightSpaceCount,this.ModifyIndexDialog&&(i.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(i.ChangeIndexEvent=this.ChangeIndexDialog.DoModal),i.HorizontalMax=20,i.HorizontalMin=10,0==e){i.YSplitOperator=new\x20FrameSplitKLinePriceY,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get(\x22price\x22),i.YSplitOperator.FrameSplitData2=this.FrameSplitData.get(\x22double\x22);var\x20r=GetDevicePixelRatio();a.BottomSpace=12*r,a.TopSpace=12*r}else\x20i.YSplitOperator=new\x20FrameSplitY,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get(\x22double\x22),i.YSplitOperator.LanguageID=this.LanguageID;i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=a,i.XSplitOperator=new\x20FrameSplitKLineX,i.XSplitOperator.Frame=i,i.XSplitOperator.ChartBorder=a,i.XSplitOperator.LanguageID=this.LanguageID,e!=t-1&&(i.XSplitOperator.ShowText=!1);for(var\x20n=i.HorizontalMin;n<=i.HorizontalMax;n+=1)i.HorizontalInfo[n]=new\x20CoordinateInfo,i.HorizontalInfo[n].Value=n,0==e&&n==i.HorizontalMin||(i.HorizontalInfo[n].Message[1]=n.toString(),i.HorizontalInfo[n].Font=\x2214px\x20微软雅黑\x22);var\x20s=new\x20SubFrameItem;s.Frame=i,s.Height=0==e?20:10,this.Frame.SubFrame[e]=s}},this.CreateSubFrameItem=function(t){var\x20e=new\x20ChartBorder;e.UIElement=this.UIElement;var\x20a=new\x20KLineFrame;a.Canvas=this.Canvas,a.ChartBorder=e,a.Identify=t,this.ModifyIndexDialog&&(a.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(a.ChangeIndexEvent=this.ChangeIndexDialog.DoModal),a.HorizontalMax=20,a.HorizontalMin=10,a.YSplitOperator=new\x20FrameSplitY,a.YSplitOperator.LanguageID=this.LanguageID,a.YSplitOperator.FrameSplitData=this.FrameSplitData.get(\x22double\x22),a.YSplitOperator.Frame=a,a.YSplitOperator.ChartBorder=e,a.XSplitOperator=new\x20FrameSplitKLineX,a.XSplitOperator.Frame=a,a.XSplitOperator.ChartBorder=e,a.XSplitOperator.ShowText=!1;var\x20i=this.Frame.SubFrame[0].Frame.XPointCount;a.XPointCount=i,a.Data=this.ChartPaint[0].Data;for(var\x20r=a.HorizontalMin;r<=a.HorizontalMax;r+=1)a.HorizontalInfo[r]=new\x20CoordinateInfo,a.HorizontalInfo[r].Value=r,a.HorizontalInfo[r].Message[1]=r.toString(),a.HorizontalInfo[r].Font=\x2214px\x20微软雅黑\x22;var\x20n=new\x20SubFrameItem;return\x20n.Frame=a,n.Height=10,n},this.CreateMainKLine=function(){var\x20t=new\x20ChartKLine;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name=\x22Main-KLine\x22,t.DrawType=this.KLineDrawType,this.ChartPaint[0]=t,this.TitlePaint[0]=new\x20DynamicKLineTitlePainting,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].OverlayChartPaint=this.OverlayChartPaint,this.TitlePaint[0].LanguageID=this.LanguageID},this.BindMainData=function(t,e){(window.chartdata[this.Period]&&window.chartdata[this.Period].XPointCount&&(e=window.chartdata[this.Period].XPointCount),this.ChartPaint[0].Data=t,this.ChartPaint[0].Symbol=this.Symbol,this.KLineSize)&&(null==this.KLineSize.DataWidth?e=this.Frame.SubFrame[0].Frame.XPointCount-this.RightSpaceCount:(e=this.Frame.SetDataWidth(this.KLineSize.DataWidth).XPointCount-this.RightSpaceCount,this.KLineSize.DataWidth=null));for(var\x20a\x20in\x20this.Frame.SubFrame){(i=this.Frame.SubFrame[a].Frame).XPointCount=e+this.RightSpaceCount,i.Data=this.ChartPaint[0].Data,i.XSplitOperator.Symbol=this.Symbol,i.XSplitOperator.Period=this.Period}for(var\x20a\x20in\x20this.TitlePaint[0].Data=this.ChartPaint[0].Data,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.TitlePaint[0].Period=this.Period,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data,this.Frame.Data=this.ChartPaint[0].Data,this.OverlayChartPaint){var\x20i;(i=this.OverlayChartPaint[a]).MainData=this.ChartPaint[0].Data}var\x20r=t.Data.length-e;r<0&&(r=0);var\x20n=r-(window.chartdata[this.Period]?window.chartdata[this.Period].DataOffset:r);this.ChartPaint[0].Data.DataOffset=n<0||n>3?window.chartdata[this.Period].DataOffset:r,debug&&console.log(\x22=========BindMainData\x22,this.ChartPaint[0].Data.DataOffset,e),this.ChartPaint[0].Period=this.Period,this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.CursorIndex=e,this.CursorIndex+r>=t.Data.length&&(this.CursorIndex=t.Data.length-1-r),this.CursorIndex<0&&(this.CursorIndex=0),this.CustomShow&&(this.SetCustomShow(this.CustomShow,t),this.CustomShow=null)},this.UpdateMainData=function(t,e){var\x20a=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(a=this.Frame.SubFrame[0].Frame.Data):a=this.Frame.Data,a){var\x20i=0;for(var\x20r\x20in\x20e>0&&t.Data.length>e&&(i=t.Data.length-e,JSConsole.Chart.Log(`[KLineChartContainer::UpdateMainData]\x20\x20[count=${e}->${t.Data.length}],\x20[newDataCount=${i}]`)),this.ChartPaint[0].Data=t,this.ChartPaint[0].Symbol=this.Symbol,this.ChartPaint[0].Data.DataOffset=a.DataOffset+i,this.Frame.SubFrame){(n=this.Frame.SubFrame[r].Frame).Data=this.ChartPaint[0].Data,0==r&&(n.YSplitOperator.Symbol=this.Symbol,n.YSplitOperator.Data=this.ChartPaint[0].Data,n.YSplitOperator.Period=this.Period)}for(var\x20r\x20in\x20this.TitlePaint[0].Data=this.ChartPaint[0].Data,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data,this.Frame.Data=this.ChartPaint[0].Data,this.OverlayChartPaint){var\x20n;(n=this.OverlayChartPaint[r]).MainData=this.ChartPaint[0].Data}this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol}},this.SetCustomShow=function(t,e){if(t&&t.Date&&!(t.Date<19910101)){for(var\x20a=t.Date,i=null,r=0;r<e.Data.length;++r){if(e.Data[r].Date>=a){i=r;break}}if(null!==i){var\x20n=e.Data.length-i;t.PageSize>0&&(n=t.PageSize);var\x20s=n,o=this.GetMaxMinPageSize();for(var\x20r\x20in\x20n>o.Max?s=o.Max:n<o.Min&&(s=o.Min),this.Frame.SubFrame){this.Frame.SubFrame[r].Frame.XPointCount=s}this.ChartPaint[0].Data.DataOffset=i,this.CursorIndex=0}else\x20JSConsole.Chart.Log(`[KLineChartContainer::SetCustomShow]\x20Can\x27t\x20find\x20first\x20date=${a}`)}},this.ShowSelectData=function(t){this.HideSelectRect(),this.SelectRectRightMenu&&this.SelectRectRightMenu.Hide(),JSConsole.Chart.Log(\x22[KLineChartContainer::ShowSelectData]\x20selectData\x22,t);var\x20e=t.Start,a=t.End-t.Start+1;for(var\x20i\x20in\x20JSConsole.Chart.Log(`[KLineChartContainer::ShowSelectData]\x20DataOffset=${e},\x20ShowCount=${a}`),this.Frame.SubFrame){this.Frame.SubFrame[i].Frame.XPointCount=a}this.ChartPaint[0].Data.DataOffset=e,this.CursorIndex=0,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex()},this.CreateWindowIndex=function(t){this.WindowIndex[t].Create(this,t)},this.BindIndexData=function(t,e){if(this.WindowIndex[t]){if(\x22function\x22!=typeof\x20this.WindowIndex[t].RequestData)return\x22function\x22==typeof\x20this.WindowIndex[t].ExecuteScript?(debug&&console.log(\x22xxxxxxxxxxxxxxx\x20BindIndexData\x22,this.ChartPaint.length),void\x20this.WindowIndex[t].ExecuteScript(this,t,e)):void\x20this.WindowIndex[t].BindData(this,t,e);this.WindowIndex[t].RequestData(this,t,e)}},this.BindOverlayIndexData=function(t,e,a){if(t.Script){if(\x22function\x22!=typeof\x20t.Script.RequestData)return\x22function\x22==typeof\x20t.Script.ExecuteScript?(debug&&console.log(\x22xxxxxxxxxxxxxxx\x20BindOverlayIndexData\x22,this.ChartPaint.length),void\x20t.Script.ExecuteScript(this,e,a)):void\x20t.Script.BindData(this,e,a);t.Script.RequestData(this,e,a)}},this.BindInstructionIndexData=function(t){debug&&console.log(\x22xxxxxxxxxxxxxxx\x20BindInstructionIndexData\x22,this.ChartPaint.length),this.ColorIndex&&\x22function\x22==typeof\x20this.ColorIndex.ExecuteScript&&this.ColorIndex.ExecuteScript(this,0,t),this.TradeIndex&&\x22function\x22==typeof\x20this.TradeIndex.ExecuteScript&&this.TradeIndex.ExecuteScript(this,0,t)},this.GetChartPaint=function(t){var\x20e=new\x20Array;for(var\x20a\x20in\x20this.ChartPaint)if(0!=a){var\x20i=this.ChartPaint[a];i.ChartFrame==this.Frame.SubFrame[t].Frame&&e.push(i)}return\x20e},this.AutoUpdateEvent=function(t,e){var\x20a=t?JSCHART_EVENT_ID.RECV_START_AUTOUPDATE:JSCHART_EVENT_ID.RECV_STOP_AUTOUPDATE;if(this.mapEvent.has(a)){var\x20i=this,r=this.mapEvent.get(a),n={Stock:{Symbol:this.Symbol,Name:this.Name,Right:this.Right,Period:this.Period},Explain:e};t&&(n.Callback=function(t){ChartData.IsDayPeriod(i.Period,!0)?i.RecvRealtimeData(t):ChartData.IsMinutePeriod(i.Period,!0)?i.RecvMinuteRealtimeData(t):ChartData.IsSecondPeriod(i.Period)&&i.RecvMinuteRealtimeData(t)}),r.Callback(r,n,this)}},this.SendKLineUpdateEvent=function(t){var\x20e=this.GetEventCallback(JSCHART_EVENT_ID.RECV_KLINE_UPDATE_DATA);if(e&&e.Callback){var\x20a={HistoryData:t,Stock:{Symbol:this.Symbol,Name:this.Name}};return\x20e.Callback(e,a,this),!0}return!1},this.SendManualKLineUpdateEvent=function(t){var\x20e=this.GetEventCallback(JSCHART_EVENT_ID.RECV_KLINE_MANUAL_UPDATE_DATA);if(e&&e.Callback){var\x20a={HistoryData:t,Stock:{Symbol:this.Symbol,Name:this.Name}};return\x20e.Callback(e,a,this),!0}return!1},this.RequestHistoryData=function(){this.ReqeustHistoryMinuteData(window.minutedata?suffix({data:minutedata}):null)},this.RecvHistoryData=function(t){var\x20e=KLineChartContainer.JsonDataToHistoryData(t),a=new\x20ChartData;a.Data=e,a.DataType=0,a.Symbol=t.symbol,this.SourceData=a,this.BeforeBindMainData&&this.BeforeBindMainData(\x22RecvHistoryData\x22);var\x20i,r=new\x20ChartData;if(r.Data=e,r.Right=this.Right,r.Period=this.Period,r.DataType=0,r.Symbol=t.symbol,r.Right>0&&!this.IsApiPeriod){var\x20n=r.GetRightDate(r.Right);r.Data=n}if(ChartData.IsDayPeriod(r.Period,!1)&&!this.IsApiPeriod){var\x20s=r.GetPeriodData(r.Period);r.Data=s}this.Symbol=t.symbol,this.Name=t.name,this.BindMainData(r,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData(\x22RecvHistoryData\x22),this.Frame.SetSizeChage(!0),this.BindInstructionIndexData(r);for(var\x20o=0;o<this.Frame.SubFrame.length;++o)0==o&&(i=this.Frame.SubFrame[o].Frame),this.BindIndexData(o,r);i&&i.YSplitOperator&&(i.YSplitOperator.Symbol=this.Symbol,i.YSplitOperator.Data=this.ChartPaint[0].Data,i.YSplitOperator.Period=this.Period);var\x20h=this.Page.Day;(0==h.Enable||1==h.Enable&&1==h.Finish)&&(this.ReqeustKLineInfoData(),this.RequestFlowCapitalData(),this.RequestOverlayHistoryData(),this.CreateChartDrawPictureByStorage()),h.Enable&&(h.Index=1),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.UpdatePointByCursorIndex(2),this.Draw();for(o=0;o<this.Frame.SubFrame.length;++o){var\x20l=this.Frame.SubFrame[o];for(var\x20C\x20in\x20l.OverlayIndex){var\x20u=l.OverlayIndex[C];this.BindOverlayIndexData(u,o,r)}}if(this.mapEvent.has(JSCHART_EVENT_ID.RECV_HISTROY_DATA)){var\x20D=this.mapEvent.get(JSCHART_EVENT_ID.RECV_HISTROY_DATA);t={HistoryData:r,Stock:{Symbol:this.Symbol,Name:this.Name}};D.Callback(D,t,this)}},this.RequestHistoryPageData=function(){var\x20t=this;if(this.NetworkFilter){var\x20e=this.SourceData.Data[0],a={Name:\x22KLineChartContainer::RequestHistoryPageData\x22,Explain:\x22日K数据分页\x22,Request:{Url:\x22none\x22,Type:\x22POST\x22,Data:{symbol:t.Symbol,index:t.Page.Day.Index,field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],firstDate:e.Date,first:{date:e.Date}}},Page:t.Page.Day,Self:this,PreventDefault:!1};if(this.NetworkFilter(a,function(e){t.RecvHistoryPageData(e);var\x20a=t.Page.Day;1==a.Enable&&0==a.Finish?t.RequestHistoryPageData():t.AutoUpdate()}),1==a.PreventDefault)return}setTimeout(function(){var\x20e=t.Page.Day;e.Finish=!0;var\x20a={data:[[20150218,12.54,12.5,12.74,11.95,12.27,117632441,1459671045],[20150219,12.27,12.1,12.23,11.9,12.23,95889423,1157078548],[20150220,12.23,12.17,12.17,11.9,12.05,67763439,815652761]],symbol:t.Symbol,name:t.Name};t.RecvHistoryPageData(a),1==e.Enable&&0==e.Finish?t.RequestHistoryPageData():t.AutoUpdate()},500)},this.RecvHistoryPageData=function(t){var\x20e=KLineChartContainer.JsonDataToHistoryData(t),a=this.GetHistoryDataCount();for(var\x20i\x20in\x20e){var\x20r=e[i];this.SourceData.Data.splice(i,0,r)}var\x20n=new\x20ChartData;if(n.Data=this.SourceData.Data,n.Period=this.Period,n.Right=this.Right,n.DataType=this.SourceData.DataType,n.Right>0&&n.Period<=3){var\x20s=n.GetRightDate(n.Right);n.Data=s}if(ChartData.IsDayPeriod(n.Period,!1)||ChartData.IsMinutePeriod(n.Period,!1)){var\x20o=n.GetPeriodData(n.Period);n.Data=o}this.UpdateMainData(n,a),this.BindInstructionIndexData(n);for(i=0;i<this.Frame.SubFrame.length;++i)this.BindIndexData(i,n);var\x20h=this.Page.Day;++h.Index,1==h.Enable&&1==h.Finish&&(this.RequestFlowCapitalData(),this.RequestOverlayHistoryData(),this.CreateChartDrawPictureByStorage()),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()},this.ReqeustHistoryMinuteData=function(t){if(void\x200===window.ReqeustHistoryMinuteData_obj&&(window.ReqeustHistoryMinuteData_obj=this,debug&&console.log(\x22ReqeustHistoryMinuteData_obj\x22,this)),t){this.ChartSplashPaint.EnableSplash(!0),this.FlowCapitalReady=!1,this.ResetPage(),this.ResetDragDownload(),console.log(\x22------------------------------------KLineChartContainer::ReqeustHistoryMinuteData----------1分钟K线数据\x22),this.ChartSplashPaint.EnableSplash(!1),this.RecvMinuteHistoryData(t);var\x20e=this.Page.Minute;1==e.Enable&&0==e.Finish?this.ReqeustHistoryMinutePageData():(this.AutoUpdateEvent(!0,\x22KLineChartContainer::ReqeustHistoryMinuteData\x22),this.AutoUpdate())}},this.RecvMinuteHistoryData=function(t){if(1!=this.IsOnTouch){var\x20e=KLineChartContainer.JsonDataToMinuteHistoryData(t),a=this.SourceData;this.SourceData||(a=new\x20ChartData),a.Data=e,a.DataType=1,a.Symbol=t.symbol,this.SourceData=a,this.BeforeBindMainData&&this.BeforeBindMainData(\x22RecvMinuteHistoryData\x22);var\x20i,r=this.ChartPaint[0].Data;if(this.ChartPaint[0].Data||(r=new\x20ChartData),r.Data=e,r.Right=this.Right,r.Period=this.Period,r.DataType=1,r.Symbol=t.symbol,debug&&console.log(\x22bindData\x20period\x22,this.Period,this),ChartData.IsMinutePeriod(r.Period,!1)&&!this.IsApiPeriod){var\x20n=a.GetPeriodData(r.Period);r.Data=n}this.Symbol=t.symbol,this.Name=t.name,this.BindMainData(r,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData(\x22RecvMinuteHistoryData\x22),this.Frame.SetSizeChage(!0),this.BindInstructionIndexData(r);for(var\x20s=0;s<this.Frame.SubFrame.length;++s)0==s&&(i=this.Frame.SubFrame[s].Frame),this.BindIndexData(s,r);for(var\x20s\x20in\x20i&&i.YSplitOperator&&(i.YSplitOperator.Symbol=this.Symbol,i.YSplitOperator.Data=this.ChartPaint[0].Data,i.YSplitOperator.Period=this.Period),this.OverlayChartPaint){(h=this.OverlayChartPaint[s]).Data=null}var\x20o=this.Page.Minute;(0==o.Enable||1==o.Enable&&1==o.Finish)&&(this.RequestFlowCapitalData(),this.RequestOverlayHistoryMinuteData(),this.CreateChartDrawPictureByStorage()),o.Enable&&++o.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(2),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw();for(s=0;s<this.Frame.SubFrame.length;++s){var\x20h=this.Frame.SubFrame[s];for(var\x20l\x20in\x20h.OverlayIndex){var\x20C=h.OverlayIndex[l];this.BindOverlayIndexData(C,s,r)}}if(this.mapEvent.has(JSCHART_EVENT_ID.RECV_HISTROY_DATA)){var\x20u=this.mapEvent.get(JSCHART_EVENT_ID.RECV_HISTROY_DATA);t={HistoryData:r,Stock:{Symbol:this.Symbol,Name:this.Name}};u.Callback(u,t,this)}}},this.ReqeustHistoryMinutePageData=function(){var\x20t=this;if(this.NetworkFilter){var\x20e=this.SourceData.Data[0],a={Name:\x22KLineChartContainer::RecvHistoryMinutePageData\x22,Explain:\x221分钟K线数据分页\x22,Request:{Url:\x22none\x22,Type:\x22POST\x22,Data:{symbol:t.Symbol,index:t.Page.Minute.Index,field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],firstDate:e.Date,first:{date:e.Date,time:e.Time}}},Page:t.Page.Minute,Self:this,PreventDefault:!1};if(this.NetworkFilter(a,function(e){t.RecvHistoryMinutePageData(e);var\x20a=t.Page.Minute;1==a.Enable&&0==a.Finish?t.ReqeustHistoryMinutePageData():t.AutoUpdate()}),1==a.PreventDefault)return}setTimeout(function(){var\x20e=t.Page.Minute;e.Finish=!0;t.RecvHistoryMinutePageData({data:[[20190906,14.58,14.71,14.71,14.71,14.71,1096425,16128411,925],[20190906,14.71,14.73,14.74,14.71,14.71,2154859,31731820,930],[20190906,14.71,14.71,14.71,14.68,14.69,1427516,20989208,931],[20190906,14.69,14.69,14.71,14.68,14.7,1680503,24694143,932],[20190906,14.7,14.69,14.7,14.65,14.65,1315900,19310964,933],[20190906,14.65,14.66,14.69,14.65,14.68,702955,10313842,934],[20190906,14.68,14.7,14.71,14.67,14.67,1735266,25495875,935],[20190906,14.67,14.68,14.7,14.67,14.67,739e3,10845398,936],[20190906,14.67,14.67,14.68,14.67,14.68,389800,5721266,937],[20190906,14.68,14.68,14.7,14.68,14.69,648477,9527859,938],[20190906,14.69,14.7,14.71,14.69,14.7,1128400,16589794,939],[20190906,14.7,14.7,14.71,14.69,14.71,714858,10509708,940],[20190906,14.71,14.71,14.71,14.69,14.69,401500,5900477,941],[20190906,14.69,14.69,14.71,14.69,14.69,1165684,17131034,942],[20190906,14.69,14.69,14.7,14.67,14.67,498516,7321024,943],[20190906,14.67,14.68,14.68,14.67,14.67,350126,5139012,944],[20190906,14.67,14.67,14.69,14.67,14.69,561600,8246789,945]]}),1==e.Enable&&0==e.Finish?t.ReqeustHistoryMinutePageData():t.AutoUpdate()},500)},this.RecvHistoryMinutePageData=function(t){var\x20e=KLineChartContainer.JsonDataToMinuteHistoryData(t),a=this.GetHistoryDataCount();for(var\x20i\x20in\x20e){var\x20r=e[i];this.SourceData.Data.splice(i,0,r)}var\x20n=new\x20ChartData;if(n.Data=this.SourceData.Data,n.Period=this.Period,n.Right=this.Right,n.DataType=this.SourceData.DataType,n.Right>0&&ChartData.IsDayPeriod(n.Period,!1)){var\x20s=n.GetRightDate(n.Right);n.Data=s}if(ChartData.IsDayPeriod(n.Period,!1)||ChartData.IsMinutePeriod(n.Period,!1)){var\x20o=n.GetPeriodData(n.Period);n.Data=o}this.UpdateMainData(n,a),this.BindInstructionIndexData(n);for(i=0;i<this.Frame.SubFrame.length;++i)this.BindIndexData(i,n);var\x20h=this.Page.Minute;(0==h.Enable||1==h.Enable&&1==h.Finish)&&(this.RequestFlowCapitalData(),this.CreateChartDrawPictureByStorage()),h.Enable&&++h.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()},this.RequestRealtimeData=function(){var\x20t=this,e=[t.Symbol];for(var\x20a\x20in\x20this.OverlayChartPaint){var\x20i=this.OverlayChartPaint[a];i.Symbol&&(i.MainData&&i.Status==OVERLAY_STATUS_ID.STATUS_FINISHED_ID&&e.push(i.Symbol))}if(this.NetworkFilter){var\x20r={Name:\x22KLineChartContainer::RequestRealtimeData\x22,Explain:\x22当天最新日线数据\x22,Request:{Url:t.RealtimeApiUrl,Data:{symbol:e,field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22,\x22amount\x22,\x22date\x22,\x22time\x22]},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,function(e){t.RecvRealtimeData(e),t.AutoUpdate()}),1==r.PreventDefault)return}JSNetwork.HttpRequest({url:this.RealtimeApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22,\x22amount\x22,\x22date\x22,\x22time\x22],symbol:e,start:-1},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){t.RecvRealtimeData(e),t.AutoUpdate()}})},this.RecvRealtimeData=function(t){},this.UpdateOverlayRealtimeData=function(t){for(var\x20e\x20in\x20this.OverlayChartPaint){var\x20a=this.OverlayChartPaint[e];if(a.Symbol&&(a.MainData&&a.Status==OVERLAY_STATUS_ID.STATUS_FINISHED_ID)){var\x20i=KLineChartContainer.JsonDataToRealtimeData(t,a.Symbol);if(i){var\x20r=a.SourceData,n=r.Data[r.Data.length-1];if(n.Date==i.Date)JSConsole.Chart.Log(\x22[KLineChartContainer::UpdateOverlayRealtimeData]\x20update\x20kline\x20by\x20minute\x20data\x22,i),n.Close=i.Close,n.High=i.High,n.Low=i.Low,n.Vol=i.Vol,n.Amount=i.Amount;else{if(!(a.Date<i.Date))continue;JSConsole.Chart.Log(\x22[KLineChartContainer::UpdateOverlayRealtimeData]\x20insert\x20kline\x20by\x20minute\x20data\x22,i);var\x20s=new\x20HistoryData;s.YClose=i.YClose,s.Open=i.Open,s.Close=i.Close,s.High=i.High,s.Low=i.Low,s.Vol=i.Vol,s.Amount=i.Amount,s.Date=i.Date,r.Data.push(s)}var\x20o=new\x20ChartData;if(o.Data=r.Data,o.Period=this.Period,o.Right=this.Right,o.DataType=0,o.Right>0&&MARKET_SUFFIX_NAME.IsSHSZStockA(t.symbol)&&!this.IsApiPeriod){var\x20h=o.GetRightDate(o.Right);o.Data=h}var\x20l=this.SourceData.GetOverlayData(o.Data,this.IsApiPeriod);if(o.Data=l,ChartData.IsDayPeriod(o.Period,!1)&&!this.IsApiPeriod){var\x20C=o.GetPeriodData(o.Period);o.Data=C}a.Data=o}}}},this.RequestMinuteRealtimeData=function(){var\x20t=this,e=[t.Symbol];for(var\x20a\x20in\x20this.OverlayChartPaint){var\x20i=this.OverlayChartPaint[a];i.Symbol&&(i.MainData&&i.Status==OVERLAY_STATUS_ID.STATUS_FINISHED_ID&&e.push(i.Symbol))}if(this.NetworkFilter){var\x20r={Name:\x22KLineChartContainer::RequestMinuteRealtimeData\x22,Explain:\x22当天1分钟K线数据\x22,Request:{Url:t.RealtimeApiUrl,Data:{symbol:e,field:[\x22name\x22,\x22symbol\x22,\x22price\x22,\x22yclose\x22,\x22minutecount\x22,\x22minute\x22,\x22date\x22,\x22time\x22]},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,function(e){t.RecvMinuteRealtimeData(e),t.AutoUpdate()}),1==r.PreventDefault)return}JSNetwork.HttpRequest({url:this.RealtimeApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22price\x22,\x22yclose\x22,\x22minutecount\x22,\x22minute\x22,\x22date\x22,\x22time\x22],symbol:e,start:-1},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){t.RecvMinuteRealtimeData(e),t.AutoUpdate()}})},this.SetSourceDatatLimit=function(t){for(var\x20e\x20in\x20this.SourceDataLimit=new\x20Map,t){var\x20a=t[e];this.SourceDataLimit.set(a.Period,a.MaxCount),JSConsole.Chart.Log(`[KLineChartContainer::SetSourceDatatLimit]\x20Period=${a.Period},\x20MaxCount=${a.MaxCount}`)}},this.ReduceSourceData=function(){if(this.SourceDataLimit&&this.SourceDataLimit.has(this.Period)){var\x20t=this.SourceDataLimit.get(this.Period),e=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(e=this.Frame.SubFrame[0].Frame.Data):e=this.Frame.Data,e&&!(t<50)){for(var\x20a=e.DataOffset,i=0;this.SourceData.Data.length>t;)this.SourceData.Data.shift(),--a,++i;i>0&&(a<0&&(a=0),e.DataOffset=a,JSConsole.Chart.Log(`[KLineChartContainer::ReduceSourceData]\x20remove\x20data\x20${i},\x20dataOffset=${a}`))}}},this.RecvMinuteRealtimeDataV2=function(t){if(1!=this.IsOnTouch){var\x20e=KLineChartContainer.JsonDataToMinuteHistoryData(t);if(e&&!(e.length<=0)){this.IsApiPeriod&&this.ReduceSourceData();var\x20a=this.GetHistoryDataCount();if(this.SourceData&&this.SourceData.MergeMinuteData(e)){JSConsole.Chart.Log(`[KLineChartContainer::RecvMinuteRealtimeDataV2]\x20update\x20kline\x20by\x201\x20minute\x20data\x20[${a}->${this.SourceData.Data.length}]`);var\x20i=new\x20ChartData;if(i.Data=this.SourceData.Data,i.Period=this.Period,i.Right=this.Right,i.DataType=this.SourceData.DataType,i.Symbol=this.Symbol,i.Right>0&&ChartData.IsDayPeriod(i.Period,!0)&&!this.IsApiPeriod){var\x20r=i.GetRightDate(i.Right);i.Data=r}if((ChartData.IsDayPeriod(i.Period,!1)||ChartData.IsMinutePeriod(i.Period,!1))&&!this.IsApiPeriod){var\x20n=i.GetPeriodData(i.Period);i.Data=n}this.UpdateMainData(i,a),this.BindInstructionIndexData(i);for(var\x20s=0;s<this.Frame.SubFrame.length;++s)this.BindIndexData(s,i);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(1),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(i)}}}},this.RecvMinuteRealtimeData=function(t){if(1!=this.IsOnTouch)if(2!=t.ver){var\x20e=KLineChartContainer.JsonDataToMinuteRealtimeData(t,this.Symbol);if(e){this.IsApiPeriod&&this.ReduceSourceData();var\x20a=this.GetHistoryDataCount(),i=this.SourceData.Data.length;if(this.SourceData.MergeMinuteData(e)){JSConsole.Chart.Log(`[KLineChartContainer::RecvMinuteRealtimeData]\x20update\x20kline\x20by\x201\x20minute\x20data\x20[${i}->${this.SourceData.Data.length}]`);var\x20r=new\x20ChartData;if(r.Data=this.SourceData.Data,r.Period=this.Period,r.Right=this.Right,r.DataType=this.SourceData.DataType,r.Symbol=this.Symbol,r.Right>0&&ChartData.IsDayPeriod(r.Period,!0)&&!this.IsApiPeriod){var\x20n=r.GetRightDate(r.Right);r.Data=n}if((ChartData.IsDayPeriod(r.Period,!1)||ChartData.IsMinutePeriod(r.Period,!1))&&!this.IsApiPeriod){var\x20s=r.GetPeriodData(r.Period);r.Data=s}this.UpdateMainData(r,a),this.UpdateOverlayMinuteRealtimeData(t),this.BindInstructionIndexData(r);for(var\x20o=0;o<this.Frame.SubFrame.length;++o)this.BindIndexData(o,r);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(1),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(r)}}}else\x20this.RecvMinuteRealtimeDataV2(t)},this.UpdateOverlayMinuteRealtimeData=function(t){for(var\x20e\x20in\x20this.OverlayChartPaint){var\x20a=this.OverlayChartPaint[e];if(a.Symbol&&(a.MainData&&a.Status==OVERLAY_STATUS_ID.STATUS_FINISHED_ID)){var\x20i=KLineChartContainer.JsonDataToMinuteRealtimeData(t,a.Symbol);if(i){var\x20r=a.SourceData;if(!r.MergeMinuteData(i))return;var\x20n=new\x20ChartData;n.Data=r.Data,n.Period=this.Period,n.Right=this.Right,n.DataType=0;var\x20s=this.SourceData.GetOverlayMinuteData(n.Data,this.IsApiPeriod);if(n.Data=s,ChartData.IsMinutePeriod(n.Period,!1)&&!this.IsApiPeriod){var\x20o=n.GetPeriodData(n.Period);n.Data=o}a.Data=n}}}},this.GetHistoryDataCount=function(){var\x20t=null;return\x20this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(t=this.Frame.SubFrame[0].Frame.Data):t=this.Frame.Data,t?t.Data.length:-1},this.GetRequestDataCount=function(){var\x20t={MaxRequestDataCount:this.MaxReqeustDataCount,MaxRequestMinuteDayCount:this.MaxRequestMinuteDayCount};if(!this.SourceData||!this.SourceData.Data||this.SourceData.Data.length<=0)return\x20t;if(ChartData.IsDayPeriod(this.Period,!0))(a=this.SourceData.Data.length)>t.MaxRequestDataCount&&(t.MaxRequestDataCount=a);else\x20if(ChartData.IsMinutePeriod(this.Period,!0)){var\x20e,a=0;for(var\x20i\x20in\x20this.SourceData.Data){var\x20r=this.SourceData.Data[i];r.Date!=e&&++a,e=r.Date}a>t.MaxRequestMinuteDayCount&&(t.MaxRequestMinuteDayCount=a)}return\x20t},this.RequestTickData=function(){var\x20t=this;t.ChartSplashPaint.EnableSplash(!0),t.Draw();var\x20e=g_JSChartResource.CacheDomain+\x22/cache/dealday/today/\x22+t.Symbol+\x22.json\x22;if(this.NetworkFilter){var\x20a={Name:\x22KLineChartContainer::RequestTickData\x22,Explain:\x22当天分笔数据\x22,Request:{Url:e,Data:{symbol:t.Symbol},Type:\x22GET\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvTickData(e),t.AutoUpdate()}),1==a.PreventDefault)return}JSNetwork.HttpRequest({url:e,data:{symbol:t.Symbol},type:\x22get\x22,dataType:\x22json\x22,async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvTickData(e),t.AutoUpdate(1)},error:function(e,a){t.ChartSplashPaint.EnableSplash(!1),t.AutoUpdate()}})},this.RecvTickData=function(t){var\x20e=KLineChartContainer.JsonDataToTickData(t),a=new\x20ChartData;a.Data=e,a.DataType=2,this.SourceData=a,this.BeforeBindMainData&&this.BeforeBindMainData(\x22RecvTickData\x22);var\x20i,r=new\x20ChartData;r.Data=e,r.Right=this.Right,r.Period=this.Period,r.DataType=2,this.Symbol=t.symbol,this.Name=t.name,this.BindMainData(r,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData(\x22RecvTickData\x22),this.BindInstructionIndexData(r);for(var\x20n=0;n<this.Frame.SubFrame.length;++n)0==n&&(i=this.Frame.SubFrame[n].Frame),this.BindIndexData(n,r);if(i&&i.YSplitOperator&&(i.YSplitOperator.Symbol=this.Symbol,i.YSplitOperator.Data=this.ChartPaint[0].Data,i.YSplitOperator.Period=this.Period,i.YSplitOperator.KLineChart=this.ChartPaint[0]),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex(),this.mapEvent.has(JSCHART_EVENT_ID.RECV_HISTROY_DATA)){var\x20s=this.mapEvent.get(JSCHART_EVENT_ID.RECV_HISTROY_DATA);t={HistoryData:r,Stock:{Symbol:this.Symbol,Name:this.Name}};s.Callback(s,t,this)}},this.RequestTickRealtimeData=function(){var\x20t=this,e=0;if(this.SourceData&&this.SourceData.Data&&(e=this.SourceData.Data.length),this.NetworkFilter){var\x20a={Name:\x22KLineChartContainer::RequestTickRealtimeData\x22,Explain:\x22当天最新分笔数据\x22,Request:{Url:t.TickApiUrl,Data:{symbol:t.Symbol,start:e,end:e+1e3},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvTickData(e),t.AutoUpdate()}),1==a.PreventDefault)return}JSNetwork.HttpRequest({url:t.TickApiUrl,data:{symbol:t.Symbol,start:e-10,end:e+1e3},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvTickRealtimeData(e),t.AutoUpdate()}})},this.RecvTickRealtimeData=function(t){var\x20e=KLineChartContainer.JsonDataToTickData(t);if(e&&!(e.length<=0)){var\x20a=this.SourceData.Data,i=this.SourceData.Data.length,r=0;a.length>0&&(r=a[a.length-1].Time);var\x20n=0;for(var\x20s\x20in\x20e){var\x20o=e[s];o.Time<=r||(a.push(o),++n)}if(!(n<=0)){var\x20h=new\x20ChartData;h.Data=a,h.Right=this.Right,h.Period=this.Period,h.DataType=2,this.Symbol=t.symbol,this.Name=t.name,this.UpdateMainData(h,i),this.BindInstructionIndexData(h);for(s=0;s<this.Frame.SubFrame.length;++s)this.BindIndexData(s,h);this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex()}}},this.ChangePeriod=function(t,e){var\x20a=!1,i=!1,r=null;if(e&&(e.KLine&&(IFrameSplitOperator.IsNumber(e.KLine.DrawType)&&(a=!0),IFrameSplitOperator.IsNumber(e.KLine.Right)&&(r=e.KLine.Right)),1==e.Reload&&(i=!0)),this.Period!=t||0!=i){a&&this.ChangeKLineDrawType(e.KLine.DrawType,!1);var\x20n=!1;if(t>CUSTOM_DAY_PERIOD_START&&t<=CUSTOM_DAY_PERIOD_END)0!=this.SourceData.DataType&&(n=!0);else\x20if(t>CUSTOM_MINUTE_PERIOD_START&&t<=CUSTOM_MINUTE_PERIOD_END||t>CUSTOM_SECOND_PERIOD_START&&t<=CUSTOM_SECOND_PERIOD_END)1!=this.SourceData.DataType&&(n=!0);else\x20switch(t){case\x200:case\x201:case\x202:case\x203:case\x209:case\x2021:0!=this.SourceData.DataType&&(n=!0);break;case\x204:case\x205:case\x206:case\x207:case\x208:case\x2011:case\x2012:1!=this.SourceData.DataType&&(n=!0);break;case\x2010:2!=this.SourceData.DataType&&(n=!0)}this.Period=t,null!=r&&(this.Right=r),this.ReloadChartDrawPicture(),0!=n||this.IsApiPeriod?ChartData.IsDayPeriod(this.Period,!0)?(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,\x22KLineChartContainer::ChangePeriod\x22),this.ResetOverlaySymbolStatus(),this.RequestHistoryData()):ChartData.IsMinutePeriod(this.Period,!0)||ChartData.IsSecondPeriod(this.Period)?(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,\x22KLineChartContainer::ChangePeriod\x22),this.ResetOverlaySymbolStatus(),this.ReqeustHistoryMinuteData()):ChartData.IsTickPeriod(this.Period)&&(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,\x22KLineChartContainer::ChangePeriod\x22),this.RequestTickData()):this.Update({UpdateCursorIndexType:2})}else\x20a&&this.ChangeKLineDrawType(e.KLine.DrawType)},this.ChangeRight=function(t){if(MARKET_SUFFIX_NAME.IsSHSZStockA(this.Symbol)&&!ChartData.IsTickPeriod(this.Period)){var\x20e=this.Symbol.toUpperCase();MARKET_SUFFIX_NAME.IsBIT(e)||t<0||t>2||this.Right!=t&&(this.Right=t,this.IsApiPeriod?ChartData.IsDayPeriod(this.Period,!0)?(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,\x22KLineChartContainer::ChangeRight\x22),this.ResetOverlaySymbolStatus(),this.RequestHistoryData()):(ChartData.IsMinutePeriod(this.Period,!0)||ChartData.IsSecondPeriod(this.Period))&&(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,\x22KLineChartContainer::ChangeRight\x22),this.ResetOverlaySymbolStatus(),this.ReqeustHistoryMinuteData()):this.Update())}},this.SetFirstShowDate=function(t){if(t&&t.Date){JSConsole.Chart.Log(\x22[KLineChartContainer::SetFirstShowDate]\x20obj=\x22,t);var\x20e=null;if(e=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data){var\x20a=null;if(ChartData.IsDayPeriod(this.Period,!0))for(var\x20i=0;i<e.Data.length;++i){if((s=e.Data[i]).Date>=t.Date){a=i;break}}else\x20if(ChartData.IsMinutePeriod(this.Period,!0)){let\x20r=t.Time;if(IFrameSplitOperator.IsPlusNumber(r))for(i=0;i<e.Data.length;++i){if((s=e.Data[i]).Date>t.Date||s.Date==t.Date&&s.Time>=r){a=i;break}}else\x20for(i=0;i<e.Data.length;++i){if((s=e.Data[i]).Date>=t.Date){a=i;break}}}if(null!==a){var\x20r=e.Data.length-a;t.PageSize>0&&(r=t.PageSize);var\x20n=this.GetMaxMinPageSize();for(var\x20i\x20in\x20n.Max<r?r=n.Max:n.Min>r&&(r=n.Min),this.Frame.SubFrame){var\x20s;(s=this.Frame.SubFrame[i].Frame).XPointCount=r}e.DataOffset=a,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,JSConsole.Chart.Log(`[KLineChartContainer::SetFirstShowDate]\x20dataOffset=${e.DataOffset}\x20CursorIndex=${this.CursorIndex}\x20PageSize=${r}`),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.UpdatePointByCursorIndex(2),this.Draw()}else\x20JSConsole.Chart.Log(`[KLineChartContainer::SetFirstShowDate]\x20an\x27t\x20find\x20first\x20date=${t.Date}\x20time=${t.Time}`,t)}}},this.DeleteIndexPaint=function(t){let\x20e=new\x20Array;for(var\x20a\x20in\x20this.OldPaint||(this.OldPaint=[]),this.ChartPaint){let\x20n=this.ChartPaint[a];if(0==a||n.ChartFrame!=this.Frame.SubFrame[t].Frame)e.push(n);else{for(var\x20i=!1,r=0;r<this.OldPaint.length;r++)this.OldPaint[r].Name==n.Name&&(i=!0);i||(this.OldPaint.push(n),debug&&console.log(\x22>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>OldPaint\x22,this.OldPaint))}}this.Frame.SubFrame[t].Frame.YSpecificMaxMin=null,this.Frame.SubFrame[t].Frame.IsLocked=!1,this.Frame.SubFrame[t].Frame.YSplitScale=null,this.ChartPaint=e;var\x20n=t+1;this.TitlePaint[n].Data=[],this.TitlePaint[n].Title=null},this.ShowKLine=function(t){this.ChartPaint.length<=0||!this.ChartPaint[0]||(this.ChartPaint[0].IsShow=t)},this.SetInstructionData=function(t,e){if(!(this.ChartPaint.length<=0)&&this.ChartPaint[0]){var\x20a=this.TitlePaint[1];2==t?(this.ChartPaint[0].ColorData=e.Data,a&&(a.ColorIndex={Name:e.Name,Param:e.Param})):1==t&&(this.ChartPaint[0].TradeData={Sell:e.Sell,Buy:e.Buy,Name:e.Name,Param:e.Param},a&&(a.TradeIndex={Name:e.Name,Param:e.Param}))}},this.ChangeInstructionIndex=function(t){let\x20e=(new\x20JSIndexScript).Get(t);e&&(1!=e.InstructionType&&2!=e.InstructionType||(e.ID=t,this.ChangeInstructionScriptIndex(e)))},this.ChangeInstructionScriptIndex=function(t){if(1==t.InstructionType)this.TradeIndex=new\x20ScriptIndex(t.Name,t.Script,t.Args,t);else{if(2!=t.InstructionType)return;this.ColorIndex=new\x20ScriptIndex(t.Name,t.Script,t.Args,t)}var\x20e=this.ChartPaint[0].Data;this.BindInstructionIndexData(e),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.CancelInstructionIndex=function(){if(!(this.ChartPaint.length<=0)&&this.ChartPaint[0]){this.ColorIndex=null,this.TradeIndex=null,this.ChartPaint[0].ColorData=null,this.ChartPaint[0].TradeData=null;var\x20t=this.TitlePaint[1];t&&(t.TradeIndex=null,t.ColorIndex=null),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.SetFrameToolbar=function(t,e){if(e&&this.Frame.SubFrame[t]&&this.Frame.SubFrame[t].Frame){var\x20a=this.Frame.SubFrame[t].Frame,i=!1;IFrameSplitOperator.IsBool(e.Modify)&&(a.ModifyIndex=e.Modify,i=!0),IFrameSplitOperator.IsBool(e.Change)&&(a.ChangeIndex=e.Change,i=!0),IFrameSplitOperator.IsBool(e.Close)&&(a.CloseIndex=e.Close,i=!0),IFrameSplitOperator.IsBool(e.Overlay)&&(a.OverlayIndex=e.Overlay,i=!0),i&&(a.SizeChange=!0,a.ToolbarRect=null,a.DrawToolbar())}},this.ChangeScriptIndex=function(t,e,a){this.DeleteIndexPaint(t),this.WindowIndex[t]=new\x20ScriptIndex(e.Name,e.Script,e.Args,e),a&&a.Window&&this.SetFrameToolbar(t,a.Window);var\x20i=this.ChartPaint[0].Data;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeAPIIndex=function(t,e){this.DeleteIndexPaint(t);var\x20a=e.API;this.WindowIndex[t]=new\x20APIScriptIndex(a.Name,a.Script,a.Args,e),e&&e.Window&&this.SetFrameToolbar(t,e.Window);var\x20i=this.ChartPaint[0].Data;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeIndex=function(t,e,a){if(a&&a.API)return\x20this.ChangeAPIIndex(t,a);var\x20i=JSIndexMap.Get(e);if(!i){let\x20i=(new\x20JSIndexScript).Get(e);if(!i)return;i.IsMainIndex?t=0:0==t&&(t=1);let\x20r=i;return\x20a&&(a.FloatPrecision>=0&&(r.FloatPrecision=a.FloatPrecision),a.StringFormat>0&&(r.StringFormat=a.StringFormat),a.Args&&(r.Args=a.Args),a.TitleFont&&(r.TitleFont=a.TitleFont),a.IsShortTitle&&(r.IsShortTitle=a.IsShortTitle)),this.ChangeScriptIndex(t,r,a)}i.IsMainIndex?t>0&&(t=0):0==t&&(t=1);var\x20r=new\x20Array;for(var\x20n\x20in\x20this.ChartPaint){var\x20s=this.ChartPaint[n];0!=n&&s.ChartFrame==this.Frame.SubFrame[t].Frame||r.push(s)}this.Frame.SubFrame[t].Frame.YSpecificMaxMin=null,this.Frame.SubFrame[t].Frame.IsLocked=!1,this.Frame.SubFrame[t].Frame.YSplitScale=null,this.ChartPaint=r;var\x20o=t+1;this.TitlePaint[o].Data=[],this.TitlePaint[o].Title=null,this.WindowIndex[t]=i.Create(),this.CreateWindowIndex(t);var\x20h=this.ChartPaint[0].Data;this.BindIndexData(t,h),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangePyScriptIndex=function(t,e){this.DeleteIndexPaint(t),this.WindowIndex[t]=new\x20PyScriptIndex(e.Name,e.Script,e.Args,e);var\x20a=this.ChartPaint[0].Data;this.BindIndexData(t,a),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.AddOverlayIndex=function(t){var\x20e=this.CreateOverlayWindowsIndex(t);if(e){var\x20a=this.ChartPaint[0].Data;this.BindOverlayIndexData(e,t.WindowIndex,a),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.CreateOverlayWindowsIndex=function(t){let\x20e=t.IndexName,a=t.WindowIndex;var\x20i=null,r=null,n=null;if(t.API)i=t.API;else\x20if(t.Script)r={Script:t.Script,ID:t.indexName,Name:t.indexName},t.Name&&(r.Name=t.Name);else{if(!(r=(new\x20JSIndexScript).Get(e))&&!(n=JSIndexMap.Get(e)))return\x20console.warn(`[KLineChartContainer::CreateOverlayIndex]\x20can\x20not\x20find\x20index[${e}]`),null}var\x20s=this.Frame.SubFrame[a];s.Interval=this.OverlayIndexFrameWidth;var\x20o=new\x20OverlayIndexItem;t.Identify&&(o.Identify=t.Identify);var\x20h=\x22KLineChartHScreenContainer\x22===this.ClassName?new\x20OverlayKLineHScreenFrame:new\x20OverlayKLineFrame;if(h.Canvas=this.Canvas,h.MainFrame=s.Frame,h.ChartBorder=s.Frame.ChartBorder,!0===t.ShowRightText?h.IsShow=!0:!1===t.ShowRightText&&(h.IsShow=!1),h.YSplitOperator=new\x20FrameSplitY,h.YSplitOperator.LanguageID=this.LanguageID,h.YSplitOperator.FrameSplitData=this.FrameSplitData.get(\x22double\x22),h.YSplitOperator.Frame=h,h.YSplitOperator.ChartBorder=h.ChartBorder,h.YSplitOperator.SplitCount=s.Frame.YSplitOperator.SplitCount,o.Frame=h,i){var\x20l=new\x20APIScriptIndex(i.Name,i.Script,i.Args,t,!0);l.OverlayIndex={IsOverlay:!0,Identify:o.Identify,WindowIndex:a,Frame:o},o.Script=l}else\x20if(r){let\x20e=r;t.Args&&(e.Args=t.Args),(C=new\x20OverlayScriptIndex(e.Name,e.Script,e.Args,e)).OverlayIndex={IsOverlay:!0,Identify:o.Identify,WindowIndex:a,Frame:o},o.Script=C}else{var\x20C;(C=n.Create()).OverlayIndex={IsOverlay:!0,Identify:o.Identify,WindowIndex:a,Frame:o},C.Create(this,a),o.Script=C}return\x20s.OverlayIndex.push(o),o},this.DeleteOverlayWindowsIndex=function(t){var\x20e=null;for(var\x20a\x20in\x20this.Frame.SubFrame){var\x20i=this.Frame.SubFrame[a];for(var\x20r\x20in\x20i.OverlayIndex){if(i.OverlayIndex[r].Identify===t){i.OverlayIndex.splice(r,1),e=parseInt(a);break}}}if(null!=e){var\x20n=e+1,s=this.TitlePaint[n];s.OverlayIndex.has(t)&&s.OverlayIndex.delete(t),this.Draw()}else\x20console.warn(`[KLineChartContainer::DeleteOverlayWindowsIndex]\x20can\x27t\x20find\x20overlay\x20index.\x20[identify=${t}]`)},this.ChangeKLineDrawType=function(t,e){if(this.KLineDrawType!=t){for(var\x20a\x20in\x20this.KLineDrawType=t,this.ChartPaint){var\x20i=this.ChartPaint[a];0==a?i.DrawType=this.KLineDrawType:\x22ChartVolStick\x22==i.ClassName&&(i.KLineDrawType=this.KLineDrawType)}for(var\x20a\x20in\x20this.OverlayChartPaint){(i=this.OverlayChartPaint[a]).DrawType=this.KLineDrawType}0!=e&&(this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw())}},this.ChangeCoordinateType=function(t){if((this.Frame||this.Frame.SubFrame)&&this.Frame.SubFrame.length){if(IFrameSplitOperator.IsNumber(t)){var\x20e=t;if(2==e)this.Frame.SubFrame[0].Frame.CoordinateType=1;else\x20if(1==e)this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=e;else\x20if(0==e)this.Frame.SubFrame[0].Frame.CoordinateType=0,this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=0;else{if(3!=e)return;this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=2}}else\x20t.Type>=0&&t.Type<=2&&(this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=t.Type),!0===t.IsReverse?this.Frame.SubFrame[0].Frame.CoordinateType=1:0==t.IsReverse&&(this.Frame.SubFrame[0].Frame.CoordinateType=0);this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.ChangeIndexWindowCount=function(t,e){if(!(t<=0)&&this.Frame.SubFrame.length!=t){var\x20a=this.Frame.SubFrame.length;if(a>t){for(var\x20i=a-1;i>=t;--i)this.DeleteIndexPaint(i),this.Frame.SubFrame[i].Frame.ClearToolbar();this.Frame.SubFrame.splice(t,a-t),this.WindowIndex.splice(t,a-t);for(i=0;i<this.Frame.SubFrame.length;++i){var\x20r=this.Frame.SubFrame[i].Frame;i==this.Frame.SubFrame.length-1?r.XSplitOperator.ShowText=!0:r.XSplitOperator.ShowText=!1}}else{for(i=a;i<t;++i){var\x20n=this.CreateSubFrameItem(i);this.Frame.SubFrame[i]=n;var\x20s=new\x20DynamicChartTitlePainting;s.Frame=this.Frame.SubFrame[i].Frame,s.Canvas=this.Canvas,s.LanguageID=this.LanguageID,this.TitlePaint[i+1]=s}var\x20o=[{Index:\x22RSI\x22},{Index:\x22MACD\x22},{Index:\x22VOL\x22},{Index:\x22UOS\x22},{Index:\x22CHO\x22},{Index:\x22BRAR\x22}];e&&e.Windows.length>0&&(o=e.Windows);let\x20u=new\x20JSIndexScript;for(i=a;i<t;++i){var\x20h=(r=o[i%o.length]).Index;let\x20t=u.Get(h);var\x20l=t.Args;r.Args&&(l=r.Args);let\x20e={Name:t.Name,Script:t.Script,Args:l,ID:r.Index,KLineType:t.KLineType,YSpecificMaxMin:t.YSpecificMaxMin,YSplitScale:t.YSplitScale,FloatPrecision:t.FloatPrecision,Condition:t.Condition,OutName:t.OutName};this.WindowIndex[i]=new\x20ScriptIndex(e.Name,e.Script,e.Args,e),null!=r.Modify&&(this.Frame.SubFrame[i].Frame.ModifyIndex=r.Modify),null!=r.Change&&(this.Frame.SubFrame[i].Frame.ChangeIndex=r.Change),null!=r.Close&&(this.Frame.SubFrame[i].Frame.CloseIndex=r.Close),null!=r.Overlay&&(chart.Frame.SubFrame[i].Frame.OverlayIndex=r.Overlay),1==r.IsDrawTitleBG&&(this.Frame.SubFrame[i].Frame.IsDrawTitleBG=r.IsDrawTitleBG),IFrameSplitOperator.IsNumber(r.TitleHeight)?this.Frame.SubFrame[i].Frame.ChartBorder.TitleHeight=r.TitleHeight:r.TitleHeight=this.Frame.SubFrame[i].Frame.ChartBorder.TitleHeight,0==r.IsShowTitleArraw&&(this.Frame.SubFrame[i].Frame.IsShowTitleArraw=!1),0==r.IsShowIndexName&&(this.Frame.SubFrame[i].Frame.IsShowIndexName=!1),r.IndexParamSpace>=0&&(this.Frame.SubFrame[i].Frame.IndexParamSpace=r.IndexParamSpace),0==r.IsShowXLine&&(this.Frame.SubFrame[i].Frame.IsShowXLine=!1),0==r.IsShowYLine&&(this.Frame.SubFrame[i].Frame.IsShowYLine=!1);var\x20C=this.ChartPaint[0].Data;this.BindIndexData(i,C)}for(i=0;i<this.Frame.SubFrame.length;++i){r=this.Frame.SubFrame[i].Frame;i==this.Frame.SubFrame.length-1?r.XSplitOperator.ShowText=!0:r.XSplitOperator.ShowText=!1}this.UpdataDataoffset()}this.Frame.SetSizeChage(!0),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw()}},this.ChangeIndexTemplate=function(t){if(t.Windows){var\x20e=t.Windows.length;if(!(e<=0)){var\x20a=this.Frame.SubFrame.length,i=null,r=null;t.KLine&&(IFrameSplitOperator.IsNumber(t.KLine.Period)&&t.KLine.Period!=this.Period&&(i=t.KLine.Period),IFrameSplitOperator.IsNumber(t.KLine.Right)&&t.KLine.Right!=this.Right&&(r=t.KLine.Right));for(var\x20n=null!=i||null!=r,s=0;s<a;++s){this.DeleteIndexPaint(s);var\x20o=this.Frame.SubFrame[s];o.YSpecificMaxMin=null,o.IsLocked=!1,o.YSplitScale=null}if(a>e){for(s=a-1;s>=e;--s)this.Frame.SubFrame[s].Frame.ClearToolbar();this.Frame.SubFrame.splice(e,a-e),this.WindowIndex.splice(e,a-e)}else\x20for(s=a;s<e;++s){var\x20h=this.CreateSubFrameItem(s);this.Frame.SubFrame[s]=h;var\x20l=new\x20DynamicChartTitlePainting;l.Frame=this.Frame.SubFrame[s].Frame,l.Canvas=this.Canvas,l.LanguageID=this.LanguageID,this.TitlePaint[s+1]=l}var\x20C=new\x20JSIndexScript,u=this.ChartPaint[0].Data;for(s=0;s<e;++s){var\x20D=s,d=t.Windows[s],c=null;t.Frame&&t.Frame.length>s&&(c=t.Frame[s]);var\x20m=D+1;if(this.TitlePaint[m].Data=[],this.TitlePaint[m].Title=null,d.Script)this.WindowIndex[s]=new\x20ScriptIndex(d.Name,d.Script,d.Args,d),n||this.BindIndexData(D,u);else{var\x20f=d.Index,v=JSIndexMap.Get(f);if(v)this.WindowIndex[s]=v.Create(),this.CreateWindowIndex(D),n||this.BindIndexData(D,u);else{var\x20S=C.Get(f);if(S){var\x20T=S.Args;t.Windows[s].Args&&(T=t.Windows[s].Args);let\x20e={Name:S.Name,Script:S.Script,Args:T,ID:f,KLineType:S.KLineType,YSpecificMaxMin:S.YSpecificMaxMin,YSplitScale:S.YSplitScale,FloatPrecision:S.FloatPrecision,Condition:S.Condition,OutName:S.OutName};this.WindowIndex[s]=new\x20ScriptIndex(e.Name,e.Script,e.Args,e),n||this.BindIndexData(D,u)}}}null!=d.Modify&&(this.Frame.SubFrame[s].Frame.ModifyIndex=d.Modify),null!=d.Change&&(this.Frame.SubFrame[s].Frame.ChangeIndex=d.Change),null!=d.Close&&(this.Frame.SubFrame[s].Frame.CloseIndex=d.Close),null!=d.Overlay&&(chart.Frame.SubFrame[s].Frame.OverlayIndex=d.Overlay),1==d.IsDrawTitleBG&&(this.Frame.SubFrame[s].Frame.IsDrawTitleBG=d.IsDrawTitleBG),IFrameSplitOperator.IsNumber(d.TitleHeight)?this.Frame.SubFrame[s].Frame.ChartBorder.TitleHeight=d.TitleHeight:d.TitleHeight=this.Frame.SubFrame[s].Frame.ChartBorder.TitleHeight,0==d.IsShowTitleArraw&&(this.Frame.SubFrame[s].Frame.IsShowTitleArraw=!1),0==d.IsShowIndexName&&(this.Frame.SubFrame[s].Frame.IsShowIndexName=!1),d.IndexParamSpace>=0&&(this.Frame.SubFrame[s].Frame.IndexParamSpace=d.IndexParamSpace),c&&(c.SplitCount&&(this.Frame.SubFrame[s].Frame.YSplitOperator.SplitCount=c.SplitCount),!1!==c.IsShowXLine&&!0!==c.IsShowXLine||(this.Frame.SubFrame[s].Frame.IsShowXLine=c.IsShowXLine),!1!==c.IsShowYLine&&!0!==c.IsShowYLine||(this.Frame.SubFrame[s].Frame.IsShowYLine=c.IsShowYLine),!1!==c.IsShowLeftText&&!0!==c.IsShowLeftText||(this.Frame.SubFrame[s].Frame.IsShowYText[0]=c.IsShowLeftText,this.Frame.SubFrame[s].Frame.YSplitOperator.IsShowLeftText=c.IsShowLeftText),!1!==c.IsShowRightText&&!0!==c.IsShowRightText||(this.Frame.SubFrame[s].Frame.IsShowYText[1]=c.IsShowRightText,this.Frame.SubFrame[s].Frame.YSplitOperator.IsShowRightText=c.IsShowRightText))}for(s=0;s<this.Frame.SubFrame.length;++s){d=this.Frame.SubFrame[s].Frame;s==this.Frame.SubFrame.length-1?d.XSplitOperator.ShowText=!0:d.XSplitOperator.ShowText=!1}n?(this.Frame.SetSizeChage(!0),null!=i?this.ChangePeriod(i,t):null!=r&&this.ChangeRight(r)):(this.UpdataDataoffset(),this.Frame.SetSizeChage(!0),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw())}}},this.RemoveIndexWindow=function(t){if(JSConsole.Chart.Log(\x22[KLineChartContainer::RemoveIndexWindow]\x20remove\x20id\x22,t),0!=t&&this.Frame.SubFrame&&!(t>=this.Frame.SubFrame.length)){var\x20e=this.Frame.SubFrame[t].Frame;this.DeleteIndexPaint(t),this.Frame.SubFrame[t].Frame.ClearToolbar(),this.Frame.SubFrame.splice(t,1),this.WindowIndex.splice(t,1),this.TitlePaint.splice(t+1,1);for(var\x20a=0;a<this.Frame.SubFrame.length;++a){var\x20i=this.Frame.SubFrame[a].Frame;a==this.Frame.SubFrame.length-1?i.XSplitOperator.ShowText=!0:i.XSplitOperator.ShowText=!1,i.Identify=a}if(this.ChartDrawPicture.length>0){var\x20r=[];for(var\x20a\x20in\x20this.ChartDrawPicture){(i=this.ChartDrawPicture[a]).Frame!=e&&r.push(i)}this.ChartDrawPicture=r}this.Frame.SetSizeChage(!0),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}},this.GetIndexInfo=function(){var\x20t=[];for(var\x20e\x20in\x20this.WindowIndex){var\x20a=this.WindowIndex[e],i={Name:a.Name};a.ID&&(i.ID=a.ID),t.push(i)}return\x20t},this.CreateExtendChart=function(t,e){var\x20a;switch(t){case\x22筹码分布\x22:return(a=new\x20StockChip).Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.Left=this.Frame.ChartBorder.Right,a.SetOption(e),this.ExtendChartPaint.push(a),this.Frame.ChartBorder.Right+=a.Width,a;case\x22画图工具\x22:return(a=new\x20DrawToolsButton).Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.Left=this.Frame.ChartBorder.Right,a.SetOption(e),this.ExtendChartPaint.push(a),this.Frame.ChartBorder.Right+=a.Width,a;case\x22KLineTooltip\x22:return(a=e.Create&&\x22function\x22==typeof\x20e.Create?e.Create():new\x20KLineTooltipPaint).Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,e.LanguageID=this.LanguageID,a.SetOption(e),this.ExtendChartPaint.push(a),a;case\x22深度图\x22:return(a=new\x20DepthMapPaint).Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a;case\x22背景图\x22:return(a=new\x20BackgroundPaint).Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a;default:return\x20null}},this.OnTouchFinished=function(){if(this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID){if(1==this.TouchStatus.CorssCursorShow&&this.TouchDrawCount>0)return;return\x20this.TouchStatus.CorssCursorShow=!1,void\x20this.DrawDynamicInfo()}if(!0!==this.CorssCursorTouchEnd)for(var\x20t\x20in\x20this.ExtendChartPaint){\x22KLineTooltipPaint\x22===this.ExtendChartPaint[t].ClassName&&this.DrawDynamicInfo()}else\x20this.TouchDrawCount>0&&this.DrawDynamicInfo()},this.GetExtendChartByClassName=function(t){for(var\x20e\x20in\x20this.ExtendChartPaint){var\x20a=this.ExtendChartPaint[e];if(a.ClassName==t)return{Index:e,Chart:a}}return\x20null},this.DeleteExtendChart=function(t){t.Index>=this.ExtendChartPaint.length||this.ExtendChartPaint[t.Index]==t.Chart&&(\x22function\x22==typeof\x20t.Chart.Clear&&t.Chart.Clear(),this.ExtendChartPaint.splice(t.Index,1))},this.LockIndex=function(t){if(t&&t.IndexName)for(var\x20e\x20in\x20this.WindowIndex){let\x20a=this.WindowIndex[e];if(a||conintue,a.Name==t.IndexName){a.SetLock(t),this.Update();break}}},this.TryClickLock=function(t,e){for(var\x20a\x20in\x20this.Frame.SubFrame){var\x20i=this.Frame.SubFrame[a];if(i.Frame.IsLocked&&i.Frame.LockPaint){var\x20r=new\x20TooltipData;if(i.Frame.LockPaint.GetTooltipData(t,e,r))return\x20r.HQChart=this,r.Data.Callback&&r.Data.Callback(r),!0}}return!1},this.TryClickIndexTitle=function(t,e){for(var\x20a\x20in\x20this.TitlePaint){var\x20i=this.TitlePaint[a];if(i.IsClickTitle&&i.IsClickTitle(t,e)){var\x20r={Point:{X:t,Y:e},Title:i.Title,FrameID:i.Frame.Identify};JSConsole.Chart.Log(\x22[KLineChartContainer::TryClickIndexTitle]\x20click\x20title\x20\x22,r);var\x20n=this.GetEventCallback(JSCHART_EVENT_ID.ON_CLICK_INDEXTITLE);return\x20n&&n.Callback&&n.Callback(n,r,this),!0}}return!1},this.SetSizeChage=function(t){for(var\x20e\x20in\x20this.Frame.SetSizeChage(t),this.ExtendChartPaint){this.ExtendChartPaint[e].SizeChange=t}},this.Update=function(t){if(this.SourceData){if(this.BeforeBindMainData&&this.BeforeBindMainData(\x22Update\x22),(n=new\x20ChartData).Data=this.SourceData.Data,n.Period=this.Period,n.Right=this.Right,n.DataType=this.SourceData.DataType,n.Symbol=this.Symbol,n.Right>0&&ChartData.IsDayPeriod(n.Period,!0)){var\x20e=n.GetRightDate(n.Right);n.Data=e}if(ChartData.IsDayPeriod(n.Period,!1)||ChartData.IsMinutePeriod(n.Period,!1)){var\x20a=n.GetPeriodData(n.Period);n.Data=a}this.BindMainData(n,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData(\x22Update\x22);for(var\x20i=0;i<this.Frame.SubFrame.length;++i)this.BindIndexData(i,n);for(var\x20i\x20in\x20this.OverlayChartPaint){if((s=this.OverlayChartPaint[i]).SourceData)if(ChartData.IsMinutePeriod(this.Period,!0)){(n=new\x20ChartData).Data=s.SourceData.Data,n.Period=this.Period,n.Right=this.Right;var\x20r=this.SourceData.GetOverlayMinuteData(n.Data,this.IsApiPeriod);if(n.Data=r,ChartData.IsMinutePeriod(n.Period,!1)&&!this.IsApiPeriod){a=n.GetPeriodData(n.Period);n.Data=a}s.Data=n}else{var\x20n;if((n=new\x20ChartData).Data=s.SourceData.Data,n.Period=this.Period,n.Right=this.Right,n.Right>0&&MARKET_SUFFIX_NAME.IsSHSZStockA(s.Symbol)){e=n.GetRightDate(n.Right);n.Data=e}r=this.SourceData.GetOverlayData(n.Data,this.IsApiPeriod);if(n.Data=r,ChartData.IsDayPeriod(n.Period,!1)&&!this.IsApiPeriod){a=n.GetPeriodData(n.Period);n.Data=a}s.Data=n}}this.ReqeustKLineInfoData(),this.CreateChartDrawPictureByStorage(),this.UpdataDataoffset(),t&&t.UpdateCursorIndexType>0?this.UpdatePointByCursorIndex(t.UpdateCursorIndexType):this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw();for(i=0;i<this.Frame.SubFrame.length;++i){var\x20s=this.Frame.SubFrame[i];for(var\x20o\x20in\x20s.OverlayIndex){var\x20h=s.OverlayIndex[o];this.BindOverlayIndexData(h,i,n)}}}},this.ChangeSymbol=function(t){if(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,\x22KLineChartContainer::ChangeSymbol\x22),this.Symbol=t,t){if(MARKET_SUFFIX_NAME.IsSHSZIndex(t)&&(this.Right=0),this.Frame&&this.Frame.SubFrame)for(var\x20e=0;e<this.Frame.SubFrame.length;++e)this.DeleteIndexPaint(e);this.ReloadChartDrawPicture(),ChartData.IsDayPeriod(this.Period,!0)?this.RequestHistoryData():ChartData.IsMinutePeriod(this.Period,!0)||ChartData.IsSecondPeriod(this.Period)?this.ReqeustHistoryMinuteData():ChartData.IsTickPeriod(this.Period)&&this.RequestTickData()}else\x20this.DrawEmpty()},this.ReqeustKLineInfoData=function(){this.ChartPaint.length>0&&(this.ChartPaint[0].InfoData=new\x20Map);for(var\x20t\x20in\x20this.ChartInfo)this.ChartInfo[t].RequestData(this)},this.SetKLineInfo=function(t,e){for(var\x20a\x20in\x20this.ChartInfo=[],t){var\x20i=JSKLineInfoMap.Get(t[a]);if(i){var\x20r=i.Create();r.MaxReqeustDataCount=this.MaxReqeustDataCount,this.ChartInfo.push(r)}}1==e&&this.ReqeustKLineInfoData()},this.AddKLineInfo=function(t,e){var\x20a=JSKLineInfoMap.GetClassInfo(t);if(a){for(var\x20i\x20in\x20this.ChartInfo){if((r=this.ChartInfo[i]).ClassName==a.ClassName)return}var\x20r,n=JSKLineInfoMap.Get(t);if(n)(r=n.Create()).MaxReqeustDataCount=this.MaxReqeustDataCount,this.ChartInfo.push(r),1==e&&r.RequestData(this)}else\x20console.warn(\x22[KLineChartContainer::AddKLineInfo]\x20can\x27t\x20find\x20infoname=\x22,t)},this.DeleteKLineInfo=function(t){var\x20e=JSKLineInfoMap.GetClassInfo(t);if(e)for(var\x20a\x20in\x20this.ChartInfo){if(this.ChartInfo[a].ClassName==e.ClassName){this.ChartInfo.splice(a,1),this.UpdataChartInfo(),this.Draw();break}}else\x20console.warn(\x22[KLineChartContainer::DeleteKLineInfo]\x20can\x27t\x20find\x20infoname=\x22,t)},this.ClearKLineInfo=function(){!this.ChartInfo||this.ChartInfo.length<=0||(this.ChartInfo=[],this.ChartPaint[0].InfoData=null,this.Draw())},this.OverlaySymbol=function(t,e){for(var\x20a\x20in\x20this.OverlayChartPaint){if(this.OverlayChartPaint[a].Symbol===t)return\x20console.warn(`[KLineChartContainer::OverlaySymbol]\x20overlay\x20symbol=${t}\x20exist.`),!1}var\x20i=new\x20ChartOverlayKLine;return\x20i.Canvas=this.Canvas,i.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,i.ChartFrame=this.Frame.SubFrame[0].Frame,i.Name=\x22Overlay-KLine\x22,i.DrawType=this.KLineDrawType,i.Symbol=t,e&&e.Color?i.Color=e.Color:i.Color=g_JSChartResource.OverlaySymbol.Color[g_JSChartResource.OverlaySymbol.Random%g_JSChartResource.OverlaySymbol.Color.length],i.SetOption(e),++g_JSChartResource.OverlaySymbol.Random,this.ChartPaint[0]&&this.ChartPaint[0].Data&&this.SourceData&&(i.MainData=this.ChartPaint[0].Data),this.OverlayChartPaint.push(i),ChartData.IsDayPeriod(this.Period,!0)?this.RequestOverlayHistoryData():ChartData.IsMinutePeriod(this.Period,!0)&&this.RequestOverlayHistoryMinuteData(),!0},this.RequestOverlayHistoryData=function(){if(this.OverlayChartPaint.length&&this.SourceData&&this.SourceData.Data){var\x20t=this,e=this.GetRequestDataCount(),a=this.SourceData.Data[0].Date;for(var\x20i\x20in\x20this.OverlayChartPaint){let\x20n=this.OverlayChartPaint[i];if(!n.MainData)continue;if(n.Status!=OVERLAY_STATUS_ID.STATUS_NONE_ID)continue;let\x20s=n.Symbol;if(s){if(n.Status=OVERLAY_STATUS_ID.STATUS_REQUESTDATA_ID,this.NetworkFilter){var\x20r={Name:\x22KLineChartContainer::RequestOverlayHistoryData\x22,Explain:\x22叠加股票日K线数据\x22,Request:{Url:t.KLineApiUrl,Data:{symbol:s,count:e.MaxRequestDataCount,first:{date:a},field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22vol\x22,\x22amount\x22]},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,function(e){n.Status=OVERLAY_STATUS_ID.STATUS_RECVDATA_ID,t.RecvOverlayHistoryData(e,n)}),1==r.PreventDefault)return}JSNetwork.HttpRequest({url:this.KLineApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22],symbol:s,start:-1,count:e.MaxRequestDataCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){n.Status=OVERLAY_STATUS_ID.STATUS_RECVDATA_ID,t.RecvOverlayHistoryData(e,n)}})}}}},this.RecvOverlayHistoryData=function(t,e){if(!e.IsDelete){var\x20a=KLineChartContainer.JsonDataToHistoryData(t),i=new\x20ChartData;i.Data=a,i.DataType=0;var\x20r=new\x20ChartData;if(r.Data=a,r.Period=this.Period,r.Right=this.Right,r.DataType=0,r.Right>0&&MARKET_SUFFIX_NAME.IsSHSZStockA(t.symbol)){var\x20n=r.GetRightDate(r.Right);r.Data=n}var\x20s=this.SourceData.GetOverlayData(r.Data,this.IsApiPeriod);if(r.Data=s,ChartData.IsDayPeriod(r.Period,!1)&&!this.IsApiPeriod){var\x20o=r.GetPeriodData(r.Period);r.Data=o}e.Data=r,e.SourceData=i,e.Title=t.name,e.Symbol=t.symbol,e.Status=OVERLAY_STATUS_ID.STATUS_FINISHED_ID,this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=1,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.RequestOverlayHistoryMinuteData=function(){if(this.OverlayChartPaint.length&&this.SourceData&&this.SourceData.Data){var\x20t=this,e=this.GetRequestDataCount(),a=this.SourceData.Data[0].Date,i=this.SourceData.Data[0].Time;for(var\x20r\x20in\x20this.OverlayChartPaint){let\x20s=this.OverlayChartPaint[r];if(!s.MainData)continue;if(s.Status!=OVERLAY_STATUS_ID.STATUS_NONE_ID)continue;let\x20o=s.Symbol;if(o){if(s.Status=OVERLAY_STATUS_ID.STATUS_REQUESTDATA_ID,this.NetworkFilter){var\x20n={Name:\x22KLineChartContainer::RequestOverlayHistoryMinuteData\x22,Explain:\x22叠加股票分钟K线数据\x22,Request:{Url:t.MinuteKLineApiUrl,Data:{symbol:o,count:e.MaxRequestMinuteDayCount,first:{date:a,time:i},field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22vol\x22,\x22amount\x22]},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,function(e){s.Status=OVERLAY_STATUS_ID.STATUS_RECVDATA_ID,t.RecvOveralyHistoryMinuteData(e,s)}),1==n.PreventDefault)return}JSNetwork.HttpRequest({url:this.MinuteKLineApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22vol\x22,\x22amount\x22],symbol:o,start:-1,count:e.MaxRequestMinuteDayCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){s.Status=OVERLAY_STATUS_ID.STATUS_RECVDATA_ID,t.RecvOveralyHistoryMinuteData(e,s)}})}}}},this.RecvOveralyHistoryMinuteData=function(t,e){var\x20a=KLineChartContainer.JsonDataToMinuteHistoryData(t);if(a){var\x20i=new\x20ChartData;i.Data=a,i.DataType=1;var\x20r=new\x20ChartData;r.Data=a,r.Period=this.Period,r.Right=this.Right,r.DataType=1;var\x20n=this.SourceData.GetOverlayMinuteData(r.Data,this.IsApiPeriod);if(r.Data=n,ChartData.IsMinutePeriod(r.Period,!1)&&!this.IsApiPeriod){var\x20s=r.GetPeriodData(r.Period);r.Data=s}e.Data=r,e.SourceData=i,e.Title=t.name,e.Symbol=t.symbol,e.Status=OVERLAY_STATUS_ID.STATUS_FINISHED_ID,this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=1,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.ResetOverlaySymbolStatus=function(){for(var\x20t\x20in\x20this.OverlayChartPaint){this.OverlayChartPaint[t].Status=OVERLAY_STATUS_ID.STATUS_NONE_ID}},this.ClearOverlaySymbol=function(){for(var\x20t\x20in\x20this.OverlayChartPaint){this.OverlayChartPaint[t].IsDelete=!0}this.OverlayChartPaint=[],this.TitlePaint[0].OverlayChartPaint=this.OverlayChartPaint,this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=0,this.UpdateFrameMaxMin(),this.Draw()},this.DeleteOverlaySymbol=function(t){for(var\x20e\x20in\x20this.OverlayChartPaint){var\x20a=this.OverlayChartPaint[e];if(a.Symbol===t)return\x20a.IsDelete=!0,this.OverlayChartPaint.splice(e,1),this.OverlayChartPaint.length<=0&&(this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=0),this.UpdateFrameMaxMin(),this.Draw(),!0}return\x20console.warn(`[KLineChartContainer::DeleteOverlaySymbol]\x20overlay\x20symbol=${t}\x20not\x20exist.`),!1},this.RequestFlowCapitalData=function(){},this.RecvFlowCapitalData=function(t){if(!t.stock||1!=t.stock.length)return;let\x20e=t.stock[0];var\x20a=new\x20Array;for(var\x20i\x20in\x20e.stockday){var\x20r=e.stockday[i];let\x20t=new\x20SingleData;t.Date=r.date;var\x20n=r.capital;n&&(n.a>0&&(t.Value=n.a,a.push(t)))}if(this.IsApiPeriod){var\x20s=this.ChartPaint[0].Data,o=null;if(ChartData.IsMinutePeriod(this.Period,!0)?o=s.GetMinuteFittingFinanceData(a):ChartData.IsDayPeriod(this.Period,!0)&&(o=s.GetFittingFinanceData(a)),o&&s.Data&&o.length==s.Data.length)for(var\x20i\x20in\x20s.Data){r=s.Data[i];o[i]&&IFrameSplitOperator.IsNumber(o[i].Value)&&(r.FlowCapital=o[i].Value)}}else\x20if(ChartData.IsMinutePeriod(this.Period,!0)){o=this.SourceData.GetMinuteFittingFinanceData(a);for(var\x20i\x20in\x20this.SourceData.Data){r=this.SourceData.Data[i];o[i]&&IFrameSplitOperator.IsNumber(o[i].Value)&&(r.FlowCapital=o[i].Value)}var\x20h=this.ChartPaint[0].Data;if((C=new\x20ChartData).Data=this.SourceData.Data,ChartData.IsMinutePeriod(h.Period,!1)){var\x20l=C.GetPeriodData(h.Period);C.Data=l}h.Data=C.Data}else{o=this.SourceData.GetFittingFinanceData(a);for(var\x20i\x20in\x20this.SourceData.Data){r=this.SourceData.Data[i];o[i]&&IFrameSplitOperator.IsNumber(o[i].Value)&&(r.FlowCapital=o[i].Value)}var\x20C;h=this.ChartPaint[0].Data;if((C=new\x20ChartData).Data=this.SourceData.Data,h.Right>0){var\x20u=C.GetRightDate(h.Right);C.Data=u}if(ChartData.IsDayPeriod(h.Period,!1)){l=C.GetPeriodData(h.Period);C.Data=l}h.Data=C.Data}this.FlowCapitalReady=!0;var\x20D=!1;for(var\x20i\x20in\x20this.ExtendChartPaint){if(\x22StockChip\x22==(r=this.ExtendChartPaint[i]).ClassName){D=!0;break}}D&&this.Draw()},this.CreateChartDrawPicture=function(t,e,a){var\x20i=null,r=IChartDrawPicture.GetDrawPictureByName(t);if(r&&\x22ChartDrawPictureText\x22==(i=r.Create()).ClassName&&(i.HQChart=this),!i&&IChartDrawPicture.MapIonFont.has(t)){var\x20n=IChartDrawPicture.MapIonFont.get(t);(i=new\x20ChartDrawPictureIconFont).FontOption.Family=n.Family,i.Text=n.Text,n.Color&&(i.LineColor=n.Color)}if(!i)return!1;i.Canvas=this.Canvas,i.Status=0,i.Symbol=this.Symbol,i.Period=this.Period,i.Option=this.ChartDrawOption,a&&(i.FinishedCallback=a),e&&i.SetOption(e);var\x20s=this;return\x20i.Update=function(){s.DrawDynamicInfo()},this.CurrentChartDrawPicture=i,!0},this.MoveChartDrawPicture=function(t,e,a){var\x20i=this.CurrentChartDrawPicture;if(!i)return!1;var\x20r=GetDevicePixelRatio();a&&(r=1);var\x20n=t*r,s=e*r;return\x20i.Move(n,s),!0},this.UpdateChartDrawXValue=function(){for(var\x20t\x20in\x20this.ChartDrawPicture){this.ChartDrawPicture[t].UpdateXValue()}},this.OnRightMenu=function(t,e,a){var\x20i=GetDevicePixelRatio();if(this.RightMenu){var\x20r=this.Frame.PtInFrame(t*i,e*i);a.data={Chart:this,FrameID:r},this.RightMenu.DoModal(a)}var\x20n=this.GetEventCallback(JSCHART_EVENT_ID.ON_CONTEXT_MENU);if(n){var\x20s={X:t,Y:e,Event:a,FrameID:r=this.Frame.PtInFrame(t*i,e*i)};n.Callback(n,s,this)}},this.ReloadChartDrawPicture=function(){this.ChartDrawPicture=[],this.ChartDrawStorageCache,this.ChartDrawStorage&&(this.ChartDrawStorageCache=this.ChartDrawStorage.GetDrawData({Symbol:this.Symbol,Period:this.Period}))},this.CreateChartDrawPictureByStorage=function(){if(this.ChartDrawStorageCache&&!(this.ChartDrawStorageCache.length<=0)){for(var\x20t\x20in\x20this.ChartDrawStorageCache){var\x20e=this.ChartDrawStorageCache[t];if(!(e.FrameID<0||!this.Frame.SubFrame||this.Frame.SubFrame.length<e.FrameID)){var\x20a=IChartDrawPicture.CreateChartDrawPicture(e);a&&(a.Canvas=this.Canvas,a.Status=10,a.Frame=this.Frame.SubFrame[e.FrameID].Frame,a.UpdateXValue(),a.ValueToPoint(),\x22ChartDrawPictureText\x22===a.ClassName&&(a.IsInitialized=!0),this.ChartDrawPicture.push(a))}}this.ChartDrawStorageCache=null}},this.RequestKLineMatch=function(t,e){var\x20a=this,i=e.Scope,r=e.WaitDialog;JSConsole.Chart.Log(\x22[KLineChartContainer::RequestKLineMatch\x22,t,i);for(var\x20n=new\x20Array,s=new\x20Array,o=t.Start;o<t.End&&o<t.Data.Data.length;++o){var\x20h=t.Data.Data[o];n.push(h.Date),s.push(h.Close)}var\x20l={Stock:t.Stock,Index:{Start:t.Start,End:t.End},Date:{Start:n[0],End:n[n.length-1]},Minsimilar:i.Minsimilar,Plate:i.Plate,DayRegion:300};$.ajax({url:this.KLineMatchUrl,data:{userid:\x22guest\x22,plate:i.Plate,period:this.Period,right:this.Right,dayregion:l.DayRegion,minsimilar:i.Minsimilar,sampledate:n,samplevalue:s},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){r&&r.Close(),a.RecvKLineMatchData(t,l)},error:function(t,e,a){console.warn(\x22[KLineChartContainer::RequestKLineMatch]\x20failed\x22,t,e,a),r&&r.Close()}})},this.RecvKLineMatchData=function(t,e){JSConsole.Chart.Log(\x22[KLineChartContainer::RecvKLineMatchData]\x20recv\x22,t,e);var\x20a=[];for(var\x20i\x20in\x20t.match){if((o=t.match[i]).symbol!=e.Stock.Symbol)for(var\x20r\x20in\x20o.data){var\x20n=o.data[r],s={Symbol:o.symbol,Name:o.name,Similar:n.similar,Start:n.start,End:n.end};a.push(s)}}if(a.sort(function(t,e){return\x20e.Similar-t.Similar}),JSConsole.Chart.Log(\x22[KLineChartContainer::RecvKLineMatchData]\x20filterData\x22,a),this.mapEvent.has(JSCHART_EVENT_ID.RECV_KLINE_MATCH)){var\x20o;t={Sample:e,Match:a,Source:t};(o=this.mapEvent.get(JSCHART_EVENT_ID.RECV_KLINE_MATCH)).Callback(o,t,this)}else{var\x20h={data:{Chart:this,MatchData:a,Sample:e,Source:t}};new\x20KLineMatchDialog(this.Frame.ChartBorder.UIElement.parentNode).DoModal(h)}},this.UpdataChartInfo=function(){var\x20t=null;if(0==this.Period)for(var\x20e\x20in\x20t=new\x20Map,this.ChartInfo){var\x20a=this.ChartInfo[e].Data;for(var\x20i\x20in\x20a){var\x20r=a[i];t.has(r.Date.toString())?t.get(r.Date.toString()).Data.push(r):t.set(r.Date.toString(),{Data:new\x20Array(r)})}}else\x20if(ChartData.IsDayPeriod(this.Period,!1)){t=new\x20Map;var\x20n=this.ChartPaint[0].Data;if(n&&n.Data&&n.Data.length>0){var\x20s=n.Data[0],o=[];for(var\x20e\x20in\x20this.ChartInfo){var\x20h=this.ChartInfo[e];for(var\x20i\x20in\x20h.Data){(r=h.Data[i]).Date>=s.Date&&o.push(r)}}o.sort(function(t,e){return\x20t.Date-e.Date});for(e=0;e<n.Data.length;){var\x20l=n.Data[e];if(o.length<=0)break;h=o[0];l.Date<h.Date?++e:(t.has(l.Date.toString())?t.get(l.Date.toString()).Data.push(h):t.set(l.Date.toString(),{Data:new\x20Array(h)}),o.shift())}}}this.ChartPaint[0].InfoData=t},this.UpdateWindowIndex=function(t){var\x20e=new\x20ChartData;if(e.Data=this.SourceData.Data,e.Period=this.Period,e.Right=this.Right,this.IsApiPeriod);else{if(e.Right>0){var\x20a=e.GetRightDate(e.Right);e.Data=a}if(ChartData.IsDayPeriod(e.Period,!1)||ChartData.IsMinutePeriod(e.Period,!1)){var\x20i=e.GetPeriodData(e.Period);e.Data=i}}if(\x22function\x22==typeof\x20this.WindowIndex[t].ExecuteScript){debug&&console.log(\x22xxxxxxxxxxxxxxx\x20UpdateWindowIndex\x22,this.ChartPaint.length);var\x20r=this.ChartPaint[0].Data;this.WindowIndex[t].ExecuteScript(this,t,r)}else\x20this.WindowIndex[t].BindData(this,t,e);this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeWindowIndexParam=function(t){this.WindowIndex[t].Index[0].Param+=1,this.WindowIndex[t].Index[1].Param+=1,this.UpdateWindowIndex(t)},this.OnDoubleClick=function(t,e,a){var\x20i=null;if(this.mapEvent.has(JSCHART_EVENT_ID.DBCLICK_KLINE)&&(i=this.mapEvent.get(JSCHART_EVENT_ID.DBCLICK_KLINE)),this.MinuteDialog||i){var\x20r=new\x20TooltipData;for(var\x20n\x20in\x20this.ChartPaint){if(this.ChartPaint[n].GetTooltipData(t,e,r))break}if(r.Data){if(i){var\x20s={Tooltip:r,Stock:{Symbol:this.Symbol,Name:this.Name}};i.Callback(i,s,this)}this.MinuteDialog&&(a.data={Chart:this,Tooltip:r},this.MinuteDialog.DoModal(a))}}},this.CancelAutoUpdate=function(){\x22number\x22==typeof\x20this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=void\x200)},this.AutoUpdate=function(t){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol){var\x20e=this,a=MARKET_SUFFIX_NAME.GetMarketStatus(this.Symbol);if(0!=a&&3!=a){var\x20i=this.AutoUpdateFrequency;1==a?this.AutoUpdateTimer=setTimeout(function(){e.AutoUpdate()},i):2==a&&(this.AutoUpdateTimer=setTimeout(function(){ChartData.IsDayPeriod(e.Period,!0)?e.RequestRealtimeData():ChartData.IsMinutePeriod(e.Period,!0)||ChartData.IsSecondPeriod(e.Period)?e.RequestMinuteRealtimeData():ChartData.IsTickPeriod(e.Period)&&e.RequestTickRealtimeData()},i))}}},this.GetMaxMinPageSize=function(){let\x20t={},e=this.Frame.ChartBorder.GetWidth(),a=ZOOM_SEED[ZOOM_SEED.length-1][0]+ZOOM_SEED[ZOOM_SEED.length-1][1];return\x20t.Max=parseInt(e/a)-2,a=ZOOM_SEED[0][0]+ZOOM_SEED[0][1],t.Min=parseInt(e/a)-2,JSConsole.Chart.Log(`[KLineChartContainer::GetMaxMinPageSize]\x20Max=${t.Max}\x20Min=${t.Min}`),t},this.GetChartStatus=function(){var\x20t=this.Frame.SubFrame[0].Frame;if(!t)return\x20null;var\x20e=t.Data;if(!e)return\x20null;var\x20a={KLine:{},Zoom:{}};return\x20a.KLine.Count=e.Data.length,a.KLine.Offset=e.DataOffset,a.KLine.PageSize=t.XPointCount,a.Zoom.Index=t.ZoomIndex,a.Zoom.Max=ZOOM_SEED.length,a},this.DragDownloadData=function(){var\x20t=null;if(!(t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data))return!1;if(!(t.DataOffset>0))if(ChartData.IsMinutePeriod(this.Period,!0)){if(JSConsole.Chart.Log(`[KLineChartContainer.DragDownloadData]\x20Minute:[Enable=${this.DragDownload.Minute.Enable},\x20IsEnd=${this.DragDownload.Minute.IsEnd},\x20Status=${this.DragDownload.Minute.Status}]`),!this.DragDownload.Minute.Enable)return;if(this.DragDownload.Minute.IsEnd)return;if(0!=this.DragDownload.Minute.Status)return;this.RequestDragMinuteData()}else\x20if(ChartData.IsDayPeriod(this.Period,!0)){if(JSConsole.Chart.Log(`[KLineChartContainer.DragDownloadData]\x20Day:[Enable=${this.DragDownload.Minute.Enable},\x20IsEnd=${this.DragDownload.Minute.IsEnd},\x20Status=${this.DragDownload.Minute.Status}]`),!this.DragDownload.Day.Enable)return;if(this.DragDownload.Day.IsEnd)return;if(0!=this.DragDownload.Day.Status)return;this.RequestDragDayData()}},this.RequestDragMinuteData=function(){var\x20t=this;this.AutoUpdateEvent(!1,\x22KLineChartContainer::RequestDragMinuteData\x22),this.CancelAutoUpdate();var\x20e=this.DragDownload.Minute;e.Status=1;var\x20a=this.SourceData.Data[0],i={field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],symbol:t.Symbol,enddate:a.Date,endtime:a.Time,count:t.MaxRequestMinuteDayCount,first:{date:a.Date,time:a.Time}};if(this.NetworkFilter){var\x20r={Name:\x22KLineChartContainer::RequestDragMinuteData\x22,Explain:\x22拖拽1分钟K线数据下载\x22,Request:{Url:this.DragMinuteKLineApiUrl,Type:\x22POST\x22,Data:i},DragDownload:e,Self:this,PreventDefault:!1};if(this.NetworkFilter(r,function(a){t.RecvDragMinuteData(a),e.Status=0,t.AutoUpdateEvent(!0,\x22KLineChartContainer::RequestDragMinuteData\x22),t.AutoUpdate()}),1==r.PreventDefault)return}JSNetwork.HttpRequest({url:this.DragMinuteKLineApiUrl,data:i,type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(a){t.RecvDragMinuteData(a),e.Status=0,t.AutoUpdateEvent(!0,\x22KLineChartContainer::RequestDragMinuteData\x22),t.AutoUpdate()}})},this.RecvDragMinuteData=function(t){var\x20e=KLineChartContainer.JsonDataToMinuteHistoryData(t);if(!e||e.length<=0)this.DragDownload.Minute.IsEnd=!0;else{for(var\x20a=this.GetHistoryDataCount(),i=this.SourceData.Data[0],r=null,n=e.length-1;n>=0;--n){var\x20s=e[n];if(i.Date>s.Date||i.Date==s.Date&&i.Time>s.Time){r=n;break}if(i.Date==s.Date&&i.Time==s.Time){i.YClose=s.YClose,r=n-1;break}}if(!(null==r&&r<0)){for(n=0;n<e.length&&n<=r;++n){s=e[n];this.SourceData.Data.splice(n,0,s)}var\x20o=new\x20ChartData;if(o.Data=this.SourceData.Data,o.Period=this.Period,o.Right=this.Right,o.DataType=this.SourceData.DataType,o.Symbol=this.Symbol,!this.IsApiPeriod&&(ChartData.IsDayPeriod(o.Period,!1)||ChartData.IsMinutePeriod(o.Period,!1))){var\x20h=o.GetPeriodData(o.Period);o.Data=h}this.UpdateMainData(o,a),this.BindInstructionIndexData(o);for(n=0;n<this.Frame.SubFrame.length;++n)this.BindIndexData(n,o);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.UpdateChartDrawXValue(),this.Draw()}}},this.RequestDragDayData=function(){var\x20t=this;this.AutoUpdateEvent(!1,\x22KLineChartContainer::RequestDragDayData\x22),this.CancelAutoUpdate();var\x20e=this.DragDownload.Day;e.Status=1;var\x20a=this.SourceData.Data[0],i={field:[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22],symbol:t.Symbol,enddate:a.Date,count:t.MaxReqeustDataCount,first:{date:a.Date}};if(this.NetworkFilter){var\x20r={Name:\x22KLineChartContainer::RequestDragDayData\x22,Explain:\x22拖拽日K数据下载\x22,Request:{Url:this.DragKLineApiUrl,Type:\x22POST\x22,Data:i},DragDownload:e,Self:this,PreventDefault:!1};if(this.NetworkFilter(r,function(a){t.RecvDragDayData(a),e.Status=0,t.AutoUpdateEvent(!0,\x22KLineChartContainer::RequestDragDayData\x22),t.AutoUpdate()}),1==r.PreventDefault)return}JSNetwork.HttpRequest({url:this.DragKLineApiUrl,data:i,type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(a){t.RecvDragDayData(a),e.Status=0,t.AutoUpdateEvent(!0,\x22KLineChartContainer::RequestDragDayData\x22),t.AutoUpdate()}})},this.RecvDragDayData=function(t){var\x20e=KLineChartContainer.JsonDataToHistoryData(t);if(!e||e.length<=0)this.DragDownload.Day.IsEnd=!0;else{for(var\x20a=this.GetHistoryDataCount(),i=this.SourceData.Data[0],r=null,n=e.length-1;n>=0;--n){var\x20s=e[n];if(i.Date>s.Date){r=n;break}if(i.Date==s.Date){i.YClose=s.YClose,r=n-1;break}}if(!(null==r&&r<0)){for(n=0;n<e.length&&n<=r;++n){s=e[n];this.SourceData.Data.splice(n,0,s)}var\x20o=new\x20ChartData;if(o.Data=this.SourceData.Data,o.Period=this.Period,o.Right=this.Right,o.DataType=this.SourceData.DataType,o.Symbol=this.Symbol,!this.IsApiPeriod&&(ChartData.IsDayPeriod(o.Period,!1)||ChartData.IsMinutePeriod(o.Period,!1))){var\x20h=o.GetPeriodData(o.Period);o.Data=h}this.UpdateMainData(o,a),this.BindInstructionIndexData(o);for(n=0;n<this.Frame.SubFrame.length;++n)this.BindIndexData(n,o);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.UpdateChartDrawXValue(),this.Draw()}}},this.SetCustomVerical=function(t,e){if(this.Frame&&!(t>=this.Frame.SubFrame.length)){var\x20a=this.Frame.SubFrame[t];a.Frame&&(a.Frame.CustomVerticalInfo=e)}},this.OnSize=function(){if(this.Frame&&this.Frame.OnSize){var\x20t=this.Frame.OnSize();this.Frame.SetSizeChage(!0),t.Changed&&(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(2),this.UpdateFrameMaxMin()),this.Draw()}}}function\x20MinuteChartContainer(t){this.newMethod=JSChartContainer,this.newMethod(t),delete\x20this.newMethod,this.ClassName=\x22MinuteChartContainer\x22,this.WindowIndex=new\x20Array,this.Symbol,this.Name,this.SourceData,this.IsAutoUpdate=!0,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer,this.TradeDate=0,this.DayCount=1,this.DayData,this.LimitPrice,this.IsShowBeforeData=!1,this.BeforeData=null,this.IsBeforeData=!1,this.IsShowLead=!0,this.ChartDrawStorage=new\x20ChartDrawStorage,this.ChartDrawStorageCache=null,this.MinuteApiUrl=g_JSChartResource.Domain+\x22/API/Stock\x22,this.HistoryMinuteApiUrl=g_JSChartResource.Domain+\x22/API/StockMinuteData\x22,this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.OnTouchStart=function(t){this.IsTouchMove=!1,this.IsOnTouch=!0,this.TouchDrawCount=0,this.PhonePinch=null,this.StopDragTimer();var\x20e=this.IsSingleTouch(t);if((0==this.EnableScrollUpDown||!e||this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID&&1==this.TouchStatus.CorssCursorShow)&&t.cancelable&&t.preventDefault(),this.IsPhoneDragging(t)){if(this.TryClickLock||this.TryClickIndexTitle){var\x20a=this.GetToucheData(t,this.IsForceLandscape),i=(o=this.PointAbsoluteToRelative(a[0].clientX,a[0].clientY,!0)).X,r=o.Y;if(this.TryClickLock&&this.TryClickLock(i,r))return;if(this.TryClickIndexTitle&&this.TryClickIndexTitle(i,r))return}var\x20n=!0;this.ChartDrawOption.IsLockScreen?n=!1:this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID?1==this.TouchStatus.CorssCursorShow&&(n=!1):this.DragMode==JSCHART_DRAG_ID.DISABLE_DRAG_ID?n=!1:e||(n=!1);var\x20s={Click:{},LastMove:{}};a=this.GetToucheData(t,this.IsForceLandscape);s.Click.X=a[0].clientX,s.Click.Y=a[0].clientY,s.LastMove.X=a[0].clientX,s.LastMove.Y=a[0].clientY,this.MouseDrag=s,this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.IsSelected=!1),this.SelectChartDrawPicture=null;if(this.CurrentChartDrawPicture)return\x202==this.CurrentChartDrawPicture.Status?this.SetChartDrawPictureThirdPoint(s.Click.X,s.Click.Y,!0):(this.SetChartDrawPictureFirstPoint(s.Click.X,s.Click.Y,!0),this.FinishChartDrawPicturePoint()&&this.DrawDynamicInfo({Corss:!1,Tooltip:!1})),void(t.cancelable&&t.preventDefault());var\x20o,h={X:(o=this.PointAbsoluteToRelative(a[0].clientX,a[0].clientY,!0)).X,Y:o.Y};GetDevicePixelRatio();if(this.GetChartDrawPictureByPoint(h)){h.ChartDrawPicture.Status=20,h.ChartDrawPicture.ValueToPoint(),h.ChartDrawPicture.MovePointIndex=h.PointIndex,h.ChartDrawPicture.IsSelected=!0,this.CurrentChartDrawPicture=h.ChartDrawPicture,this.SelectChartDrawPicture=h.ChartDrawPicture;let\x20e=this.GetEventCallback(JSCHART_EVENT_ID.ON_CLICK_DRAWPICTURE);if(e&&e.Callback){let\x20t={DrawPicture:h.ChartDrawPicture};e.Callback(e,t,this)}return\x20void(t.cancelable&&t.preventDefault())}if(n){var\x20l=this;this.DragTimer=setTimeout(function(){if(s.Click.X==s.LastMove.X&&s.Click.Y==s.LastMove.Y){l.MouseDrag;l.MouseDrag=null,l.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID&&(l.TouchStatus.CorssCursorShow=!0),l.MoveCorssCursor(s.Click,t)}},l.PressTime)}this.ChartDrawOption.IsLockScreen?this.MouseDrag=null:this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID||(this.DragMode==JSCHART_DRAG_ID.DISABLE_DRAG_ID?(this.MouseDrag=null,this.MoveCorssCursor(s.Click,t)):this.IsClickShowCorssCursor&&this.MoveCorssCursor(s.Click,t))}else\x20if(this.IsPhonePinching(t)){var\x20C={Start:{},Last:{}};a=this.GetToucheData(t,this.IsForceLandscape);C.Start={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},C.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},this.PhonePinch=C,this.SelectChartDrawPicture=null}},this.OnTouchMove=function(e){this.IsTouchMove=!0;var\x20a=this.GetToucheData(e,this.IsForceLandscape);if(this.IsPhoneDragging(e)){var\x20i=this.MouseDrag;if(null==i)this.IsForceLandscape&&(y=t.getBoundingClientRect().width-a[0].clientY),this.ChartDrawOption.IsLockScreen||this.MoveCorssCursor({X:a[0].clientX,Y:a[0].clientY},e);else{var\x20r=this.GetMoveAngle(i.LastMove,{X:a[0].clientX,Y:a[0].clientY}),n=Math.abs(i.LastMove.X-a[0].clientX),s=Math.abs(i.LastMove.Y-a[0].clientY);n=parseInt(n);var\x20o=this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID&&1==this.TouchStatus.CorssCursorShow;if(this.CurrentChartDrawPicture){var\x20h=this.CurrentChartDrawPicture;if(1==h.Status||2==h.Status){if(n<5&&s<5)return;this.SetChartDrawPictureSecondPoint(a[0].clientX,a[0].clientY,!0)&&this.DrawDynamicInfo()}else\x20if(3==h.Status)this.SetChartDrawPictureThirdPoint(a[0].clientX,a[0].clientY,!0)&&this.DrawDynamicInfo();else\x20if(20==h.Status){if(n<5&&s<5)return;this.MoveChartDrawPicture(a[0].clientX-i.LastMove.X,a[0].clientY-i.LastMove.Y,!0)&&this.DrawDynamicInfo()}i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}else\x20if(o){this.MouseDrag;this.MouseDrag=null,this.MoveCorssCursor(i.Click,e)}else\x20if(1==this.DragMode||0==o){if((s>0&&n<=3||r<=this.TouchMoveMinAngle)&&1==this.EnableScrollUpDown)return\x20void\x20this.StopDragTimer();if(n<5||r<=this.TouchMoveMinAngle)return\x20void\x20this.PreventTouchEvent(e);var\x20l=!0;i.LastMove.X<a[0].clientX&&(l=!1),this.DataMove(n,l)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()):this.DragDownloadData&&this.DragDownloadData(),i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}}}else\x20if(this.IsPhonePinching(e)){if(this.DragMode==JSCHART_DRAG_ID.DISABLE_DRAG_ID)return;this.PreventTouchEvent(e);var\x20C=this.PhonePinch;if(!C)return;var\x20u=Math.abs(a[0].pageY-a[1].pageY)-Math.abs(C.Last.Y-C.Last.Y2),D=Math.abs(a[0].pageX-a[1].pageX)-Math.abs(C.Last.X-C.Last.X2),d=this.ZoomStepPixel;if(Math.abs(u)<d&&Math.abs(D)<d)return;var\x20c=u;if(Math.abs(u)<d&&(c=D),c>0){if((m={}).Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomUp(m))return;this.CursorIndex=m.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.StopDragTimer()}else{var\x20m;if((m={}).Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomDown(m))return;this.CursorIndex=m.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.StopDragTimer()}C.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY}}this.PreventTouchEvent(e)},this.OnTouchEnd=function(t){JSConsole.Chart.Log(\x22[KLineChartContainer:OnTouchEnd]\x22,t);var\x20e=!0;if(this.CurrentChartDrawPicture){var\x20a=this.CurrentChartDrawPicture;2==a.Status||1==a.Status||3==a.Status?(a.PointStatus=a.Status,this.FinishChartDrawPicturePoint()?this.DrawDynamicInfo():e=!1):20==a.Status&&this.FinishMoveChartDrawPicture()&&this.DrawDynamicInfo()}this.IsOnTouch=!1,!0===e&&(this.CurrentChartDrawPicture=null),this.StopDragTimer(),this.OnTouchFinished(),this.TouchDrawCount=0},this.OnKeyDown=function(t){switch(t.keyCode?t.keyCode:t.which){case\x2037:if(this.CursorIndex=parseInt(this.CursorIndex),this.CursorIndex<=.99999){if(!this.DataMoveLeft())break;this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw()}else--this.CursorIndex,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo();break;case\x2039:var\x20e=0;if(e=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,this.CursorIndex=parseInt(this.CursorIndex),this.CursorIndex+1>=e){if(!this.DataMoveRight())break;this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw()}else{var\x20a=null;if(!(a=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data))break;if(this.CursorIndex+a.DataOffset+1>=a.Data.length)break;++this.CursorIndex,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo()}break;default:return}t.preventDefault?t.preventDefault():t.returnValue=!1},this.OnRightMenu=function(t,e,a){if(this.RightMenu){var\x20i=this.Frame.PtInFrame(t,e);a.data={Chart:this,FrameID:i},this.RightMenu.DoModal(a)}var\x20r=this.GetEventCallback(JSCHART_EVENT_ID.ON_CONTEXT_MENU);if(r){var\x20n={X:t,Y:e,Event:a,FrameID:i=this.Frame.PtInFrame(t,e)};r.Callback(r,n,this)}},this.OnWheel=function(t){JSConsole.Chart.Log(\x22[MinuteChartContainer::OnWheel]\x22,t)},this.UpdatePointByCursorIndex=function(){this.LastPoint.X=this.Frame.GetXFromIndex(this.CursorIndex);var\x20t=this.CursorIndex;t=parseInt(t.toFixed(0));var\x20e=this.Frame.SourceData;if(!(e.DataOffset+t>=e.Data.length)){var\x20a=e.Data[e.DataOffset+t],i=null;i=a.Before?a.Before.Close:a.Close,this.LastPoint.Y=this.Frame.GetYFromData(i)}},this.Create=function(t,e){for(var\x20a\x20in\x20this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new\x20ChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=new\x20HQMinuteTimeStringFormat,this.ChartCorssCursor.StringFormatY=new\x20HQPriceStringFormat,this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartSplashPaint=new\x20ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new\x20HQTradeFrame,this.Frame.ChartBorder=new\x20ChartBorder,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=25,this.Frame.ChartBorder.Left=50,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var\x20i=new\x20DynamicChartTitlePainting;i.Frame=this.Frame.SubFrame[a].Frame,i.Canvas=this.Canvas,i.LanguageID=this.LanguageID,this.TitlePaint.push(i)}this.ChartCorssCursor.StringFormatX.Frame=this.Frame.SubFrame[0].Frame;var\x20r=!0,n=!0;e&&(!1===e.KeyDown&&(r=!1,JSConsole.Chart.Log(\x22[MinuteChartContainer::Create]\x20not\x20register\x20keydown\x20event.\x22)),!1===e.Wheel&&(n=!1,JSConsole.Chart.Log(\x22[MinuteChartContainer::Create]\x20not\x20register\x20wheel\x20event.\x22))),r&&this.UIElement.addEventListener(\x22keydown\x22,t=>{this.OnKeyDown(t)},!0),n&&this.UIElement.addEventListener(\x22wheel\x22,t=>{this.OnWheel(t)},!0)},this.CreateChildWindow=function(t){for(var\x20e=0;e<t;++e){var\x20a=new\x20ChartBorder;a.UIElement=this.UIElement;var\x20i=new\x20MinuteFrame;i.Canvas=this.Canvas,i.ChartBorder=a,i.Identify=e,e<2&&(i.ChartBorder.TitleHeight=0),i.XPointCount=243,e>=2&&(this.ModifyIndexDialog&&(i.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(i.ChangeIndexEvent=this.ChangeIndexDialog.DoModal));var\x20r=[9,8,7,6,5,4,3,2,1];for(var\x20n\x20in\x20i.HorizontalMax=r[0],i.HorizontalMin=r[r.length-1],0==e?(i.YSplitOperator=new\x20FrameSplitMinutePriceY,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get(\x22price\x22)):(i.YSplitOperator=new\x20FrameSplitY,i.YSplitOperator.LanguageID=this.LanguageID,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get(\x22double\x22)),i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=a,i.XSplitOperator=new\x20FrameSplitMinuteX,i.XSplitOperator.Frame=i,i.XSplitOperator.ChartBorder=a,e!=t-1&&(i.XSplitOperator.ShowText=!1),i.XSplitOperator.Operator(),r)i.HorizontalInfo[n]=new\x20CoordinateInfo,i.HorizontalInfo[n].Value=r[n],0==e&&n==i.HorizontalMin||(i.HorizontalInfo[n].Message[1]=r[n].toString(),i.HorizontalInfo[n].Font=\x2214px\x20微软雅黑\x22);var\x20s=new\x20SubFrameItem;s.Frame=i,s.Height=0==e?20:10,this.Frame.SubFrame[e]=s}},this.CreateSubFrameItem=function(t){var\x20e=new\x20ChartBorder;e.UIElement=this.UIElement;var\x20a=new\x20MinuteFrame;a.Canvas=this.Canvas,a.ChartBorder=e,a.Identify=t,a.XPointCount=243,t>=2&&(this.ModifyIndexDialog&&(a.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(a.ChangeIndexEvent=this.ChangeIndexDialog.DoModal));var\x20i=[9,8,7,6,5,4,3,2,1];a.HorizontalMax=i[0],a.HorizontalMin=i[i.length-1],a.YSplitOperator=new\x20FrameSplitY,a.YSplitOperator.LanguageID=this.LanguageID,a.YSplitOperator.FrameSplitData=this.FrameSplitData.get(\x22double\x22),a.YSplitOperator.Frame=a,a.YSplitOperator.ChartBorder=e,a.XSplitOperator=new\x20FrameSplitMinuteX,a.XSplitOperator.Frame=a,a.XSplitOperator.ChartBorder=e,a.XSplitOperator.ShowText=!1;var\x20r=this.Frame.SubFrame[0].Frame.XPointCount;for(var\x20n\x20in\x20a.XPointCount=r,a.Data=this.ChartPaint[0].Data,i)a.HorizontalInfo[n]=new\x20CoordinateInfo,a.HorizontalInfo[n].Value=i[n],a.HorizontalInfo[n].Message[1]=i[n].toString(),a.HorizontalInfo[n].Font=\x2214px\x20微软雅黑\x22;var\x20s=new\x20SubFrameItem;return\x20s.Frame=a,s.Height=10,s},this.UpdateXShowText=function(){for(var\x20t=!0,e=this.Frame.SubFrame.length-1;e>=0;--e){var\x20a=this.Frame.SubFrame[e].Frame,i=this.Frame.SubFrame[e];t?(a.XSplitOperator.ShowText=!0,i.Height>0&&(t=!1)):a.XSplitOperator.ShowText=!1}},this.DeleteIndexPaint=function(t){let\x20e=new\x20Array;for(var\x20a\x20in\x20this.ChartPaint){let\x20i=this.ChartPaint[a];0!=a&&i.ChartFrame==this.Frame.SubFrame[t].Frame||e.push(i)}this.Frame.SubFrame[t].Frame.YSpecificMaxMin=null,this.Frame.SubFrame[t].Frame.IsLocked=!1,this.ChartPaint=e;var\x20i=t+1;this.TitlePaint[i].Data=[],this.TitlePaint[i].Title=null},this.CreateStockInfo=function(){this.ExtendChartPaint[0]=new\x20StockInfoExtendChartPaint,this.ExtendChartPaint[0].Canvas=this.Canvas,this.ExtendChartPaint[0].ChartBorder=this.Frame.ChartBorder,this.ExtendChartPaint[0].ChartFrame=this.Frame,this.Frame.ChartBorder.Right=300},this.CreateMainKLine=function(){var\x20t=new\x20ChartMinutePriceLine;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name=\x22Minute-Line\x22,t.Color=g_JSChartResource.Minute.PriceColor,t.AreaColor=g_JSChartResource.Minute.AreaPriceColor,t.HQChart=this,this.ChartPaint[0]=t;var\x20e=new\x20ChartMinutePriceLine;e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.Name=\x22Minute-Average-Line\x22,e.Color=g_JSChartResource.Minute.AvPriceColor,e.IsDrawArea=!1,this.ChartPaint[1]=e;var\x20a=new\x20ChartMinuteVolumBar;a.Color=g_JSChartResource.Minute.VolBarColor,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.SubFrame[1].Frame.ChartBorder,a.ChartFrame=this.Frame.SubFrame[1].Frame,a.Name=\x22Minute-Vol-Bar\x22,this.ChartPaint[2]=a,this.TitlePaint[0]=new\x20DynamicMinuteTitlePainting,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].OverlayChartPaint=this.OverlayChartPaint,this.TitlePaint[0].LanguageID=this.LanguageID},this.ChangeScriptIndex=function(t,e,a){this.DeleteIndexPaint(t),this.WindowIndex[t]=new\x20ScriptIndex(e.Name,e.Script,e.Args,e);var\x20i=this.SourceData;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeIndex=function(t,e,a){if(this.Frame.SubFrame.length<3)return;let\x20i=(new\x20JSIndexScript).Get(e);if(!i)return;t<2&&(t=2),t>=this.Frame.SubFrame.length&&(t=2);let\x20r={Name:i.Name,Script:i.Script,Args:i.Args,ID:e,KLineType:i.KLineType,YSpecificMaxMin:i.YSpecificMaxMin,YSplitScale:i.YSplitScale,FloatPrecision:i.FloatPrecision,Condition:i.Condition,StringFormat:i.StringFormat,OutName:i.OutName};return\x20a&&(a.FloatPrecision>=0&&(r.FloatPrecision=a.FloatPrecision),a.StringFormat>0&&(r.StringFormat=a.StringFormat),a.Args&&(r.Args=a.Args)),this.ChangeScriptIndex(t,r,a)},this.ChangeIndexWindowCount=function(t){if(!(t<2)&&this.Frame.SubFrame.length!=t){var\x20e=this.Frame.SubFrame.length;if(e>t){for(var\x20a=e-1;a>=t;--a){this.DeleteIndexPaint(a),(o=this.Frame.SubFrame[a].Frame).ClearToolbar&&o.ClearToolbar()}this.Frame.SubFrame.splice(t,e-t),this.WindowIndex.splice(t,e-t)}else{for(a=e;a<t;++a){var\x20i=this.CreateSubFrameItem(a);this.Frame.SubFrame[a]=i;var\x20r=new\x20DynamicChartTitlePainting;r.Frame=this.Frame.SubFrame[a].Frame,r.Canvas=this.Canvas,r.LanguageID=this.LanguageID,this.TitlePaint[a+1]=r}const\x20h=[\x22RSI\x22,\x22MACD\x22,\x22DMA\x22,\x22DMI\x22,\x22KDJ\x22,\x22WR\x22];let\x20l=new\x20JSIndexScript;for(a=e;a<t;++a){var\x20n=h[a%h.length];let\x20t=l.Get(n);this.WindowIndex[a]=new\x20ScriptIndex(t.Name,t.Script,t.Args,t);var\x20s=this.SourceData;this.BindIndexData(a,s)}for(a=0;a<this.Frame.SubFrame.length;++a){var\x20o=this.Frame.SubFrame[a].Frame;a==this.Frame.SubFrame.length-1?o.XSplitOperator.ShowText=!0:o.XSplitOperator.ShowText=!1}this.UpdataDataoffset()}this.UpdateXShowText(),this.Frame.SetSizeChage(!0),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw()}},this.RemoveIndexWindow=function(t){if(JSConsole.Chart.Log(\x22[MinuteChartContainer::RemoveIndexWindow]\x20remove\x20id\x22,t),!(t<2)&&this.Frame.SubFrame&&!(t>=this.Frame.SubFrame.length)){this.Frame.SubFrame[t].Frame;this.DeleteIndexPaint(t),this.Frame.SubFrame[t].Frame.ClearToolbar(),this.Frame.SubFrame.splice(t,1),this.WindowIndex.splice(t,1),this.TitlePaint.splice(t+1,1);for(var\x20e=0;e<this.Frame.SubFrame.length;++e){var\x20a=this.Frame.SubFrame[e].Frame;e==this.Frame.SubFrame.length-1?a.XSplitOperator.ShowText=!0:a.XSplitOperator.ShowText=!1,a.Identify=e}this.Frame.SetSizeChage(!0),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}},this.ChangeSymbol=function(t){this.CancelAutoUpdate(),this.Symbol=t,this.ResetOverlaySymbolStatus(),this.ReloadChartDrawPicture(),t?(this.ChartSplashPaint.EnableSplash(!0),this.Draw(),this.RequestData()):this.DrawEmpty()},this.ChangeDayCount=function(t){t<0||t>10||(this.DayCount=t,this.DayCount>1?this.ChartDrawPicture=[]:this.ReloadChartDrawPicture(),this.ResetOverlaySymbolStatus(),this.RequestData())},this.OverlaySymbol=function(t,e){for(var\x20a\x20in\x20this.OverlayChartPaint){if(this.OverlayChartPaint[a].Symbol==t)return\x20console.warn(`[MinuteChartContainer::OverlaySymbol]\x20overlay\x20symbol=${t}\x20exist.`),!1}var\x20i=new\x20ChartOverlayMinutePriceLine;return\x20i.Canvas=this.Canvas,i.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,i.ChartFrame=this.Frame.SubFrame[0].Frame,i.Name=\x22Overlay-Minute\x22,i.Symbol=t,e&&e.Color?i.Color=e.Color:i.Color=g_JSChartResource.OverlaySymbol.Color[g_JSChartResource.OverlaySymbol.Random%g_JSChartResource.OverlaySymbol.Color.length],++g_JSChartResource.OverlaySymbol.Random,this.ChartPaint[0].YClose>0&&this.ChartPaint[0].Data&&(i.MainData=this.ChartPaint[0].Data,i.MainYClose=this.ChartPaint[0].YClose),this.OverlayChartPaint.push(i),this.DayCount<=1?this.RequestOverlayMinuteData():this.RequestOverlayHistoryMinuteData(),!0},this.ResetOverlaySymbolStatus=function(){for(var\x20t\x20in\x20this.OverlayChartPaint){this.OverlayChartPaint[t].Status=OVERLAY_STATUS_ID.STATUS_NONE_ID}},this.DeleteOverlaySymbol=function(t){for(var\x20e\x20in\x20this.OverlayChartPaint){var\x20a=this.OverlayChartPaint[e];if(a.Symbol===t)return\x20a.IsDelete=!0,this.OverlayChartPaint.splice(e,1),this.UpdateFrameMaxMin(),this.Draw(),!0}return\x20console.warn(`[MinuteChartContainer::DeleteOverlaySymbol]\x20overlay\x20symbol=${t}\x20not\x20exist.`),!1},this.ClearOverlaySymbol=function(){for(var\x20t\x20in\x20this.OverlayChartPaint){this.OverlayChartPaint[t].IsDelete=!0}this.OverlayChartPaint=[],this.Frame.SubFrame[0].Frame.YSplitOperator.OverlayChartPaint=this.OverlayChartPaint,this.TitlePaint[0].OverlayChartPaint=this.OverlayChartPaint,this.UpdateFrameMaxMin(),this.Draw()},this.ShowBeforeData=function(t){this.IsShowBeforeData!=t&&(this.IsShowBeforeData=t,this.RequestData())},this.RequestData=function(){this.DayCount<=1?this.RequestMinuteData():this.RequestHistoryMinuteData()},this.ChangeDrawType=function(t){if(!(this.ChartPaint.length<=0)){if(0==t)this.ChartPaint[0].IsDrawArea=!0;else{if(1!=t)return;this.ChartPaint[0].IsDrawArea=!1}this.Draw()}},this.RequestHistoryMinuteData=function(){var\x20t=this;if(this.IsBeforeData=!1,this.ChartSplashPaint.EnableSplash(!0),this.Draw(),this.NetworkFilter){var\x20e={Name:\x22MinuteChartContainer::RequestHistoryMinuteData\x22,Explain:\x22多日分时数据\x22,Request:{Url:t.HistoryMinuteApiUrl,Data:{daycount:t.DayCount,symbol:t.Symbol},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)}),1==e.PreventDefault)return}JSNetwork.HttpRequest({url:t.HistoryMinuteApiUrl,data:{symbol:t.Symbol,daycount:t.DayCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)}})},this.RecvHistoryMinuteData=function(t){this.DayData=MinuteChartContainer.JsonDataToMinuteDataArray(t),this.Symbol=t.symbol,this.Name=t.name,this.CaclutateLimitPrice(this.DayData[0].YClose,t.data[0].limitprice),this.UpdateHistoryMinuteUI(),this.RecvMinuteDataEvent(),this.RequestOverlayHistoryMinuteData(),this.AutoUpdate()},this.UpdateHistoryMinuteUI=function(){var\x20t=this.HistoryMinuteDataToArray(this.DayData),e=new\x20ChartData;e.Data=t,this.SourceData=e,this.TradeDate=this.DayData[0].Date,this.BindMainData(e,this.DayData[0].YClose);var\x20a=this.Symbol.toUpperCase();if(MARKET_SUFFIX_NAME.IsForeignExchange(a)&&(this.ChartPaint[1].Data=null),this.Frame.SubFrame.length>2){var\x20i=new\x20ChartData;i.Data=t;for(var\x20r=2;r<this.Frame.SubFrame.length;++r)this.BindIndexData(r,i)}for(var\x20r\x20in\x20this.Frame.SubFrame){var\x20n=this.Frame.SubFrame[r];for(var\x20s\x20in\x20n.Frame.XSplitOperator.Symbol=this.Symbol,n.Frame.XSplitOperator.DayCount=this.DayData.length,n.Frame.XSplitOperator.DayData=this.DayData,n.Frame.XSplitOperator.Operator(),n.Frame.XSplitOperator.IsBeforeData=this.IsBeforeData,n.Frame.YSplitOperator.Symbol=this.Symbol,n.Frame.IsBeforeData=this.IsBeforeData,n.OverlayIndex){var\x20o=n.OverlayIndex[s];o.Frame.XPointCount=n.Frame.XPointCount,o.Frame.MinuteCount=n.Frame.MinuteCount}}this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.IsBeforeData=this.IsBeforeData,this.TitlePaint[0].IsShowDate=!0,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()},this.HistoryMinuteDataToArray=function(t){for(var\x20e=[],a=t.length-1;a>=0;--a){var\x20i=t[a];for(var\x20r\x20in\x20i.Data)e.push(i.Data[r])}return\x20e},this.UpdateLatestMinuteData=function(t,e){for(var\x20a\x20in\x20this.DayData){var\x20i=this.DayData[a];if(i.Date===e){i.Data=t;break}}},this.RequestMinuteData=function(t){if(void\x200===window.RequestMinuteData_obj&&(window.RequestMinuteData_obj=this,debug&&console.log(\x22RequestMinuteData_obj\x22,this)),t){var\x20e=[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22,\x22amount\x22,\x22date\x22,\x22time\x22,\x22minute\x22,\x22minutecount\x22],a=this.Symbol.toUpperCase();MARKET_SUFFIX_NAME.IsFutures(a)&&(e.push(\x22clearing\x22),e.push(\x22yclearing\x22)),this.IsBeforeData=!1,this.IsShowBeforeData&&1===this.DayCount&&MARKET_SUFFIX_NAME.IsSHSZStockA(this.Symbol)&&(this.IsBeforeData=!0,e.push(\x22before\x22)),console.log(\x22------------------------------------MinuteChartContainer::RequestMinuteData----------分时数据\x22),this.ChartSplashPaint.EnableSplash(!1),this.RecvMinuteData(t)}},this.RecvMinuteDataEvent=function(){if(this.mapEvent.has(JSCHART_EVENT_ID.RECV_MINUTE_DATA)){var\x20t=this.mapEvent.get(JSCHART_EVENT_ID.RECV_MINUTE_DATA),e={MinuteData:this.SourceData,Stock:{Symbol:this.Symbol,Name:this.Name}};t.Callback(t,e,this)}},this.RecvMinuteData=function(t){if(1!=this.IsOnTouch){if(this.IsBeforeData)var\x20e=MinuteChartContainer.JsonDataToMinuteData2(t);else\x20e=MinuteChartContainer.JsonDataToMinuteData(t);if(this.DayCount>1)return\x20this.UpdateLatestMinuteData(e,t.stock[0].date),this.UpdateHistoryMinuteUI(),this.RecvMinuteDataEvent(),this.RequestOverlayMinuteData(),void\x20this.AutoUpdate();var\x20a=this.SourceData;this.SourceData||(a=new\x20ChartData),a.Data=e,this.TradeDate=t.stock[0].date,this.SourceData=a,this.Symbol=t.stock[0].symbol,this.Name=t.stock[0].name;var\x20i=t.stock[0].yclose,r=this.Symbol.toUpperCase(),n=MARKET_SUFFIX_NAME.IsFutures(r);t.stock[0].yclearing>0&&n&&(i=t.stock[0].yclearing),this.CaclutateLimitPrice(i,t.stock[0].limitprice);var\x20s=null;if(t.stock[0].high>0&&t.stock[0].low>0&&(s={High:t.stock[0].high,Low:t.stock[0].low}),this.BindMainData(a,i,s),this.Frame.SubFrame.length>2){var\x20o=new\x20ChartData;o.Data=e;for(var\x20h=2;h<this.Frame.SubFrame.length;++h)this.BindIndexData(h,o)}for(var\x20h\x20in\x20this.Frame.SubFrame){var\x20l=this.Frame.SubFrame[h];for(var\x20C\x20in\x20l.Frame.XSplitOperator.Symbol=this.Symbol,l.Frame.XSplitOperator.DayCount=1,l.Frame.XSplitOperator.Operator(),l.Frame.XSplitOperator.IsBeforeData=this.IsBeforeData,l.Frame.YSplitOperator.Symbol=this.Symbol,l.Frame.IsBeforeData=this.IsBeforeData,l.OverlayIndex){var\x20u=l.OverlayIndex[C];u.Frame.XPointCount=l.Frame.XPointCount,u.Frame.MinuteCount=l.Frame.MinuteCount}}this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.IsBeforeData=this.IsBeforeData,MARKET_SUFFIX_NAME.IsSHSZ(r)&&(this.TitlePaint[0].IsShowDate=!1),1==t.stock[0].IsHistoryMinute&&(this.TitlePaint[0].IsShowDate=!0);var\x20D=this.GetChartMinuteInfo();D&&(D.SourceData=this.SourceData),this.RecvMinuteDataEvent(),this.RequestMinuteInfoData(),this.RequestOverlayMinuteData(),this.CreateChartDrawPictureByStorage(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.AutoUpdate()}},this.CaclutateLimitPrice=function(t,e){if(this.LimitPrice=null,e&&e.max>0&&e.min>0)this.LimitPrice={Max:e.max,Min:e.min};else{var\x20a=MARKET_SUFFIX_NAME.GetLimitPriceRange(this.Symbol,this.Name);a?t<=0||(this.LimitPrice={Max:t*(1+a.Max),Min:t*(1+a.Min)},JSConsole.Chart.Log(`[MinuteChartContainer::CaclutateLimitPrice]\x20${this.Symbol}\x20yClose:${t}\x20max:${this.LimitPrice.Max}\x20min:${this.LimitPrice.Min}`),this.LimitPrice.Max=parseFloat(this.LimitPrice.Max.toFixed(2)),this.LimitPrice.Min=parseFloat(this.LimitPrice.Min.toFixed(2)),JSConsole.Chart.Log(`[MinuteChartContainer::CaclutateLimitPrice]\x20${this.Symbol}\x20tofixed(2)\x20max:${this.LimitPrice.Max}\x20min:${this.LimitPrice.Min}`)):JSConsole.Chart.Log(`[MinuteChartContainer::CaclutateLimitPrice]\x20${this.Symbol}\x20no\x20limit\x20price.`)}},this.RequestOverlayMinuteData=function(){var\x20t=this,e=this.TradeDate;for(var\x20a\x20in\x20this.OverlayChartPaint){let\x20n=this.OverlayChartPaint[a];if(n.MainData&&n.MainYClose>0&&n.Status==OVERLAY_STATUS_ID.STATUS_NONE_ID){var\x20i=n.Symbol;if(!i)return;if(n.Status=OVERLAY_STATUS_ID.STATUS_REQUESTDATA_ID,this.NetworkFilter){var\x20r={Name:\x22MinuteChartContainer::RequestOverlayMinuteData\x22,Explain:\x22叠加股票最新分时数据\x22,Request:{Url:t.HistoryMinuteApiUrl,Data:{days:[e],symbol:i},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,function(e){n.Status=OVERLAY_STATUS_ID.STATUS_RECVDATA_ID,t.RecvOverlayMinuteData(e,n)}),1==r.PreventDefault)continue}JSNetwork.HttpRequest({url:t.HistoryMinuteApiUrl,data:{symbol:i,days:[e]},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){n.Status=OVERLAY_STATUS_ID.STATUS_RECVDATA_ID,t.RecvOverlayMinuteData(e,n)}})}}},this.RecvOverlayMinuteData=function(t,e){if(!e.IsDelete){var\x20a,i=MinuteChartContainer.JsonDataToMinuteDataArray(t),r=null;if(this.DayCount>1){if(i.length<=0)return;var\x20n=i[0];for(var\x20s\x20in\x20e.SourceData){if(e.SourceData[s].Date==n.Date){e.SourceData[s]=n;var\x20o=this.HistoryMinuteDataToArray(e.SourceData);(r=new\x20ChartData).Data=o,a=n.YClose;break}}if(null==r)return}else\x20a=(r=i.length>0?i[0]:new\x20ChartData).YClose;e.Data=r,e.Title=t.name,e.Symbol=t.symbol,e.YClose=a,e.Status=OVERLAY_STATUS_ID.STATUS_FINISHED_ID,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.RequestOverlayHistoryMinuteData=function(){var\x20t=this,e=[];for(var\x20a\x20in\x20this.DayData){var\x20i=this.DayData[a];e.push(i.Date)}if(!(e.length<=0))for(var\x20a\x20in\x20this.OverlayChartPaint){let\x20i=this.OverlayChartPaint[a];var\x20r=i.Symbol;if(!r)return;if(i.Status==OVERLAY_STATUS_ID.STATUS_NONE_ID){if(i.Status=OVERLAY_STATUS_ID.STATUS_REQUESTDATA_ID,this.NetworkFilter){var\x20n={Name:\x22MinuteChartContainer::RequestOverlayHistoryMinuteData\x22,Explain:\x22叠加股票多日分时数据\x22,Request:{Url:t.HistoryMinuteApiUrl,Data:{days:e,symbol:r},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,function(e){i.Status=OVERLAY_STATUS_ID.STATUS_RECVDATA_ID,t.RecvOverlayHistoryMinuteData(e,i)}),1==n.PreventDefault)return}JSNetwork.HttpRequest({url:t.HistoryMinuteApiUrl,data:{symbol:r,days:e},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){i.Status=OVERLAY_STATUS_ID.STATUS_RECVDATA_ID,t.RecvOverlayHistoryMinuteData(e,i)}})}}},this.RecvOverlayHistoryMinuteData=function(t,e){var\x20a=MinuteChartContainer.JsonDataToMinuteDataArray(t),i=[];for(var\x20r\x20in\x20this.DayData){var\x20n=this.DayData[r],s=!1;for(var\x20o\x20in\x20a)if(n.Date==a[o].Date){i.push(a[r]),s=!0;break}if(!s)(new\x20ChartData).Date=n.Date}e.SourceData=i;var\x20h=this.HistoryMinuteDataToArray(i),l=i[0].YClose,C=new\x20ChartData;C.Data=h,e.Data=C,e.Title=t.name,e.Symbol=t.symbol,e.YClose=l,e.Status=OVERLAY_STATUS_ID.STATUS_FINISHED_ID,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()},this.CancelAutoUpdate=function(){\x22number\x22==typeof\x20this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=void\x200)},this.AutoUpdate=function(){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol){var\x20t=this,e=MARKET_SUFFIX_NAME.GetMarketStatus(this.Symbol);if(0!=e&&3!=e){var\x20a=this.AutoUpdateFrequency;1==e?this.AutoUpdateTimer=setTimeout(function(){t.AutoUpdate()},a):2==e&&(this.AutoUpdateTimer=setTimeout(function(){t.ResetOverlaySymbolStatus(),t.RequestMinuteData()},a))}}},this.BindIndexData=function(t,e){if(this.WindowIndex[t]){if(\x22function\x22!=typeof\x20this.WindowIndex[t].RequestData)return\x22function\x22==typeof\x20this.WindowIndex[t].ExecuteScript?(debug&&console.log(\x22xxxxxxxxxxxxxxx\x20BindIndexData2\x22,this.ChartPaint.length),void\x20this.WindowIndex[t].ExecuteScript(this,t,e)):void\x20this.WindowIndex[t].BindData(this,t,e);this.WindowIndex[t].RequestData(this,t,e)}},this.BindMainData=function(t,e,a){var\x20i=new\x20ChartData;if(i.Data=t.GetClose(),this.ChartPaint[0].Data=i,this.ChartPaint[0].YClose=e,this.ChartPaint[0].NotSupportMessage=null,this.ChartPaint[0].SourceData=this.IsBeforeData?t:null,this.ChartPaint[0].IsShowLead=!1,this.ChartPaint[0].LeadData=null,MARKET_SUFFIX_NAME.IsSHSZIndex(this.Symbol)&&1==this.DayCount&&this.IsShowLead){var\x20r=new\x20ChartData;r.Data=t.GetLead(),this.ChartPaint[0].LeadData=r,this.ChartPaint[0].IsShowLead=!0}for(var\x20n\x20in\x20this.Frame.SubFrame[0].Frame.YSplitOperator.YClose=e,this.Frame.SubFrame[0].Frame.YSplitOperator.Data=i,this.Frame.Data=this.ChartPaint[0].Data,this.Frame.SourceData=t,this.Frame.SubFrame){(l=this.Frame.SubFrame[n].Frame).Data=t}(i=new\x20ChartData).Data=t.GetMinuteAvPrice(),this.ChartPaint[1].Data=i;var\x20s=this.Symbol.toUpperCase();MARKET_SUFFIX_NAME.IsForeignExchange(s)&&(this.ChartPaint[1].Data=null),this.Frame.SubFrame[0].Frame.YSplitOperator.AverageData=i,this.Frame.SubFrame[0].Frame.YSplitOperator.SourceData=this.IsBeforeData?t:null,this.Frame.SubFrame[0].Frame.YSplitOperator.OverlayChartPaint=this.OverlayChartPaint,this.Frame.SubFrame[0].Frame.YSplitOperator.LimitPrice=this.LimitPrice,a&&(this.Frame.SubFrame[0].Frame.YSplitOperator.High=a.High,this.Frame.SubFrame[0].Frame.YSplitOperator.Low=a.Low),this.ChartPaint[2].Data=t,this.ChartPaint[2].YClose=e,MARKET_SUFFIX_NAME.IsFutures(s)||MARKET_SUFFIX_NAME.IsSHO(s)?this.BindOverlayMainData(t,e):this.ClearBindOverlayMainData(),this.TitlePaint[0].Data=this.SourceData,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.TitlePaint[0].YClose=e,this.ChartCorssCursor&&this.ChartCorssCursor.StringFormatY&&(this.ChartCorssCursor.StringFormatY.YClose=e,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data),this.ExtendChartPaint[0]&&(this.ExtendChartPaint[0].Symbol=this.Symbol,this.ExtendChartPaint[0].Name=this.Name);var\x20o=0,h=this.IsBeforeData;for(var\x20n\x20in\x20this.DayCount>1&&(h=!1),h&&(o=15),this.OverlayChartPaint){var\x20l;(l=this.OverlayChartPaint[n]).MainData=this.ChartPaint[0].Data,l.MainYClose=e,l.BeforeDataCount=o,l.IsBeforeData=h}},this.BindOverlayMainData=function(t,e){if(!(this.Frame.SubFrame.length<2)){var\x20a=null,i=null,r=this.Frame.SubFrame[1];if(r.OverlayIndex.length<=0){var\x20n=new\x20OverlayIndexItem;n.Identify=\x22Position_Line_Frame\x22,(i=new\x20OverlayMinuteFrame).Canvas=this.Canvas,i.MainFrame=r.Frame,i.ChartBorder=r.Frame.ChartBorder,n.Frame=i,i.YSplitOperator=new\x20FrameSplitY,i.YSplitOperator.LanguageID=this.LanguageID,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get(\x22double\x22),i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=i.ChartBorder,i.YSplitOperator.SplitCount=r.Frame.YSplitOperator.SplitCount,(a=new\x20ChartLine).Canvas=this.Canvas,a.Name=\x22Position-Line\x22,a.ChartBorder=i.ChartBorder,a.ChartFrame=i,a.Identify=n.Identify,a.Color=g_JSChartResource.Minute.PositionColor,n.ChartPaint.push(a),r.OverlayIndex.push(n),r.Frame.RightFrame=i}else\x20a=r.OverlayIndex[0].ChartPaint[0],i=r.OverlayIndex[0].Frame;var\x20s=this.Frame.SubFrame[0].Frame.XPointCount;i.XPointCount=s;var\x20o=new\x20ChartData;o.Data=t.GetPosition(),a.Data=o}},this.ClearBindOverlayMainData=function(){if(!(this.Frame.SubFrame.length<2)){var\x20t=this.Frame.SubFrame[1];t.Frame.RightFrame=null,t.OverlayIndex=[]}},this.GetChartPaint=function(t){var\x20e=new\x20Array;for(var\x20a\x20in\x20this.ChartPaint)if(!(a<3)){var\x20i=this.ChartPaint[a];i.ChartFrame==this.Frame.SubFrame[t].Frame&&e.push(i)}return\x20e},this.CreateWindowIndex=function(t){this.WindowIndex[t].Create(this,t)},this.GetIndexInfo=function(){var\x20t=[];for(var\x20e\x20in\x20this.WindowIndex){var\x20a=this.WindowIndex[e],i={Name:a.Name};a.ID&&(i.ID=a.ID),t.push(i)}return\x20t},this.OnTouchFinished=function(){!0!==this.CorssCursorTouchEnd||this.DrawDynamicInfo()},this.CreateExtendChart=function(t,e){var\x20a;switch(t){case\x22MinuteTooltip\x22:return(a=e.Create&&\x22function\x22==typeof\x20e.Create?e.Create():new\x20MinuteTooltipPaint).Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,e.LanguageID=this.LanguageID,a.SetOption(e),this.ExtendChartPaint.push(a),a;default:return\x20null}},this.SetMinuteInfo=function(t,e){for(var\x20a\x20in\x20this.ChartInfo=[],t){var\x20i=JSMinuteInfoMap.Get(t[a]);if(i){var\x20r=i.Create();this.ChartInfo.push(r)}}1==e&&this.RequestMinuteInfoData()},this.GetChartMinuteInfo=function(){return\x20this.ChartInfoPaint},this.CreateMinuteInfo=function(t){var\x20e=new\x20ChartMinuteInfo;return\x20e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.HQChartBorder=this.Frame.ChartBorder,e.ChartMinutePrice=this.ChartPaint[0],t&&e.SetOption&&e.SetOption(t),this.ChartInfoPaint=e,e},this.RequestMinuteInfoData=function(){if(!(this.ChartInfo.length<=0)){var\x20t=this.GetChartMinuteInfo();for(var\x20e\x20in\x20t||(t=this.CreateMinuteInfo(null)),t.SourceData=this.SourceData,this.ChartInfo)this.ChartInfo[e].RequestData(this)}},this.UpdataChartInfo=function(){var\x20t=this.GetChartMinuteInfo();if(t){var\x20e=new\x20Map;for(var\x20a\x20in\x20this.ChartInfo){var\x20i=this.ChartInfo[a].Data;for(var\x20r\x20in\x20i){var\x20n=i[r],s=`${n.Date}\x20${n.Time}`;e.has(s)?e.get(s).Data.push(n):e.set(s,{Data:new\x20Array(n)})}}t.Data=e}},this.UpdateWindowIndex=function(t){if(!(t<2)){var\x20e=this.SourceData;this.BindIndexData(t,e),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.CreateChartDrawPicture=function(t,e,a){var\x20i=null;switch(t){case\x22线段\x22:i=new\x20ChartDrawPictureLine;break;case\x22射线\x22:i=new\x20ChartDrawPictureHaflLine;break;case\x22水平线\x22:i=new\x20ChartDrawPictureHorizontalLine;break;case\x22趋势线\x22:i=new\x20ChartDrawPictureTrendLine;break;case\x22矩形\x22:i=new\x20ChartDrawPictureRect;break;case\x22圆弧线\x22:i=new\x20ChartDrawPictureArc;break;case\x22M头W底\x22:i=new\x20ChartDrawPictureWaveMW;break;default:{const\x20e=new\x20Map([[\x22icon-arrow_up\x22,{Text:\x22\x22,Color:\x22#318757\x22}],[\x22icon-arrow_down\x22,{Text:\x22\x22,Color:\x22#db563e\x22}],[\x22icon-arrow_right\x22,{Text:\x22\x22,Color:\x22#318757\x22}],[\x22icon-arrow_left\x22,{Text:\x22\x22,Color:\x22#318757\x22}]]);if(e.has(t)){var\x20r=e.get(t);(i=new\x20ChartDrawPictureIconFont).FontOption.Family=\x22iconfont\x22,i.Text=r.Text,r.Color&&(i.LineColor=r.Color);break}}return!1}i.Canvas=this.Canvas,i.Status=0,i.Symbol=this.Symbol,i.Period=888888888,i.Option=this.ChartDrawOption,a&&(i.FinishedCallback=a),e&&i.SetOption(e);var\x20n=this;return\x20i.Update=function(){n.DrawDynamicInfo()},this.CurrentChartDrawPicture=i,JSConsole.Chart.Log(\x22[MinuteChartContainer::CreateChartDrawPicture]\x20\x22,t,this.CurrentChartDrawPicture),!0},this.ReloadChartDrawPicture=function(){this.ChartDrawPicture=[],this.ChartDrawStorageCache,this.ChartDrawStorage&&(this.ChartDrawStorageCache=this.ChartDrawStorage.GetDrawData({Symbol:this.Symbol,Period:888888888}))},this.CreateChartDrawPictureByStorage=function(){if(this.ChartDrawStorageCache&&!(this.ChartDrawStorageCache.length<=0)){for(var\x20t\x20in\x20this.ChartDrawStorageCache){var\x20e=this.ChartDrawStorageCache[t];if(!(e.FrameID<0||!this.Frame.SubFrame||this.Frame.SubFrame.length<e.FrameID)){var\x20a=IChartDrawPicture.CreateChartDrawPicture(e);a&&(a.Canvas=this.Canvas,a.Status=10,a.Frame=this.Frame.SubFrame[e.FrameID].Frame,a.UpdateXValue(),a.ValueToPoint(),\x22ChartDrawPictureText\x22===a.ClassName&&(a.IsInitialized=!0),this.ChartDrawPicture.push(a))}}this.ChartDrawStorageCache=null}}}function\x20HistoryMinuteChartContainer(t){this.newMethod=MinuteChartContainer,this.newMethod(t),delete\x20this.newMethod,this.HistoryMinuteApiUrl=\x22https://opensourcecache.zealink.com/cache/minuteday/day/\x22,this.ClassName=\x22HistoryMinuteChartContainer\x22,this.CreateMainKLine=function(){var\x20t,e=new\x20ChartMinutePriceLine;e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.Name=\x22Minute-Line\x22,e.Color=g_JSChartResource.Minute.PriceColor,this.ChartPaint[0]=e,(t=new\x20ChartLine).Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name=\x22Minute-Average-Line\x22,t.Color=g_JSChartResource.Minute.AvPriceColor,this.ChartPaint[1]=t,(t=new\x20ChartMinuteVolumBar).Color=g_JSChartResource.Minute.VolBarColor,t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[1].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[1].Frame,t.Name=\x22Minute-Vol-Bar\x22,this.ChartPaint[2]=t,this.TitlePaint[0]=new\x20DynamicMinuteTitlePainting,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].IsShowDate=!0},this.ChangeTradeDate=function(t){t&&(this.TradeDate=t,this.RequestData())},this.RequestData=function(){var\x20t=new\x20Date;1e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate()==this.TradeDate?this.RequestMinuteData():this.RequestHistoryMinuteData()},this.RequestHistoryMinuteData=function(){var\x20t=this,e=this.HistoryMinuteApiUrl+this.TradeDate.toString()+\x22/\x22+this.Symbol+\x22.json\x22;JSNetwork.HttpRequest({url:e,type:\x22get\x22,dataType:\x22json\x22,async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)},error:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteError(e)}})},this.RecvHistoryMinuteError=function(t){if(404==t.status){var\x20e=new\x20ChartData;for(var\x20a\x20in\x20this.SourceData=e,this.ChartPaint)this.ChartPaint[a].Data=e,0==a&&(this.ChartPaint[a].NotSupportMessage=\x22没有权限访问!\x22);this.TitlePaint[0].Data=this.SourceData,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=null,this.Draw()}},this.RecvHistoryMinuteData=function(t){var\x20e=HistoryMinuteChartContainer.JsonDataToMinuteData(t),a=new\x20ChartData;if(a.Data=e,this.TradeDate=t.date,this.SourceData=a,this.Symbol=t.symbol,this.Name=t.name,this.BindMainData(a,t.day.yclose),this.Frame.SubFrame.length>2){var\x20i=new\x20ChartData;i.Data=e;for(var\x20r=2;r<this.Frame.SubFrame.length;++r)this.BindIndexData(r,i)}this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}}function\x20CustomKLineChartContainer(t){this.newMethod=KLineChartContainer,this.newMethod(t),delete\x20this.newMethod,this.ClassName=\x22CustomKLineChartContainer\x22,this.CustomKLineApiUrl=g_JSChartResource.Domain+\x22/API/IndexCalculate\x22,this.CustomStock,this.QueryDate={Start:20180101,End:20180627},this.RequestHistoryData=function(){var\x20t=this;this.ChartSplashPaint.EnableSplash(!0),this.Draw(),JSNetwork.HttpRequest({url:this.CustomKLineApiUrl,data:{stock:t.CustomStock,Name:t.Symbol,date:{startdate:t.QueryDate.Start,enddate:t.QueryDate.End}},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryData(e)}})},this.RecvHistoryData=function(t){var\x20e=KLineChartContainer.JsonDataToHistoryData(t),a=new\x20ChartData;a.Data=e,a.DataType=0;var\x20i=new\x20ChartData;if(i.Data=e,i.Right=this.Right,i.Period=this.Period,i.DataType=0,i.Right>0){var\x20r=i.GetRightDate(i.Right);i.Data=r}if(ChartData.IsDayPeriod(this.Period,!1)){var\x20n=a.GetPeriodData(i.Period);i.Data=n}this.SourceData=a,this.Name=t.name,this.BindMainData(i,this.PageSize);for(var\x20s=0;s<this.Frame.SubFrame.length;++s)this.BindIndexData(s,i);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}}function\x20KLineTrainChartContainer(t,e){!0===e?(this.newMethod=KLineChartHScreenContainer,this.newMethod(t),delete\x20this.newMethod):(this.newMethod=KLineChartContainer,this.newMethod(t),delete\x20this.newMethod),this.BuySellPaint,this.TrainDataCount=300,this.TrainStartDate,this.AutoRunTimer=null,this.BuySellData=[],this.TrainCallback,this.DragMode=1,this.IsAutoUpdate=!1,this.KLineSourceData,this.TrainInfo={Start:{},End:{}},this.CreateBuySellPaint=function(){var\x20t=new\x20ChartBuySell;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name=\x22KLine-Train-BuySell\x22,this.ChartPaintEx[0]=t},this.GetKDataIndexByDateTime=function(t,e){if(!e||!t)return-1;for(var\x20a\x20in\x20t){var\x20i=t[a];if(ChartData.IsMinutePeriod(this.Period,!0)){if(IFrameSplitOperator.IsNumber(this.TrainStartDate.Time)){if(i.Date>=this.TrainStartDate.Date&&i.Time>=this.TrainStartDate.Time)return\x20parseInt(a)}else\x20if(i.Date>=this.TrainStartDate.Date)return\x20parseInt(a)}else\x20if((ChartData.IsDayPeriod(this.Period,!0)||ChartData.IsTickPeriod(this.Period))&&i.Date>=this.TrainStartDate.Date)return\x20parseInt(a)}return-1},this.AfterBindMainData=function(t){this.ChartPaintEx[0]||this.CreateBuySellPaint();var\x20e=this.ChartPaint[0].Data;this.ChartPaintEx[0].Data=e;var\x20a=e.Data[e.Data.length-1];this.TrainInfo.LastShowData=a,this.TrainInfo.LastData=this.SourceData.Data[this.SourceData.Data.length-1],\x22Update\x22!=t&&this.UpdateTrainUICallback(\x22开始\x22)},this.BeforeBindMainData=function(t){if(\x22Update\x22!=t){this.KLineSourceData=new\x20ChartData,this.KLineSourceData.Data=this.SourceData.Data.slice(0);var\x20e=this.SourceData.Data.length,a=e-this.TrainDataCount-20,i=this.GetKDataIndexByDateTime(this.SourceData.Data,this.TrainStartDate);i>=0&&e-(a=i+1)<this.TrainDataCount&&(this.TrainDataCount=e-a);var\x20r=a-1,n=this.SourceData.Data[r];this.TrainInfo.Start.Index=r,this.TrainInfo.Start.Date=n.Date,this.TrainInfo.Start.Time=n.Time,this.TrainInfo.End.Index=r,this.TrainInfo.End.Date=n.Date,this.TrainInfo.End.Time=n.Time,this.TrainInfo.LastData=n,this.SourceData.Data.length=a}},this.Run=function(t){if(!(this.AutoRunTimer||this.TrainDataCount<=0)){var\x20e=this;this.AutoRunTimer=setInterval(function(){e.MoveNextKLineData(t)||clearInterval(e.AutoRunTimer)},1e3)}},this.MoveNextKLineData=function(t){if(this.TrainDataCount<=0)return!1;var\x20e=1;t&&t.Step>1&&(e=t.Step);for(var\x20a=0,i=0;i<e;++i){var\x20r=this.TrainInfo.End.Index+1;if(r>=this.KLineSourceData.Data.length)break;var\x20n=this.KLineSourceData.Data[r];if(this.SourceData.Data.push(n),this.TrainInfo.End.Index=r,this.TrainInfo.End.Date=n.Date,this.TrainInfo.End.Time=n.Time,--this.TrainDataCount,++a,this.TrainDataCount<=0)break}if(0==a)return!1;var\x20s=this.Frame.GetCurrentPageSize();return\x20IFrameSplitOperator.IsNumber(s)&&(this.PageSize=s-this.RightSpaceCount),t&&t.PageSize>0&&(this.PageSize=t.PageSize),this.Update(),this.TrainDataCount<=0?(this.FinishTrainData(),this.UpdateTrainUICallback(\x22结束\x22),!1):(this.UpdateTrainUICallback(\x22训练中\x22),!0)},this.UpdateTrainUICallback=function(t){if(this.mapEvent.has(JSCHART_EVENT_ID.RECV_TRAIN_MOVE_STEP)){var\x20e=this.mapEvent.get(JSCHART_EVENT_ID.RECV_TRAIN_MOVE_STEP);if(e.Callback){var\x20a={TrainDataCount:this.TrainDataCount,BuySellData:this.BuySellData,KLine:{Start:{Index:this.TrainInfo.Start.Index,Date:this.TrainInfo.Start.Date},End:{Index:this.TrainInfo.End.Index,Date:this.TrainInfo.End.Date}},LastData:this.TrainInfo.LastData,LastShowData:this.TrainInfo.LastShowData};IFrameSplitOperator.IsNumber(this.TrainInfo.Start.Time)&&(a.KLine.Start.Time=this.TrainInfo.Start.Time),IFrameSplitOperator.IsNumber(this.TrainInfo.End.Time)&&(a.KLine.End.Time=this.TrainInfo.End.Time),t&&(a.Description=t),this.TrainDataCount<=0&&(a.Symbol=this.Symbol,a.Name=this.Name),e.Callback(e,a,this)}}},this.FinishTrainData=function(){JSConsole.Chart.Log(\x22[KLineTrainChartContainer::FinishTrainData]\x20trian\x20end\x20\x22)},this.Stop=function(){null!=this.AutoRunTimer&&clearInterval(this.AutoRunTimer),this.AutoRunTimer=null},this.BuyOrSell=function(t,e){if(!this.TrainInfo.LastShowData)return!1;var\x20a=this.ChartPaintEx[0];if(!a)return!1;var\x20i=this.ChartPaint[0].Data;if(!i||i.Data.length<=0)return!1;var\x20r=i.Data.length-1,n={Date:this.TrainInfo.End.Date,Time:this.TrainInfo.End.Time,Price:t.Price,Vol:t.Vol,Op:0,ID:t.ID};1==t.Op&&(n.Op=1);var\x20s=r;n.Key=s,this.BuySellData.push(n),a.AddTradeItem(n),1==e&&this.Draw()},this.RestartTrain=function(t){JSConsole.Chart.Log(\x22[KLineTrainChartContainer::RestartTrain]\x20option\x20\x22,t),this.TrainInfo={Start:{},End:{}},this.BuySellData=[],this.KLineSourceData=null;var\x20e=this.ChartPaintEx[0];e&&(e.Data=null,e.ClearTradeData()),t.Symbol&&(this.Symbol=t.Symbol),IFrameSplitOperator.IsNumber(t.Period)&&(this.Period=t.Period),IFrameSplitOperator.IsNumber(t.Right)&&(this.Right=t.Right),t.Train&&(t.Train.DataCount>1&&(this.TrainDataCount=t.Train.DataCount),t.Train.DateTime&&(this.TrainStartDate=t.Train.DateTime));var\x20a=this.Symbol;this.ChangeSymbol(a)},this.RecvFlowCapitalData=function(t){if(!t.stock||1!=t.stock.length)return;let\x20e=t.stock[0];var\x20a=new\x20Array;for(var\x20i\x20in\x20e.stockday){var\x20r=e.stockday[i];let\x20t=new\x20SingleData;t.Date=r.date;var\x20n=r.capital;n&&(n.a>0&&(t.Value=n.a,a.push(t)))}if(ChartData.IsMinutePeriod(this.Period,!0)){var\x20s=this.SourceData.GetMinuteFittingFinanceData(a);for(var\x20i\x20in\x20this.SourceData.Data){(r=this.SourceData.Data[i]).FlowCapital=s[i].Value}var\x20o=this.ChartPaint[0].Data;if((l=new\x20ChartData).Data=this.SourceData.Data,ChartData.IsMinutePeriod(o.Period,!1)){var\x20h=l.GetPeriodData(o.Period);l.Data=h}o.Data=l.Data;s=this.KLineSourceData.GetMinuteFittingFinanceData(a);for(var\x20i\x20in\x20this.KLineSourceData.Data){(r=this.KLineSourceData.Data[i]).FlowCapital=s[i].Value}}else{s=this.SourceData.GetFittingFinanceData(a);for(var\x20i\x20in\x20this.SourceData.Data){(r=this.SourceData.Data[i]).FlowCapital=s[i].Value}var\x20l;o=this.ChartPaint[0].Data;if((l=new\x20ChartData).Data=this.SourceData.Data,o.Right>0){var\x20C=l.GetRightDate(o.Right);l.Data=C}if(ChartData.IsDayPeriod(o.Period,!1)){h=l.GetPeriodData(o.Period);l.Data=h}o.Data=l.Data;s=this.KLineSourceData.GetFittingFinanceData(a);for(var\x20i\x20in\x20this.KLineSourceData.Data){(r=this.KLineSourceData.Data[i]).FlowCapital=s[i].Value}}this.FlowCapitalReady=!0;var\x20u=!1;for(var\x20i\x20in\x20this.ExtendChartPaint){if(\x22StockChip\x22==(r=this.ExtendChartPaint[i]).ClassName){u=!0;break}}u&&this.Draw()},this.AutoUpdate()}function\x20KLineChartHScreenContainer(t){this.newMethod=KLineChartContainer,this.newMethod(t),delete\x20this.newMethod,this.ClassName=\x22KLineChartHScreenContainer\x22,this.OnMouseMove=function(t,e,a){this.LastPoint.X=t,this.LastPoint.Y=e,this.CursorIndex=this.Frame.GetXData(e),this.DrawDynamicInfo()},t.onmousedown=function(e){if(this.JSChartContainer&&0!=this.JSChartContainer.DragMode){var\x20a=GetDevicePixelRatio();if(this.JSChartContainer.TryClickLock){var\x20i=(e.clientX-this.getBoundingClientRect().left)*a,r=(e.clientY-this.getBoundingClientRect().top)*a;if(this.JSChartContainer.TryClickLock(i,r))return}var\x20n={Click:{},LastMove:{}};n.Click.X=e.clientX,n.Click.Y=e.clientY,n.LastMove.X=e.clientX,n.LastMove.Y=e.clientY,this.JSChartContainer.MouseDrag=n,document.JSChartContainer=this.JSChartContainer,this.JSChartContainer.SelectChartDrawPicture=null,t.ondblclick=function(t){var\x20e=t.clientX-this.getBoundingClientRect().left,a=t.clientY-this.getBoundingClientRect().top;this.JSChartContainer&&this.JSChartContainer.OnDoubleClick(e,a,t)},document.onmousemove=function(t){if(this.JSChartContainer&&(!this.JSChartContainer.ChartSplashPaint||1!=this.JSChartContainer.ChartSplashPaint.IsEnableSplash)){var\x20e=this.JSChartContainer.MouseDrag;if(e){var\x20a=Math.abs(e.LastMove.Y-t.clientY);if(1==this.JSChartContainer.DragMode){if(a<5)return;var\x20i=!0;e.LastMove.Y<t.clientY&&(i=!1),this.JSChartContainer.DataMove(a,i)&&(this.JSChartContainer.UpdataDataoffset(),this.JSChartContainer.UpdatePointByCursorIndex(),this.JSChartContainer.UpdateFrameMaxMin(),this.JSChartContainer.ResetFrameXYSplit(),this.JSChartContainer.Draw()),e.LastMove.X=t.clientX,e.LastMove.Y=t.clientY}}}},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null,this.JSChartContainer.MouseDrag=null,this.JSChartContainer.CurrentChartDrawPicture=null,this.JSChartContainer=null}}},this.OnTouchStart=function(e){this.PhonePinch=null,this.IsOnTouch=!0,this.TouchDrawCount=0,this.StopDragTimer();var\x20a=this.IsSingleTouch(e);if(e.cancelable&&e.preventDefault(),this.IsPhoneDragging(e)){if(this.TryClickLock||this.TryClickIndexTitle){var\x20i=(h=this.GetToucheData(e,this.IsForceLandscape))[0].clientX,r=h[0].clientY,n=GetDevicePixelRatio();if(i-=t.getBoundingClientRect().left*n,r-=t.getBoundingClientRect().top*n,this.TryClickLock&&this.TryClickLock(i,r))return;if(this.TryClickIndexTitle&&this.TryClickIndexTitle(i,r))return}var\x20s=!0;this.ChartDrawOption.IsLockScreen?s=!1:this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID?1==this.TouchStatus.CorssCursorShow&&(s=!1):this.DragMode==JSCHART_DRAG_ID.DISABLE_DRAG_ID?s=!1:a||(s=!1);var\x20o={Click:{},LastMove:{}},h=this.GetToucheData(e,!1);if(o.Click.X=h[0].clientX,o.Click.Y=h[0].clientY,o.LastMove.X=h[0].clientX,o.LastMove.Y=h[0].clientY,this.MouseDrag=o,this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.IsSelected=!1),this.SelectChartDrawPicture=null,this.CurrentChartDrawPicture)return\x202==this.CurrentChartDrawPicture.Status?this.SetChartDrawPictureThirdPoint(o.Click.X,o.Click.Y,!0):(this.SetChartDrawPictureFirstPoint(o.Click.X,o.Click.Y,!0),this.FinishChartDrawPicturePoint()&&this.DrawDynamicInfo({Corss:!1,Tooltip:!1})),void(e.cancelable&&e.preventDefault());var\x20l={};n=GetDevicePixelRatio();if(l.X=h[0].clientX-t.getBoundingClientRect().left,l.Y=h[0].clientY-t.getBoundingClientRect().top,this.GetChartDrawPictureByPoint(l)){l.ChartDrawPicture.Status=20,l.ChartDrawPicture.ValueToPoint(),l.ChartDrawPicture.MovePointIndex=l.PointIndex,l.ChartDrawPicture.IsSelected=!0,this.CurrentChartDrawPicture=l.ChartDrawPicture,this.SelectChartDrawPicture=l.ChartDrawPicture;let\x20t=this.GetEventCallback(JSCHART_EVENT_ID.ON_CLICK_DRAWPICTURE);if(t&&t.Callback){let\x20e={DrawPicture:l.ChartDrawPicture};t.Callback(t,e,this)}return\x20void(e.cancelable&&e.preventDefault())}if(s){var\x20C=this;this.DragTimer=setTimeout(function(){if(o.Click.X==o.LastMove.X&&o.Click.Y==o.LastMove.Y){C.MouseDrag;C.MouseDrag=null,C.MoveCorssCursor(o.Click,e)}},C.PressTime)}this.ChartDrawOption.IsLockScreen?this.MouseDrag=null:this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID||(this.DragMode==JSCHART_DRAG_ID.DISABLE_DRAG_ID?(this.MouseDrag=null,this.MoveCorssCursor(o.Click,e)):this.IsClickShowCorssCursor&&this.MoveCorssCursor(o.Click,e))}else\x20if(this.IsPhonePinching(e)){var\x20u={Start:{},Last:{}};h=this.GetToucheData(e,!1);u.Start={X:h[0].pageX,Y:h[0].pageY,X2:h[1].pageX,Y2:h[1].pageY},u.Last={X:h[0].pageX,Y:h[0].pageY,X2:h[1].pageX,Y2:h[1].pageY},this.PhonePinch=u,this.SelectChartDrawPicture=null}},this.OnTouchMove=function(t){t.cancelable&&t.preventDefault();var\x20e=this.GetToucheData(t,!1);if(this.IsPhoneDragging(t)){var\x20a=this.MouseDrag;if(null==a)this.ChartDrawOption.IsLockScreen||this.MoveCorssCursor({X:e[0].clientX,Y:e[0].clientY},t);else{var\x20i=Math.abs(a.LastMove.Y-e[0].clientY),r=Math.abs(a.LastMove.X-e[0].clientX),n=this.DragMode==JSCHART_DRAG_ID.CLICK_TOUCH_MODE_ID&&1==this.TouchStatus.CorssCursorShow;if(this.CurrentChartDrawPicture){var\x20s=this.CurrentChartDrawPicture;if(1==s.Status||2==s.Status){if(i<5&&r<5)return;this.SetChartDrawPictureSecondPoint(e[0].clientX,e[0].clientY,!0)&&this.DrawDynamicInfo()}else\x20if(3==s.Status)this.SetChartDrawPictureThirdPoint(e[0].clientX,e[0].clientY,!0)&&this.DrawDynamicInfo();else\x20if(20==s.Status){if(i<5&&r<5)return;this.MoveChartDrawPicture(e[0].clientX-a.LastMove.X,e[0].clientY-a.LastMove.Y,!0)&&this.DrawDynamicInfo()}a.LastMove.X=e[0].clientX,a.LastMove.Y=e[0].clientY}if(n){this.MouseDrag;this.MouseDrag=null,this.MoveCorssCursor(a.Click,t)}else\x20if(1==this.DragMode||0==n){if(i<5)return;var\x20o=!0;a.LastMove.Y<e[0].clientY&&(o=!1),this.DataMove(i,o)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()):this.DragDownloadData&&this.DragDownloadData(),a.LastMove.X=e[0].clientX,a.LastMove.Y=e[0].clientY}}}else\x20if(this.IsPhonePinching(t)){if(this.DragMode==JSCHART_DRAG_ID.DISABLE_DRAG_ID)return;var\x20h=this.PhonePinch;if(!h)return;var\x20l=Math.abs(e[0].pageX-e[1].pageX)-Math.abs(h.Last.X-h.Last.X2);if(Math.abs(l)<5)return;if(l>0){if((C={}).Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomUp(C))return;this.CursorIndex=C.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown()}else{var\x20C;if((C={}).Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomDown(C))return;this.CursorIndex=C.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown()}h.Last={X:e[0].pageX,Y:e[0].pageY,X2:e[1].pageX,Y2:e[1].pageY}}},this.OnTouchEnd=function(t){JSConsole.Chart.Log(\x22[KLineChartHScreenContainer:OnTouchEnd]\x22,t);if(this.CurrentChartDrawPicture){var\x20e=this.CurrentChartDrawPicture;2==e.Status||1==e.Status||3==e.Status?(e.PointStatus=e.Status,this.FinishChartDrawPicturePoint()?this.DrawDynamicInfo():!1):20==e.Status&&this.FinishMoveChartDrawPicture()&&this.DrawDynamicInfo()}this.IsOnTouch=!1,this.StopDragTimer(),this.OnTouchFinished(),this.TouchDrawCount=0},this.Create=function(t){for(var\x20e\x20in\x20this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new\x20ChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=g_DivTooltipDataForamt.Create(\x22CorssCursor_XStringFormat\x22),this.ChartCorssCursor.StringFormatY=g_DivTooltipDataForamt.Create(\x22CorssCursor_YStringFormat\x22),this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY.ExtendChartPaint=this.ExtendChartPaint,this.ChartSplashPaint=new\x20ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new\x20HQTradeHScreenFrame,this.Frame.ChartBorder=new\x20ChartBorder,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var\x20a=new\x20DynamicChartTitlePainting;a.Frame=this.Frame.SubFrame[e].Frame,a.Canvas=this.Canvas,a.LanguageID=this.LanguageID,this.TitlePaint.push(a)}this.UIElement.addEventListener(\x22keydown\x22,OnKeyDown,!0)},this.CreateChildWindow=function(t){for(var\x20e=0;e<t;++e){var\x20a=new\x20ChartBorder;a.UIElement=this.UIElement;var\x20i=new\x20KLineHScreenFrame;if(i.Canvas=this.Canvas,i.ChartBorder=a,i.Identify=e,i.RightSpaceCount=this.RightSpaceCount,this.ModifyIndexDialog&&(i.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(i.ChangeIndexEvent=this.ChangeIndexDialog.DoModal),i.HorizontalMax=20,i.HorizontalMin=10,0==e){i.YSplitOperator=new\x20FrameSplitKLinePriceY,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get(\x22price\x22);var\x20r=GetDevicePixelRatio();a.TopSpace=12*r,a.BottomSpace=12*r}else\x20i.YSplitOperator=new\x20FrameSplitY,i.YSplitOperator.LanguageID=this.LanguageID,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get(\x22double\x22);i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=a,i.XSplitOperator=new\x20FrameSplitKLineX,i.XSplitOperator.Frame=i,i.XSplitOperator.ChartBorder=a,e!=t-1&&(i.XSplitOperator.ShowText=!1);for(var\x20n=i.HorizontalMin;n<=i.HorizontalMax;n+=1)i.HorizontalInfo[n]=new\x20CoordinateInfo,i.HorizontalInfo[n].Value=n,0==e&&n==i.HorizontalMin||(i.HorizontalInfo[n].Message[1]=n.toString(),i.HorizontalInfo[n].Font=\x2214px\x20微软雅黑\x22);var\x20s=new\x20SubFrameItem;s.Frame=i,s.Height=0==e?20:10,this.Frame.SubFrame[e]=s}}}function\x20MinuteChartHScreenContainer(t){this.newMethod=MinuteChartContainer,this.newMethod(t),delete\x20this.newMethod,this.ClassName=\x22MinuteChartHScreenContainer\x22,this.OnMouseMove=function(t,e,a){this.LastPoint.X=t,this.LastPoint.Y=e,this.CursorIndex=this.Frame.GetXData(e),this.DrawDynamicInfo()},this.Create=function(t){for(var\x20e\x20in\x20this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new\x20ChartCorssCursor,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=new\x20HQMinuteTimeStringFormat,this.ChartCorssCursor.StringFormatY=new\x20HQPriceStringFormat,this.ChartSplashPaint=new\x20ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new\x20HQTradeHScreenFrame,this.Frame.ChartBorder=new\x20ChartBorder,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=25,this.Frame.ChartBorder.Left=50,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var\x20a=new\x20DynamicChartTitlePainting;a.Frame=this.Frame.SubFrame[e].Frame,a.Canvas=this.Canvas,a.LanguageID=this.LanguageID,this.TitlePaint.push(a)}this.ChartCorssCursor.StringFormatX.Frame=this.Frame.SubFrame[0].Frame,this.UIElement.addEventListener(\x22keydown\x22,OnKeyDown,!0)},this.CreateChildWindow=function(t){for(var\x20e=0;e<t;++e){var\x20a=new\x20ChartBorder;a.UIElement=this.UIElement;var\x20i=new\x20MinuteHScreenFrame;i.Canvas=this.Canvas,i.ChartBorder=a,i.Identify=e,e<2&&(i.ChartBorder.TitleHeight=0),i.XPointCount=243;var\x20r=[9,8,7,6,5,4,3,2,1];for(var\x20n\x20in\x20i.HorizontalMax=r[0],i.HorizontalMin=r[r.length-1],0==e?(i.YSplitOperator=new\x20FrameSplitMinutePriceY,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get(\x22price\x22)):(i.YSplitOperator=new\x20FrameSplitY,i.YSplitOperator.LanguageID=this.LanguageID,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get(\x22double\x22)),i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=a,i.XSplitOperator=new\x20FrameSplitMinuteX,i.XSplitOperator.Frame=i,i.XSplitOperator.ChartBorder=a,e!=t-1&&(i.XSplitOperator.ShowText=!1),i.XSplitOperator.Operator(),r)i.HorizontalInfo[n]=new\x20CoordinateInfo,i.HorizontalInfo[n].Value=r[n],0==e&&n==i.HorizontalMin||(i.HorizontalInfo[n].Message[1]=r[n].toString(),i.HorizontalInfo[n].Font=\x2214px\x20微软雅黑\x22);var\x20s=new\x20SubFrameItem;s.Frame=i,s.Height=0==e?20:10,this.Frame.SubFrame[e]=s}}}function\x20SimlpleChartContainer(t){this.newMethod=JSChartContainer,this.newMethod(t),delete\x20this.newMethod,this.MainDataControl,this.Create=function(){this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new\x20ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.Frame=new\x20SimpleChartFrame,this.Frame.ChartBorder=new\x20ChartBorder,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor&&(this.ChartCorssCursor.Frame=this.Frame),this.ChartSplashPaint.Frame=this.Frame,this.CreateMainChart(),this.UIElement.addEventListener(\x22keydown\x22,OnKeyDown,!0)},this.SetMainDataConotrl=function(t){t&&(this.MainDataControl=t,this.ChartPaint=[],this.CreateMainChart(),this.Draw(),this.RequestData())},this.CreateMainChart=function(){if(this.MainDataControl){for(var\x20t\x20in\x20this.MainDataControl.DataType){let\x20a=this.MainDataControl.DataType[t];if(\x22BAR\x22==a.Type)(e=new\x20ChartBar).Canvas=this.Canvas,e.ChartBorder=this.Frame.ChartBorder,e.ChartFrame=this.Frame,e.Name=a.Name,a.Color&&(e.UpBarColor=a.Color),a.Color2&&(e.DownBarColor=a.Color2),this.ChartPaint.push(e);else\x20if(\x22LINE\x22==a.Type){var\x20e;(e=new\x20ChartLine).Canvas=this.Canvas,e.ChartBorder=this.Frame.ChartBorder,e.ChartFrame=this.Frame,e.Name=a.Name,a.Color&&(e.Color=a.Color),this.ChartPaint.push(e)}}this.Frame.YSplitOperator=new\x20FrameSplitY,this.Frame.YSplitOperator.FrameSplitData=this.FrameSplitData.get(\x22double\x22),this.Frame.YSplitOperator.Frame=this.Frame,this.Frame.YSplitOperator.ChartBorder=this.Frame.ChartBorder,this.Frame.XSplitOperator=new\x20FrameSplitXData,this.Frame.XSplitOperator.Frame=this.Frame,this.Frame.XSplitOperator.ChartBorder=this.Frame.ChartBorder}},this.RequestData=function(){this.MainDataControl&&(this.MainDataControl.JSChartContainer=this,this.MainDataControl.RequestData())},this.UpdateMainData=function(t){let\x20e=0;for(var\x20a\x20in\x20t.Data){let\x20i=new\x20ChartData;i.Data=t.Data[a],this.ChartPaint[a].Data=i,e<i.Data.length&&(e=i.Data.length)}this.Frame.XPointCount=e,this.Frame.Data=this.ChartPaint[0].Data,this.Frame.XData=t.XData,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}}function\x20PieChartContainer(t){this.Radius,this.newMethod=JSChartContainer,this.newMethod(t),delete\x20this.newMethod,this.MainDataControl,this.OnMouseMove=function(t,e,a){},this.Create=function(){this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new\x20ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.Frame=new\x20NoneFrame,this.Frame.ChartBorder=new\x20ChartBorder,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartSplashPaint.Frame=this.Frame,this.CreateMainChart()},this.SetMainDataConotrl=function(t){t&&(this.MainDataControl=t,this.ChartPaint=[],this.CreateMainChart(),this.Draw(),this.RequestData())},this.CreateMainChart=function(){if(this.MainDataControl)for(var\x20t\x20in\x20this.MainDataControl.DataType){let\x20a=this.MainDataControl.DataType[t];if(\x22PIE\x22==a.Type)(e=new\x20ChartPie).Canvas=this.Canvas,e.ChartBorder=this.Frame.ChartBorder,e.ChartFrame=this.Frame,e.Name=a.Name,this.Radius&&(e.Radius=this.Radius),this.ChartPaint.push(e);else\x20if(\x22RADAR\x22==a.Type){var\x20e;(e=new\x20ChartRadar).Canvas=this.Canvas,e.ChartBorder=this.Frame.ChartBorder,e.ChartFrame=this.Frame,e.Name=a.Name,a.StartAngle&&(e.StartAngle=a.StartAngle),this.ChartPaint.push(e)}}},this.RequestData=function(){this.MainDataControl&&(this.MainDataControl.JSChartContainer=this,this.MainDataControl.RequestData())},this.UpdateMainData=function(t){for(var\x20e\x20in\x20t.Data){let\x20a=new\x20ChartData;a.Data=t.Data[e],this.ChartPaint[e].Data=a}this.Frame.SetSizeChage(!0),this.Draw()}}function\x20MapChartContainer(t){this.newMethod=JSChartContainer,this.newMethod(t),delete\x20this.newMethod,this.MainDataControl,this.OnMouseMove=function(t,e,a){},this.Create=function(){this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new\x20ChartSplashPaint,this.ChartSplashPaint.Canvas=this.Canvas,this.Frame=new\x20NoneFrame,this.Frame.ChartBorder=new\x20ChartBorder,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartSplashPaint.Frame=this.Frame,this.CreateMainChart()},this.SetMainDataConotrl=function(t){t&&(this.MainDataControl=t,this.ChartPaint=[],this.CreateMainChart(),this.Draw(),this.RequestData())},this.CreateMainChart=function(){if(!this.MainDataControl)return;let\x20t=new\x20ChartChinaMap;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.ChartBorder,t.ChartFrame=this.Frame,t.Name=this.MainDataControl.DataType[0].Name,this.Radius&&(t.Radius=this.Radius),this.ChartPaint.push(t)},this.RequestData=function(){this.MainDataControl&&(this.MainDataControl.JSChartContainer=this,this.MainDataControl.RequestData())},this.UpdateMainData=function(t){this.ChartPaint[0].Data=t.Data[0],this.Frame.SetSizeChage(!0),this.Draw()}}function\x20IndexInfo(t,e){this.Name=t,this.Param=e,this.LineColor,this.ReqeustData=null}function\x20BaseIndex(t){this.Index,this.Name=t,this.Script=null,this.OverlayIndex=null,this.Create=function(t,e){},this.NotSupport=function(t,e,a){if(!this.IsOverlay()){t.DeleteIndexPaint(e);var\x20i=t.Frame.SubFrame[e].Frame,r=new\x20ChartErrorMessage;r.Canvas=t.Canvas,r.ChartBorder=i.ChartBorder,r.ChartFrame=i,r.NotSupportMessage=a,t.ChartPaint.push(r)}},this.FormatIndexTitle=function(){var\x20t=this.Name,e=null;for(var\x20a\x20in\x20this.Index){var\x20i=this.Index[a];null!=i.Param&&(e?e+=\x22,\x22+i.Param.toString():e=i.Param.toString())}return\x20e&&(t+=\x22(\x22+e+\x22)\x22),t},this.IsOverlay=function(){return!(!this.OverlayIndex||1!=this.OverlayIndex.IsOverlay)},this.CreateChart=function(t){return\x20new\x20ChartLine},this.CreatePaints=function(t,e){var\x20a=null,i=this.IsOverlay();i?(a=this.OverlayIndex.Frame.Frame,this.OverlayIndex.Frame.ChartPaint=[]):(a=t.Frame.SubFrame[e].Frame,t.DeleteIndexPaint(e));var\x20r=[];for(var\x20n\x20in\x20this.Index){var\x20s=this.CreateChart(n);s.Color=this.Index[n].LineColor,s.Canvas=t.Canvas,s.Name=this.Name+\x22-\x22+n.toString(),s.ChartBorder=a.ChartBorder,s.ChartFrame=a,i?this.OverlayIndex.Frame.ChartPaint.push(s):t.ChartPaint.push(s),r.push(s)}return\x20r},this.SendEvent=function(t,e,a,i){if(t.GetIndexEvent){var\x20r=t.GetIndexEvent();if(r){var\x20n={Data:this.GetOutData(),WindowIndex:e,Name:this.Name,HistoryData:a,Stock:{Symbol:t.Symbol,Name:t.Name}};i&&(n.Error=i),r.Callback(r,n,self)}}},this.GetOutData=function(){return\x20null}}function\x20JSIndex_CJL(){this.newMethod=BaseIndex,this.newMethod(\x22CJL\x22),delete\x20this.newMethod,this.Index=new\x20Array(new\x20IndexInfo(\x22VOL\x22,null),new\x20IndexInfo(\x22OPID\x22,null)),this.Index[0].LineColor=g_JSChartResource.Index.LineColor[0],this.Index[1].LineColor=g_JSChartResource.Index.LineColor[1],this.CreateChart=function(t){var\x20e;return\x200==t?e=new\x20ChartVolStick:1==t?((e=new\x20ChartSubLine).LineWidth=1*GetDevicePixelRatio(),e):void\x200},this.RequestData=function(t,e,a){return\x20this.BindData(t,e,a),t.UpdataDataoffset(),t.UpdateFrameMaxMin(),t.Draw(),!0},this.BindData=function(t,e,a){var\x20i=this.CreatePaints(t,e),r=this.IsOverlay();if(i.length!=this.Index.length)return!1;var\x20n=a.GetVol(),s=a.GetPosition();i[0].HistoryData=a,i[0].Data.Data=n,i[1].Data.Data=s;var\x20o=e+1;if(r){var\x20h=t.TitlePaint[o];for(var\x20l\x20in\x20h.OverlayIndex.set(this.OverlayIndex.Identify,{Data:[],Title:\x22\x22}),i){var\x20C=new\x20DynamicTitleData(i[l].Data,this.Index[l].Name,this.Index[l].LineColor);h.OverlayIndex.get(this.OverlayIndex.Identify).Data[l]=C}}else\x20t.TitlePaint[o].Data[0]=new\x20DynamicTitleData(i[0].Data,this.Index[0].Name,this.Index[0].LineColor),t.TitlePaint[o].Data[1]=new\x20DynamicTitleData(i[1].Data,this.Index[1].Name,this.Index[1].LineColor),t.TitlePaint[o].Title=this.Name;return!0}}function\x20MarketLongShortIndex(){this.newMethod=BaseIndex,this.newMethod(\x22Long-Short\x22),delete\x20this.newMethod,this.Index=new\x20Array(new\x20IndexInfo(\x22多头区域\x22,null),new\x20IndexInfo(\x22空头区域\x22,null),new\x20IndexInfo(\x22市场多空指标\x22,null)),this.Index[0].LineColor=g_JSChartResource.UpBarColor,this.Index[1].LineColor=g_JSChartResource.DownBarColor,this.Index[2].LineColor=g_JSChartResource.Index.LineColor[0],this.LongShortData,this.CreateChart=function(t){if(2==t){var\x20e=new\x20ChartLine;return\x20e.LineWidth=2,e}return\x20new\x20ChartStraightLine},this.GetOutData=function(){return{LongShortData:this.LongShortData}},this.RequestData=function(t,e,a){var\x20i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return\x20this.LongShortData=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,\x22不支持周期切换\x22),r.HQChart.Draw(),this.SendEvent(t,e,a,\x22不支持周期切换\x22),!1):(JSNetwork.HttpRequest({url:g_JSChartResource.Index.MarketLongShortApiUrl,data:{},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(n){i.RecvData(n,r),i.SendEvent(t,e,a)}}),!0)},this.RecvData=function(t,e){if(!(t.data.length<=0)){var\x20a=new\x20Array;for(var\x20i\x20in\x20t.data){var\x20r=t.data[i],n=new\x20SingleData;n.Date=r[0],n.Value=r[1],a.push(n)}var\x20s=e.HistoryData.GetFittingData(a),o=new\x20ChartData;o.Data=s,o.Period=e.HQChart.Period,o.Right=e.HQChart.Right,this.LongShortData=o.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var\x20i=this.CreatePaints(t,e),r=this.IsOverlay();if(i.length!=this.Index.length)return!1;i[2].Data.Data=this.LongShortData,i[0].Data.Data[0]=8,i[1].Data.Data[0]=1;var\x20n=e+1;if(r){this.OverlayIndex.Frame.Frame.YSpecificMaxMin={Max:9,Min:0,Count:3};var\x20s=t.TitlePaint[n];for(var\x20o\x20in\x20s.OverlayIndex.set(this.OverlayIndex.Identify,{Data:[],Title:\x22\x22}),i){var\x20h=new\x20DynamicTitleData(i[o].Data,this.Index[o].Name,this.Index[o].LineColor);2!=o&&(h.DataType=\x22StraightLine\x22),s.OverlayIndex.get(this.OverlayIndex.Identify).Data[o]=h}}else\x20for(var\x20o\x20in\x20t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:9,Min:0,Count:3},i)t.TitlePaint[n].Data[o]=new\x20DynamicTitleData(i[o].Data,this.Index[o].Name,this.Index[o].LineColor),2!=o&&(t.TitlePaint[n].Data[o].DataType=\x22StraightLine\x22);return!0}}function\x20MarketTimingIndex(){this.newMethod=BaseIndex,this.newMethod(\x22Market-Timing\x22),delete\x20this.newMethod,this.Index=new\x20Array(new\x20IndexInfo(\x22因子择时\x22,null)),this.TimingData,this.TitleColor=g_JSChartResource.FrameSplitTextColor,this.CreateChart=function(t){return\x20new\x20ChartMACD},this.GetOutData=function(){return{TimingData:this.TimingData}},this.RequestData=function(t,e,a){var\x20i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return\x20this.LongShortData=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,\x22不支持周期切换\x22),r.HQChart.Draw(),this.SendEvent(t,e,a,\x22不支持周期切换\x22),!1):(JSNetwork.HttpRequest({url:g_JSChartResource.Index.MarketLongShortApiUrl,data:{},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(n){i.RecvData(n,r),i.SendEvent(t,e,a)}}),!0)},this.RecvData=function(t,e){if(!(t.data.length<=0)){var\x20a=new\x20Array;for(var\x20i\x20in\x20t.data){var\x20r=t.data[i],n=new\x20SingleData;n.Date=r[0],n.Value=r[2],a.push(n)}var\x20s=e.HistoryData.GetFittingData(a),o=new\x20ChartData;o.Data=s,o.Period=e.HQChart.Period,o.Right=e.HQChart.Right,this.TimingData=o.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var\x20i=this.CreatePaints(t,e),r=this.IsOverlay();if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.TimingData,i[0].NotSupportMessage=null;var\x20n=e+1;if(r){var\x20s=t.TitlePaint[n];for(var\x20o\x20in\x20s.OverlayIndex.set(this.OverlayIndex.Identify,{Data:[],Title:\x22\x22}),i){var\x20h=new\x20DynamicTitleData(i[o].Data,this.Index[o].Name,this.Index[o].LineColor);h.StringFormat=STRING_FORMAT_TYPE.THOUSANDS,h.FloatPrecision=0,s.OverlayIndex.get(this.OverlayIndex.Identify).Data[o]=h}}else\x20for(var\x20o\x20in\x20i)t.TitlePaint[n].Data[o]=new\x20DynamicTitleData(i[o].Data,this.Index[o].Name,this.TitleColor),t.TitlePaint[n].Data[o].StringFormat=STRING_FORMAT_TYPE.THOUSANDS,t.TitlePaint[n].Data[o].FloatPrecision=0;return!0}}function\x20MarketAttentionIndex(){this.newMethod=BaseIndex,this.newMethod(\x22Market-Attention\x22),delete\x20this.newMethod,this.Index=new\x20Array(new\x20IndexInfo(\x22市场关注度\x22,null)),this.Data,this.TitleColor=g_JSChartResource.FrameSplitTextColor,this.ApiUrl=g_JSChartResource.Index.MarketAttentionApiUrl,this.CreateChart=function(t){return\x20new\x20ChartMACD},this.GetOutData=function(){return{Data:this.Data}},this.SetFrame=function(t,e,a){this.IsOverlay()?this.OverlayIndex.Frame.Frame.YSpecificMaxMin={Max:6,Min:0,Count:3}:t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:6,Min:0,Count:3}},this.RequestData=function(t,e,a){var\x20i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return\x20this.Data=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,\x22不支持周期切换\x22),r.HQChart.Draw(),this.SendEvent(t,e,a,\x22不支持周期切换\x22),!1):(JSNetwork.HttpRequest({url:this.ApiUrl,data:{symbol:r.HQChart.Symbol,startdate:20100101},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(n){i.RecvData(n,r),i.SendEvent(t,e,a)}}),!0)},this.RecvData=function(t,e){if(!(t.date.length<0)){var\x20a=new\x20Array;for(var\x20i\x20in\x20t.date){var\x20r=new\x20SingleData;r.Date=t.date[i],r.Value=t.value[i],a.push(r)}var\x20n=e.HistoryData.GetFittingData(a),s=new\x20ChartData;s.Data=n,s.Period=e.HQChart.Period,s.Right=e.HQChart.Right,this.Data=s.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),this.SetFrame(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var\x20i=this.CreatePaints(t,e),r=this.IsOverlay();if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.Data,i[0].NotSupportMessage=null;var\x20n=e+1;if(r){var\x20s=t.TitlePaint[n];for(var\x20o\x20in\x20s.OverlayIndex.set(this.OverlayIndex.Identify,{Data:[],Title:\x22\x22}),i){var\x20h=new\x20DynamicTitleData(i[o].Data,this.Index[o].Name,this.Index[o].LineColor);h.StringFormat=STRING_FORMAT_TYPE.THOUSANDS,h.FloatPrecision=0,s.OverlayIndex.get(this.OverlayIndex.Identify).Data[o]=h}}else\x20for(var\x20o\x20in\x20i)t.TitlePaint[n].Data[o]=new\x20DynamicTitleData(i[o].Data,this.Index[o].Name,this.TitleColor),t.TitlePaint[n].Data[o].StringFormat=STRING_FORMAT_TYPE.THOUSANDS,t.TitlePaint[n].Data[o].FloatPrecision=0;return!0}}function\x20MarketHeatIndex(){this.newMethod=BaseIndex,this.newMethod(\x22Market-Heat\x22),delete\x20this.newMethod,this.Index=new\x20Array(new\x20IndexInfo(\x22热度\x22,5),new\x20IndexInfo(\x22MA\x22,10),new\x20IndexInfo(\x22MA\x22,null)),this.Data,this.ApiUrl=g_JSChartResource.Index.MarketHeatApiUrl,this.Index[0].LineColor=g_JSChartResource.FrameSplitTextColor,this.Index[1].LineColor=g_JSChartResource.Index.LineColor[0],this.Index[2].LineColor=g_JSChartResource.Index.LineColor[1],this.CreateChart=function(t){return\x200==t?new\x20ChartMACD:new\x20ChartLine},this.RequestData=function(t,e,a){var\x20i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return\x20this.Data=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,\x22不支持周期切换\x22),r.HQChart.Draw(),!1):(JSNetwork.HttpRequest({url:this.ApiUrl,data:{symbol:r.HQChart.Symbol,startdate:20100101},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){i.RecvData(t,r)}}),!0)},this.RecvData=function(t,e){if(!(t.date.length<0)){var\x20a=new\x20Array;for(var\x20i\x20in\x20t.date){var\x20r=new\x20SingleData;r.Date=t.date[i],r.Value=t.value[i],a.push(r)}var\x20n=e.HistoryData.GetFittingData(a),s=new\x20ChartData;s.Data=n,s.Period=e.HQChart.Period,s.Right=e.HQChart.Right,this.Data=s.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var\x20i=this.CreatePaints(t,e),r=this.IsOverlay();if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.Data,i[0].NotSupportMessage=null;var\x20n=HQIndexFormula.MA(this.Data,this.Index[0].Param);i[1].Data.Data=n;var\x20s=HQIndexFormula.MA(this.Data,this.Index[1].Param);i[2].Data.Data=s;var\x20o=e+1;if(r){var\x20h=t.TitlePaint[o];for(var\x20l\x20in\x20h.OverlayIndex.set(this.OverlayIndex.Identify,{Data:[],Title:\x22\x22}),i){var\x20C=\x22\x22;C=0==l?t.Name+this.Index[l].Name:\x22MA\x22+this.Index[l-1].Param;var\x20u=new\x20DynamicTitleData(i[l].Data,C,this.Index[l].LineColor);u.StringFormat=STRING_FORMAT_TYPE.DEFAULT,u.FloatPrecision=2,h.OverlayIndex.get(this.OverlayIndex.Identify).Data[l]=u}}else\x20for(var\x20l\x20in\x20i){C=\x22\x22;C=0==l?t.Name+this.Index[l].Name:\x22MA\x22+this.Index[l-1].Param,t.TitlePaint[o].Data[l]=new\x20DynamicTitleData(i[l].Data,C,this.Index[l].LineColor),t.TitlePaint[o].Data[l].StringFormat=STRING_FORMAT_TYPE.DEFAULT,t.TitlePaint[o].Data[l].FloatPrecision=2}return!0}}function\x20CustonIndexHeatIndex(){this.newMethod=BaseIndex,this.newMethod(\x22Market-Heat\x22),delete\x20this.newMethod,this.Index=new\x20Array(new\x20IndexInfo(\x22区域\x22,3),new\x20IndexInfo(\x22热度指数\x22,10),new\x20IndexInfo(\x22MA\x22,5),new\x20IndexInfo(\x22MA\x22,10)),this.Data,this.ApiUrl=g_JSChartResource.Index.CustomIndexHeatApiUrl,this.Index[1].LineColor=g_JSChartResource.Index.LineColor[1],this.Index[2].LineColor=g_JSChartResource.Index.LineColor[2],this.Index[3].LineColor=g_JSChartResource.Index.LineColor[3],this.Create=function(t,e){for(var\x20a\x20in\x20this.Index){var\x20i=null;0==a?i=new\x20ChartStraightArea:(i=new\x20ChartLine).Color=this.Index[a].LineColor,i.Canvas=t.Canvas,i.Name=this.Name+\x22-\x22+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i)}},this.RequestData=function(t,e,a){var\x20i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return\x20this.Data=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,\x22不支持周期切换\x22),r.HQChart.Draw(),!1):(JSNetwork.HttpRequest({url:this.ApiUrl,data:{stock:r.HQChart.CustomStock,date:{startdate:r.HQChart.QueryDate.Start,enddate:r.HQChart.QueryDate.End},day:[this.Index[0].Param,this.Index[1].Param]},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){i.RecvData(t,r)}}),!0)},this.RecvData=function(t,e){if(!(null==t.data||t.data.length<0)){var\x20a=new\x20Array;for(var\x20i\x20in\x20t.data){let\x20e=t.data[i],r=new\x20SingleData;r.Date=e[0],r.Value=e[1],a.push(r)}var\x20r=e.HistoryData.GetFittingData(a),n=new\x20ChartData;n.Data=r,n.Period=e.HQChart.Period,n.Right=e.HQChart.Right,this.Data=n.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){let\x20i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].NotSupportMessage=null,i[0].Data.Data=[{Value:0,Value2:.2,Color:\x22rgb(50,205,50)\x22,Title:\x22热度1\x22,TitleColor:\x22rgb(245,255\x20,250)\x22},{Value:.2,Value2:.4,Color:\x22rgb(255,140,0)\x22,Title:\x22热度2\x22,TitleColor:\x22rgb(245,255\x20,250)\x22},{Value:.4,Value2:.8,Color:\x22rgb(255,106,106)\x22,Title:\x22热度3\x22,TitleColor:\x22rgb(245,255\x20,250)\x22},{Value:.8,Value2:1,Color:\x22rgb(208,\x2032\x20,144)\x22,Title:\x22热度4\x22,TitleColor:\x22rgb(245,255\x20,250)\x22}],i[1].Data.Data=this.Data;let\x20r=HQIndexFormula.MA(this.Data,this.Index[2].Param);i[2].Data.Data=r;let\x20n=HQIndexFormula.MA(this.Data,this.Index[3].Param);i[3].Data.Data=n,t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:1,Min:0,Count:3};let\x20s=e+1;for(var\x20o=1;o<i.length;++o){let\x20e=this.Index[o].Name;\x22MA\x22==e&&(e=\x22MA\x22+this.Index[o].Param),t.TitlePaint[s].Data[o]=new\x20DynamicTitleData(i[o].Data,e,this.Index[o].LineColor),t.TitlePaint[s].Data[o].StringFormat=STRING_FORMAT_TYPE.DEFAULT,t.TitlePaint[s].Data[o].FloatPrecision=2}return\x20t.TitlePaint[s].Title=\x22热度(\x22+this.Index[0].Param+\x22,\x22+this.Index[1].Param+\x22,\x22+this.Index[2].Param+\x22,\x22+this.Index[3].Param+\x22)\x22,!0}}function\x20BenfordIndex(){this.newMethod=BaseIndex,this.newMethod(\x22财务粉饰\x22),delete\x20this.newMethod,this.Index=new\x20Array(new\x20IndexInfo(\x22区域\x22,null),new\x20IndexInfo(\x22系数\x22,null)),this.Data,this.ApiUrl=g_JSChartResource.Index.StockHistoryDayApiUrl,this.Index[0].LineColor=g_JSChartResource.Index.LineColor[0],this.Index[1].LineColor=\x22rgb(105,105,105)\x22,this.CreateChart=function(t){return\x200==t?new\x20ChartStraightArea:new\x20ChartLineMultiData},this.GetOutData=function(){return{Data:this.Data}},this.RequestData=function(t,e,a){var\x20i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};if(this.Data=[],2!=r.HQChart.Period)return\x20this.NotSupport(r.HQChart,r.WindowIndex,\x22只支持月线\x22),r.HQChart.Draw(),this.SendEvent(t,e,a,\x22只支持月线\x22),!1;return\x20JSNetwork.HttpRequest({url:this.ApiUrl,data:{symbol:[r.HQChart.Symbol],field:[\x22finance.benford\x22,\x22announcement2.quarter\x22,\x22announcement1.quarter\x22,\x22announcement3.quarter\x22,\x22announcement4.quarter\x22],condition:[{item:[\x22date\x22,\x22int32\x22,\x22gte\x22,\x2220130101\x22]},{item:[\x22announcement1.year\x22,\x22int32\x22,\x22gte\x22,0,\x22announcement2.year\x22,\x22int32\x22,\x22gte\x22,0,\x22announcement3.year\x22,\x22int32\x22,\x22gte\x22,0,\x22announcement4.year\x22,\x22int32\x22,\x22gte\x22,0,\x22or\x22]}]},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(n){i.RecvData(n,r),i.SendEvent(t,e,a)}}),!0},this.JsonDataToMapSingleData=function(t){var\x20e=t.stock[0].stockday,a=new\x20Map;for(var\x20i\x20in\x20e){var\x20r=e[i],n=new\x20SingleData;if(n.Date=r.date,n.Value=new\x20Array,null!=r.finance1&&null!=r.announcement1){let\x20t=r.announcement1.year,e=r.announcement1.quarter,a=r.finance1.benford;n.Value.push({Year:t,Quarter:e,Value:a})}if(null!=r.finance2&&null!=r.announcement2){let\x20t=r.announcement2.year,e=r.announcement2.quarter,a=r.finance2.benford;n.Value.push({Year:t,Quarter:e,Value:a})}if(null!=r.finance3&&null!=r.announcement3){let\x20t=r.announcement3.year,e=r.announcement3.quarter,a=r.finance3.benford;n.Value.push({Year:t,Quarter:e,Value:a})}if(null!=r.finance4&&null!=r.announcement4){let\x20t=r.announcement4.year,e=r.announcement4.quarter,a=r.finance4.benford;n.Value.push({Year:t,Quarter:e,Value:a})}a.set(n.Date,n)}var\x20s=new\x20Array;for(var\x20r\x20of\x20a)s.push(r[1]);return\x20s},this.RecvData=function(t,e){if(JSConsole.Chart.Log(t),!(null==t.stock||t.stock.length<=0)){var\x20a=this.JsonDataToMapSingleData(t),i=e.HistoryData.GetFittingMonthData(a),r=new\x20ChartData;r.Data=i,r.Period=e.HQChart.Period,r.Right=e.HQChart.Right,this.Data=r.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var\x20i=this.CreatePaints(t,e);if(i.length!=this.Index.length)return!1;i[0].NotSupportMessage=null,i[0].Data.Data=[{Value:0,Value2:.2,Color:\x22rgb(50,205,50)\x22,Title:\x22安全区\x22,TitleColor:\x22rgb(245,255\x20,250)\x22},{Value:.2,Value2:.4,Color:\x22rgb(255,140,0)\x22,Title:\x22预警区\x22,TitleColor:\x22rgb(245,255\x20,250)\x22},{Value:.4,Value2:1,Color:\x22rgb(255,106,106)\x22,Title:\x22警示区\x22,TitleColor:\x22rgb(245,255\x20,250)\x22}],i[1].Data.Data=this.Data,t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:1,Min:0,Count:3};var\x20r=e+1;return\x20t.TitlePaint[r].Data[1]=new\x20DynamicTitleData(i[1].Data,this.Index[1].Name,this.Index[1].LineColor),t.TitlePaint[r].Data[1].DataType=\x22MultiReport\x22,t.TitlePaint[r].Title=this.FormatIndexTitle(),!0}}function\x20LighterIndex1(){this.newMethod=BaseIndex,this.newMethod(\x22Lighter-Trend\x22),delete\x20this.newMethod,this.Index=new\x20Array(new\x20IndexInfo(\x22STICKLINE\x22,null),new\x20IndexInfo(\x22STICKLINE\x22,null)),this.Index[0].LineColor=\x22rgb(255,0,0)\x22,this.Index[1].LineColor=\x22rgb(0,0,255)\x22,this.Create=function(t,e){for(var\x20a\x20in\x20this.Index){var\x20i=new\x20ChartStickLine;i.Canvas=t.Canvas,i.Name=this.Name,i.Name=this.Name+\x22-\x22+a.toString(),i.Color=this.Index[a].LineColor,i.LineWidth=2,i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i)}},this.BindData=function(t,e,a){var\x20i=t.GetChartPaint(e);if(2!=i.length)return!1;var\x20r=a.GetClose(),n=HQIndexFormula.SMA(r,6.5,1),s=HQIndexFormula.SMA(r,13.5,1),o=HQIndexFormula.STICKLINE(HQIndexFormula.ARRAY_GT(n,s),n,s),h=HQIndexFormula.STICKLINE(HQIndexFormula.ARRAY_GT(s,n),n,s);i[0].Data.Data=o,i[1].Data.Data=h;var\x20l=e+1;return\x20t.TitlePaint[l].Title=\x22大盘/个股\x20趋势函数\x22,!0}}function\x20LighterIndex2(){this.newMethod=BaseIndex,this.newMethod(\x22位置研判函数\x22),delete\x20this.newMethod,this.Index=new\x20Array(new\x20IndexInfo(\x22STICKLINE\x22,34),new\x20IndexInfo(\x22STICKLINE\x22,3),new\x20IndexInfo(\x22STICKLINE\x22,null),new\x20IndexInfo(\x22STICKLINE\x22,null),new\x20IndexInfo(\x22STICKLINE\x22,null),new\x20IndexInfo(\x22STICKLINE\x22,null),new\x20IndexInfo(\x22LINE\x22,null),new\x20IndexInfo(\x22TEXT\x22,null)),this.Index[0].LineColor=\x22rgb(0,0,138)\x22,this.Index[1].LineColor=\x22rgb(133,0,138)\x22,this.Index[2].LineColor=\x22rgb(101,118,0)\x22,this.Index[3].LineColor=\x22rgb(105,0,121)\x22,this.Index[4].LineColor=\x22rgb(121,183,21)\x22,this.Index[5].LineColor=\x22rgb(0,0,138)\x22,this.Index[6].LineColor=\x22rgb(255,0,0)\x22,this.Create=function(t,e){for(var\x20a\x20in\x20this.Index){var\x20i=null;\x22LINE\x22==this.Index[a].Name?(i=new\x20ChartLine).Color=this.Index[a].LineColor:\x22TEXT\x22==this.Index[a].Name?i=new\x20ChartText:((i=new\x20ChartStickLine).Color=this.Index[a].LineColor,i.LineWidth=5),i.Canvas=t.Canvas,i.Name=this.Name,i.Name=this.Name+\x22-\x22+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i)}},this.BindData=function(t,e,a){var\x20i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;var\x20r=a.GetClose(),n=a.GetHigh(),s=a.GetLow();i[0].Data.Data=HQIndexFormula.STICKLINE(HQIndexFormula.ARRAY_GT(r,0),0,2),i[1].Data.Data=HQIndexFormula.STICKLINE(HQIndexFormula.ARRAY_GT(r,0),2,5),i[2].Data.Data=HQIndexFormula.STICKLINE(HQIndexFormula.ARRAY_GT(r,0),5,10),i[3].Data.Data=HQIndexFormula.STICKLINE(HQIndexFormula.ARRAY_GT(r,0),10,21.5),i[4].Data.Data=HQIndexFormula.STICKLINE(HQIndexFormula.ARRAY_GT(r,0),21.5,23,5),i[5].Data.Data=HQIndexFormula.STICKLINE(HQIndexFormula.ARRAY_GT(r,0),23,28,5);var\x20o=HQIndexFormula.ARRAY_DIVIDE(HQIndexFormula.EMA(HQIndexFormula.ARRAY_MULTIPLY(HQIndexFormula.ARRAY_DIVIDE(HQIndexFormula.ARRAY_SUBTRACT(r,HQIndexFormula.LLV(s,this.Index[0].Param)),HQIndexFormula.ARRAY_SUBTRACT(HQIndexFormula.HHV(n,this.Index[0].Param),HQIndexFormula.LLV(s,this.Index[0].Param))),100),this.Index[1].Param),4);i[6].Data.Data=o;var\x20h=new\x20Array;h[0]={Value:1,Message:\x22底部区域\x22,Color:\x22rgb(0,255,255)\x22,Position:\x22Left\x22},h[1]={Value:3.5,Message:\x22介入区域\x22,Color:\x22rgb(0,255,255)\x22,Position:\x22Left\x22},h[2]={Value:7.5,Message:\x22稳健区域\x22,Color:\x22rgb(0,255,255)\x22,Position:\x22Left\x22},h[3]={Value:16,Message:\x22高位区域\x22,Color:\x22rgb(0,255,255)\x22,Position:\x22Left\x22},h[4]={Value:22,Message:\x22风险区域\x22,Color:\x22rgb(0,0,255)\x22,Position:\x22Left\x22},h[5]={Value:25.5,Message:\x22顶部区域\x22,Color:\x22rgb(255,0,255)\x22,Position:\x22Left\x22},i[7].Data.Data=h;var\x20l=e+1;return\x20t.TitlePaint[l].Data[0]=new\x20DynamicTitleData(i[6].Data,\x22财貌双拳\x22,i[6].Color),t.TitlePaint[l].Title=this.FormatIndexTitle(),!0}}function\x20PyScriptIndex(t,e,a,i){this.newMethod=BaseIndex,this.newMethod(t),delete\x20this.newMethod,this.Script=e,this.Arguments=[],this.OutVar=[],this.ApiUrl=g_JSChartResource.PyIndexDomain+\x22/hq/code\x22,a&&(this.Arguments=a),this.RequestData=function(t,e,a){this.OutVar=[];var\x20i=this,r={HQChart:t,WindowIndex:e,HistoryData:a},n=\x22\x22;for(var\x20s\x20in\x20this.Arguments){n.length>0&&(n+=\x22,\x22);var\x20o=this.Arguments[s];n+=\x27\x22\x27+o.Name+\x27\x22:\x27+o.Value}n=\x22{\x22+n+\x22}\x22;var\x20h=JSON.parse(n),l=JSON.stringify({code:this.Script,symbol:r.HQChart.Symbol,period:r.HQChart.Period,right:r.HQChart.Right,params:h,numcount:t.MaxReqeustDataCount});return\x20JSNetwork.HttpRequest({url:this.ApiUrl,data:l,type:\x22post\x22,dataType:\x22json\x22,contentType:\x22\x20application/json;\x20charset=utf-8\x22,async:!0,success:function(t){i.RecvData(t,r)},complete:function(t){},error:function(t,e){i.RecvError(t,e,r)}}),!0},this.RecvError=function(t,e,a){JSConsole.Chart.Log(\x22[PyScriptIndex::RecvError]\x20error\x22,e),a.HQChart.ScriptErrorCallback&&a.HQChart.ScriptErrorCallback(e)},this.RecvData=function(t,e){if(0!=t.code)return\x20JSConsole.Chart.Log(\x22[PyScriptIndex::RecvData]\x20failed.\x22,t),void(e.HQChart.ScriptErrorCallback&&e.HQChart.ScriptErrorCallback(t.msg));JSConsole.Chart.Log(\x22[PyScriptIndex::RecvData]\x20recv\x20data.\x22,t);var\x20a=t.date;for(var\x20i\x20in\x20t.data){for(var\x20r=t.data[i],n=[],s=0;s<a.length&&s<a.length;++s)if(!(s>=r.data.length)){var\x20o=new\x20SingleData;o.Date=a[s],o.Value=r.data[s],n.push(o)}var\x20h=e.HistoryData.GetFittingData(n),l=new\x20ChartData;l.Data=h,l.Period=e.HQChart.Period,l.Right=e.HQChart.Right;var\x20C={Name:r.name,Type:r.graph,LineWidth:r.width,Data:l.GetValue(),Color:r.color};this.OutVar.push(C)}this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()},this.BindData=function(t,e,a){for(var\x20i\x20in\x20t.DeleteIndexPaint(e),this.OutVar){let\x20a=this.OutVar[i];switch(a.Type){case\x22line\x22:this.CreateLine(t,e,a,i);break;case\x22colorstick\x22:this.CreateColorStock(t,e,a,i)}}var\x20r=e+1;t.TitlePaint[r].Title=this.Name;let\x20n=\x22\x22;for(var\x20i\x20in\x20this.Arguments){let\x20t=this.Arguments[i];n.length>0&&(n+=\x22,\x22),n+=t.Value.toString()}return\x20n.length>0&&(t.TitlePaint[r].Title=this.Name+\x22(\x22+n+\x22)\x22),!0},this.CreateLine=function(t,e,a,i){let\x20r=new\x20ChartLine;r.Canvas=t.Canvas,r.DrawType=1,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=a.Color:r.Color=this.GetDefaultColor(i),a.LineWidth>0&&(r.LineWidth=a.LineWidth),0==a.IsShow&&(r.IsShow=!1);let\x20n=e+1;r.Data.Data=a.Data,t.TitlePaint[n].Data[i]=new\x20DynamicTitleData(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateColorStock=function(t,e,a,i){let\x20r=new\x20ChartMACD;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame;let\x20n=e+1;r.Data.Data=a.Data,t.TitlePaint[n].Data[i]=new\x20DynamicTitleData(r.Data,a.Name,this.GetDefaultColor(i)),t.ChartPaint.push(r)},this.GetDefaultColor=function(t){let\x20e=[\x22rgb(255,174,0)\x22,\x22rgb(25,199,255)\x22,\x22rgb(175,95,162)\x22,\x22rgb(236,105,65)\x22,\x22rgb(68,114,196)\x22,\x22rgb(229,0,79)\x22,\x22rgb(0,128,255)\x22,\x22rgb(252,96,154)\x22,\x22rgb(42,230,215)\x22,\x22rgb(24,71,178)\x22];return\x20e[parseInt(t)%(e.length-1)]}}function\x20JsonDataIndex(t,e,a,i){this.newMethod=PyScriptIndex,this.newMethod(t),delete\x20this.newMethod,this.JsonData,i.JsonData&&(this.JsonData=i.JsonData),this.RequestData=function(t,e,a){if(this.JsonData){var\x20i={HQChart:t,WindowIndex:e,HistoryData:a};this.JsonData.code=0;var\x20r=this.JsonData;this.RecvData(r,i)}else\x20console.warn(\x22[PyScriptIndex::RequestData]\x20JsonData\x20is\x20null\x22),i.HQChart.ScriptErrorCallback&&i.HQChart.ScriptErrorCallback(\x22json\x20数据不能为空\x22)}}function\x20LighterIndex3(){this.newMethod=BaseIndex,this.newMethod(\x22点位研判函数\x22),delete\x20this.newMethod,this.Index=new\x20Array(new\x20IndexInfo(\x22启动买点\x22,null)),this.Index[0].LineColor=\x22rgb(255,0,0)\x22,this.BindData=function(t,e,a){var\x20i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;var\x20r=a.GetClose(),n=(a.GetHigh(),a.GetLow()),s=HQIndexFormula.REF(n,1),o=HQIndexFormula.ARRAY_MULTIPLY(HQIndexFormula.ARRAY_DIVIDE(HQIndexFormula.SMA(HQIndexFormula.ABS(HQIndexFormula.ARRAY_SUBTRACT(n,s)),13,1),HQIndexFormula.SMA(HQIndexFormula.MAX(HQIndexFormula.ARRAY_SUBTRACT(n,s),0),13,1)),100),h=HQIndexFormula.EMA(HQIndexFormula.ARRAY_IF(HQIndexFormula.ARRAY_MULTIPLY(r,1.2),HQIndexFormula.ARRAY_MULTIPLY(o,13),HQIndexFormula.ARRAY_DIVIDE(o,13)),13),l=HQIndexFormula.LLV(n,34),C=HQIndexFormula.HHV(h,34),u=HQIndexFormula.ARRAY_IF(HQIndexFormula.LLV(n,56),1,0),D=HQIndexFormula.ARRAY_DIVIDE(HQIndexFormula.ARRAY_ADD(h,HQIndexFormula.ARRAY_MULTIPLY(C,2)),2),d=HQIndexFormula.ARRAY_MULTIPLY(HQIndexFormula.ARRAY_DIVIDE(HQIndexFormula.EMA(HQIndexFormula.ARRAY_IF(HQIndexFormula.ARRAY_LTE(n,l),D,0),3),618),u),c=HQIndexFormula.ARRAY_GT(d,HQIndexFormula.REF(d,1)),m=HQIndexFormula.REF(HQIndexFormula.LLV(n,100),3),f=HQIndexFormula.REFDATE(m,-1),v=HQIndexFormula.ARRAY_EQ(n,f),S=HQIndexFormula.ARRAY_AND(c,v);i[0].Data.Data=S;var\x20T=e+1;for(var\x20I\x20in\x20i)t.TitlePaint[T].Data[I]=new\x20DynamicTitleData(i[I].Data,this.Index[I].Name,this.Index[I].LineColor);return\x20t.TitlePaint[T].Title=this.FormatIndexTitle(),!0}}function\x20JSKLineInfoMap(){}function\x20IKLineInfo(){this.MaxReqeustDataCount=1e3,this.StartDate=20160101,this.Data,this.ClassName=\x22IKLineInfo\x22,this.Explain=\x22IKLineInfo\x22,this.GetToday=function(){var\x20t=new\x20Date;return\x201e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate()},this.GetRequestData=function(t){return{Symbol:t.Symbol,MaxReqeustDataCount:t.MaxReqeustDataCount,MaxRequestMinuteDayCount:t.MaxRequestMinuteDayCount}},this.NetworkFilter=function(t){if(!t.NetworkFilter)return!1;var\x20e=this,a={HQChart:t},i={Name:`${this.ClassName}::RequestData`,Explain:this.Explain,Request:this.GetRequestData(t),Self:this,HQChart:t,PreventDefault:!1};return\x20t.NetworkFilter(i,function(t){e.RecvData(t,a)}),1==i.PreventDefault}}function\x20InvestorInfo(){this.newMethod=IKLineInfo,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22InvestorInfo\x22,this.Explain=\x22互动易\x22,this.RequestData=function(t){var\x20e=this,a={HQChart:t};if(this.Data=[],!this.NetworkFilter(t)){var\x20i={filed:[\x22question\x22,\x22answerdate\x22,\x22symbol\x22,\x22id\x22],symbol:[a.HQChart.Symbol],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},start:0,end:this.MaxReqeustDataCount};return\x20JSNetwork.HttpRequest({url:g_JSChartResource.KLine.Info.Investor.ApiUrl,data:i,type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,a)}}),!0}},this.RecvData=function(t,e){if(!(t.list.length<=0)){for(var\x20a\x20in\x20t.list){var\x20i=t.list[a],r=new\x20KLineInfoData;r.Date=i.answerdate,r.Title=i.question,r.InfoType=KLINE_INFO_TYPE.INVESTOR,this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function\x20AnnouncementInfo(){this.newMethod=IKLineInfo,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22AnnouncementInfo\x22,this.Explain=\x22公告\x22,this.ApiType=1,this.RequestData=function(t){var\x20e=this,a={HQChart:t};if(this.Data=[],!this.NetworkFilter(t))if(1==this.ApiType){var\x20i=`${g_JSChartResource.CacheDomain}/cache/analyze/shszreportlist/${a.HQChart.Symbol}.json`;JSNetwork.HttpRequest({url:i,type:\x22get\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,a)},error:function(t,i){e.RecvError(t,i,a)}})}else\x20JSNetwork.HttpRequest({url:g_JSChartResource.KLine.Info.Announcement.ApiUrl,data:{filed:[\x22title\x22,\x22releasedate\x22,\x22symbol\x22,\x22id\x22],symbol:[a.HQChart.Symbol],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},start:0,end:this.MaxReqeustDataCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,a)},error:function(t,i){e.RecvError(t,i,a)}})},this.RecvData=function(t,e){if(!(t.report.length<=0)){for(var\x20a\x20in\x20t.report){var\x20i=t.report[a],r=new\x20KLineInfoData;for(var\x20n\x20in\x20r.Date=i.releasedate,r.Title=i.title,r.InfoType=KLINE_INFO_TYPE.ANNOUNCEMENT,i.type){switch(i.type[n]){case\x22一季度报告\x22:r.InfoType=KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_1;break;case\x22半年度报告\x22:r.InfoType=KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_2;break;case\x22三季度报告\x22:r.InfoType=KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_3;break;case\x22年度报告\x22:r.InfoType=KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_4}}for(var\x20n\x20in\x20i.typeex){var\x20s=i.typeex[n];r.InfoType=KLINE_INFO_TYPE.ANNOUNCEMENT_EX_START+s;break}this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}},this.RecvError=function(t,e,a){console.warn(\x22[AnnouncementInfo::RecvError]\x20error,\x20http\x20\x22,e,t)}}function\x20PforecastInfo(){this.newMethod=IKLineInfo,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22PforecastInfo\x22,this.RequestData=function(t){var\x20e=this,a={HQChart:t};return\x20this.Data=[],JSNetwork.HttpRequest({url:g_JSChartResource.KLine.Info.Pforecast.ApiUrl,data:{field:[\x22pforecast.type\x22,\x22pforecast.reportdate\x22,\x22fweek\x22],condition:[{item:[\x22pforecast.reportdate\x22,\x22int32\x22,\x22gte\x22,this.StartDate]}],symbol:[a.HQChart.Symbol],start:0,end:this.MaxReqeustDataCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){if(1==t.stock.length&&!(t.stock[0].stockday.length<=0)){for(var\x20a\x20in\x20t.stock[0].stockday){var\x20i=t.stock[0].stockday[a];if(i.pforecast.length>0){var\x20r=i.pforecast[0],n=new\x20KLineInfoData;n.Date=i.date,n.Title=r.type,n.InfoType=KLINE_INFO_TYPE.PFORECAST,n.ExtendData={Type:r.type,ReportDate:r.reportdate},i.fweek&&(n.ExtendData.FWeek={},null!=i.fweek.week1&&(n.ExtendData.FWeek.Week1=i.fweek.week1),null!=i.fweek.week4&&(n.ExtendData.FWeek.Week4=i.fweek.week4)),this.Data.push(n)}}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function\x20ResearchInfo(){this.newMethod=IKLineInfo,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22ResearchInfo\x22,this.RequestData=function(t){var\x20e=this,a={HQChart:t};return\x20this.Data=[],JSNetwork.HttpRequest({url:g_JSChartResource.KLine.Info.Research.ApiUrl,data:{filed:[\x22releasedate\x22,\x22researchdate\x22,\x22level\x22,\x22symbol\x22,\x22id\x22,\x22type\x22],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},symbol:[a.HQChart.Symbol],start:0,end:this.MaxReqeustDataCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){if(!(t.list.length<=0)){for(var\x20a\x20in\x20t.list){var\x20i=t.list[a],r=new\x20KLineInfoData;r.ID=i.id,r.Date=i.researchdate,r.InfoType=KLINE_INFO_TYPE.RESEARCH,r.ExtendData={Level:i.level,Type:i.type},this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function\x20BlockTrading(){this.newMethod=IKLineInfo,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22BlockTrading\x22,this.RequestData=function(t){var\x20e=this,a={HQChart:t};return\x20this.Data=[],JSNetwork.HttpRequest({url:g_JSChartResource.KLine.Info.BlockTrading.ApiUrl,data:{field:[\x22blocktrading.price\x22,\x22blocktrading.vol\x22,\x22blocktrading.premium\x22,\x22fweek\x22,\x22price\x22],condition:[{item:[\x22date\x22,\x22int32\x22,\x22gte\x22,this.StartDate]},{item:[\x22blocktrading.vol\x22,\x22int32\x22,\x22gte\x22,\x220\x22]}],symbol:[a.HQChart.Symbol],start:0,end:this.MaxReqeustDataCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){if(1==t.stock.length&&!(t.stock[0].stockday.length<=0)){for(var\x20a\x20in\x20t.stock[0].stockday){var\x20i=t.stock[0].stockday[a],r=new\x20KLineInfoData;r.Date=i.date,r.InfoType=KLINE_INFO_TYPE.BLOCKTRADING,r.ExtendData={Price:i.blocktrading.price,Premium:i.blocktrading.premium,Vol:i.blocktrading.vol,ClosePrice:i.price},i.fweek&&(r.ExtendData.FWeek={},null!=i.fweek.week1&&(r.ExtendData.FWeek.Week1=i.fweek.week1),null!=i.fweek.week4&&(r.ExtendData.FWeek.Week4=i.fweek.week4)),this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function\x20TradeDetail(){this.newMethod=IKLineInfo,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22TradeDetail\x22,this.RequestData=function(t){var\x20e=this,a={HQChart:t};return\x20this.Data=[],JSNetwork.HttpRequest({url:g_JSChartResource.KLine.Info.TradeDetail.ApiUrl,data:{field:[\x22tradedetail.typeexplain\x22,\x22tradedetail.type\x22,\x22fweek\x22],condition:[{item:[\x22date\x22,\x22int32\x22,\x22gte\x22,this.StartDate]},{item:[\x22tradedetail.type\x22,\x22int32\x22,\x22gte\x22,\x220\x22]}],symbol:[a.HQChart.Symbol],start:0,end:this.MaxReqeustDataCount},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,a)}}),!0},this.RecvData=function(t,e){if(1==t.stock.length&&!(t.stock[0].stockday.length<=0)){for(var\x20a\x20in\x20t.stock[0].stockday){var\x20i=t.stock[0].stockday[a],r=new\x20KLineInfoData;for(var\x20n\x20in\x20r.Date=i.date,r.InfoType=KLINE_INFO_TYPE.TRADEDETAIL,r.ExtendData={Detail:new\x20Array},i.tradedetail){var\x20s=i.tradedetail[n];r.ExtendData.Detail.push({Type:s.type,TypeExplain:s.typeexplain})}i.fweek&&(r.ExtendData.FWeek={},null!=i.fweek.week1&&(r.ExtendData.FWeek.Week1=i.fweek.week1),null!=i.fweek.week4&&(r.ExtendData.FWeek.Week4=i.fweek.week4)),this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function\x20JSMinuteInfoMap(){}function\x20IMinuteInfo(){this.Data,this.ClassName=\x22IMinuteInfo\x22}function\x20MarketEventInfo(){this.newMethod=IMinuteInfo,this.newMethod(),delete\x20this.newMethod,this.ClassName=\x22MarketEventInfo\x22,this.RequestData=function(t){var\x20e=this;this.Data=[];var\x20a={HQChart:t},i=g_JSChartResource.CacheDomain+\x22/cache/analyze/shszevent/marketevent/concept/\x22+t.TradeDate+\x22.json\x22;if(t.NetworkFilter){var\x20r={Name:\x22MarketEventInfo::RequestData\x22,Explain:\x22大盘异动\x22,Request:{Url:i,Type:\x22Get\x22,Data:{Date:t.TradeDate,Symbol:t.Symbol}},Self:this,PreventDefault:!1};if(t.NetworkFilter(r,function(t){e.RecvData(t,a),a.HQChart.UpdataChartInfo(),a.HQChart.Draw()}),1==r.PreventDefault)return}return\x20JSNetwork.HttpRequest({url:i,type:\x22get\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,a)},error:function(t,e){console.warn(\x22[MarketEventInfo::RequestData]\x20error,\x20http\x20\x22,e,t)}}),!0},this.RecvData=function(t,e){for(var\x20a\x20in\x20t.event){var\x20i=t.event[a];for(var\x20r\x20in\x20i.data){var\x20n=i.data[r];if(Array.isArray(n)){if(n.length<2)continue;var\x20s={Date:i.date,Time:n[0],Title:n[1],Type:0};n.length>=3&&n[2]&&\x22string\x22==typeof\x20n[2]&&(s.Color=n[2]),n.length>=4&&n[3]&&\x22string\x22==typeof\x20n[3]&&(s.BGColor=n[3]),this.Data.push(s)}else{if(!IFrameSplitOperator.IsNumber(n.Date)||!IFrameSplitOperator.IsNumber(n.Time)||!n.Title)continue;s={Date:n.Date,Time:n.Time,Title:n.Title,Type:0};n.Color&&(s.Color=n.Color),n.BGColor&&(s.BGColor=n.BGColor),IFrameSplitOperator.IsNumber(n.Price)&&(s.Price=n.Price),n.Content&&(s.Content=n.Content),n.Link&&(s.Link=n.Link),this.Data.push(s)}}}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}function\x20IsIndexSymbol(t){var\x20e=t.toUpperCase();if(e.indexOf(\x22.SH\x22)>0){if(\x220\x22==(e=e.replace(\x22.SH\x22,\x22\x22)).charAt(0)&&parseInt(e)<=3e3)return!0}else\x20if(e.indexOf(\x22.SZ\x22)>0){if(\x223\x22==(e=e.replace(\x22.SZ\x22,\x22\x22)).charAt(0)&&\x229\x22==e.charAt(1))return!0}else\x20if(e.indexOf(\x22.CI\x22)>0)return!0;return!1}function\x20IsFundSymbol(t){if(!t)return!1;var\x20e=t.toUpperCase();if(e.indexOf(\x22.SH\x22)>0){if(\x225\x22==(e=e.replace(\x22.SH\x22,\x22\x22)).charAt(0)&&\x221\x22==e.charAt(1))return!0}else\x20if(e.indexOf(\x22.SZ\x22)>0&&\x221\x22==(e=e.replace(\x22.SZ\x22,\x22\x22)).charAt(0)&&(\x225\x22==e.charAt(1)||\x226\x22==e.charAt(1)||\x227\x22==e.charAt(1)||\x228\x22==e.charAt(1)))return!0;return!1}function\x20IDivDialog(t){this.DivElement=t,this.ID=null,this.TimeOut=null,this.Hide=function(){$(\x22#\x22+this.ID).hide()},this.Show=function(t,e,a,i){var\x20r={display:\x22block\x22};IFrameSplitOperator.IsNumber(t)&&(r.left=t+\x22px\x22),IFrameSplitOperator.IsNumber(e)&&(r.top=e+\x22px\x22),IFrameSplitOperator.IsNumber(a)&&(r.width=a+\x22px\x22),IFrameSplitOperator.IsNumber(i)&&(r.height=i+\x22px\x22),$(\x22#\x22+this.ID).css(r)}}function\x20ModifyIndexDialog(t){this.newMethod=IDivDialog,this.newMethod(t),delete\x20this.newMethod,this.Title={ID:Guid()},this.ParamList={ID:Guid()},this.ParamData=[],this.Identify,this.HQChart,this.Create=function(){this.ID=Guid();var\x20t=document.createElement(\x22div\x22);t.className=\x22jchart-modifyindex-box\x22,t.id=this.ID,t.innerHTML=\x22<div\x20class=\x27parameter\x27>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x27parameter-header\x27>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span></span>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20id=\x27close\x27\x20class=\x27icon\x20iconfont\x20icon-close\x27></strong>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x27parameter-content\x27><input/>MA</div>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x27parameter-footer\x27>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x27submit\x27\x20>确定</button>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x27cancel\x27\x20>取消</button>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20\x20\x20</div>\x22,this.DivElement.appendChild(t),$(\x22#\x22+this.ID+\x22\x20.submit\x22).click({divBox:this},function(t){t.data.divBox.Hide()}),t.getElementsByTagName(\x22span\x22)[0].id=this.Title.ID,t.getElementsByClassName(\x22parameter-content\x22)[0].id=this.ParamList.ID},this.SetTitle=function(t){$(\x22#\x22+this.Title.ID).html(t)},this.ClearParamList=function(){$(\x22#\x22+this.ParamList.ID).empty(),this.ParamData=[]},this.BindParam=function(t,e){var\x20a=t.WindowIndex[e];for(var\x20i\x20in\x20a.Arguments){if(null==(o=a.Arguments[i]).Name||isNaN(o.Value))break;var\x20r=Guid(),n=\x27<input\x20class=\x22row-line\x22\x20id=\x22\x27+r+\x27\x22\x20value=\x22\x27+o.Value+\x27\x22\x20type=\x22number\x22\x20step=\x221\x22/>\x27+o.Name+\x22<br>\x22;$(\x22#\x22+this.ParamList.ID).append(n),this.ParamData.push({ID:r,Value:o.Value})}var\x20s=this;for(var\x20i\x20in\x20this.ParamData){var\x20o=this.ParamData[i];$(\x22#\x22+o.ID).mouseup({Chart:t,Identify:e,ParamIndex:i},function(t){var\x20e=parseInt($(this).val());if(IFrameSplitOperator.IsNumber(e)){var\x20a=s.HQChart,i=s.Identify,r=t.data.ParamIndex;a.WindowIndex[i].Arguments[r].Value=e,a.UpdateWindowIndex(i)}else\x20alert(\x22参数不能为空\x22)}),$(\x22#\x22+o.ID).keyup({Chart:t,Identify:e,ParamIndex:i},function(t){var\x20e=parseInt($(this).val());if(IFrameSplitOperator.IsNumber(e)){var\x20a=s.HQChart,i=s.Identify,r=t.data.ParamIndex;a.WindowIndex[i].Arguments[r].Value=e,a.UpdateWindowIndex(i)}else\x20alert(\x22参数不能为空\x22)})}},this.BindCancel=function(){var\x20t=this;$(\x22#\x22+this.ID+\x22\x20.cancel\x22).click(function(){var\x20e=t.HQChart,a=t.Identify;t.RestoreParam(e.WindowIndex[a]),e.UpdateWindowIndex(a),t.Hide()}),$(\x22#\x22+this.ID+\x22\x20#close\x22).click(function(){var\x20e=t.HQChart,a=t.Identify;t.RestoreParam(e.WindowIndex[a]),e.UpdateWindowIndex(a),t.Hide()})},this.RestoreParam=function(t){for(var\x20e\x20in\x20this.ParamData){var\x20a=this.ParamData[e];t.Arguments[e].Value=a.Value}},this.DoModal=function(t){var\x20e=t.data.Chart,a=t.data.Identify,i=e.ModifyIndexDialog;i&&(null==i.ID&&i.Create(),i.Identify=a,i.HQChart=e,i.SetTitle(e.WindowIndex[a].Name+\x22\x20指标参数设置\x22),i.ClearParamList(),i.BindParam(e,a),i.BindCancel(),i.Show())}}function\x20ChangeIndexDialog(t){this.newMethod=IDivDialog,this.newMethod(t),delete\x20this.newMethod,this.DivElement=t,this.IndexTreeApiUrl=\x22https://opensourcecache.zealink.com/cache/hqh5/index/commonindextree.json\x22,this.OverlayIndexTreeApiUrl=\x22https://opensourcecache.zealink.com/cache/hqh5/index/commonindextree.json\x22,this.IsOverlayIndex=!1,this.Create=function(){var\x20t=document.createElement(\x22div\x22);t.className=\x22jchart-changeindex-box\x22,t.id=this.ID=Guid(),t.innerHTML=\x27<div\x20class=\x22target-panel\x22>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-header\x22>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>换指标</span>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20class=\x22close-tar\x20icon\x20iconfont\x20icon-close\x22></strong>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-content\x22>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-left\x22>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul></ul>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-right\x22>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<ul></ul>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20\x20\x20</div>\x27,this.DivElement.appendChild(t)},this.ReqeustData=function(){if($(\x22#\x22+this.ID+\x22\x20.target-left\x20ul\x20li\x22).length>0)return!1;var\x20t=this.IndexTreeApiUrl;1==this.IsOverlayIndex&&(t=this.OverlayIndexTreeApiUrl),JSNetwork.HttpRequest({url:t,type:\x22get\x22,success:function(t){var\x20e,a,i,r=t.list;!function(t){$(\x22.target-left\x20ul\x22).html(\x22\x22),$.each(t,function(t,e){var\x20a;a=\x22<li>\x22+e.node+\x22</li>\x22,$(\x22.target-left\x20ul\x22).append(a)}),$(\x22.target-left\x20ul\x20li:first-child\x22).addClass(\x22active-list\x22)}(r),e=r,i=[],$.each(e,function(t,e){i.push(e.list)}),$.each(i[0],function(t,e){a=\x22<li\x20id=\x22+e.id+\x22>\x22+e.name+\x22</li>\x22,$(\x22.target-right\x20ul\x22).append(a)}),$(\x22.target-left\x20ul\x22).delegate(\x22li\x22,\x22click\x22,function(){$(this).addClass(\x22active-list\x22).siblings().removeClass(\x22active-list\x22);var\x20t=$(this).index();$(\x22.target-right\x20ul\x22).html(\x22\x22),$.each(i[t],function(t,e){a=\x22<li\x20id=\x22+e.id+\x22>\x22+e.name+\x22</li>\x22,$(\x22.target-right\x20ul\x22).append(a)})})}})},this.BindClose=function(t){$(\x22#\x22+this.ID+\x22\x20.close-tar\x22).click({Chart:t},function(t){t.data.Chart.ChangeIndexDialog.Hide()})},this.BindSearch=function(t){$(\x22.target-left\x20input\x22).on(\x22input\x22,{Chart:t},function(t){let\x20e=(new\x20JSIndexScript).Search(t.target.value);for(var\x20a\x20in\x20$(\x22.target-right\x20ul\x22).html(\x22\x22),e){var\x20i=e[a],r=\x22<li\x20id=\x22+i+\x22>\x22+i+\x22</li>\x22;$(\x22.target-right\x20ul\x22).append(r)}})},this.DoModal=function(t){var\x20e=t.data.Chart,a=t.data.Identify,i=e.ChangeIndexDialog,r=t.data.IsOverlay;i&&(null==i.ID&&i.Create(),i.IsOverlayIndex=r,i.ReqeustData(),$(\x22.target-right\x20ul\x22).undelegate().delegate(\x22li\x22,\x22click\x22,function(){var\x20t=$(this).attr(\x22id\x22);r?e.AddOverlayIndex({WindowIndex:a,IndexName:t}):e.ChangeIndex(a,t),$(this).addClass(\x22active-list\x22).siblings().removeClass(\x22active-list\x22)}),i.BindSearch(e),i.BindClose(e),i.Show())}}function\x20KLineInfoTooltip(t){this.newMethod=IDivDialog,this.newMethod(t),delete\x20this.newMethod,this.UpColor=g_JSChartResource.UpTextColor,this.DownColor=g_JSChartResource.DownTextColor,this.UnchagneColor=g_JSChartResource.UnchagneTextColor,this.Create=function(){this.ID=Guid();var\x20t=document.createElement(\x22div\x22);t.className=\x22jchart-klineinfo-tooltip\x22,t.id=this.ID,t.innerHTML=\x22<div\x20class=\x27title-length\x27></div>\x22,this.DivElement.appendChild(t)},this.BindInfoList=function(t,e){var\x20a=\x22<div\x20class=\x27total-list\x27>共\x22+e.length+\x22条</div>\x22,i=[];for(var\x20r\x20in\x20e){var\x20n=e[r],s=n.Date;if(t==KLINE_INFO_TYPE.PFORECAST){var\x20o,h=n.ExtendData.ReportDate,l=parseInt(h/1e4),C=h%1e4;1231==C?o=\x22年报\x22:331==C?o=\x22一季度报\x22:630==C?o=\x22半年度报\x22:930==C&&(o=\x22三季度报\x22);var\x20u=\x22\x22;n.ExtendData.FWeek&&(null!=n.ExtendData.FWeek.Week1&&(u+=\x22一周后涨幅:<i\x20class=\x27increase\x27\x20style=\x27color:\x22+this.GetColor(n.ExtendData.FWeek.Week1.toFixed(2))+\x22\x27>\x22+n.ExtendData.FWeek.Week1.toFixed(2)+\x22%</i>\x22),null!=n.ExtendData.FWeek.Week4&&(u+=\x22&nbsp;四周后涨幅:<i\x20class=\x27increase\x27\x20style=\x27color:\x22+this.GetColor(n.ExtendData.FWeek.Week4.toFixed(2))+\x22\x27>\x22+n.ExtendData.FWeek.Week4.toFixed(2)+\x22%</i>\x22),u.length>0&&(u=\x22<br/>&nbsp;&nbsp;<i\x20class=\x27prorecast-week\x27>\x22+u+\x22</i>\x22)),i+=\x22<span>\x22+(S=(m=n.Date.toString()).substring(0,4)+\x22-\x22+m.substring(4,6)+\x22-\x22+m.substring(6,8))+\x22&nbsp;&nbsp;\x22+l+o+n.Title+\x22&nbsp;\x22+u+\x22</span>\x22}else\x20if(t==KLINE_INFO_TYPE.RESEARCH){var\x20D=n.ExtendData.Level,d=[];if(0==D.length)d=\x22<i>无</i>\x22;else\x20for(var\x20c\x20in\x20D)0==D[c]?d+=\x22<i\x20style=\x27color:#00a0e9\x27>证券代表&nbsp;&nbsp;&nbsp;</i>\x22:1==D[c]?d+=\x22<i>董秘&nbsp;&nbsp;&nbsp;</i>\x22:2==D[c]?d+=\x22<i\x20style=\x27color:#00a0e9\x27>总经理&nbsp;&nbsp;&nbsp;</i>\x22:3==D[c]&&(d+=\x22<i\x20style=\x27color:#00a0e9\x27>董事长&nbsp;&nbsp;&nbsp;</i>\x22);i+=\x22<span>\x22+(S=(m=n.Date.toString()).substring(0,4)+\x22-\x22+m.substring(4,6)+\x22-\x22+m.substring(6,8))+\x22&nbsp;&nbsp;&nbsp;接待:&nbsp;&nbsp;&nbsp;\x22+d+\x22</span>\x22}else\x20if(t==KLINE_INFO_TYPE.BLOCKTRADING){var\x20m,f=n.ExtendData;i+=\x22<span><i\x20class=\x27date-tipbox\x27>\x22+(S=(m=n.Date.toString()).substring(0,4)+\x22-\x22+m.substring(4,6)+\x22-\x22+m.substring(6,8))+\x22</i>&nbsp;&nbsp;<i\x20class=\x27tipBoxTitle\x27>成交价:&nbsp;\x22+f.Price.toFixed(2)+\x22</i><i\x20class=\x27tipBoxTitle\x27>收盘价:&nbsp;\x22+f.ClosePrice.toFixed(2)+\x22</i><br/><i\x20class=\x27rate-discount\x20tipBoxTitle\x27>溢折价率:&nbsp;<strong\x20style=\x27color:\x22+this.GetColor(f.Premium.toFixed(2))+\x22\x27>\x22+f.Premium.toFixed(2)+\x22%</strong></i><i\x20class=\x27tipBoxTitle\x27>成交量(万股):&nbsp;\x22+f.Vol.toFixed(2)+\x22</i></span>\x22}else\x20if(t==KLINE_INFO_TYPE.TRADEDETAIL){var\x20v=n.ExtendData.Detail,S=(I=s.toString()).substring(0,4)+\x22-\x22+I.substring(4,6)+\x22-\x22+I.substring(6,8),T=[];for(var\x20r\x20in\x20v)T+=\x22<i>\x22+v[r].TypeExplain+\x22</i><br/>\x22;i=\x22<span><i\x20class=\x27trade-time\x27>\x22+S+\x22&nbsp;&nbsp;&nbsp;上榜原因:&nbsp;&nbsp;</i><i\x20class=\x27reason-list\x27>\x22+T+\x22</i><br/><i\x20class=\x27trade-detall\x27>一周后涨幅:&nbsp;<strong\x20style=\x27color:\x22+this.GetColor(n.ExtendData.FWeek.Week1.toFixed(2))+\x22\x27>\x22+n.ExtendData.FWeek.Week1.toFixed(2)+\x22%</strong>&nbsp;&nbsp;&nbsp;四周后涨幅:&nbsp;<strong\x20style=\x27color:\x22+this.GetColor(n.ExtendData.FWeek.Week4.toFixed(2))+\x22;\x27>\x22+n.ExtendData.FWeek.Week4.toFixed(2)+\x22%</strong></i></span>\x22}else{var\x20I;i+=\x22<span>\x22+(S=(I=s.toString()).substring(0,4)+\x22-\x22+I.substring(4,6)+\x22-\x22+I.substring(6,8))+\x22&nbsp;&nbsp;&nbsp;\x22+n.Title+\x22</span>\x22}}var\x20F=$(\x22.title-length\x22).html(i);$(\x22#\x22+this.ID).html(F),e.length>8&&$(\x22#\x22+this.ID).append(a)},this.GetColor=function(t){return\x20t>0?this.UpColor:t<0?this.DownColor:this.UnchagneColor},this.Show=function(t,e,a,i,r,n){$(\x22#\x22+this.ID).css({display:\x22block\x22,top:e+\x22px\x22,left:t+\x22px\x22,width:a+\x22px\x22,height:i+\x22px\x22}),null!=this.TimeOut&&clearTimeout(this.TimeOut),this.TimeOut=setTimeout(function(){r.Hide()},n)},this.DoModal=function(t){var\x20e=t.data.Chart,a=t.data.InfoType,i=t.data.InfoList,r=e.KLineInfoTooltip;if(r){null==r.ID&&r.Create(),r.BindInfoList(a,i);var\x20n=t.pageX,s=t.pageY+10;$(\x22#\x22+r.ID).height();n+380>e.UIElement.getBoundingClientRect().width&&(n-=380),r.Show(n,s,380,\x22auto\x22,r,8e3)}},this.Leave=function(t){var\x20e=t.data.Chart.KLineInfoTooltip;e&&null!=e.ID&&e.Hide()}}function\x20MinuteDialog(t){this.newMethod=IDivDialog,this.newMethod(t),delete\x20this.newMethod,this.JSChart=null,this.Height=500,this.Width=600,this.Symbol,this.TradeDate,this.HistoryData,this.Create=function(){this.ID=Guid();var\x20t=document.createElement(\x22div\x22);t.className=\x22jchart-kline-minute-box\x22,t.id=this.ID;var\x20e=Guid();t.innerHTML=`<div><div\x20class=\x27minute-dialog-title\x27><span></span><strong\x20class=\x27close-munite\x20icon\x20iconfont\x20icon-close\x27></strong></div><div\x20class=\x27minute-hqchart\x27\x20id=\x27${e}\x27\x20></div></div>`,t.style.width=this.Height+\x22px\x22,t.style.height=this.Width+\x22px\x22,this.DivElement.appendChild(t),this.JSChart=JSChart.Init(document.getElementById(e));var\x20a={Type:\x22历史分钟走势图\x22,Symbol:this.Symbol,IsAutoUpdate:!1,IsShowRightMenu:!1,HistoryMinute:{TradeDate:this.TradeDate,IsShowName:!1,IsShowDate:!1}};this.JSChart.SetOption(a)},this.BindClose=function(t){$(\x22#\x22+this.ID+\x22\x20.close-munite\x22).click({Chart:t},function(t){t.data.Chart.MinuteDialog.Hide()})},this.DoModal=function(t){this.UpColor=g_JSChartResource.UpTextColor,this.DownColor=g_JSChartResource.DownTextColor,this.UnchagneColor=g_JSChartResource.UnchagneTextColor;var\x20e=t.data.Chart,a=t.data.Tooltip,i=e.MinuteDialog;if(i.Symbol=e.Symbol,i.TradeDate=a.Data.Date,i){null==i.ID?i.Create():(i.JSChart.JSChartContainer.TradeDate=i.TradeDate,i.JSChart.ChangeSymbol(this.Symbol));t.clientX,t.clientY;i.Show(500,100,600,500),i.JSChart.OnSize(),this.BindClose(e),this.GetColor=function(t,e){return\x20t>e?this.UpColor:t<e?this.DownColor:this.UnchagneColor};var\x20r=t.data.Chart.Name,n=t.data.Tooltip.Data,s=(new\x20Date(parseInt(n.Date/1e4),n.Date/100%100-1,n.Date%100),n.Date.toString()),o=\x22<span>\x22+r+\x22</span><span>\x22+(s.substring(0,4)+\x22-\x22+s.substring(4,6)+\x22-\x22+s.substring(6,8))+\x22</span>&nbsp;<span\x20style=\x27color:\x22+this.GetColor(n.Open,n.YClose)+\x22;\x27>开:\x22+n.Open.toFixed(2)+\x22</span><span\x20style=\x27color:\x22+this.GetColor(n.High,n.YClose)+\x22;\x27>高:\x22+n.High.toFixed(2)+\x22</span><span\x20style=\x27color:\x22+this.GetColor(n.Low,n.YClose)+\x22;\x27>低:\x22+n.Low.toFixed(2)+\x22</span><span\x20style=\x27color:\x22+this.GetColor(n.Close,n.YClose)+\x22;\x27>收:\x22+n.Close.toFixed(2)+\x22</span><span\x20style=\x27color:\x22+this.VolColor+\x22;\x27>量:\x22+IFrameSplitOperator.FormatValueString(n.Vol,2)+\x22</span><span\x20style=\x27color:\x22+this.AmountColor+\x22;\x27>额:\x22+IFrameSplitOperator.FormatValueString(n.Amount,2)+\x22</span>\x22;$(\x22.minute-dialog-title\x20span\x22).html(o)}}}function\x20KLineSelectRectDialog(t){this.newMethod=IDivDialog,this.newMethod(t),delete\x20this.newMethod,this.SelectData,this.Dialog,this.HQChart,this.Close=function(){this.Dialog&&(this.DivElement.removeChild(this.Dialog),this.Dialog=null),this.HQChart.HideSelectRect()},this.Create=function(){this.ID=Guid();var\x20t=document.createElement(\x22div\x22);t.className=\x22jchart-select-statistics-box\x22,t.id=this.ID,t.innerHTML=\x22<div\x20class=\x27parameter\x20jchart-select-section\x27>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x27parameter-header\x27>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>区间统计</span>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20id=\x27close\x27\x20class=\x27icon\x20iconfont\x20icon-close\x27></strong>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x27parameter-content\x27>统计数据</div>\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x27parameter-footer\x27>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x27close\x27\x20class=\x27submit\x27\x20>确定</button>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x27match\x27\x20class=\x27submit\x27\x20>形态匹配</button>\x20\x20\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20\x20\x20</div>\x22,this.DivElement.appendChild(t),this.Dialog=t,$(\x22#\x22+this.ID+\x22\x20#close\x22).click({divBox:this},function(t){t.data.divBox.Close()}),$(\x22#\x22+this.ID+\x22\x20#match\x22).click({divBox:this},function(t){t.data.divBox.KLineMatch()})},this.BindData=function(){for(var\x20t=this.SelectData.Data,e=this.SelectData.Start,a=this.SelectData.End,i={Open:0,Close:0,High:0,Low:0,YClose:0,Vol:0,Amount:0,Date:{Start:{Time:null,Date:null},End:{Time:null,Date:null}},Count:0,KLine:{Up:0,Down:0,Unchanged:0}},r=e;r<=a&&r<t.Data.length;++r){var\x20n=t.Data[r];r==e&&(i.Date.Start.Date=n.Date,i.Date.Start.Time=n.Time,i.Open=n.Open,i.High=n.High,i.Low=n.Low,i.YClose=n.YClose),i.Date.End.Date=n.Date,i.Date.End.Time=n.Time,i.Close=n.Close,i.Vol+=n.Vol,i.Amount+=n.Amount,++i.Count,i.High<n.High&&(i.High=n.High),i.Low>n.Low&&(i.Low=n.Low),n.Close>n.Open?++i.KLine.Up:n.Close<n.Open?++i.KLine.Down:++i.KLine.Unchanged}i.Vol>0&&(i.AvPrice=i.Amount/i.Vol),n.YClose>0&&(i.Increase=(i.Close-i.YClose)/i.YClose*100,i.Amplitude=(i.High-i.Low)/i.YClose*100);var\x20s=GetfloatPrecision(this.SelectData.Symbol),o=IFrameSplitOperator.FormatDateString(i.Date.Start.Date),h=IFrameSplitOperator.FormatDateString(i.Date.End.Date);ChartData.IsMinutePeriod(this.HQChart.Period)&&(o+=\x22\x20\x22+IFrameSplitOperator.FormatTimeString(i.Date.Start.Time,\x22HH:MM\x22),h+=\x22\x20\x22+IFrameSplitOperator.FormatTimeString(i.Date.End.Time,\x22HH:MM\x22));var\x20l=\x22\x22,C=\x22\x22,u=\x22\x22,D=\x22\x22;e<=0&&(l=\x22BtnBackground\x22),e>=a&&(C=\x22BtnBackground\x22,u=\x22BtnBackground\x22),a>=t.Data.length-1&&(D=\x22BtnBackground\x22);var\x20d=document.createElement(\x22div\x22);d.className=\x22jchart-select-table-right\x22,d.innerHTML=\x27<div\x20class=\x22jchart-select-date\x22>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>开始:\x20\x27+o+\x27<i\x20class=\x22start-date-left\x20\x27+l+\x27\x22><</i><i\x20class=\x22start-date-right\x20\x27+C+\x27\x22>></i></span>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>结束:\x20\x27+h+\x27<i\x20class=\x22end-date-left\x20\x27+u+\x27\x22><</i><i\x20class=\x22end-date-right\x20\x27+D+\x27\x22>></i></span>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>总个数:\x20\x27+i.Count+\x22</span>\x20\x20\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20\x20\x20<table>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr><td><strong>起始价:\x20</strong><span>\x22+i.YClose.toFixed(s)+\x22</span></td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><strong>最终价:\x20</strong><span>\x22+i.Close.toFixed(s)+\x22</span></td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><strong>均价:\x20</strong><span>\x22+i.AvPrice.toFixed(s)+\x22</span></td></tr>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr><td><strong>最低价:\x20</strong><span>\x22+i.Low.toFixed(s)+\x22</span></td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><strong>最高价:\x20</strong><span>\x22+i.High.toFixed(s)+\x27</span></td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><strong>涨跌幅:\x20</strong><span\x20class=\x22\x27+IFrameSplitOperator.FormatValueColor(i.Increase)+\x27\x22>\x27+i.Increase.toFixed(2)+\x22%</span></td></tr>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr><td><strong>振幅:\x20</strong><span>\x22+i.Amplitude.toFixed(2)+\x22%</span></td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><strong>成交量:\x20</strong><span>\x22+IFrameSplitOperator.FormatValueString(i.Vol,2)+\x22股</span></td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><strong>金额:\x20</strong><span>\x22+IFrameSplitOperator.FormatValueString(i.Amount,2)+\x22元</span></td></tr>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr><td><strong>阴线:\x20</strong><span>\x22+i.KLine.Up+\x22</span></td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><strong>阳线:\x20</strong><span>\x22+i.KLine.Down+\x22</span></td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td><strong>平线:\x20</strong><span>\x22+i.KLine.Unchanged+\x22</span></td></tr>\x20\x20\x20\x20\x20\x20\x20\x20</table>\x22,$(\x22.parameter-content\x22).html(d),this.BindEvent()},this.BindEvent=function(){var\x20t=this;t.SelectData.Start>0&&$(\x22.jchart-select-date\x20.start-date-left\x22).click(function(){t.SelectData.Start--,t.BindData(),t.HQChart.UpdateSelectRect(t.SelectData.Start,t.SelectData.End)}),t.SelectData.Start<t.SelectData.End&&($(\x22.jchart-select-date\x20.start-date-right\x22).click(function(){t.SelectData.Start++,t.BindData(),t.HQChart.UpdateSelectRect(t.SelectData.Start,t.SelectData.End)}),$(\x22.jchart-select-date\x20.end-date-left\x22).click(function(){t.SelectData.End--,t.BindData(),t.HQChart.UpdateSelectRect(t.SelectData.Start,t.SelectData.End)})),t.SelectData.End<t.SelectData.Data.Data.length-1&&$(\x22.jchart-select-date\x20.end-date-right\x22).click(function(){t.SelectData.End++,t.BindData(),t.HQChart.UpdateSelectRect(t.SelectData.Start,t.SelectData.End)})},this.DoModal=function(t){var\x20e=t.data.Chart;null==this.ID&&this.Create(),this.SelectData=t.data.SelectData,this.HQChart=e,this.BindData(),this.Show()},this.KLineMatch=function(t){var\x20e=new\x20WaitDialog(this.DivElement);e.DoModal({data:{Title:\x22计算中......\x22,Chart:this.HQChart}}),this.Close();var\x20a={Scope:{Plate:[\x22CNA.ci\x22],Minsimilar:.9},WaitDialog:e};this.HQChart.RequestKLineMatch(this.SelectData,a)}}function\x20KLineMatchDialog(t){this.newMethod=IDivDialog,this.newMethod(t),delete\x20this.newMethod,this.MatchData,this.Sample,this.Dialog,this.HQChart,this.PageData,this.Close=function(){this.DivElement.removeChild(this.Dialog)},this.Create=function(){this.ID=Guid();var\x20t=document.createElement(\x22div\x22);t.className=\x22jchart-kline-match-box\x22,t.id=this.ID,t.innerHTML=\x22<div\x20class=\x27parameter\x20jchart-kline-match-box\x27>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x27parameter-header\x27>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>形态匹配</span>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20id=\x27close\x27\x20class=\x27icon\x20iconfont\x20icon-close\x27></strong>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x27parameter-content\x27>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x27dataCount\x27></p>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<table\x20class=\x27matchTable\x27>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<thead>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tr>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>股票名称</td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>匹配度</td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td>时间段</td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</thead>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<tbody>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tbody>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</table>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x27pagination\x27\x20data-current=\x271\x27></div>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x27parameter-footer\x27>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x27close\x27\x20class=\x27submit\x27\x20>确定</button>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20\x20\x20</div>\x22.trim(),this.DivElement.appendChild(t),this.Dialog=t,$(\x22#\x22+this.ID+\x22\x20#close\x22).click({divBox:this},function(t){t.data.divBox.Close()})},this.BindData=function(){JSConsole.Chart.Log(`[KLineMatchDialog::BindData]\x20形态源:\x20${this.Sample.Stock.Name}\x20区间:${this.Sample.Date.Start}\x20-\x20${this.Sample.Date.End}`);var\x20t=this.MatchData.length+1,e={NewData:{},MetaData:[],PageCount:0,Count:t},a=0;$(\x22#\x22+this.ID+\x22\x20.dataCount\x22).html(\x22个数：\x22+t);for(var\x20i=0;i<t;i++){var\x20r={};if(0==i)r={Symbol:this.Sample.Stock.Symbol,Name:this.Sample.Stock.Name,Rate:\x22形态源\x22,Color:\x22red\x22,Date:`${this.Sample.Date.Start}-${this.Sample.Date.End}`};else{let\x20t=this.MatchData[i-1];r={Symbol:t.Symbol,Name:t.Name,Rate:Number(100*t.Similar).toFixed(2),Color:\x22\x22,Date:`${t.Start}-${t.End}`}}e.MetaData.push(r)}a=e.Count%10==0?e.Count/10:Math.floor(e.Count/10)+1,e.PageCount=a,this.PaginationMetaData(e),this.PageData=e,JSConsole.Chart.Log(\x22[KLineMatchDialog::DoModal\x20pageData]\x22,e),this.RenderDom(1),this.PaginationInit(\x22#\x22+this.ID,e.PageCount,this.paginationCallback)},this.RenderDom=function(t){let\x20e=this.PageData.NewData[t];JSConsole.Chart.Log(\x22[KLineMatchDialog::RenderDom\x20currentPageData]\x22,e);let\x20a=\x22\x22;for(var\x20i=0;i<e.length;i++)a+=`<tr>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=${e[i].Color}>${e[i].Name}</td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=${e[i].Color}>${e[i].Rate}</td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<td\x20class=${e[i].Color}>${e[i].Date}</td>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</tr>`.trim();$(\x22#\x22+this.ID+\x22\x20.matchTable\x20tbody\x22).html(a)};var\x20e=this;this.paginationCallback=function(t){e.RenderDom(t),e.PaginationInit(\x22#\x22+e.ID,e.PageData.PageCount,e.paginationCallback)},this.PaginationInit=function(t,e,a){var\x20i=\x22\x22,r=$(t+\x22\x20.pagination\x22).data(\x22current\x22),n=0;if(r<5)if(e>=5)for(var\x20s=0;s<5;s++)i+=s+1!=r?\x22<span>\x22+(s+1)+\x22</span>\x22:\x22<span\x20class=\x27active\x27>\x22+(s+1)+\x22</span>\x22;else\x20for(s=0;s<e;s++)i+=s+1!=r?\x22<span>\x22+(s+1)+\x22</span>\x22:\x22<span\x20class=\x27active\x27>\x22+(s+1)+\x22</span>\x22;else{n=r+1>e?r:r+1;for(var\x20o=r-3;o<=n;o++)i+=o!=r?\x22<span>\x22+o+\x22</span>\x22:\x22<span\x20class=\x27active\x27>\x22+o+\x22</span>\x22}i=\x22<span\x20class=\x27beforePage\x27>上一页</span>\x22+i+\x22<span\x20class=\x27nextPage\x27>下一页</span>\x22,$(t+\x22\x20.pagination\x22).html(i),$(t+\x22\x20.pagination\x20span\x22).bind(\x22click\x22,{maxpage:e,Callback:a},this.PaginationCurrentIndex)},this.PaginationCurrentIndex=function(t){var\x20e=$(this).text();JSConsole.Chart.Log(\x22[::PaginationCurrentIndex\x20text]\x22,e);var\x20a=Number($(this).parent().data(\x22current\x22)),i=t.data.maxpage,r=t.data.Callback,n=1;n=\x22上一页\x22===e?1===a?a:a-1:\x22下一页\x22===e?a===i?a:a+1:Number(e),$(this).parent().data(\x22current\x22,n),r(n)},this.PaginationMetaData=function(t){for(var\x20e={},a=t.MetaData,i=t.PageCount,r=0;r<i;r++){for(var\x20n=[],s=0;s<10;s++){var\x20o=10*r+s;if(!(o<=a.length-1))break;var\x20h=a[o];n.push(h)}e[r+1]=n}t.NewData=e},this.DoModal=function(t){var\x20e=t.data.Chart;null==this.ID&&this.Create(),this.MatchData=t.data.MatchData,this.Sample=t.data.Sample,this.HQChart=e,this.BindData();var\x20a=e.Frame.ChartBorder,i=(GetScrollPosition(),a.GetWidth()/2),r=a.GetHeight()/2;this.Show(i,r,200,200)}}function\x20WaitDialog(t){this.newMethod=IDivDialog,this.newMethod(t),delete\x20this.newMethod,this.Title=\x22加载中......\x22,this.Dialog,this.Close=function(){this.Dialog&&(this.DivElement.removeChild(this.Dialog),this.Dialog=null)},this.SetTitle=function(t){this.Title=t,this.Dialog},this.Create=function(){this.ID=Guid();var\x20t=document.createElement(\x22div\x22);t.className=\x22jchart-wait-box\x22,t.id=this.ID,t.innerHTML=`<div\x20class=\x27parameter\x20jchart-kline-match-box\x27>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x27parameter-header\x27>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>${this.Title}</span>\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x20\x20\x20\x20\x20\x20\x20\x20</div>`.trim(),this.DivElement.appendChild(t),this.Dialog=t},this.DoModal=function(t){this.Title=t.data.Title;var\x20e=t.data.Chart;null==this.ID&&this.Create();var\x20a=e.Frame.ChartBorder,i=(GetScrollPosition(),a.GetWidth()/2),r=a.GetHeight()/2;this.Show(i,r,200,40)}}function\x20KLineRightMenu(t){this.newMethod=IDivDialog,this.newMethod(t),delete\x20this.newMethod,this.option={},this.Create=function(){this.ID=Guid(),this.BindData(),this.BindEvent()},this.BindData=function(){var\x20t=this.DivElement.id,e=$(\x22#\x22+t);e.find(\x22div[id^=\x27topMenu_\x27]\x22).remove(),e.find(\x22div[id^=\x27childMenu_\x27]\x22).remove();var\x20a=$(\x22<div\x20/>\x22);a.attr(\x22id\x22,\x22topMenu_\x22+this.ID).addClass(\x22context-menu-wrapper\x20topmenu\x22).hide(),e.append(a);var\x20i=$(\x22<table\x20/>\x22);i.attr({id:\x22topTable_\x22+this.ID,cellspacing:\x220\x22,cellpadding:\x220\x22}).addClass(\x22context-menu\x22),a.append(i),i.append(this.childrenList(this.option.data));for(var\x20r=0;r<this.option.data.length;r++){if(void\x200!==this.option.data[r].children){var\x20n=$(\x22<div\x20/>\x22);n.attr({id:\x22childMenu_\x22+this.ID+r,\x22data-index\x22:r}).addClass(\x22context-menu-wrapper\x22).hide(),e.append(n);var\x20s=$(\x22<table\x20/>\x22);s.attr({id:\x22childTable_\x22+this.ID+r,cellspacing:\x220\x22,cellpadding:\x220\x22}).addClass(\x22context-menu\x22),n.append(s),s.append(this.childrenList(this.option.data[r].children))}}},this.Update=function(){this.BindData(),this.BindEvent()},this.childrenList=function(t){for(var\x20e=[],a=0;a<t.length;a++){var\x20i=void\x200!==t[a].isBorder&&t[a].isBorder,r=$(\x22<tr\x20/>\x22);r.addClass(\x22font_Arial\x20context-menu\x22),i&&r.addClass(\x22border\x22);var\x20n=$(\x22<td\x20/>\x22);t[a].selected?n.addClass(\x22spacer\x20context-menu\x22).html(\x22√\x22):n.addClass(\x22spacer\x20context-menu\x22);var\x20s=$(\x22<td\x20/>\x22);s.addClass(\x22text\x22).html(t[a].text);var\x20o=$(\x22<td\x20/>\x22);o.addClass(\x22right\x20shortcut\x22);var\x20h=$(\x22<td\x20/>\x22);h.addClass(void\x200!==t[a].children?\x22submenu-arrow\x22:\x22context-menu\x20spacer\x22),r.append(n).append(s).append(o).append(h),e.push(r)}return\x20e},this.Show=function(t){$.extend(this.option,t),this.ID?this.Update():this.Create();var\x20e=$(\x22#topMenu_\x22+this.ID),a=e.outerWidth(),i=e.outerHeight(),r=this.option.x,n=this.option.y;a>this.option.position.X+this.option.position.W-r&&(r-=a),i>this.option.position.Y+this.option.position.H-n&&(n-=i),e.hide(),e.css({position:\x22absolute\x22,left:r+\x22px\x22,top:n+\x22px\x22}).show(),this.isInit=!0},this.Hide=function(){$(\x22#topMenu_\x22+this.ID).hide(),$(\x22[id^=\x27childMenu_\x22+this.ID+\x22\x27]\x22).hide()},this.BindEvent=function(){var\x20t=this,e=$(\x22[id^=\x27childMenu_\x22+t.ID+\x22\x27]\x22);$(\x22#topTable_\x22+t.ID).find(\x22tr\x22).mouseenter(function(){var\x20a=$(this),i=a.index(),r=$(\x22#topMenu_\x22+t.ID),n=$(\x22#childMenu_\x22+t.ID+i),s=a.outerWidth(),o=a.outerHeight(),h=r.position().left+s+1,l=r.position().top+o*i;s>t.option.position.X+t.option.position.W-h&&(h=h-s-r.outerWidth()-2),n.outerHeight()>t.option.position.Y+t.option.position.H-l&&(l=r.position().top+r.outerHeight()-n.outerHeight()),e.hide(),n.css({left:h+\x22px\x22,top:l+\x22px\x22}).show()}).mouseleave(function(){var\x20e=$(this).index();setTimeout(function(){1!=$(\x22#childMenu_\x22+t.ID+e).attr(\x22data-isShow\x22)&&$(\x22#childMenu_\x22+t.ID+e).hide()},10)}).click(function(){var\x20e=$(this),a=e.index();\x22function\x22==$.type(t.option.data[a].click)&&(t.option.data[a].click(t.option.returnData),e.hide())}).contextmenu(function(){return!1}),e.mouseenter(function(){$(this).attr(\x22data-isShow\x22,\x221\x22)}).mouseleave(function(){$(this).attr(\x22data-isShow\x22,\x220\x22)}).contextmenu(function(){return!1}),e.find(\x22tr\x22).click(function(){var\x20a=$(this),i=parseInt(a.closest(\x22div\x22).attr(\x22data-index\x22)),r=a.index();\x22function\x22==$.type(t.option.data[i].children[r].click)&&(t.option.data[i].children[r].click(t.option.windowIndex||1),e.hide())})},this.GetPeriod=function(t){var\x20e=[{text:\x22日线\x22,Value:0,click:function(){t.ChangePeriod(0)}},{text:\x22周线\x22,Value:1,click:function(){t.ChangePeriod(1)}},{text:\x22双周线\x22,Value:21,click:function(){t.ChangePeriod(21)}},{text:\x22月线\x22,Value:2,click:function(){t.ChangePeriod(2)}},{text:\x22季线\x22,Value:9,click:function(){t.ChangePeriod(9)}},{text:\x22年线\x22,Value:3,click:function(){t.ChangePeriod(3)}},{text:\x221分\x22,Value:4,click:function(){t.ChangePeriod(4)}},{text:\x225分\x22,Value:5,click:function(){t.ChangePeriod(5)}},{text:\x2215分\x22,Value:6,click:function(){t.ChangePeriod(6)}},{text:\x2230分\x22,Value:7,click:function(){t.ChangePeriod(7)}},{text:\x2260分\x22,Value:8,click:function(){t.ChangePeriod(8)}},{text:\x222小时\x22,Value:11,click:function(){t.ChangePeriod(11)}},{text:\x224小时\x22,Value:12,click:function(){t.ChangePeriod(12)}},{text:\x22分笔\x22,Value:10,click:function(){t.ChangePeriod(10)}},{text:\x22自定义周期:3分钟\x22,Value:20003,click:function(){t.ChangePeriod(20003)}},{text:\x22自定义周期:35分钟\x22,Value:20035,click:function(){t.ChangePeriod(20035)}},{text:\x22自定义周期:8日\x22,Value:40008,click:function(){t.ChangePeriod(40008)}}];for(var\x20a\x20in\x20e){var\x20i=e[a];if(i.Value==t.Period){i.selected=!0;break}}return\x20e},this.GetRight=function(t){var\x20e=[{text:\x22不复权\x22,click:function(){t.ChangeRight(0)}},{text:\x22前复权\x22,click:function(){t.ChangeRight(1)}},{text:\x22后复权\x22,click:function(){t.ChangeRight(2)}}];return\x20t.Right>=0&&t.Right<e.length&&(e[t.Right].selected=!0),e},this.GetIndex=function(t){return[{text:\x22均线\x22,click:function(e){t.ChangeIndex(e,\x22均线\x22)}},{text:\x22BOLL\x22,click:function(e){t.ChangeIndex(e,\x22BOLL\x22)},isBorder:!0},{text:\x22MACD\x22,click:function(e){t.ChangeIndex(e,\x22MACD\x22)}},{text:\x22KDJ\x22,click:function(e){t.ChangeIndex(e,\x22KDJ\x22)}},{text:\x22VOL\x22,click:function(e){t.ChangeIndex(e,\x22VOL\x22)}},{text:\x22RSI\x22,click:function(e){t.ChangeIndex(e,\x22RSI\x22)}},{text:\x22BRAR\x22,click:function(e){t.ChangeIndex(e,\x22BRAR\x22)}},{text:\x22WR\x22,click:function(e){t.ChangeIndex(e,\x22WR\x22)}},{text:\x22BIAS\x22,click:function(e){t.ChangeIndex(e,\x22BIAS\x22)}},{text:\x22OBV\x22,click:function(e){t.ChangeIndex(e,\x22OBV\x22)}},{text:\x22DMI\x22,click:function(e){t.ChangeIndex(e,\x22DMI\x22)}},{text:\x22CR\x22,click:function(e){t.ChangeIndex(e,\x22CR\x22)}},{text:\x22PSY\x22,click:function(e){t.ChangeIndex(e,\x22PSY\x22)}},{text:\x22CCI\x22,click:function(e){t.ChangeIndex(e,\x22CCI\x22)}},{text:\x22DMA\x22,click:function(e){t.ChangeIndex(e,\x22DMA\x22)}},{text:\x22TRIX\x22,click:function(e){t.ChangeIndex(e,\x22TRIX\x22)}},{text:\x22VR\x22,click:function(e){t.ChangeIndex(e,\x22VR\x22)}},{text:\x22EMV\x22,click:function(e){t.ChangeIndex(e,\x22EMV\x22)}},{text:\x22ROC\x22,click:function(e){t.ChangeIndex(e,\x22ROC\x22)}},{text:\x22MIM\x22,click:function(e){t.ChangeIndex(e,\x22MIM\x22)}},{text:\x22FSL\x22,click:function(e){t.ChangeIndex(e,\x22FSL\x22)}}]},this.GetColorIndex=function(t){var\x20e=[{text:\x22十字星\x22,click:function(e){t.ChangeInstructionIndex(\x22五彩K线-十字星\x22)}},{text:\x22早晨之星\x22,click:function(e){t.ChangeInstructionIndex(\x22五彩K线-早晨之星\x22)}},{text:\x22垂死十字\x22,click:function(e){t.ChangeInstructionIndex(\x22五彩K线-垂死十字\x22)}},{text:\x22三只乌鸦\x22,click:function(e){t.ChangeInstructionIndex(\x22五彩K线-三只乌鸦\x22)}},{text:\x22光脚阴线\x22,click:function(e){t.ChangeInstructionIndex(\x22五彩K线-光脚阴线\x22)}},{text:\x22黄昏之星\x22,click:function(e){t.ChangeInstructionIndex(\x22五彩K线-黄昏之星\x22)}}];return\x20t.ColorIndex&&(e[e.length-1].isBorder=!0,e.push({text:\x22删除五彩K线\x22,click:function(e){t.CancelInstructionIndex()}})),e},this.GetTradeIndex=function(t){var\x20e=[{text:\x22BIAS\x22,click:function(e){t.ChangeInstructionIndex(\x22交易系统-BIAS\x22)}},{text:\x22CCI\x22,click:function(e){t.ChangeInstructionIndex(\x22交易系统-CCI\x22)}},{text:\x22DMI\x22,click:function(e){t.ChangeInstructionIndex(\x22交易系统-DMI\x22)}},{text:\x22KD\x22,click:function(e){t.ChangeInstructionIndex(\x22交易系统-KD\x22)}},{text:\x22BOLL\x22,click:function(e){t.ChangeInstructionIndex(\x22交易系统-BOLL\x22)}},{text:\x22KDJ\x22,click:function(e){t.ChangeInstructionIndex(\x22交易系统-KDJ\x22)}}];return\x20t.TradeIndex&&(e[e.length-1].isBorder=!0,e.push({text:\x22删除专家系统\x22,click:function(e){t.CancelInstructionIndex()}})),e},this.GetOverlay=function(t){var\x20e=[{text:\x22上证指数\x22,click:function(){t.OverlaySymbol(\x22000001.sh\x22)}},{text:\x22深证成指\x22,click:function(){t.OverlaySymbol(\x22399001.sz\x22)}},{text:\x22中小板指\x22,click:function(){t.OverlaySymbol(\x22399005.sz\x22)}},{text:\x22创业板指\x22,click:function(){t.OverlaySymbol(\x22399006.sz\x22)}},{text:\x22沪深300\x22,click:function(){t.OverlaySymbol(\x22000300.sh\x22)}}];for(var\x20a\x20in\x20t.OverlayChartPaint){var\x20i=t.OverlayChartPaint[a].Symbol;const\x20n=new\x20Map([[\x22000001.sh\x22,0],[\x22399001.sz\x22,1],[\x22399005.sz\x22,2],[\x22399006.sz\x22,3],[\x22000300.sh\x22,4]]);if(n.has(i)){var\x20r=e[n.get(i)];let\x20a=i;r.selected=!0,r.click=function(){t.DeleteOverlaySymbol(a)}}}return\x20t.OverlayChartPaint&&t.OverlayChartPaint.length>0&&(e[e.length-1].isBorder=!0,e.push({text:\x22取消叠加\x22,click:function(){t.ClearOverlaySymbol()}})),e},this.GetKLineType=function(t){var\x20e=[{text:\x22K线(空心阳线)\x22,click:function(){t.ChangeKLineDrawType(3)}},{text:\x22K线(实心阳线)\x22,click:function(){t.ChangeKLineDrawType(0)}},{text:\x22美国线\x22,click:function(){t.ChangeKLineDrawType(2)}},{text:\x22收盘线\x22,click:function(){t.ChangeKLineDrawType(1)}},{text:\x22收盘面积\x22,click:function(){t.ChangeKLineDrawType(4)}}];switch(t.KLineDrawType){case\x200:e[1].selected=!0;break;case\x201:e[3].selected=!0;break;case\x202:e[2].selected=!0;break;case\x203:e[0].selected=!0;break;case\x204:e[4].selected=!0}return\x20e},this.GetIndexWindowCount=function(t){var\x20e=[{text:\x221个窗口\x22,click:function(){t.ChangeIndexWindowCount(1)}},{text:\x222个窗口\x22,click:function(){t.ChangeIndexWindowCount(2)}},{text:\x223个窗口\x22,click:function(){t.ChangeIndexWindowCount(3)}},{text:\x224个窗口\x22,click:function(){t.ChangeIndexWindowCount(4)}},{text:\x225个窗口\x22,click:function(){t.ChangeIndexWindowCount(5)}}],a=t.Frame.SubFrame.length;return\x20a-1>=0&&a-1<e.length&&(e[a-1].selected=!0),e},this.GetCoordinateType=function(t){var\x20e=[{text:\x22普通坐标\x22,click:function(){t.ChangeCoordinateType({Type:0})}},{text:\x22百分比坐标\x22,click:function(){t.ChangeCoordinateType({Type:1})}},{text:\x22反转坐标\x22,click:function(){t.ChangeCoordinateType({IsReverse:!0})}},{text:\x22对数坐标\x22,click:function(){t.ChangeCoordinateType({Type:2})}}];return\x20t.Frame&&t.Frame.SubFrame&&t.Frame.SubFrame.length>0&&(1==t.Frame.SubFrame[0].Frame.CoordinateType&&(e[2].selected=!0,e[2].click=function(){t.ChangeCoordinateType({IsReverse:!1})}),1==t.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType?e[1].selected=!0:0==t.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType?e[0].selected=!0:2==t.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType&&(e[3].selected=!0)),e},this.GetDragModeType=function(t){var\x20e=[{text:\x22禁止拖拽\x22,click:function(){t.DragMode=0}},{text:\x22启动拖拽\x22,click:function(){t.DragMode=1}},{text:\x22区间选择\x22,click:function(){t.DragMode=2}}];return\x20t.DragMode>=0&&t.DragMode<e.length&&(e[t.DragMode].selected=!0),e},this.GetTools=function(t){var\x20e=[],a=t.GetExtendChartByClassName(\x22DrawToolsButton\x22);a?e.push({text:\x22关闭画图工具\x22,click:function(){for(var\x20e=a.Chart.Width,i=parseInt(a.Index)+1;i<t.ExtendChartPaint.length;++i){var\x20r=t.ExtendChartPaint[i];\x22StockChip\x22==r.ClassName&&(r.Left-=e)}t.DeleteExtendChart(a),t.Frame.ChartBorder.Right-=e,t.SetSizeChage(!0),t.Draw()}}):e.push({text:\x22画图工具\x22,click:function(){var\x20e={Name:\x22画图工具\x22,Top:t.Frame.ChartBorder.Top};t.CreateExtendChart(e.Name,e);t.SetSizeChage(!0),t.Draw()}});var\x20i=t.GetExtendChartByClassName(\x22StockChip\x22);return\x20i?e.push({text:\x22关闭移动筹码\x22,click:function(){for(var\x20e=i.Chart.Width,a=parseInt(i.Index)+1;a<t.ExtendChartPaint.length;++a){var\x20r=t.ExtendChartPaint[a];\x22DrawToolsButton\x22==r.ClassName&&(r.Left-=e)}t.DeleteExtendChart(i),t.Frame.ChartBorder.Right-=e,t.SetSizeChage(!0),t.Draw()}}):e.push({text:\x22移动筹码\x22,click:function(){var\x20e={Name:\x22筹码分布\x22,ShowType:1,Width:230};t.CreateExtendChart(e.Name,e);t.SetSizeChage(!0),t.Draw()}}),e},this.GetKLineInfo=function(t){var\x20e=new\x20Set;for(var\x20a\x20in\x20t.ChartInfo){var\x20i=t.ChartInfo[a];e.add(i.ClassName)}var\x20r=[\x22公告\x22,\x22业绩预告\x22,\x22调研\x22,\x22大宗交易\x22,\x22龙虎榜\x22,\x22互动易\x22],n=[];for(var\x20a\x20in\x20r){var\x20s=r[a],o=JSKLineInfoMap.GetClassInfo(s);if(o){i=this.CreateKlineInfoItem(s,e.has(o.ClassName),t);n.push(i)}}if(t.ChartInfo.length>0){n[n.length-1].isBorder=!0;i={text:\x22删除所有\x22,click:function(){t.ClearKLineInfo()}};n.push(i)}return\x20n},this.CreateKlineInfoItem=function(t,e,a){var\x20i={text:t,selected:e};return\x20i.click=e?function(){a.DeleteKLineInfo(t)}:function(){a.AddKLineInfo(t,!0)},i},this.DoModal=function(t){var\x20e=t.data.Chart,a=e.RightMenu,i=t.offsetX,r=t.offsetY,n=[{text:\x22分析周期\x22,children:this.GetPeriod(e)},{text:\x22复权处理\x22,children:this.GetRight(e)},{text:\x22指标切换\x22,children:this.GetIndex(e)},{text:\x22五彩K线\x22,children:this.GetColorIndex(e)},{text:\x22专家系统\x22,children:this.GetTradeIndex(e)},{text:\x22信息地雷\x22,children:this.GetKLineInfo(e)},{text:\x22叠加品种\x22,children:this.GetOverlay(e)},{text:\x22主图线型\x22,children:this.GetKLineType(e)},{text:\x22坐标类型\x22,children:this.GetCoordinateType(e)},{text:\x22指标窗口个数\x22,children:this.GetIndexWindowCount(e)},{text:\x22鼠标拖拽\x22,children:this.GetDragModeType(e)},{text:\x22工具\x22,children:this.GetTools(e)}],s=e.Symbol.toUpperCase();(MARKET_SUFFIX_NAME.IsSHSZIndex(e.Symbol)||MARKET_SUFFIX_NAME.IsBIT(s))&&n.splice(1,1);var\x20o=t.data.FrameID,h=this.GetOverlayIndex(e,o);if(h&&h.length>0){var\x20l={text:\x22删除叠加指标\x22,children:this.GetDeleteOverlayIndex(e,h)};n.splice(3,0,l)}JSConsole.Chart.Log(\x22[KLineRightMenu::DoModal]\x22,o),a.Show({windowIndex:o,x:i+e.UIElement.offsetLeft,y:r+e.UIElement.offsetTop,position:e.Frame.Position,data:n}),$(document).click(function(){a.Hide()})},this.GetOverlayIndex=function(t,e){if(e>=t.Frame.SubFrame.length)return[];var\x20a=[],i=t.Frame.SubFrame[e];for(var\x20r\x20in\x20i.OverlayIndex){var\x20n=i.OverlayIndex[r];a.push({Name:n.Script.Name,Identify:n.Identify})}return\x20a},this.GetDeleteOverlayIndex=function(t,e){var\x20a=[];for(var\x20i\x20in\x20e){let\x20r=e[i].Identify;a.push({text:e[i].Name,click:function(){t.DeleteOverlayWindowsIndex(r)}})}return\x20a}}function\x20KLineSelectRightMenu(t){this.newMethod=KLineRightMenu,this.newMethod(t),delete\x20this.newMethod,this.DoModal=function(e){var\x20a=e.data.Chart,i=this,r=e.data.X,n=e.data.Y,s=[{text:\x22区间统计\x22,click:function(){JSConsole.Chart.Log(\x22[KLineSelectRightMenu::click]\x20区间统计\x22),i.Hide(),new\x20KLineSelectRectDialog(t).DoModal(e)}},{text:\x22区间放大\x22,click:function(){JSConsole.Chart.Log(\x22[KLineSelectRightMenu::click]\x20区间放大\x22),e.data.Chart.ShowSelectData(e.data.SelectData)}}];i.Show({x:r,y:n,position:a.Frame.Position,data:s})},this.Show=function(t){$.extend(this.option,t),this.ID||this.Create();var\x20e=\x22topMenu_\x22+this.ID;document.getElementById(e)||this.Create();var\x20a=$(\x22#topMenu_\x22+this.ID),i=a.outerWidth(),r=a.outerHeight();a.contextmenu(function(){return!1});var\x20n=this.option.x,s=this.option.y;i>this.option.position.X+this.option.position.W-n&&(n-=i),r>this.option.position.Y+this.option.position.H-s&&(s-=r),a.hide(),a.css({position:\x22absolute\x22,left:n+\x22px\x22,top:s+\x22px\x22}).show(),$(\x22#topMenu_\x22+this.ID).find(\x22tr\x22).show(),this.isInit=!0}}function\x20MinuteRightMenu(t){this.newMethod=KLineRightMenu,this.newMethod(t),delete\x20this.newMethod,this.DoModal=function(t){var\x20e=t.data.Chart,a=e.RightMenu,i=t.offsetX,r=t.offsetY,n=[{text:\x22叠加品种\x22,children:this.GetOverlay(e)},{text:\x22多日分时图\x22,children:this.GetDayCount(e)},{text:\x22指标窗口个数\x22,children:this.GetIndexWindowCount(e)},{text:\x22副图指标切换\x22,children:this.GetIndex(e)}],s=e.Symbol;MARKET_SUFFIX_NAME.IsSHSZStockA(s)&&n.push({text:\x22集合竞价\x22,children:this.GetShowBeforeData(e)});var\x20o=t.data.FrameID;JSConsole.Chart.Log(\x22[MinuteRightMenu::DoModal]\x22,o),a.Show({windowIndex:o,x:i+e.UIElement.offsetLeft,y:r+e.UIElement.offsetTop,position:e.Frame.Position,data:n}),$(document).click(function(){a.Hide()})},this.GetDayCount=function(t){var\x20e=[{text:\x22当日分时图\x22,click:function(){t.ChangeDayCount(1)},isBorder:!0},{text:\x22最近2日\x22,click:function(){t.ChangeDayCount(2)}},{text:\x22最近3日\x22,click:function(){t.ChangeDayCount(3)}},{text:\x22最近4日\x22,click:function(){t.ChangeDayCount(4)}},{text:\x22最近5日\x22,click:function(){t.ChangeDayCount(5)}},{text:\x22最近6日\x22,click:function(){t.ChangeDayCount(6)}}];return\x20t.DayCount-1>=0&&t.DayCount-1<e.length&&(e[t.DayCount-1].selected=!0),e},this.GetIndex=function(t){return[{text:\x22MACD\x22,click:function(e){t.ChangeIndex(e,\x22MACD\x22)}},{text:\x22DMI\x22,click:function(e){t.ChangeIndex(e,\x22DMI\x22)}},{text:\x22DMA\x22,click:function(e){t.ChangeIndex(e,\x22DMA\x22)}},{text:\x22BRAR\x22,click:function(e){t.ChangeIndex(e,\x22BRAR\x22)}},{text:\x22KDJ\x22,click:function(e){t.ChangeIndex(e,\x22KDJ\x22)}},{text:\x22RSI\x22,click:function(e){t.ChangeIndex(e,\x22RSI\x22)}},{text:\x22WR\x22,click:function(e){t.ChangeIndex(e,\x22WR\x22)}},{text:\x22CCI\x22,click:function(e){t.ChangeIndex(e,\x22CCI\x22)}},{text:\x22TRIX\x22,click:function(e){t.ChangeIndex(e,\x22TRIX\x22)}}]},this.GetShowBeforeData=function(t){return\x20t.IsShowBeforeData?[{text:\x22隐藏\x22,click:function(){t.ShowBeforeData(!1)}}]:[{text:\x22显示\x22,click:function(){t.ShowBeforeData(!0)}}]},this.GetIndexWindowCount=function(t){var\x20e=[{text:\x221个窗口\x22,click:function(){t.ChangeIndexWindowCount(2)}},{text:\x222个窗口\x22,click:function(){t.ChangeIndexWindowCount(3)}},{text:\x223个窗口\x22,click:function(){t.ChangeIndexWindowCount(4)}}],a=t.Frame.SubFrame.length-1;return\x20a-1>=0&&a-1<e.length&&(e[a-1].selected=!0),e}}function\x20ChartPictureSettingMenu(t){this.newMethod=IDivDialog,this.newMethod(t),delete\x20this.newMethod,this.HQChart,this.ChartPicture,this.SubToolsDiv,this.SettingMenu,this.DoModal=function(t){if(!this.SubToolsDiv){this.ID=Guid();var\x20e=document.createElement(\x22div\x22);e.className=\x22subTolls\x22,e.id=this.ID,this.DivElement.appendChild(e),this.SubToolsDiv=e}this.HQChart=t.data.HQChart,this.ChartPicture=t.data.ChartPicture;var\x20a=GetDevicePixelRatio(),i=this.HQChart.Frame.SubFrame[0].Frame,r=i.ChartBorder.Top+40,n=i.ChartBorder.Right,s=i.ChartBorder.GetLeft(),o=\x22\x22;o=\x22ChartDrawPictureText\x22===this.ChartPicture.ClassName?\x27<span\x20class=\x22changes-color\x22\x20title=\x22改变图形颜色\x22><i\x20class=\x22iconfont\x20icon-bianji\x22></i><input\x20type=\x22color\x22\x20name=\x22color\x22\x20id=\x22color\x22\x20class=\x22change-color\x22\x20value=\x22\x27+this.ChartPicture.LineColor+\x27\x22></span><span\x20class=\x22subtool-set\x22\x20title=\x22设置\x22><i\x20class=\x22iconfont\x20icon-shezhi\x22></i></span><span\x20class=\x22subtool-del\x22><i\x20class=\x22iconfont\x20icon-recycle_bin\x22></i></span>\x27:\x27<p\x20class=\x22changes-color\x22\x20title=\x22改变图形颜色\x22><i\x20class=\x22iconfont\x20icon-bianji\x22></i><input\x20type=\x22color\x22\x20name=\x22color\x22\x20id=\x22color\x22\x20class=\x22change-color\x22\x20value=\x22\x27+this.ChartPicture.LineColor+\x27\x22></p>\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22subtool-del\x22><i\x20class=\x22iconfont\x20icon-recycle_bin\x22></i></p>\x27,this.SubToolsDiv.style.right=n/a+\x22px\x22,this.SubToolsDiv.style.top=r/a+\x22px\x22,this.SubToolsDiv.innerHTML=o,this.SubToolsDiv.style.position=\x22absolute\x22,this.SubToolsDiv.style.display=\x22block\x22;var\x20h=this.HQChart,l=this.ChartPicture;this.SubToolsDiv;$(\x22.subtool-del\x22).click(function(){h.ClearChartDrawPicture(l),$(\x22.subTolls\x22).css(\x22display\x22,\x22none\x22)});var\x20C=this;$(\x22.subtool-set\x22).click(function(){$(C.SubToolsDiv).hide(),this.SettingMenu||(C.SettingMenu=new\x20ChartPictureTextSettingMenu(i.ChartBorder.UIElement.parentNode)),C.SettingMenu.ChartPicture=l,C.SettingMenu.HQChart=h,C.SettingMenu.Position={Left:n+80,Top:r+20},C.SettingMenu.DoModal()}),$(\x22.changes-color\x22).click(function(){document.getElementById(\x22color\x22).click(),$(\x22.change-color\x22).change(function(){var\x20t=$(\x22.change-color\x22).val();l.LineColor=t,l.PointColor=t,h.ChartDrawStorage&&h.ChartDrawStorage.SaveDrawData(l)})}),JSConsole.Chart.Log(\x22[ChartPictureSettingMenu::DoModal]\x22,{Top:r,Left:s,Right:n})}}function\x20ChartPictureTextSettingMenu(t){this.newMethod=IDivDialog,this.newMethod(t),delete\x20this.newMethod,this.ChartPicture,this.SettingDiv,this.Position,this.BackupData,this.Close=function(){this.SettingDiv&&this.DivElement.removeChild(this.SettingDiv)},this.DoModal=function(){var\x20t=this.ChartPicture.Text,e=this.ChartPicture.FontOption,a=this.ChartPicture.LineColor;this.BackupData={Text:t,LineColor:a,FontOption:{Family:e.Family,Size:e.Size,Weight:e.Weight,Style:e.Style}},JSConsole.Chart.Log(\x22[ChartPictureTextSettingMenu::DoModal]\x20picture\x20info\x22,this.BackupData);var\x20i=this,r=this.DivElement.getElementsByClassName(\x22chartpicture-text-setting\x22)[0];r?this.SettingDiv=r:((r=document.createElement(\x22div\x22)).className=\x22chartpicture-text-setting\x22,this.DivElement.appendChild(r),this.SettingDiv=r);var\x20n=[10,11,12,14,16,20,24,28,32,40],s=[\x22微软雅黑\x22,\x22宋体\x22,\x22Arial\x22,\x22仿宋\x22],o=\x22\x22,h=\x22\x22;s.forEach(function(t,e){h+=0!==e?\x22<p>\x22+t+\x22</P>\x22:\x27<p\x20class=\x22active\x22>\x27+t+\x22</P>\x22}),n.forEach(function(t,e){o+=5!==e?\x22<p>\x22+t+\x22</P>\x22:\x27<p\x20class=\x22active\x22>\x27+t+\x22</P>\x22});var\x20l=\x27<div\x20class=\x22contentWrap\x22><div\x20class=\x22styleOptions\x22><span\x20class=\x22colorPicker\x22><input\x20type=\x22color\x22\x20id=\x22fontColor\x22\x20value=\x22#1e90ff\x22></span><div\x20class=\x22likeSelect\x20fontSelect\x22><span\x20class=\x22choicedText\x22>微软雅黑</span><div\x20class=\x22selectList\x22>\x27+h+\x27</div><i\x20class=\x22iconfont\x20icon-xia\x22></i></div><div\x20class=\x22likeSelect\x20fontSizeSelect\x22><span\x20class=\x22choicedText\x22>20</span><div\x20class=\x22selectList\x22>\x27+o+\x27</div><i\x20class=\x22iconfont\x20icon-xia\x22></i></div><span\x20class=\x22strongFont\x20likeBtn\x22><i\x20class=\x22iconfont\x20icon-jiacu\x22></i></span><span\x20class=\x22italicsFont\x20likeBtn\x22><i\x20class=\x22iconfont\x20icon-qingxieL\x22></i></span></div><textarea\x20class=\x22tArea\x22\x20id=\x22tArea\x22\x20placeholder=\x22Text\x22></textarea></div>\x27,C=GetDevicePixelRatio(),u=\x27<div\x20class=\x22titleWrap\x22><span\x20class=\x22titleName\x22>样式设置</span><i\x20class=\x22closeBtn\x20iconfont\x20icon-close\x22></i></div>\x27+l+\x27<div\x20class=\x22btnsContainer\x22><span\x20class=\x22okBtn\x20btn\x22>确认</span><span\x20class=\x22cancelBtn\x20btn\x22>取消</span></div>\x27;this.SettingDiv.style.left=this.Position.Left/C+\x22px\x22,this.SettingDiv.style.top=this.Position.Top/C+\x22px\x22,this.SettingDiv.innerHTML=u,this.SettingDiv.style.position=\x22absolute\x22,this.SettingDiv.style.display=\x22block\x22,$(\x22.chartpicture-text-setting\x20.colorPicker\x22).css({borderColor:i.ChartPicture.LineColor,\x22background-color\x22:i.ChartPicture.LineColor});var\x20D=this.ChartPicture.FontOption.Family;$(\x22.chartpicture-text-setting\x20.fontSelect\x20.choicedText\x22).html(D),s.forEach(function(t,e){t==D&&($(\x22.chartpicture-text-setting\x20.fontSelect\x20p\x22).removeClass(\x22active\x22),$(\x22.chartpicture-text-setting\x20.fontSelect\x20p\x22).eq(e).addClass(\x22active\x22))});var\x20d=this.ChartPicture.FontOption.Size;$(\x22.chartpicture-text-setting\x20.fontSizeSelect\x20.choicedText\x22).html(d),n.forEach(function(t,e){t==d&&($(\x22.chartpicture-text-setting\x20.fontSizeSelect\x20p\x22).removeClass(\x22active\x22),$(\x22.chartpicture-text-setting\x20.fontSizeSelect\x20p\x22).eq(e).addClass(\x22active\x22))});var\x20c=this.ChartPicture.FontOption.Weight;null!=c&&\x22bold\x22==c&&$(\x22.chartpicture-text-setting\x20.strongFont\x22).addClass(\x22hot\x22);var\x20m=this.ChartPicture.FontOption.Style;null!=m&&\x22italic\x22==m&&$(\x22.chartpicture-text-setting\x20.italicsFont\x22).addClass(\x22hot\x22);t=this.ChartPicture.Text;$(\x22.chartpicture-text-setting\x20.tArea\x22).val(t);$(\x22.chartpicture-text-setting\x20#fontColor\x22).change({Picture:this.ChartPicture},function(t){var\x20e=$(this).val();$(this).parent().css({borderColor:e,\x22background-color\x22:e});var\x20a=t.data.Picture;a.LineColor=e,a.Update&&a.Update()}),$(\x22.chartpicture-text-setting\x20.fontSelect,.chartpicture-text-setting\x20.fontSizeSelect\x22).click(function(){$(this).find(\x22.selectList\x22).toggle(),$(this).toggleClass(\x22hot\x22)}),$(\x22.chartpicture-text-setting\x20.fontSelect\x20p\x22).click({Picture:this.ChartPicture},function(t){var\x20e=$(this).closest(\x22.fontSelect\x22).find(\x22.choicedText\x22).html(),a=t.currentTarget.innerHTML;if(e!==a){$(this).closest(\x22.fontSelect\x22).find(\x22.choicedText\x22).html(a),$(this).siblings().removeClass(\x22active\x22),$(this).addClass(\x22active\x22);var\x20i=t.data.Picture;i.FontOption.Family=a,i.Update&&i.Update()}}),$(\x22.chartpicture-text-setting\x20.fontSizeSelect\x20p\x22).click({Picture:this.ChartPicture},function(t){var\x20e=$(this).closest(\x22.fontSizeSelect\x22).find(\x22.choicedText\x22).html(),a=t.currentTarget.innerHTML;if(e!==a){$(this).closest(\x22.fontSizeSelect\x22).find(\x22.choicedText\x22).html(a),$(this).siblings().removeClass(\x22active\x22),$(this).addClass(\x22active\x22);var\x20i=t.data.Picture;i.FontOption.Size=Number(a),i.Update&&i.Update()}}),$(\x22.chartpicture-text-setting\x20.strongFont\x22).click({Picture:this.ChartPicture},function(t){if($(this).toggleClass(\x22hot\x22),$(this).attr(\x22class\x22).indexOf(\x22hot\x22)>0){var\x20e=t.data.Picture;e.FontOption.Weight=\x22bold\x22,e.Update&&e.Update()}}),$(\x22.chartpicture-text-setting\x20.italicsFont\x22).click({Picture:this.ChartPicture},function(t){if($(this).toggleClass(\x22hot\x22),$(this).attr(\x22class\x22).indexOf(\x22hot\x22)>0){var\x20e=t.data.Picture;e.FontOption.Style=\x22italic\x22,e.Update&&e.Update()}}),$(\x22.chartpicture-text-setting\x20.titleWrap\x20.closeBtn,.chartpicture-text-setting\x20.btnsContainer\x20.cancelBtn\x22).click({Picture:this.ChartPicture},function(t){var\x20e=t.data.Picture;e.Text=i.BackupData.Text,e.LineColor=i.BackupData.LineColor,e.FontOption=i.BackupData.FontOption,e.Update&&e.Update(),i.Close()}),$(\x22.chartpicture-text-setting\x20.tArea\x22).keyup({Picture:this.ChartPicture},function(t){JSConsole.Chart.Log(\x27[ChartPictureTextSettingMenu::DoModal]\x20$(\x22.chartpicture-text-setting\x20.tArea\x22).keyup()\x27);var\x20e=$(this).val(),a=t.data.Picture;a.Text=e,a.Update&&a.Update()}),$(\x22.chartpicture-text-setting\x20.btnsContainer\x20.okBtn\x22).click(function(){i.Close(),i.HQChart&&i.HQChart.ChartDrawStorage&&i.HQChart.ChartDrawStorage.SaveDrawData(i.ChartPicture)})}}JSIndexMap.Get=function(t){return\x20new\x20Map([[\x22市场多空\x22,{IsMainIndex:!1,Create:function(){return\x20new\x20MarketLongShortIndex}}],[\x22市场择时\x22,{IsMainIndex:!1,Create:function(){return\x20new\x20MarketTimingIndex}}],[\x22市场关注度\x22,{IsMainIndex:!1,Create:function(){return\x20new\x20MarketAttentionIndex}}],[\x22指数热度\x22,{IsMainIndex:!1,Create:function(){return\x20new\x20MarketHeatIndex}}],[\x22财务粉饰\x22,{IsMainIndex:!1,Create:function(){return\x20new\x20BenfordIndex}}],[\x22自定义指数热度\x22,{IsMainIndex:!1,Create:function(){return\x20new\x20CustonIndexHeatIndex},Name:\x22自定义指数热度\x22}],[\x22能图-趋势\x22,{IsMainIndex:!1,Create:function(){return\x20new\x20LighterIndex1},Name:\x22大盘/个股趋势\x22}],[\x22能图-位置研判\x22,{IsMainIndex:!1,Create:function(){return\x20new\x20LighterIndex2},Name:\x22位置研判\x22}],[\x22能图-点位研判\x22,{IsMainIndex:!1,Create:function(){return\x20new\x20LighterIndex3},Name:\x22点位研判\x22}],[\x22CJL\x22,{IsMainIndex:!1,Create:function(){return\x20new\x20JSIndex_CJL}}]]).get(t)},HQIndexFormula.EMA=function(t,e){var\x20a=[],i=0;if(i>=t.length)return\x20a;for(;i<t.length&&(null==t[i]||isNaN(t[i]));++i);var\x20r=i,n=i+1;a[r]=t[r];for(var\x20s=i+1;s<t.length;++s,++r,++n)a[n]=(2*t[n]+(e-1)*a[r])/(e+1);return\x20a},HQIndexFormula.SMA=function(t,e,a){for(var\x20i=[],r=0,n=null;r<t.length;++r)if(null!=t[r]&&!isNaN(t[r])){n=t[r],i[r]=n;break}for(++r;r<t.length;++r)i[r]=(a*t[r]+(e-a)*n)/e,n=i[r];return\x20i},HQIndexFormula.DMA=function(t,e){var\x20a=[];if(t.length<0||t.length!=e.length)return\x20a;for(var\x20i=0;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])&&null!=e[i]&&!isNaN(e[i])){a[i]=t[i];break}for(i+=1;i<t.length;++i)null==t[i]||null==e[i]?a[i]=null:t[i]<1?a[i]=e[i]*t[i]+(1-e[i])*a[i-1]:a[i]=t[i];return\x20a},HQIndexFormula.HHV=function(t,e){var\x20a=[];if(e>t.length)return\x20a;for(var\x20i=-1e4,r=e,n=0;r<t.length;++r,++n){if(r<e+i)i=t[r]<t[i]?i:r;else\x20for(n=1+(i=r-e+1);n<=r;++n)t[n]>t[i]&&(i=n);a[r]=t[i]}return\x20a},HQIndexFormula.LLV=function(t,e){var\x20a=[];if(e>t.length)return\x20a;for(var\x20i=-1e4,r=e;r<t.length;++r,++n){if(r<e+i)i=t[r]>t[i]?i:r;else\x20for(var\x20n=1+(i=r-e+1);n<=r;++n)t[n]<t[i]&&(i=n);a[r]=t[i]}return\x20a},HQIndexFormula.REF=function(t,e){var\x20a=[];if(t.length<=0)return\x20a;if(e>=t.length)return\x20a;a=t.slice(0,t.length-e);for(var\x20i=0;i<e;++i)a.unshift(null);return\x20a},HQIndexFormula.REFDATE=function(t,e){var\x20a=[];if(t.length<=0)return\x20a;for(var\x20i\x20in\x20e=t.length-1,t)a[i]=t[e];return\x20a},HQIndexFormula.SUM=function(t,e){var\x20a=[];if(0==e){a[0]=t[0];for(var\x20i=1;i<t.length;++i)a[i]=a[i-1]+t[i]}else{i=e-1;for(var\x20r=0;i<t.length;++i,++r)for(var\x20n=0;n<e;++n)0==n?a[i]=t[n+r]:a[i]+=t[n+r]}return\x20a},HQIndexFormula.ARRAY_SUBTRACT=function(t,e){var\x20a=[];if(\x22number\x22==typeof\x20e)for(var\x20i\x20in\x20t)null==t[i]||isNaN(t[i])?a[i]=null:a[i]=t[i]-e;else{var\x20r=Math.max(t.length,e.length);for(i=0;i<r;++i)i<t.length&&i<e.length?null==t[i]||null==e[i]?a[i]=null:a[i]=t[i]-e[i]:a[i]=null}return\x20a},HQIndexFormula.ARRAY_GT=function(t,e){var\x20a=[];if(\x22number\x22==typeof\x20e)for(var\x20i\x20in\x20t)a[i]=t[i]>e?1:0;else{var\x20r=Math.max(t.length,e.length);for(i=0;i<r;++i)i<t.length&&i<e.length?a[i]=t[i]>e[i]?1:0:a[i]=null}return\x20a},HQIndexFormula.ARRAY_GTE=function(t,e){var\x20a=[];if(\x22number\x22==typeof\x20e)for(var\x20i\x20in\x20t)a[i]=t[i]>=e?1:0;else{var\x20r=Math.max(t.length,e.length);for(i=0;i<r;++i)i<t.length&&i<e.length?a[i]=t[i]>=e[i]?1:0:a[i]=null}return\x20a},HQIndexFormula.ARRAY_LT=function(t,e){var\x20a=[];if(\x22number\x22==typeof\x20e)for(var\x20i\x20in\x20t)a[i]=t[i]<e?1:0;else{var\x20r=Math.max(t.length,e.length);for(i=0;i<r;++i)i<t.length&&i<e.length?a[i]=t[i]<e[i]?1:0:a[i]=null}return\x20a},HQIndexFormula.ARRAY_LTE=function(t,e){var\x20a=[];if(\x22number\x22==typeof\x20e)for(var\x20i\x20in\x20t)a[i]=t[i]<=e?1:0;else{var\x20r=Math.max(t.length,e.length);for(i=0;i<r;++i)i<t.length&&i<e.length?a[i]=t[i]<=e[i]?1:0:a[i]=null}return\x20a},HQIndexFormula.ARRAY_EQ=function(t,e){var\x20a=[];if(\x22number\x22==typeof\x20e)for(var\x20i\x20in\x20t)a[i]=t[i]==e?1:0;else{var\x20r=Math.max(t.length,e.length);for(i=0;i<r;++i)i<t.length&&i<e.length?a[i]=t[i]==e[i]?1:0:a[i]=null}return\x20a},HQIndexFormula.ARRAY_IF=function(t,e,a){var\x20i=[],r=[\x22number\x22==typeof\x20e,\x22number\x22==typeof\x20a];for(var\x20n\x20in\x20t)t[n]?i[n]=r[0]?e:e[n]:i[n]=r[1]?a:a[n];return\x20i},HQIndexFormula.ARRAY_AND=function(t,e){var\x20a=[];if(\x22number\x22==typeof\x20e)for(var\x20i\x20in\x20t)a[i]=t[i]&&e?1:0;else{var\x20r=Math.max(t.length,e.length);for(i=0;i<r;++i)i<t.length&&i<e.length?a[i]=t[i]&&e[i]?1:0:a[i]=0}return\x20a},HQIndexFormula.ARRAY_OR=function(t,e){var\x20a=[];if(\x22number\x22==typeof\x20e)for(var\x20i\x20in\x20t)a[i]=t[i]||e?1:0;else{var\x20r=Math.max(t.length,e.length);for(i=0;i<r;++i)i<t.length&&t[i]?a[i]=1:i<e.length&&e[i]?a[i]=1:a[i]=0}return\x20a},HQIndexFormula.ARRAY_MULTIPLY=function(t,e){if(2==arguments.length){var\x20a=[];if(\x22number\x22==typeof\x20e)for(var\x20i\x20in\x20t)null==t[i]||isNaN(t[i])?a[i]=null:a[i]=t[i]*e;else{var\x20r=Math.max(t.length,e.length);for(i=0;i<r;++i)i<t.length&&i<e.length?a[i]=t[i]*e[i]:a[i]=null}return\x20a}for(a=HQIndexFormula.ARRAY_MULTIPLY(arguments[0],arguments[1]),i=2;i<arguments.length;++i)a=HQIndexFormula.ARRAY_MULTIPLY(a,arguments[i]);return\x20a},HQIndexFormula.ARRAY_DIVIDE=function(t,e){var\x20a=[];if(\x22number\x22==typeof\x20e)for(var\x20i\x20in\x20t)a[i]=t[i]/e;else{var\x20r=Math.max(t.length,e.length);for(i=0;i<r;++i)i<t.length&&i<e.length?null==t[i]||null==e[i]||isNaN(t[i])||isNaN(e[i])?a[i]=null:0==e[i]?a[i]=null:a[i]=t[i]/e[i]:a[i]=null}return\x20a},HQIndexFormula.ARRAY_ADD=function(t,e){if(2==arguments.length){var\x20a=[];if(\x22number\x22==typeof\x20e)for(var\x20i\x20in\x20t)a[i]=t[i]+e;else{var\x20r=Math.max(t.length,e.length);for(i=0;i<r;++i)i<t.length&&i<e.length?null==t[i]||null==e[i]||isNaN(t[i])||isNaN(e[i])?a[i]=null:a[i]=t[i]+e[i]:a[i]=null}return\x20a}for(a=HQIndexFormula.ARRAY_ADD(arguments[0],arguments[1]),i=2;i<arguments.length;++i)a=HQIndexFormula.ARRAY_ADD(a,arguments[i]);return\x20a},HQIndexFormula.MAX=function(t,e){var\x20a=[];if(\x22number\x22==typeof\x20e)for(var\x20i\x20in\x20t)null==t[i]?a[i]=null:a[i]=Math.max(t[i],e);else{var\x20r=Math.max(t.length,e.length);for(i=0;i<r;++i)i<t.length&&i<e.length?null==t[i]||null==e[i]?a[i]=null:a[i]=Math.max(t[i],e[i]):a[i]=null}return\x20a},HQIndexFormula.MIN=function(t,e){var\x20a=[];if(\x22number\x22==typeof\x20e)for(var\x20i\x20in\x20t)null==t[i]?a[i]=null:a[i]=Math.min(t[i],e);else{var\x20r=Math.max(t.length,e.length);for(i=0;i<r;++i)i<t.length&&i<e.length?null==t[i]||null==e[i]?a[i]=null:a[i]=Math.min(t[i],e[i]):a[i]=null}return\x20a},HQIndexFormula.ABS=function(t){var\x20e=[];for(var\x20a\x20in\x20t)null==t[a]?e[a]=null:e[a]=Math.abs(t[a]);return\x20e},HQIndexFormula.MA=function(t,e){for(var\x20a=[],i=0,r=t.length;i<r;i++)if(i<e)a[i]=null;else{for(var\x20n=0,s=0;s<e;s++)n+=t[i-s];a[i]=n/e}return\x20a},HQIndexFormula.EXPMA=function(t,e){var\x20a=[];if(e>=t.length)return\x20a;for(var\x20i=e;i<t.length;++i)if(null!=t[i]){a[i]=t[i];break}for(i+=1;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return\x20a},HQIndexFormula.EXPMEMA=function(t,e){var\x20a=[];if(e>=t.length)return\x20a;for(var\x20i=0;i<t.length&&(!t[i]||isNaN(t[i]));++i);for(var\x20r=0,n=0;i<t.length&&n<e;++n,++i)t[i]&&!isNaN(t[i])?r+=t[i]:r+=t[i-1];for(a[i-1]=r/e;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return\x20a},HQIndexFormula.STD=function(t,e){for(var\x20a=[],i=0,r=[],n=e-1;n<t.length;++n){i=0;for(var\x20s=0;s<e;++s)i+=t[n-s];r[n]=i/e}for(n=e-1;n<t.length;++n){i=0;for(s=0;s<e;++s)i+=Math.pow(t[n-s]-r[n],2);a[n]=Math.sqrt(i/e)}return\x20a},HQIndexFormula.AVEDEV=function(t,e){for(var\x20a=[],i=0,r=[],n=e-1;n<t.length;++n){i=0;for(var\x20s=0;s<e;++s)i+=t[n-s];r[n]=i/e}for(n=e-1;n<t.length;++n){i=0;for(s=0;s<e;++s)i+=Math.abs(t[n-s]-r[n]);a[n]=i/e}return\x20a},HQIndexFormula.COUNT=function(t,e){for(var\x20a=[],i=e-1;i<t.length;++i){for(var\x20r=0,n=0;n<e;++n)t[i-n]&&++r;a[i]=r}return\x20a},HQIndexFormula.CROSS=function(t,e){var\x20a=[];if(t.length!=e.length)return[];for(var\x20i=0;i<t.length&&(null==t[i]||isNaN(t[i])||null==e[i]||!isNaN(e[i]));++i);for(++i;i<t.length;++i)a[i]=t[i]>e[i]&&t[i-1]<e[i-1]?1:0;return\x20a},HQIndexFormula.MULAR=function(t,e){var\x20a=[];if(t.length<e)return\x20a;for(var\x20i=e;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])){a[i]=t[i];break}for(++i;i<t.length;++i)a[i]=a[i-1]*t[i];return\x20a},HQIndexFormula.STICKLINE=function(t,e,a){var\x20i=[];if(t.length<=0)return\x20i;var\x20r=\x22number\x22==typeof\x20e,n=\x22number\x22==typeof\x20a;for(var\x20s\x20in\x20t)if(i[s]=null,!isNaN(t[s])&&t[s])if(r&&n)i[s]={Value:e,Value2:a};else\x20if(r&&!n){if(isNaN(a[s]))continue;i[s]={Value:e,Value2:a[s]}}else\x20if(!r&&n){if(isNaN(e[s]))continue;i[s]={Value:e[s],Value2:a}}else{if(isNaN(e[s])||isNaN(a[s]))continue;i[s]={Value:e[s],Value2:a[s]}}return\x20i},KLineChartContainer.JsonDataToHistoryData=function(t){var\x20e=[];if(!t.data)return\x20e;var\x20a=null;t.symbol&&(a=t.symbol.toUpperCase());MARKET_SUFFIX_NAME.IsFutures(a);for(var\x20i=t.data,r=0;r<i.length;++r){var\x20n=new\x20HistoryData,s=i[r];n.Date=s[0],n.Open=s[2],n.YClose=s[1],n.Close=s[5],n.High=s[3],n.Low=s[4],n.Vol=s[6],n.Amount=s[7],IFrameSplitOperator.IsNumber(s[8])&&(n.Position=s[8]),IFrameSplitOperator.IsNumber(s[9])&&(n.FClose=s[9]),IFrameSplitOperator.IsNumber(s[10])&&(n.YFClose=s[10]),isNaN(n.Open)||n.Open<=0||e.push(n)}return\x20e},KLineChartContainer.JsonDataToRealtimeData=function(t,e){if(!t.stock)return\x20null;var\x20a;for(var\x20i\x20in\x20t.stock){var\x20r=t.stock[i];if(r&&r.symbol==e){a=r;break}}if(!a)return\x20null;var\x20n=e.toUpperCase(),s=(MARKET_SUFFIX_NAME.IsSHSZ(n),new\x20HistoryData);return\x20s.Date=a.date,s.Open=a.open,s.YClose=a.yclose,s.High=a.high,s.Low=a.low,s.Vol=a.vol,s.Amount=a.amount,s.Close=a.price,IFrameSplitOperator.IsNumber(a.position)&&(s.Position=a.position),s},KLineChartContainer.JsonDataToMinuteRealtimeData=function(t,e){if(!t.stock)return\x20null;var\x20a;for(var\x20i\x20in\x20t.stock){var\x20r=t.stock[i];if(r&&r.symbol==e){a=r;break}}if(!a)return\x20null;var\x20n=e.toUpperCase(),s=(MARKET_SUFFIX_NAME.IsSHSZ(n),MARKET_SUFFIX_NAME.IsFutures(n)),o=new\x20Array,h=a.yclose,l=a.date;for(var\x20i\x20in\x20s&&a.yclearing&&(h=a.yclearing),a.minute){var\x20C=a.minute[i],u=new\x20HistoryData;u.Close=C.price,u.Open=C.open,u.High=C.high,u.Low=C.low,u.Vol=C.vol,u.Amount=C.amount,C.date>0?u.Date=C.date:u.Date=l,u.Time=C.time,u.YClose=h,IFrameSplitOperator.IsNumber(C.position)&&(u.Position=C.position),u.Close||(u.Close=h,u.Open=u.High=u.Low=u.Close),u.Open<=0&&(u.Open=null),u.Close<=0&&(u.Close=null),u.High<=0&&(u.High=null),u.Low<=0&&(u.Low=null),C.price>0&&(h=C.price),o[i]=u}return\x20o},KLineChartContainer.JsonDataToMinuteHistoryData=function(t){var\x20e=null;t.symbol&&(e=t.symbol.toUpperCase());e&&MARKET_SUFFIX_NAME.IsSHSZ(e);e&&MARKET_SUFFIX_NAME.IsFutures(e);for(var\x20a=t.data,i=new\x20Array,r=0,n=0;n<a.length;++n){var\x20s=new\x20HistoryData,o=a[n];s.Close=o[2],s.Open=o[1],s.High=o[3],s.Low=o[4],s.Amount=o[6],s.Vol=o[5],s.YClose=r||s.Close,s.Time=o[0],s.Time>1e7&&(s.DateTime=datetime(s.Time),s.Date=s.DateTime.substr(0,8),s.Time=s.DateTime.substr(9,4)),IFrameSplitOperator.IsNumber(o[9])&&(s.Position=o[9]),s.YClose<=0&&r>0&&(s.YClose=r),s.Close>0&&(r=s.Close),i.push(s)}for(n=0;n<i.length;++n){var\x20h=i[n];if(null!=h&&(isNaN(h.Open)||h.Open<=0||isNaN(h.High)||h.High<=0||isNaN(h.Low)||h.Low<=0||isNaN(h.Close)||h.Close<=0))if(0==n)h.YClose>0&&(h.Open=h.YClose,h.High=h.YClose,h.Low=h.YClose,h.Close=h.YClose);else\x20for(var\x20l=n-1;l>=0;--l){var\x20C=i[l];if(null==C&&coninue,C.Open>0&&C.High>0&&C.Low>0&&C.Close>0){h.YClose<=0&&(h.YClose=C.Close),h.Open=C.Open,h.High=C.High,h.Low=C.Low,h.Close=C.Close;break}}}return\x20i},KLineChartContainer.JsonDataToTickData=function(t){var\x20e=[];if(!t.detail)return\x20e;var\x20a=t.date,i=t.yclose;for(var\x20r\x20in\x20t.detail){var\x20n=new\x20HistoryData,s=t.detail[r];s&&(n.Date=a,n.Time=s[0],n.Low=n.High=n.Close=n.Open=s[1],n.YClose=i,n.Vol=s[2],n.Amount=s[3],n.Flag=s[4],isNaN(n.Open)||n.Open<=0||(i=n.Close,e.push(n)))}return\x20e},MinuteChartContainer.JsonDataToMinuteData2=function(t){t.stock[0].symbol;var\x20e=t.stock[0].yclose,a=t.stock[0].yclose,i=t.stock[0].yclose,r=[],n=t.stock[0],s=n.date;for(var\x20o\x20in\x20n.before){var\x20h=new\x20MinuteData,l=(C=n.before[o])[0];h.Before={},h.Before.Close=C[1],h.Before.Close?e=h.Before.Close:h.Before.Close=e,h.Before.Vol=C[2]/100,h.Before.Amount=C[3],h.DateTime=s.toString()+\x22\x20\x22+l.toString(),h.Date=s,h.Time=l,i&&h.Before.Close&&(h.Before.Increase=(h.Before.Close-i)/i*100),r.push(h)}for(var\x20o\x20in\x20n.minute){var\x20C=n.minute[o];h=new\x20MinuteData;C.price&&(e=C.price),C.avprice&&(a=C.avprice),925!=C.time&&(h.Close=C.price||C[2],h.Open=C.open||C[1],h.High=C.high||C[3],h.Low=C.low||C[4],h.Amount=C.amount||C[6],h.Vol=C.vol||C[5],h.Time=C.time||C[0],h.DateTime=t.stock[0].date.toString()+\x22\x20\x22+h.Time.toString(),h.Date=t.stock[0].date,h.Increase=C.increase,h.Risefall=C.risefall,h.AvPrice=C.avprice,h.Close||(h.Open=h.High=h.Low=h.Close=e),h.AvPrice||(h.AvPrice=a),i&&h.Close&&(h.Increase=(h.Close-i)/i*100),r.push(h))}return\x20r},MinuteChartContainer.JsonDataToMinuteData=function(t,e){var\x20a=t.stock[0].symbol.toUpperCase(),i=(MARKET_SUFFIX_NAME.IsSHSZ(a),MARKET_SUFFIX_NAME.IsFutures(a)),r=MARKET_SUFFIX_NAME.IsSHO(a),n=new\x20Array,s=t.stock[0].yclose,o=t.stock[0].yclose,h=t.stock[0].yclose;i&&t.stock[0].yclearing&&(h=s=o=t.stock[0].yclearing);var\x20l=t.stock[0].date,C=0,u=0;for(var\x20D\x20in\x20t.stock[0].minute){var\x20d=t.stock[0].minute[D],c=new\x20MinuteData;c.Close=d.price||d[2],c.Open=d.open||d[1],c.High=d.high||d[3],c.Low=d.low||d[4],c.Amount=d.amount||d[6],c.Vol=d.vol||d[5],c.Increase=d.increase||d[8],c.Risefall=d.risefall||d[9],c.AvPrice=d.avprice||d[7],d.date>0&&(l=d.date),c.Time=d.time||d[0],c.DateTime=l.toString()+\x22\x20\x22+c.Time.toString(),c.Date=l,c.Time>1e7&&(c.DateTime=datetime(c.Time),c.Date=c.DateTime.substr(0,8),c.Time=c.DateTime.substr(9,4)),c.AvPrice||(C+=c.Vol,u+=c.Amount,c.AvPrice=u/C),(i||r)&&(c.Position=d.position),0==D&&(c.IsFristData=!0),IFrameSplitOperator.IsNumber(d.lead)&&(c.Lead=d.lead),c.Close||(c.Close=s,c.Open=c.High=c.Low=c.Close),c.AvPrice||(c.AvPrice=o),c.Open<=0&&(c.Open=null),c.Close<=0&&(c.Close=null),c.AvPrice<=0&&(c.AvPrice=null),c.High<=0&&(c.High=null),c.Low<=0&&(c.Low=null),h&&c.Close&&(c.Increase=(c.Close-h)/h*100),c.Close>0&&(s=c.Close),c.AvPrice>0&&(o=c.AvPrice),n[D]=c}return\x20n},MinuteChartContainer.JsonDataToMinuteDataArray=function(t){var\x20e=t.symbol.toUpperCase(),a=MARKET_SUFFIX_NAME.IsSHSZ(e),i=MARKET_SUFFIX_NAME.IsSHO(e),r=MARKET_SUFFIX_NAME.IsFutures(e),n=[],s=0,o=0;for(var\x20h\x20in\x20t.data){var\x20l=[],C=t.data[h],u=C.date,D=C.yclose,d=D,c=null;for(var\x20m\x20in\x20C.minute){var\x20f=C.minute[m];f[2]&&(d=f[2]);var\x20v=new\x20MinuteData;v.Close=f[2],v.Open=f[1],v.High=f[3],v.Low=f[4],v.Vol=a?f[5]/100:f[5],v.Amount=f[6],v.DateTime=u.toString()+\x22\x20\x22+f[0].toString(),v.Date=u,v.Time=f[0],8<f.length&&f[8]>0&&(v.Date=f[8]),f[0]>1e7&&(v.DateTime=datetime(f[0]),v.Date=v.DateTime.substr(0,8),v.Time=v.DateTime.substr(9,4)),f[7]||(s+=f[5],o+=f[6],f[7]=o/s),7<f.length&&f[7]>0&&(v.AvPrice=f[7]),(r||i)&&9<f.length&&(v.Position=f[9]),v.Close||(v.Close=d,v.Open=v.High=v.Low=v.Close),!v.AvPrice&&c&&(v.AvPrice=c),v.Close&&D?v.Increase=(v.Close-D)/D*100:v.Increase=null,0==m&&(v.IsFristData=!0),v.Open<=0&&(v.Open=null),v.Close<=0&&(v.Close=null),v.AvPrice<=0&&(v.AvPrice=null),v.High<=0&&(v.High=null),v.Low<=0&&(v.Low=null),v.AvPrice<=0&&(v.AvPrice=null),v.AvPrice,f.length>7&&f[7]>0&&v.AvPrice===f[7]&&(c=f[7]),l[m]=v}var\x20S=new\x20ChartData;S.Data=l,S.YClose=D,S.Close=C.close,S.Date=u,n.push(S)}return\x20n},HistoryMinuteChartContainer.JsonDataToMinuteData=function(t){var\x20e=[];for(var\x20a\x20in\x20t.minute.time){var\x20i=new\x20MinuteData;t.minute.price[a]<=0&&a>0?(i.Close=e[a-1].Close,i.Open=e[a-1].Close,i.High=i.Close,i.Low=i.Close,i.Vol=t.minute.vol[a],i.Amount=t.minute.amount[a],i.DateTime=t.date.toString()+\x22\x20\x22+t.minute.time[a].toString(),i.AvPrice=e[a-1].AvPrice):(i.Close=t.minute.price[a],i.Open=t.minute.open[a],i.High=t.minute.high[a],i.Low=t.minute.low[a],i.Vol=t.minute.vol[a],i.Amount=t.minute.amount[a],i.DateTime=t.date.toString()+\x22\x20\x22+t.minute.time[a].toString(),i.AvPrice=t.minute.avprice[a]),i.Open<=0&&(i.Open=null),i.Close<=0&&(i.Close=null),i.AvPrice<=0&&(i.AvPrice=null),i.High<=0&&(i.High=null),i.Low<=0&&(i.Low=null),e[a]=i}return\x20e},PyScriptIndex.prototype.GetDefaultColor=function(t){let\x20e=[\x22rgb(255,174,0)\x22,\x22rgb(25,199,255)\x22,\x22rgb(175,95,162)\x22,\x22rgb(236,105,65)\x22,\x22rgb(68,114,196)\x22,\x22rgb(229,0,79)\x22,\x22rgb(0,128,255)\x22,\x22rgb(252,96,154)\x22,\x22rgb(42,230,215)\x22,\x22rgb(24,71,178)\x22];return\x20e[parseInt(t)%(e.length-1)]},JSKLineInfoMap.Get=function(t){return\x20new\x20Map([[\x22互动易\x22,{Create:function(){return\x20new\x20InvestorInfo}}],[\x22公告\x22,{Create:function(){return\x20new\x20AnnouncementInfo}}],[\x22业绩预告\x22,{Create:function(){return\x20new\x20PforecastInfo}}],[\x22调研\x22,{Create:function(){return\x20new\x20ResearchInfo}}],[\x22大宗交易\x22,{Create:function(){return\x20new\x20BlockTrading}}],[\x22龙虎榜\x22,{Create:function(){return\x20new\x20TradeDetail}}]]).get(t)},JSKLineInfoMap.GetClassInfo=function(t){return\x20new\x20Map([[\x22互动易\x22,{ClassName:\x22InvestorInfo\x22}],[\x22公告\x22,{ClassName:\x22AnnouncementInfo\x22}],[\x22业绩预告\x22,{ClassName:\x22PforecastInfo\x22}],[\x22调研\x22,{ClassName:\x22ResearchInfo\x22}],[\x22大宗交易\x22,{ClassName:\x22BlockTrading\x22}],[\x22龙虎榜\x22,{ClassName:\x22TradeDetail\x22}]]).get(t)},JSKLineInfoMap.GetIconUrl=function(t){switch(t){case\x20KLINE_INFO_TYPE.INVESTOR:return\x20g_JSChartResource.KLine.Info.Investor.Icon;case\x20KLINE_INFO_TYPE.PFORECAST:return\x20g_JSChartResource.KLine.Info.Pforecast.Icon;case\x20KLINE_INFO_TYPE.ANNOUNCEMENT:return\x20g_JSChartResource.KLine.Info.Announcement.Icon;case\x20KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_1:case\x20KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_2:case\x20KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_3:case\x20KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_4:return\x20g_JSChartResource.KLine.Info.Announcement.IconQuarter;case\x20KLINE_INFO_TYPE.RESEARCH:return\x20g_JSChartResource.KLine.Info.Research.Icon;case\x20KLINE_INFO_TYPE.BLOCKTRADING:return\x20g_JSChartResource.KLine.Info.BlockTrading.Icon;case\x20KLINE_INFO_TYPE.TRADEDETAIL:return\x20g_JSChartResource.KLine.Info.TradeDetail.Icon;default:return\x20g_JSChartResource.KLine.Info.Announcement.Icon}},JSKLineInfoMap.GetIconLibrary=function(t){var\x20e=g_JSChartResource.KLine.Info.IconLibrary;if(!e||!e.Icon)return\x20g_JSChartResource.KLine.Info.Announcement.IconFont;if(t>=0&&t<e.Icon.length){var\x20a=e.Icon[t];return{Text:a.Text,HScreenText:a.HScreenText,Color:a.Color,Family:e.Family}}return\x20g_JSChartResource.KLine.Info.Announcement.IconFont},JSKLineInfoMap.GetIconFont=function(t){if(t>=KLINE_INFO_TYPE.ANNOUNCEMENT_EX_START&&t<=KLINE_INFO_TYPE.ANNOUNCEMENT_EX_END){var\x20e=t-KLINE_INFO_TYPE.ANNOUNCEMENT_EX_START;return\x20JSKLineInfoMap.GetIconLibrary(e)}switch(t){case\x20KLINE_INFO_TYPE.INVESTOR:return\x20g_JSChartResource.KLine.Info.Investor.IconFont;case\x20KLINE_INFO_TYPE.PFORECAST:return\x20g_JSChartResource.KLine.Info.Pforecast.IconFont;case\x20KLINE_INFO_TYPE.ANNOUNCEMENT:return\x20g_JSChartResource.KLine.Info.Announcement.IconFont;case\x20KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_1:case\x20KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_2:case\x20KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_3:case\x20KLINE_INFO_TYPE.ANNOUNCEMENT_QUARTER_4:return\x20g_JSChartResource.KLine.Info.Announcement.IconFont2;case\x20KLINE_INFO_TYPE.RESEARCH:return\x20g_JSChartResource.KLine.Info.Research.IconFont;case\x20KLINE_INFO_TYPE.BLOCKTRADING:return\x20g_JSChartResource.KLine.Info.BlockTrading.IconFont;case\x20KLINE_INFO_TYPE.TRADEDETAIL:return\x20g_JSChartResource.KLine.Info.TradeDetail.IconFont;default:return\x20g_JSChartResource.KLine.Info.Announcement.IconFont}},JSMinuteInfoMap.InfoMap=new\x20Map([[\x22大盘异动\x22,{Create:function(){return\x20new\x20MarketEventInfo}}]]),JSMinuteInfoMap.Get=function(t){return\x20JSMinuteInfoMap.InfoMap.get(t)};var\x20MARKET_SUFFIX_NAME={SH:\x22.SH\x22,SZ:\x22.SZ\x22,SHSZ_C_Index:\x22.CI\x22,SHO:\x22.SHO\x22,HK:\x22.HK\x22,FHK:\x22.FHK\x22,SHFE:\x22.SHF\x22,SHFE2:\x22.SHFE\x22,CFFEX:\x22.CFE\x22,DCE:\x22.DCE\x22,CZCE:\x22.CZC\x22,USA:\x22.USA\x22,FTSE:\x22.FTSE\x22,BIT:\x22.BIT\x22,BIZ:\x22.BIZ\x22,FOREX:\x22.FOREX\x22,NYMEX:\x22.NYMEX\x22,COMEX:\x22.COMEX\x22,NYBOT:\x22.NYBOT\x22,CBOT:\x22.CBOT\x22,LME:\x22.LME\x22,ET:\x22.ET\x22,IsET:function(t){return!!t&&t.indexOf(this.ET)>0},IsETShowAvPrice:function(t){return!1},IsNYMEX:function(t){return!!t&&t.indexOf(this.NYMEX)>0},IsCOMEX:function(t){return!!t&&t.indexOf(this.COMEX)>0},IsNYBOT:function(t){return!!t&&t.indexOf(this.NYBOT)>0},IsCBOT:function(t){return!!t&&t.indexOf(this.CBOT)>0},IsLME:function(t){return!!t&&t.indexOf(this.LME)>0},IsForeignExchange(t){return!!t&&t.indexOf(this.FOREX)>0},IsFTSE:function(t){return!!t&&t.indexOf(this.FTSE)>0},IsFHK:function(t){return!!t&&t.indexOf(this.FHK)>0},IsBIT:function(t){return!!t&&(t.indexOf(this.BIT)>0||t.indexOf(this.BIZ)>0)},IsUSA:function(t){return!!t&&t.indexOf(this.USA)>0},IsSH:function(t){var\x20e=t.length-this.SH.length;return\x20t.indexOf(this.SH)==e},IsSZ:function(t){var\x20e=t.length-this.SZ.length;return\x20t.indexOf(this.SZ)==e},IsSHSZCustomIndex:function(t){var\x20e=t.length-this.SHSZ_C_Index.length;return\x20t.indexOf(this.SHSZ_C_Index)==e},IsSHO:function(t){var\x20e=t.length-this.SHO.length;return\x20t.indexOf(this.SHO)==e},IsHK:function(t){var\x20e=t.length-this.HK.length;return\x20t.indexOf(this.HK)==e},IsSHFE:function(t){return!!t&&(t.indexOf(this.SHFE)>0||t.indexOf(this.SHFE2)>0)},IsCFFEX:function(t){return!!t&&t.indexOf(this.CFFEX)>0},IsDCE:function(t){return!!t&&t.indexOf(this.DCE)>0},IsCZCE:function(t){return!!t&&t.indexOf(this.CZCE)>0},IsChinaFutures:function(t){return\x20this.IsCFFEX(t)||this.IsCZCE(t)||this.IsDCE(t)||this.IsSHFE(t)},IsFutures:function(t){return\x20this.IsChinaFutures(t)||this.IsNYMEX(t)||this.IsCOMEX(t)||this.IsNYBOT(t)||this.IsCBOT(t)||this.IsLME(t)},IsSHSZ:function(t){return\x20this.IsSZ(t)||this.IsSH(t)||this.IsSHSZCustomIndex(t)},IsSHSZFund:function(t){if(!t)return!1;if(this.IsSH(t)){if(\x225\x22==t.charAt(0)&&\x221\x22==t.charAt(1))return!0}else\x20if(this.IsSZ(t)&&\x221\x22==t.charAt(0)&&(\x225\x22==t.charAt(1)||\x226\x22==t.charAt(1)||\x227\x22==t.charAt(1)||\x228\x22==t.charAt(1)))return!0;return!1},IsSHSZIndex:function(t){if(!t)return!1;var\x20e=t.toUpperCase();if(this.IsSH(e)){var\x20a=e.replace(\x22.SH\x22,\x22\x22);if(\x220\x22==e.charAt(0)&&parseInt(a)<=3e3)return!0}else\x20if(this.IsSZ(e)){if(\x223\x22==e.charAt(0)&&\x229\x22==e.charAt(1))return!0}else\x20if(this.IsSHSZCustomIndex(e))return!0;return!1},IsSHSZStockA:function(t){if(!t)return!1;var\x20e=t.toUpperCase();if(this.IsSH(e)){e.replace(\x22.SH\x22,\x22\x22);if(\x226\x22==e.charAt(0))return!0}else\x20if(this.IsSZ(e)&&\x220\x22==e.charAt(0)){if(\x220\x22==e.charAt(1)&&\x222\x22==e.charAt(2))return!0;if(\x227\x22!=e.charAt(1)&&\x228\x22!=e.charAt(1))return!0}return!1},IsSHStockSTAR:function(t){if(!t)return!1;var\x20e=t.toUpperCase();return!!this.IsSH(e)&&(\x226\x22==e.charAt(0)&&\x228\x22==e.charAt(1)&&\x228\x22==e.charAt(2))},GetMarketStatus:function(t){if(!t)return\x200;var\x20e=t.toUpperCase(),a=new\x20Date,i=a.getDay(),r=100*a.getHours()+a.getMinutes();if(this.IsUSA(e)){var\x20n=GetLocalTime(-4);i=n.getDay(),r=100*n.getHours()+n.getMinutes();return\x206==i||0==i?0:r>1730?3:r<930?1:2}return\x20this.IsBIT(e)?2:this.IsForeignExchange(e)?2:this.IsFTSE(e)?6==i||0==i?0:r>=830&&r<=2359?2:r>=0&&r<=500?2:0:this.IsFHK(e)?6==i||0==i?0:r>=900&&r<=2359?2:r>=0&&r<=320?2:0:this.IsET(e)?this.GetETMarketStatus(t):this.IsHK(e)?6==i||0==i?0:r>1630?3:r<925?1:2:this.IsNYMEX(e)?this.GetNYMEXMarketStatus(e):this.IsCOMEX(e)?this.GetCOMEXMarketStatus(e):this.IsNYBOT(e)?this.GetNYBOTMarketStatus(e):this.IsCBOT(e)?this.GetCBOTMarketStatus(e):this.IsLME(e)?this.GetLMEMarketStatus(e):this.IsChinaFutures(e)?6==i||0==i?0:r>=2100?2:r<=240?2:r>=830&&r<=1510?2:1:6==i||0==i?0:r>1540?3:r<925?1:2},GetLimitPriceRange:function(t,e){return\x20this.IsSHSZStockA(t)?this.IsSHStockSTAR(t)?{Max:.2,Min:-.2}:e?e.indexOf(\x22ST\x22)>=0?{Max:.05,Min:-.05}:{Max:.1,Min:-.1}:null:null},GetFHKDecimal:function(t){return\x200},GetFTSEDecimal:function(t){return\x200},GetBITDecimal:function(t){return\x202},GetSHODecimal:function(t){return\x204},GetETDecimal:function(t){return\x202},GetForeignExchangeDecimal:function(t){return\x204},GetNYMEXDecimal:function(t){return\x20g_NYMEXTimeData.GetDecimal(t)},GetCOMEXDecimal:function(t){return\x20g_COMEXTimeData.GetDecimal(t)},GetNYBOTDecimal:function(t){return\x20g_NYBOTTimeData.GetDecimal(t)},GetCBOTDecimal:function(t){return\x20g_CBOTTimeData.GetDecimal(t)},GetLMEDecimal:function(t){return\x20g_LMETimeData.GetDecimal(t)},GetETMarketStatus:function(t){return\x202},GetNYMEXMarketStatus:function(t){return\x20g_NYMEXTimeData.GetMarketStatus(t)},GetCOMEXMarketStatus:function(t){return\x20g_COMEXTimeData.GetMarketStatus(t)},GetNYBOTMarketStatus:function(t){return\x20g_NYBOTTimeData.GetMarketStatus(t)},GetCBOTMarketStatus:function(t){return\x20g_CBOTTimeData.GetMarketStatus(t)},GetLMEMarketStatus:function(t){return\x20g_LMETimeData.GetMarketStatus(t)}};function\x20MinuteTimeStringData(){this.SHSZ=null,this.SHO=null,this.HK=null,this.Futures=new\x20Map,this.USA=null,this.FTSE=null,this.FHK=null,this.ForeEx=null,this.BIT=null,this.Initialize=function(){},this.GetET=function(t){throw{Name:\x22MinuteTimeStringData::GetET\x22,Error:\x22not\x20implement\x22}},this.GetSHSZ=function(t){return\x20this.SHSZ||(this.SHSZ=this.CreateSHSZData()),this.SHSZ},this.GetSHO=function(){return\x20this.SHO||(this.SHO=this.CreateSHOData()),this.SHO},this.GetHK=function(){return\x20this.HK||(this.HK=this.CreateHKData()),this.HK},this.GetFutures=function(t){if(!this.Futures.has(t.Name)){var\x20e=this.CreateTimeData(t.Data);this.Futures.set(t.Name,e)}return\x20this.Futures.get(t.Name)},this.GetUSA=function(){return\x20this.USA||(this.USA=this.CreateUSAData(0)),this.USA},this.GetFTSE=function(){return\x20this.FTSE||(this.FTSE=this.CreateFTSEData()),this.FTSE},this.GetFHK=function(){return\x20this.FHK||(this.FHK=this.CreateFHKData()),this.FHK},this.GetForeignExchange=function(){return\x20this.ForeEx||(this.ForeEx=this.CreateForeignExchangeData()),this.ForeEx},this.GetBIT=function(t){return\x20this.BIT||(this.BIT=this.CreateBITData()),this.BIT},this.CreateSHSZData=function(){return\x20this.CreateTimeData([{Start:925,End:925},{Start:930,End:1130},{Start:1300,End:1500}])},this.CreateSHOData=function(){return\x20this.CreateTimeData([{Start:930,End:1129},{Start:1300,End:1500}])},this.CreateHKData=function(){return\x20this.CreateTimeData([{Start:930,End:1200},{Start:1300,End:1600}])},this.CreateFTSEData=function(){return\x20this.CreateTimeData([{Start:1700,End:2359},{Start:0,End:445},{Start:900,End:1630}])},this.CreateFHKData=function(){return\x20this.CreateTimeData([{Start:1715,End:2359},{Start:0,End:300},{Start:915,End:1200},{Start:1300,End:1630}])},this.CreateUSAData=function(t){if(1==t){const\x20t=[{Start:2130,End:2359},{Start:0,End:400}];return\x20this.CreateTimeData(t)}if(2==t){const\x20t=[{Start:2230,End:2359},{Start:0,End:500}];return\x20this.CreateTimeData(t)}{const\x20t=[{Start:930,End:1600}];return\x20this.CreateTimeData(t)}},this.CreateForeignExchangeData=function(){return\x20this.CreateTimeData([{Start:600,End:2359},{Start:0,End:559}])},this.CreateBITData=function(){return\x20this.CreateTimeData([{Start:600,End:2359},{Start:0,End:559}])},this.CreateTimeData=function(t){var\x20e=[];for(var\x20a\x20in\x20t)for(var\x20i=t[a],r=i.Start;r<=i.End;++r)r%100>=60||e.push(r);return\x20e},this.GetTimeData=function(t){if(!t)return\x20this.SHSZ;var\x20e,a=t.toLocaleUpperCase();return\x20MARKET_SUFFIX_NAME.IsSH(a)||MARKET_SUFFIX_NAME.IsSZ(a)?this.GetSHSZ(a):MARKET_SUFFIX_NAME.IsSHO(a)?this.GetSHO():MARKET_SUFFIX_NAME.IsHK(a)?this.GetHK():MARKET_SUFFIX_NAME.IsUSA(a)?this.GetUSA(!0):MARKET_SUFFIX_NAME.IsCFFEX(a)||MARKET_SUFFIX_NAME.IsCZCE(a)||MARKET_SUFFIX_NAME.IsDCE(a)||MARKET_SUFFIX_NAME.IsSHFE(a)?(e=g_FuturesTimeData.GetSplitData(a))?this.GetFutures(e):null:MARKET_SUFFIX_NAME.IsFTSE(a)?this.GetFTSE():MARKET_SUFFIX_NAME.IsFHK(a)?this.GetFHK():MARKET_SUFFIX_NAME.IsForeignExchange(a)?this.GetForeignExchange():MARKET_SUFFIX_NAME.IsET(a)?this.GetET(a):MARKET_SUFFIX_NAME.IsBIT(a)?this.GetBIT(a):MARKET_SUFFIX_NAME.IsNYMEX(a)?(e=g_NYMEXTimeData.GetSplitData(a))?this.GetFutures(e):null:MARKET_SUFFIX_NAME.IsCOMEX(a)?(e=g_COMEXTimeData.GetSplitData(a))?this.GetFutures(e):null:MARKET_SUFFIX_NAME.IsNYBOT(a)?(e=g_NYBOTTimeData.GetSplitData(a))?this.GetFutures(e):null:MARKET_SUFFIX_NAME.IsCBOT(a)?(e=g_CBOTTimeData.GetSplitData(a))?this.GetFutures(e):null:MARKET_SUFFIX_NAME.IsLME(a)?(e=g_LMETimeData.GetSplitData(a))?this.GetFutures(e):null:void\x200}}function\x20MinuteCoordinateData(){const\x20t={Full:[[0,0,\x22rgb(200,200,200)\x22,\x2209:30\x22],[31,0,\x22RGB(200,200,200)\x22,\x2210:00\x22],[61,0,\x22RGB(200,200,200)\x22,\x2210:30\x22],[91,0,\x22RGB(200,200,200)\x22,\x2211:00\x22],[122,1,\x22RGB(200,200,200)\x22,\x2213:00\x22],[152,0,\x22RGB(200,200,200)\x22,\x2213:30\x22],[182,0,\x22RGB(200,200,200)\x22,\x2214:00\x22],[212,0,\x22RGB(200,200,200)\x22,\x2214:30\x22],[242,1,\x22RGB(200,200,200)\x22,\x2215:00\x22]],Simple:[[0,0,\x22rgb(200,200,200)\x22,\x2209:30\x22],[61,0,\x22RGB(200,200,200)\x22,\x2210:30\x22],[122,1,\x22RGB(200,200,200)\x22,\x2213:00\x22],[182,0,\x22RGB(200,200,200)\x22,\x2214:00\x22],[242,1,\x22RGB(200,200,200)\x22,\x2215:00\x22]],Min:[[0,0,\x22rgb(200,200,200)\x22,\x2209:30\x22],[122,1,\x22RGB(200,200,200)\x22,\x2213:00\x22],[242,1,\x22RGB(200,200,200)\x22,\x2215:00\x22]],Count:243,MiddleCount:122,GetData:function(t){return\x20t<200?this.Min:t<400?this.Simple:this.Full}},e={Full:[[0,0,\x22rgb(200,200,200)\x22,\x2209:30\x22],[30,0,\x22RGB(200,200,200)\x22,\x2210:00\x22],[60,0,\x22RGB(200,200,200)\x22,\x2210:30\x22],[90,0,\x22RGB(200,200,200)\x22,\x2211:00\x22],[120,1,\x22RGB(200,200,200)\x22,\x2213:00\x22],[150,0,\x22RGB(200,200,200)\x22,\x2213:30\x22],[180,0,\x22RGB(200,200,200)\x22,\x2214:00\x22],[210,0,\x22RGB(200,200,200)\x22,\x2214:30\x22],[240,1,\x22RGB(200,200,200)\x22,\x2215:00\x22]],Simple:[[0,0,\x22rgb(200,200,200)\x22,\x2209:30\x22],[60,0,\x22RGB(200,200,200)\x22,\x2210:30\x22],[120,1,\x22RGB(200,200,200)\x22,\x2213:00\x22],[180,0,\x22RGB(200,200,200)\x22,\x2214:00\x22],[240,1,\x22RGB(200,200,200)\x22,\x2215:00\x22]],Min:[[0,0,\x22rgb(200,200,200)\x22,\x2209:30\x22],[120,1,\x22RGB(200,200,200)\x22,\x2213:00\x22],[240,1,\x22RGB(200,200,200)\x22,\x2215:00\x22]],Count:241,MiddleCount:120,GetData:function(t){return\x20t<200?this.Min:t<400?this.Simple:this.Full}},a={Full:[[0,1,\x22RGB(200,200,200)\x22,\x2209:30\x22],[30,0,\x22RGB(200,200,200)\x22,\x2210:00\x22],[60,1,\x22RGB(200,200,200)\x22,\x2210:30\x22],[90,0,\x22RGB(200,200,200)\x22,\x2211:00\x22],[120,1,\x22RGB(200,200,200)\x22,\x2211:30\x22],[151,0,\x22RGB(200,200,200)\x22,\x2213:00\x22],[181,1,\x22RGB(200,200,200)\x22,\x2213:30\x22],[211,0,\x22RGB(200,200,200)\x22,\x2214:00\x22],[241,1,\x22RGB(200,200,200)\x22,\x2214:30\x22],[271,0,\x22RGB(200,200,200)\x22,\x2215:00\x22],[301,1,\x22RGB(200,200,200)\x22,\x2215:30\x22],[331,1,\x22RGB(200,200,200)\x22,\x2216:00\x22]],Simple:[[0,1,\x22RGB(200,200,200)\x22,\x2209:30\x22],[60,1,\x22RGB(200,200,200)\x22,\x2210:30\x22],[120,1,\x22RGB(200,200,200)\x22,\x2211:30\x22],[211,0,\x22RGB(200,200,200)\x22,\x2214:00\x22],[271,0,\x22RGB(200,200,200)\x22,\x2215:00\x22],[331,1,\x22RGB(200,200,200)\x22,\x2216:00\x22]],Min:[[0,1,\x22RGB(200,200,200)\x22,\x2209:30\x22],[151,0,\x22RGB(200,200,200)\x22,\x2213:00\x22],[331,1,\x22RGB(200,200,200)\x22,\x2216:00\x22]],Count:332,MiddleCount:151,GetData:function(t){return\x20t<200?this.Min:t<450?this.Simple:this.Full}},i={Full:[[0,0,\x22rgb(200,200,200)\x22,\x229:30\x22],[30,0,\x22RGB(200,200,200)\x22,\x2210:00\x22],[90,1,\x22RGB(200,200,200)\x22,\x2211:00\x22],[150,0,\x22RGB(200,200,200)\x22,\x2212:00\x22],[210,0,\x22RGB(200,200,200)\x22,\x2213:00\x22],[270,0,\x22RGB(200,200,200)\x22,\x2214:00\x22],[330,0,\x22RGB(200,200,200)\x22,\x2215:00\x22],[390,0,\x22RGB(200,200,200)\x22,\x2216:00\x22]],Simple:[[30,0,\x22rgb(200,200,200)\x22,\x2210:00\x22],[150,1,\x22RGB(200,200,200)\x22,\x2212:00\x22],[270,0,\x22RGB(200,200,200)\x22,\x2214:00\x22],[390,0,\x22RGB(200,200,200)\x22,\x2216:00\x22]],Min:[[30,0,\x22rgb(200,200,200)\x22,\x2210:00\x22],[210,1,\x22RGB(200,200,200)\x22,\x2213:00\x22],[390,0,\x22RGB(200,200,200)\x22,\x2216:00\x22]],Count:391,MiddleCount:211,GetData:function(t){return\x20t<200?this.Min:t<400?this.Simple:this.Full}},r={Full:[[0,1,\x22RGB(200,200,200)\x22,\x2217:00\x22],[120,1,\x22RGB(200,200,200)\x22,\x2219:00\x22],[240,1,\x22RGB(200,200,200)\x22,\x2221:00\x22],[360,1,\x22RGB(200,200,200)\x22,\x2223:00\x22],[480,1,\x22RGB(200,200,200)\x22,\x2201:00\x22],[600,1,\x22RGB(200,200,200)\x22,\x2203:00\x22],[706,1,\x22RGB(200,200,200)\x22,\x2209:00\x22],[826,1,\x22RGB(200,200,200)\x22,\x2211:00\x22],[946,1,\x22RGB(200,200,200)\x22,\x2213:00\x22],[1066,1,\x22RGB(200,200,200)\x22,\x2215:00\x22],[1156,1,\x22RGB(200,200,200)\x22,\x2216:30\x22]],Simple:[[0,1,\x22RGB(200,200,200)\x22,\x2217:00\x22],[240,1,\x22RGB(200,200,200)\x22,\x2221:00\x22],[480,1,\x22RGB(200,200,200)\x22,\x2201:00\x22],[706,1,\x22RGB(200,200,200)\x22,\x2209:00\x22],[946,1,\x22RGB(200,200,200)\x22,\x2213:00\x22],[1156,1,\x22RGB(200,200,200)\x22,\x2216:30\x22]],Min:[[0,1,\x22RGB(200,200,200)\x22,\x2217:00\x22],[706,1,\x22RGB(200,200,200)\x22,\x2209:00\x22],[1156,1,\x22RGB(200,200,200)\x22,\x2216:30\x22]],Count:1157,MiddleCount:707,GetData:function(t){return\x20t<200?this.Min:t<450?this.Simple:this.Full}},n={Full:[[0,1,\x22RGB(200,200,200)\x22,\x2217:15\x22],[105,1,\x22RGB(200,200,200)\x22,\x2219:00\x22],[225,1,\x22RGB(200,200,200)\x22,\x2221:00\x22],[345,1,\x22RGB(200,200,200)\x22,\x2223:00\x22],[586,0,\x22RGB(200,200,200)\x22,\x2209:15\x22],[691,1,\x22RGB(200,200,200)\x22,\x2211:00\x22],[812,1,\x22RGB(200,200,200)\x22,\x2214:00\x22],[963,1,\x22RGB(200,200,200)\x22,\x2216:30\x22]],Simple:[[0,1,\x22RGB(200,200,200)\x22,\x2217:15\x22],[225,1,\x22RGB(200,200,200)\x22,\x2221:00\x22],[586,0,\x22RGB(200,200,200)\x22,\x2209:15\x22],[752,1,\x22RGB(200,200,200)\x22,\x2213:00\x22],[963,1,\x22RGB(200,200,200)\x22,\x2216:30\x22]],Min:[[0,1,\x22RGB(200,200,200)\x22,\x2217:15\x22],[586,0,\x22RGB(200,200,200)\x22,\x2209:15\x22],[963,1,\x22RGB(200,200,200)\x22,\x2216:30\x22]],Count:963,MiddleCount:526,GetData:function(t){return\x20t<200?this.Min:t<450?this.Simple:this.Full}},s={Full:[[0,1,\x22RGB(200,200,200)\x22,\x2206:00\x22],[120,1,\x22RGB(200,200,200)\x22,\x2208:00\x22],[240,1,\x22RGB(200,200,200)\x22,\x2210:00\x22],[360,1,\x22RGB(200,200,200)\x22,\x2212:00\x22],[480,0,\x22RGB(200,200,200)\x22,\x2214:00\x22],[600,1,\x22RGB(200,200,200)\x22,\x2216:00\x22],[720,1,\x22RGB(200,200,200)\x22,\x2218:00\x22],[840,1,\x22RGB(200,200,200)\x22,\x2220:00\x22],[960,1,\x22RGB(200,200,200)\x22,\x2222:00\x22],[1080,1,\x22RGB(200,200,200)\x22,\x220:00\x22],[1200,1,\x22RGB(200,200,200)\x22,\x2202:00\x22],[1320,1,\x22RGB(200,200,200)\x22,\x2204:00\x22]],Simple:[[0,1,\x22RGB(200,200,200)\x22,\x2206:00\x22],[240,1,\x22RGB(200,200,200)\x22,\x2210:00\x22],[480,0,\x22RGB(200,200,200)\x22,\x2214:00\x22],[720,1,\x22RGB(200,200,200)\x22,\x2218:00\x22],[960,1,\x22RGB(200,200,200)\x22,\x2222:00\x22],[1200,1,\x22RGB(200,200,200)\x22,\x2202:00\x22]],Min:[[0,1,\x22RGB(200,200,200)\x22,\x2206:00\x22],[480,0,\x22RGB(200,200,200)\x22,\x2214:00\x22],[960,1,\x22RGB(200,200,200)\x22,\x2222:00\x22]],Count:1440,MiddleCount:600,GetData:function(t){return\x20t<200?this.Min:t<450?this.Simple:this.Full}};this.GetCoordinateData=function(e,i){var\x20r=null;if(e){var\x20n=e.toLocaleUpperCase();if(MARKET_SUFFIX_NAME.IsSH(n)||MARKET_SUFFIX_NAME.IsSZ(n)||MARKET_SUFFIX_NAME.IsSHSZIndex(n))r=this.GetSHSZData(n,i);else\x20if(MARKET_SUFFIX_NAME.IsSHO(n))r=this.GetSHOData(n,i);else\x20if(MARKET_SUFFIX_NAME.IsHK(n))r=a;else{if(MARKET_SUFFIX_NAME.IsCFFEX(n)||MARKET_SUFFIX_NAME.IsCZCE(n)||MARKET_SUFFIX_NAME.IsDCE(n)||MARKET_SUFFIX_NAME.IsSHFE(n))return\x20this.GetChinatFuturesData(n,i);if(MARKET_SUFFIX_NAME.IsUSA(n))r=this.GetUSAData(n,i);else\x20if(MARKET_SUFFIX_NAME.IsFTSE(n))r=this.GetFTSEData(n,i);else\x20if(MARKET_SUFFIX_NAME.IsFHK(n))r=this.GetFHKData(n,i);else\x20if(MARKET_SUFFIX_NAME.IsForeignExchange(n))r=this.GetForeignExchangeData(n,i);else\x20if(MARKET_SUFFIX_NAME.IsBIT(n,i))r=this.GetBITData(n,i);else\x20if(MARKET_SUFFIX_NAME.IsET(n))r=this.GetETData(n,i);else{if(MARKET_SUFFIX_NAME.IsNYMEX(n,i))return\x20this.GetNYMEXData(n,i);if(MARKET_SUFFIX_NAME.IsCOMEX(n,i))return\x20this.GetCOMEXData(n,i);if(MARKET_SUFFIX_NAME.IsNYBOT(n,i))return\x20this.GetNYBOTData(n,i);if(MARKET_SUFFIX_NAME.IsCBOT(n,i))return\x20this.GetCBOTData(n,i);if(MARKET_SUFFIX_NAME.IsLME(n,i))return\x20this.GetLMEData(n,i)}}}else\x20r=t;return{Count:r.Count,MiddleCount:r.MiddleCount,Data:r.GetData(i)}},this.GetSHSZData=function(e,a){return\x20t},this.GetUSAData=function(t,e){return\x20i},this.GetSHOData=function(t,a){return\x20e},this.GetFuturesData=function(t,e,a){var\x20i=a.GetSplitData(t);if(!i)return\x20null;var\x20r=g_MinuteTimeStringData.GetFutures(i);if(!r)return\x20null;var\x20n={Count:r.length},s=null;s=e<200?i.Coordinate.Min:e<480?i.Coordinate.Simple:i.Coordinate.Full;for(var\x20o=[],h=0;h<r.length;++h)for(var\x20l=r[h],C=0;C<s.length;++C){var\x20u=s[C];if(l==u.Value){var\x20D=[h,0,\x22RGB(200,200,200)\x22,u.Text];o.push(D);break}}return\x20n.Data=o,n},this.GetChinatFuturesData=function(t,e){return\x20this.GetFuturesData(t,e,g_FuturesTimeData)},this.GetNYMEXData=function(t,e){return\x20this.GetFuturesData(t,e,g_NYMEXTimeData)},this.GetCOMEXData=function(t,e){return\x20this.GetFuturesData(t,e,g_COMEXTimeData)},this.GetNYBOTData=function(t,e){return\x20this.GetFuturesData(t,e,g_NYBOTTimeData)},this.GetCBOTData=function(t,e){return\x20this.GetFuturesData(t,e,g_CBOTTimeData)},this.GetLMEData=function(t,e){return\x20this.GetFuturesData(t,e,g_LMETimeData)},this.GetFTSEData=function(t,e){return\x20r},this.GetFHKData=function(t,e){return\x20n},this.GetForeignExchangeData=function(t,e){return\x20s},this.GetBITData=function(t,e){return\x20s},this.GetETData=function(t,e){throw{Name:\x22MinuteCoordinateData::GetETData\x22,Error:\x22not\x20implement\x22}}}function\x20FuturesTimeData(){this.TIME_SPLIT=[{Name:\x229:00-10:15,10:30-11:30,13:30-15:00\x22,Data:[{Start:900,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:900,Text:\x229:00\x22},{Value:930,Text:\x229:30\x22},{Value:1e3,Text:\x2210:00\x22},{Value:1030,Text:\x2210:30\x22},{Value:1100,Text:\x2211:00\x22},{Value:1330,Text:\x2213:30\x22},{Value:1400,Text:\x2214:00\x22},{Value:1430,Text:\x2214:30\x22},{Value:1500,Text:\x2215:00\x22}],Simple:[{Value:900,Text:\x229:00\x22},{Value:1e3,Text:\x2210:00\x22},{Value:1330,Text:\x2213:30\x22},{Value:1430,Text:\x2214:30\x22},{Value:1500,Text:\x2215:00\x22}],Min:[{Value:900,Text:\x229:00\x22},{Value:1330,Text:\x2213:30\x22},{Value:1500,Text:\x2215:00\x22}]}},{Name:\x229:15-11:30,13:00-15:15\x22,Data:[{Start:915,End:1130},{Start:1301,End:1515}],Coordinate:{Full:[{Value:930,Text:\x229:30\x22},{Value:1e3,Text:\x2210:00\x22},{Value:1030,Text:\x2210:30\x22},{Value:1100,Text:\x2211:00\x22},{Value:1300,Text:\x2213:00\x22},{Value:1330,Text:\x2213:30\x22},{Value:1400,Text:\x2214:00\x22},{Value:1430,Text:\x2214:30\x22},{Value:1515,Text:\x2215:15\x22}],Simple:[{Value:930,Text:\x229:30\x22},{Value:1030,Text:\x2210:30\x22},{Value:1300,Text:\x2213:00\x22},{Value:1400,Text:\x2214:00\x22},{Value:1515,Text:\x2215:15\x22}],Min:[{Value:930,Text:\x229:30\x22},{Value:1300,Text:\x2213:00\x22},{Value:1515,Text:\x2215:15\x22}]}},{Name:\x229:30-11:30,13:00-15:00\x22,Data:[{Start:930,End:1130},{Start:1301,End:1500}],Coordinate:{Full:[{Value:930,Text:\x229:30\x22},{Value:1e3,Text:\x2210:00\x22},{Value:1030,Text:\x2210:30\x22},{Value:1100,Text:\x2211:00\x22},{Value:1300,Text:\x2213:00\x22},{Value:1330,Text:\x2213:30\x22},{Value:1400,Text:\x2214:00\x22},{Value:1430,Text:\x2214:30\x22},{Value:1500,Text:\x2215:00\x22}],Simple:[{Value:930,Text:\x229:30\x22},{Value:1030,Text:\x2210:30\x22},{Value:1300,Text:\x2213:00\x22},{Value:1400,Text:\x2214:00\x22},{Value:1500,Text:\x2215:00\x22}],Min:[{Value:930,Text:\x229:30\x22},{Value:1300,Text:\x2213:00\x22},{Value:1500,Text:\x2215:00\x22}]}},{Name:\x2221:00-23:30,9:00-10:15,10:30-11:30,13:30-15:00\x22,Data:[{Start:2100,End:2330},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:\x2221:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:901,Text:\x229:00\x22},{Value:1031,Text:\x2210:30\x22},{Value:1331,Text:\x2213:30\x22},{Value:1430,Text:\x2214:30\x22},{Value:1500,Text:\x2215:00\x22}],Simple:[{Value:2100,Text:\x2221:00\x22},{Value:901,Text:\x229:00\x22},{Value:1331,Text:\x2213:30\x22},{Value:1500,Text:\x2215:00\x22}],Min:[{Value:2100,Text:\x2221:00\x22},{Value:901,Text:\x229:00\x22},{Value:1500,Text:\x2215:00\x22}]}},{Name:\x2221:00-1:00,9:00-10:15,10:30-11:30,13:30-15:00\x22,Data:[{Start:2100,End:2359},{Start:0,End:100},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:\x2221:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:901,Text:\x229:00\x22},{Value:1031,Text:\x2210:30\x22},{Value:1331,Text:\x2213:30\x22},{Value:1500,Text:\x2215:00\x22}],Simple:[{Value:2100,Text:\x2221:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:901,Text:\x229:00\x22},{Value:1031,Text:\x2210:30\x22},{Value:1500,Text:\x2215:00\x22}],Min:[{Value:2100,Text:\x2221:00\x22},{Value:901,Text:\x229:00\x22},{Value:1500,Text:\x2215:00\x22}]}},{Name:\x2221:00-2:30,9:00-10:15,10:30-11:30,13:30-15:00\x22,Data:[{Start:2100,End:2359},{Start:0,End:230},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:\x2221:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:100,Text:\x221:00\x22},{Value:901,Text:\x229:00\x22},{Value:1031,Text:\x2210:30\x22},{Value:1331,Text:\x2213:30\x22},{Value:1500,Text:\x2215:00\x22}],Simple:[{Value:2100,Text:\x2221:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:901,Text:\x229:00\x22},{Value:1100,Text:\x2211:00\x22},{Value:1500,Text:\x2215:00\x22}],Min:[{Value:2100,Text:\x2221:00\x22},{Value:901,Text:\x229:00\x22},{Value:1500,Text:\x2215:00\x22}]}},{Name:\x2221:00-23:00,9:00-10:15,10:30-11:30,13:30-15:00\x22,Data:[{Start:2100,End:2300},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:\x2221:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:1030,Text:\x2210:30\x22},{Value:1331,Text:\x2213:30\x22},{Value:1430,Text:\x2214:30\x22},{Value:1500,Text:\x2215:00\x22}],Simple:[{Value:2100,Text:\x2221:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:1331,Text:\x2213:30\x22},{Value:1500,Text:\x2215:00\x22}],Min:[{Value:2100,Text:\x2221:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:1500,Text:\x2215:00\x22}]}}],this.MAP_TWOWORDS=new\x20Map([[MARKET_SUFFIX_NAME.DCE+\x22-JD\x22,{Time:0,Decimal:0,Name:\x22鸡蛋\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-FB\x22,{Time:0,Decimal:2,Name:\x22纤板\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-BB\x22,{Time:0,Decimal:2,Name:\x22胶板\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-PP\x22,{Time:6,Decimal:0,Name:\x22丙烯\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-JM\x22,{Time:6,Decimal:1,Name:\x22焦煤\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-EG\x22,{Time:6,Decimal:0,Name:\x22乙二醇\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-EB\x22,{Time:6,Decimal:0,Name:\x22苯乙烯\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-CS\x22,{Time:6,Decimal:0,Name:\x22淀粉\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-PG\x22,{Time:6,Decimal:0,Name:\x22液化气\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-RR\x22,{Time:6,Decimal:0,Name:\x22梗米\x22}],[MARKET_SUFFIX_NAME.SHFE+\x22-CU\x22,{Time:4,Decimal:0}],[MARKET_SUFFIX_NAME.SHFE+\x22-AL\x22,{Time:4,Decimal:0}],[MARKET_SUFFIX_NAME.SHFE+\x22-NI\x22,{Time:4,Decimal:0}],[MARKET_SUFFIX_NAME.SHFE+\x22-SN\x22,{Time:4,Decimal:0}],[MARKET_SUFFIX_NAME.SHFE+\x22-ZN\x22,{Time:4,Decimal:0}],[MARKET_SUFFIX_NAME.SHFE+\x22-PB\x22,{Time:4,Decimal:0}],[MARKET_SUFFIX_NAME.SHFE+\x22-RU\x22,{Time:6,Decimal:0}],[MARKET_SUFFIX_NAME.SHFE+\x22-FU\x22,{Time:6,Decimal:0}],[MARKET_SUFFIX_NAME.SHFE+\x22-RB\x22,{Time:6,Decimal:0}],[MARKET_SUFFIX_NAME.SHFE+\x22-BU\x22,{Time:6,Decimal:0}],[MARKET_SUFFIX_NAME.SHFE+\x22-HC\x22,{Time:6,Decimal:0}],[MARKET_SUFFIX_NAME.SHFE+\x22-SP\x22,{Time:6,Decimal:0,Name:\x22纸浆\x22}],[MARKET_SUFFIX_NAME.SHFE+\x22-WR\x22,{Time:0,Decimal:0,Name:\x22线材\x22}],[MARKET_SUFFIX_NAME.SHFE+\x22-AG\x22,{Time:5,Decimal:0,Name:\x22白银\x22}],[MARKET_SUFFIX_NAME.SHFE+\x22-AU\x22,{Time:5,Decimal:2,Name:\x22黄金\x22}],[MARKET_SUFFIX_NAME.SHFE+\x22-NR\x22,{Time:6,Decimal:1,Name:\x2220号胶\x22}],[MARKET_SUFFIX_NAME.SHFE+\x22-SC\x22,{Time:6,Decimal:1,Name:\x22中质含硫原油\x22}],[MARKET_SUFFIX_NAME.SHFE+\x22-LU\x22,{Time:6,Decimal:0,Name:\x22低硫燃料油\x22}],[MARKET_SUFFIX_NAME.CZCE+\x22-CF\x22,{Time:6,Decimal:0,Name:\x22棉花\x22}],[MARKET_SUFFIX_NAME.CZCE+\x22-SR\x22,{Time:6,Decimal:0,Name:\x22白糖\x22}],[MARKET_SUFFIX_NAME.CZCE+\x22-MA\x22,{Time:6,Decimal:0,Name:\x22甲醇\x22}],[MARKET_SUFFIX_NAME.CZCE+\x22-ZC\x22,{Time:6,Decimal:1,Name:\x22动力煤\x22}],[MARKET_SUFFIX_NAME.CZCE+\x22-TA\x22,{Time:6,Decimal:0,Name:\x22精对苯二甲酸(PTA)\x22}],[MARKET_SUFFIX_NAME.CZCE+\x22-RM\x22,{Time:6,Decimal:0,Name:\x22菜籽粕\x22}],[MARKET_SUFFIX_NAME.CZCE+\x22-OI\x22,{Time:6,Decimal:0,Name:\x22菜籽油\x22}],[MARKET_SUFFIX_NAME.CZCE+\x22-ME\x22,{Time:3,Decimal:0,Name:\x22甲醇(老)\x22}],[MARKET_SUFFIX_NAME.CZCE+\x22-FG\x22,{Time:6,Decimal:0,Name:\x22平板玻璃\x22}],[MARKET_SUFFIX_NAME.CZCE+\x22-WS\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-WT\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-GN\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-RO\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-RS\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-ER\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-RI\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-WH\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-AP\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-PM\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-QM\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-TC\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-JR\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-LR\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-SF\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CZCE+\x22-SM\x22,{Time:0,Decimal:0}],[MARKET_SUFFIX_NAME.CFFEX+\x22-TF\x22,{Time:1,Decimal:3,Name:\x22二债\x22}],[MARKET_SUFFIX_NAME.CFFEX+\x22-TS\x22,{Time:1,Decimal:3,Name:\x22五债\x22}],[MARKET_SUFFIX_NAME.CFFEX+\x22-IH\x22,{Time:2,Decimal:1,Name:\x22上证股指期货\x22}],[MARKET_SUFFIX_NAME.CFFEX+\x22-IC\x22,{Time:2,Decimal:1,Name:\x22中证股指期货\x22}],[MARKET_SUFFIX_NAME.CFFEX+\x22-IF\x22,{Time:2,Decimal:1,Name:\x22沪深股指期货\x22}]]),this.MAP_ONEWORD=new\x20Map([[MARKET_SUFFIX_NAME.DCE+\x22-C\x22,{Time:6,Decimal:0,Name:\x22玉米\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-L\x22,{Time:6,Decimal:0,Name:\x22乙烯\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-V\x22,{Time:6,Decimal:0,Name:\x22PVC\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-A\x22,{Time:6,Decimal:0,Name:\x22豆一\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-B\x22,{Time:6,Decimal:0,Name:\x22豆二\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-M\x22,{Time:6,Decimal:0,Name:\x22豆粕\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-Y\x22,{Time:6,Decimal:0,Name:\x22豆油\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-P\x22,{Time:6,Decimal:0,Name:\x22棕榈\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-J\x22,{Time:6,Decimal:1,Name:\x22焦炭\x22}],[MARKET_SUFFIX_NAME.DCE+\x22-I\x22,{Time:6,Decimal:1,Name:\x22铁矿\x22}],[MARKET_SUFFIX_NAME.CFFEX+\x22-T\x22,{Time:1,Decimal:3,Name:\x22十债\x22}]]),this.AddNewFutures=function(t){if(t){var\x20e=t.Suffix+\x22-\x22+t.Symbol,a={Time:t.Time,Decimal:t.Decimal,Name:t.Name};1==t.Symbol.length?this.MAP_ONEWORD.set(e,a):2==t.Symbol.length&&this.MAP_TWOWORDS.set(e,a)}},this.GetData=function(t){var\x20e=t.charAt(0),a=t.substr(0,2),i=null,r=null;return\x20MARKET_SUFFIX_NAME.IsDCE(t)?(i=MARKET_SUFFIX_NAME.DCE+\x22-\x22+e,r=MARKET_SUFFIX_NAME.DCE+\x22-\x22+a):MARKET_SUFFIX_NAME.IsSHFE(t)?(i=MARKET_SUFFIX_NAME.SHFE+\x22-\x22+e,r=MARKET_SUFFIX_NAME.SHFE+\x22-\x22+a):MARKET_SUFFIX_NAME.IsCFFEX(t)?(i=MARKET_SUFFIX_NAME.CFFEX+\x22-\x22+e,r=MARKET_SUFFIX_NAME.CFFEX+\x22-\x22+a):MARKET_SUFFIX_NAME.IsCZCE(t)&&(i=MARKET_SUFFIX_NAME.CZCE+\x22-\x22+e,r=MARKET_SUFFIX_NAME.CZCE+\x22-\x22+a),this.MAP_TWOWORDS.has(r)?this.MAP_TWOWORDS.get(r):this.MAP_ONEWORD.has(i)?this.MAP_ONEWORD.get(i):null},this.GetSplitData=function(t){var\x20e=this.GetData(t);return\x20e?this.TIME_SPLIT[e.Time]:null},this.GetDecimal=function(t){var\x20e=this.GetData(t);return\x20e?e.Decimal:2}}function\x20NYMEXTimeData(){this.TIME_SPLIT=[{Name:\x226:00-5:00\x22,Data:[{Start:600,End:2359},{Start:0,End:500}],Coordinate:{Full:[{Value:600,Text:\x226:00\x22},{Value:800,Text:\x228:00\x22},{Value:1e3,Text:\x2210:00\x22},{Value:1200,Text:\x2212:00\x22},{Value:1400,Text:\x2214:00\x22},{Value:1600,Text:\x2216:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:2e3,Text:\x2220:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:0,Text:\x220:00\x22},{Value:200,Text:\x222:00\x22},{Value:400,Text:\x224:00\x22}],Simple:[{Value:600,Text:\x226:00\x22},{Value:1e3,Text:\x2210:00\x22},{Value:1400,Text:\x2214:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:200,Text:\x222:00\x22}],Min:[{Value:600,Text:\x226:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:500,Text:\x225:00\x22}]}}],this.TIME_SPLIT2=[{Name:\x227:00-6:00\x22,Data:[{Start:700,End:2359},{Start:0,End:600}],Coordinate:{Full:[{Value:700,Text:\x227:00\x22},{Value:900,Text:\x229:00\x22},{Value:1100,Text:\x2211:00\x22},{Value:1300,Text:\x2213:00\x22},{Value:1500,Text:\x2215:00\x22},{Value:1700,Text:\x2217:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:1,Text:\x221:00\x22},{Value:300,Text:\x223:00\x22},{Value:500,Text:\x225:00\x22}],Simple:[{Value:700,Text:\x227:00\x22},{Value:1100,Text:\x2211:00\x22},{Value:1500,Text:\x2215:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:300,Text:\x223:00\x22}],Min:[{Value:700,Text:\x227:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:500,Text:\x225:00\x22}]}}],this.FUTURES_LIST=[{Symbol:\x22CL\x22,Decimal:2,Time:0},{Symbol:\x22NG\x22,Decimal:3,Time:0},{Symbol:\x22RB\x22,Decimal:4,Time:0},{Symbol:\x22PL\x22,Decimal:1,Time:0},{Symbol:\x22PA\x22,Decimal:2,Time:0},{Symbol:\x22HR\x22,Decimal:0,Time:0},{Symbol:\x22QM\x22,Decimal:3,Time:0},{Symbol:\x22HO\x22,Decimal:4,Time:0}],this.MarketSuffix=\x22.NYMEX\x22,this.TimeType=0,this.GetFuturesInfo=function(t){if(t.indexOf(this.MarketSuffix)<=0)return\x20null;for(var\x20e\x20in\x20this.FUTURES_LIST){var\x20a=this.FUTURES_LIST[e];if(0==t.indexOf(a.Symbol))return\x20a}return\x20null},this.GetSplitData=function(t){var\x20e=0==this.TimeType?this.TIME_SPLIT:this.TIME_SPLIT2,a=this.GetFuturesInfo(t);return\x20a?e[a.Time]:e[0]},this.GetDecimal=function(t){var\x20e=this.GetFuturesInfo(t);return\x20e?e.Decimal:3},this.GetMarketStatus=function(t){var\x20e=GetLocalTime(-4),a=new\x20Date,i=e.getDay(),r=100*a.getHours()+a.getMinutes();return\x206==i||0==i?0:r>430&&r<730?1:2}}function\x20COMEXTimeData(){this.newMethod=NYMEXTimeData,this.newMethod(),delete\x20this.newMethod,this.FUTURES_LIST=[{Symbol:\x22GC\x22,Decimal:1,Time:0},{Symbol:\x22QO\x22,Decimal:2,Time:0},{Symbol:\x22MG\x22,Decimal:1,Time:0},{Symbol:\x22QI\x22,Decimal:4,Time:0},{Symbol:\x22SI\x22,Decimal:3,Time:0},{Symbol:\x22QI\x22,Decimal:4,Time:0},{Symbol:\x22HG\x22,Decimal:4,Time:0}],this.MarketSuffix=\x22.COMEX\x22}function\x20NYBOTTimeData(){this.newMethod=NYMEXTimeData,this.newMethod(),delete\x20this.newMethod,this.TIME_SPLIT=[{Name:\x229:00-2:20\x22,Data:[{Start:900,End:2359},{Start:0,End:220}],Coordinate:{Full:[{Value:900,Text:\x229:00\x22},{Value:1100,Text:\x2211:00\x22},{Value:1300,Text:\x2213:00\x22},{Value:1500,Text:\x2215:00\x22},{Value:1700,Text:\x2217:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:100,Text:\x221:00\x22}],Simple:[{Value:900,Text:\x229:00\x22},{Value:1300,Text:\x2213:00\x22},{Value:1700,Text:\x2217:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:100,Text:\x221:00\x22}],Min:[{Value:900,Text:\x229:00\x22},{Value:1700,Text:\x2217:00\x22},{Value:100,Text:\x221:00\x22}]}},{Name:\x2215:30-1:00\x22,Data:[{Start:1530,End:2359},{Start:0,End:100}],Coordinate:{Full:[{Value:1600,Text:\x2216:00\x22},{Value:1700,Text:\x2217:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:2e3,Text:\x2220:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:0,Text:\x220:00\x22},{Value:100,Text:\x221:00\x22}],Simple:[{Value:1600,Text:\x2216:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:2e3,Text:\x2220:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:0,Text:\x220:00\x22}],Min:[{Value:1600,Text:\x2216:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:100,Text:\x221:00\x22}]}}],this.TIME_SPLIT2=[{Name:\x2210:00-3:20\x22,Data:[{Start:1e3,End:2359},{Start:0,End:320}],Coordinate:{Full:[{Value:1e3,Text:\x2210:00\x22},{Value:1200,Text:\x2212:00\x22},{Value:1400,Text:\x2214:00\x22},{Value:1600,Text:\x2216:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:2e3,Text:\x2220:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:0,Text:\x220:00\x22},{Value:200,Text:\x222:00\x22}],Simple:[{Value:1e3,Text:\x2210:00\x22},{Value:1400,Text:\x2214:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:200,Text:\x222:00\x22}],Min:[{Value:1e3,Text:\x2210:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:200,Text:\x222:00\x22}]}},{Name:\x2216:30-2:00\x22,Data:[{Start:1630,End:2359},{Start:0,End:200}],Coordinate:{Full:[{Value:1700,Text:\x2217:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:2e3,Text:\x2220:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:0,Text:\x220:00\x22},{Value:100,Text:\x221:00\x22},{Value:200,Text:\x222:00\x22}],Simple:[{Value:1700,Text:\x2217:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:100,Text:\x221:00\x22}],Min:[{Value:1700,Text:\x2217:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:200,Text:\x222:00\x22}]}}],this.FUTURES_LIST=[{Symbol:\x22SB\x22,Decimal:2,Time:1},{Symbol:\x22CT\x22,Decimal:2,Time:0}],this.MarketSuffix=\x22.NYBOT\x22,this.GetMarketStatus=function(t){var\x20e=GetLocalTime(-4),a=e.getDay(),i=100*e.getHours()+e.getMinutes();if(6==a||0==a)return\x200;var\x20r=this.GetFuturesInfo(t);if(!r)return\x202;if(\x22SB\x22==r.Symbol){if(i>300&&i<1400)return\x202}else\x20if(\x22CT\x22==r.Symbol)return\x20i>=0&&i<=1500||i>=2e3&&i<=2359?2:1;return\x200}}function\x20CBOTTimeData(){this.newMethod=NYMEXTimeData,this.newMethod(),delete\x20this.newMethod,this.TIME_SPLIT=[{Name:\x228:00-2:20\x22,Data:[{Start:800,End:2359},{Start:0,End:220}],Coordinate:{Full:[{Value:800,Text:\x228:00\x22},{Value:1e3,Text:\x2210:00\x22},{Value:1200,Text:\x2212:00\x22},{Value:1400,Text:\x2214:00\x22},{Value:1600,Text:\x2216:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:2e3,Text:\x2220:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:0,Text:\x220:00\x22},{Value:200,Text:\x222:00\x22}],Simple:[{Value:800,Text:\x228:00\x22},{Value:1200,Text:\x2212:00\x22},{Value:1600,Text:\x2216:00\x22},{Value:2e3,Text:\x2220:00\x22},{Value:0,Text:\x220:00\x22}],Min:[{Value:800,Text:\x228:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:200,Text:\x222:00\x22}]}},{Name:\x228:00-2:45\x22,Data:[{Start:800,End:2359},{Start:0,End:245}],Coordinate:{Full:[{Value:800,Text:\x228:00\x22},{Value:1e3,Text:\x2210:00\x22},{Value:1200,Text:\x2212:00\x22},{Value:1400,Text:\x2214:00\x22},{Value:1600,Text:\x2216:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:2e3,Text:\x2220:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:0,Text:\x220:00\x22},{Value:200,Text:\x222:00\x22}],Simple:[{Value:800,Text:\x228:00\x22},{Value:1200,Text:\x2212:00\x22},{Value:1600,Text:\x2216:00\x22},{Value:2e3,Text:\x2220:00\x22},{Value:0,Text:\x220:00\x22}],Min:[{Value:800,Text:\x228:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:200,Text:\x222:00\x22}]}},{Name:\x226:00-5:00\x22,Data:[{Start:600,End:2359},{Start:0,End:500}],Coordinate:{Full:[{Value:600,Text:\x226:00\x22},{Value:800,Text:\x228:00\x22},{Value:1e3,Text:\x2210:00\x22},{Value:1200,Text:\x2212:00\x22},{Value:1400,Text:\x2214:00\x22},{Value:1600,Text:\x2216:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:2e3,Text:\x2220:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:0,Text:\x220:00\x22},{Value:200,Text:\x222:00\x22},{Value:400,Text:\x224:00\x22}],Simple:[{Value:600,Text:\x226:00\x22},{Value:1e3,Text:\x2210:00\x22},{Value:1400,Text:\x2214:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:200,Text:\x222:00\x22}],Min:[{Value:600,Text:\x226:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:500,Text:\x225:00\x22}]}}],this.TIME_SPLIT2=[{Name:\x229:00-3:20\x22,Data:[{Start:900,End:2359},{Start:0,End:320}],Coordinate:{Full:[{Value:900,Text:\x229:00\x22},{Value:1100,Text:\x2211:00\x22},{Value:1300,Text:\x2213:00\x22},{Value:1500,Text:\x2215:00\x22},{Value:1700,Text:\x2217:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:1,Text:\x221:00\x22},{Value:300,Text:\x223:00\x22}],Simple:[{Value:900,Text:\x229:00\x22},{Value:1300,Text:\x2213:00\x22},{Value:1700,Text:\x2217:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:1,Text:\x221:00\x22}],Min:[{Value:900,Text:\x229:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:300,Text:\x223:00\x22}]}},{Name:\x229:00-3:45\x22,Data:[{Start:900,End:2359},{Start:0,End:345}],Coordinate:{Full:[{Value:900,Text:\x229:00\x22},{Value:1100,Text:\x2211:00\x22},{Value:1300,Text:\x2213:00\x22},{Value:1500,Text:\x2215:00\x22},{Value:1700,Text:\x2217:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:1,Text:\x221:00\x22},{Value:300,Text:\x223:00\x22}],Simple:[{Value:900,Text:\x229:00\x22},{Value:1300,Text:\x2213:00\x22},{Value:1700,Text:\x2217:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:1,Text:\x221:00\x22}],Min:[{Value:900,Text:\x229:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:300,Text:\x223:00\x22}]}},{Name:\x227:00-6:00\x22,Data:[{Start:700,End:2359},{Start:0,End:600}],Coordinate:{Full:[{Value:700,Text:\x227:00\x22},{Value:900,Text:\x229:00\x22},{Value:1100,Text:\x2211:00\x22},{Value:1300,Text:\x2213:00\x22},{Value:1500,Text:\x2215:00\x22},{Value:1700,Text:\x2217:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:1,Text:\x221:00\x22},{Value:300,Text:\x223:00\x22},{Value:500,Text:\x225:00\x22}],Simple:[{Value:700,Text:\x227:00\x22},{Value:1100,Text:\x2211:00\x22},{Value:1500,Text:\x2215:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:300,Text:\x223:00\x22}],Min:[{Value:700,Text:\x227:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:500,Text:\x225:00\x22}]}}],this.FUTURES_LIST=[{Symbol:\x22ZC\x22,Decimal:2,Time:0},{Symbol:\x22XC\x22,Decimal:2,Time:1},{Symbol:\x22ZS\x22,Decimal:2,Time:0},{Symbol:\x22XK\x22,Decimal:2,Time:1},{Symbol:\x22ZL\x22,Decimal:2,Time:0},{Symbol:\x22ZR\x22,Decimal:2,Time:0},{Symbol:\x22ZO\x22,Decimal:2,Time:0},{Symbol:\x22ZW\x22,Decimal:2,Time:0},{Symbol:\x22XW\x22,Decimal:2,Time:1},{Symbol:\x22ZM\x22,Decimal:1,Time:0},{Symbol:\x22EH\x22,Decimal:3,Time:2},{Symbol:\x22YM\x22,Decimal:0,Time:2},{Symbol:\x22ES\x22,Decimal:2,Time:2},{Symbol:\x22NQ\x22,Decimal:2,Time:2},{Symbol:\x22TY\x22,Decimal:4,Time:2},{Symbol:\x22TU\x22,Decimal:4,Time:2},{Symbol:\x22FV\x22,Decimal:4,Time:2},{Symbol:\x22US\x22,Decimal:4,Time:2},{Symbol:\x22UL\x22,Decimal:4,Time:2}],this.MarketSuffix=\x22.CBOT\x22}function\x20LMETimeData(){this.newMethod=NYMEXTimeData,this.newMethod(),delete\x20this.newMethod,this.TIME_SPLIT=[{Name:\x22LME\x209:00-3:00\x22,Data:[{Start:900,End:2359},{Start:0,End:300}],Coordinate:{Full:[{Value:900,Text:\x229:00\x22},{Value:1100,Text:\x2211:00\x22},{Value:1300,Text:\x2213:00\x22},{Value:1500,Text:\x2215:00\x22},{Value:1700,Text:\x2217:00\x22},{Value:1900,Text:\x2219:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:2300,Text:\x2223:00\x22},{Value:100,Text:\x221:00\x22},{Value:300,Text:\x223:00\x22}],Simple:[{Value:900,Text:\x229:00\x22},{Value:1300,Text:\x2213:00\x22},{Value:1700,Text:\x2217:00\x22},{Value:2100,Text:\x2221:00\x22},{Value:100,Text:\x221:00\x22}],Min:[{Value:900,Text:\x229:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:300,Text:\x223:00\x22}]}}],this.TIME_SPLIT=[{Name:\x22LME\x208:00-2:00\x22,Data:[{Start:800,End:2359},{Start:0,End:200}],Coordinate:{Full:[{Value:800,Text:\x228:00\x22},{Value:1e3,Text:\x2210:00\x22},{Value:1200,Text:\x2212:00\x22},{Value:1400,Text:\x2214:00\x22},{Value:1600,Text:\x2216:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:2e3,Text:\x2220:00\x22},{Value:2200,Text:\x2222:00\x22},{Value:0,Text:\x220:00\x22},{Value:200,Text:\x222:00\x22}],Simple:[{Value:800,Text:\x228:00\x22},{Value:1200,Text:\x2212:00\x22},{Value:1600,Text:\x2216:00\x22},{Value:2e3,Text:\x2220:00\x22},{Value:0,Text:\x220:00\x22}],Min:[{Value:800,Text:\x228:00\x22},{Value:1800,Text:\x2218:00\x22},{Value:200,Text:\x222:00\x22}]}}],this.FUTURES_LIST=[{Symbol:\x22SND\x22,Decimal:0,Time:0},{Symbol:\x22AHD\x22,Decimal:2,Time:0},{Symbol:\x22PBD\x22,Decimal:2,Time:0},{Symbol:\x22ZSD\x22,Decimal:2,Time:0},{Symbol:\x22CAD\x22,Decimal:2,Time:0},{Symbol:\x22NID\x22,Decimal:0,Time:0}],this.MarketSuffix=\x22.LME\x22}var\x20g_MinuteTimeStringData=new\x20MinuteTimeStringData,g_MinuteCoordinateData=new\x20MinuteCoordinateData,g_FuturesTimeData=new\x20FuturesTimeData,g_NYMEXTimeData=new\x20NYMEXTimeData,g_COMEXTimeData=new\x20COMEXTimeData,g_NYBOTTimeData=new\x20NYBOTTimeData,g_CBOTTimeData=new\x20CBOTTimeData,g_LMETimeData=new\x20LMETimeData;function\x20GetfloatPrecision(t){var\x20e=2;if(!t)return\x20e;var\x20a=t.toUpperCase();return\x20MARKET_SUFFIX_NAME.IsSHSZFund(a)?e=3:MARKET_SUFFIX_NAME.IsSHO(a)?e=MARKET_SUFFIX_NAME.GetSHODecimal(a):MARKET_SUFFIX_NAME.IsChinaFutures(a)?e=g_FuturesTimeData.GetDecimal(a):MARKET_SUFFIX_NAME.IsFHK(a)?e=MARKET_SUFFIX_NAME.GetFHKDecimal(a):MARKET_SUFFIX_NAME.IsFTSE(a)?e=MARKET_SUFFIX_NAME.GetFTSEDecimal(a):MARKET_SUFFIX_NAME.IsBIT(a)?e=MARKET_SUFFIX_NAME.GetBITDecimal(a):MARKET_SUFFIX_NAME.IsET(a)?e=MARKET_SUFFIX_NAME.GetETDecimal(a):MARKET_SUFFIX_NAME.IsForeignExchange(a)?e=MARKET_SUFFIX_NAME.GetForeignExchangeDecimal(a):MARKET_SUFFIX_NAME.IsNYMEX(a)?e=g_NYMEXTimeData.GetDecimal(a):MARKET_SUFFIX_NAME.IsCOMEX(a)?e=g_COMEXTimeData.GetDecimal(a):MARKET_SUFFIX_NAME.IsNYBOT(a)?e=g_NYBOTTimeData.GetDecimal(a):MARKET_SUFFIX_NAME.IsCBOT(a)&&(e=g_CBOTTimeData.GetDecimal(a)),e}function\x20GenerateMinuteStockJsonData(t){var\x20e={symbol:t.symbol,name:t.name,time:t.time,date:t.date,price:t.price,open:t.open,yclose:t.yclose,high:t.high,low:t.low,vol:t.vol,amount:t.amount,minute:[]},a=new\x20Map;for(var\x20i\x20in\x20t.minute){var\x20r=t.minute[i];a.set(r.time,r)}var\x20n=g_MinuteTimeStringData.GetTimeData(e.symbol);for(var\x20i\x20in\x20n){var\x20s=n[i],o={time:s,vaild:!1};if(a.has(s)){var\x20h=a.get(s);o.vaild=!0,o.price=h.price,o.open=h.open,o.high=h.high,o.low=h.low,o.avprice=h.avprice,o.vol=h.vol,o.amount=h.amount,IFrameSplitOperator.IsNumber(h.increase)&&(o.increase=h.increase),IFrameSplitOperator.IsNumber(h.risefall)&&(o.risefall=h.risefall),IFrameSplitOperator.IsNumber(h.position)&&(o.position=h.position)}e.minute.push(o)}var\x20l=0;for(i=e.minute.length-1;i>=0;--i){if(l=i+1,1==(r=e.minute[i]).vaild)break}return\x20e.minute=e.minute.slice(0,l),e}function\x20GetLocalTime(t){if(\x22number\x22==typeof\x20t){var\x20e=new\x20Date,a=e.getTime(),i=6e4*e.getTimezoneOffset();return\x20new\x20Date(a+i+36e5*t)}};function\x20JSStockResource(){this.Domain=\x22https://opensource.zealink.com\x22,this.CacheDomain=\x22https://opensourcecache.zealink.com\x22}var\x20g_JSStockResource=new\x20JSStockResource;function\x20IndexTopData(){this.Stop,this.Down,this.Up,this.Unchanged,this.UpStock={Symbol:null,Name:null},this.DownStock={Symbol:null,Name:null}}function\x20IndexHeatData(){this.Good,this.GoodIncrease={Day1:null,Week1:null,Week4:null}}function\x20SortData(t,e,a){this.arySymbol=new\x20Array,this.SortField=t,this.Order=e,this.TagID=new\x20Set([a])}function\x20FinanceData(){this.ROE,this.Date,this.PerSEarning,this.EPS,this.PerNetAsset,this.NProfit,this.NProfitIncrease,this.NnetProfit,this.NnProfitIncrease,this.NnProfitSpeed,this.Benford,this.SetData=function(t){isNaN(t.roe)||(this.ROE=t.roe),isNaN(t.finance.date)||(this.Date=t.finance.date),isNaN(t.finance.persearning)||(this.PerSEarning=t.finance.persearning),isNaN(t.finance.eps)||(this.EPS=t.finance.eps),isNaN(t.finance.pernetasset)||(this.PerNetAsset=t.finance.pernetasset),isNaN(t.finance.nprofit)||(this.NProfit=t.finance.nprofit),isNaN(t.finance.nprofitincrease)||(this.NProfitIncrease=t.finance.nprofitincrease),isNaN(t.finance.nnetprofit)||(this.NnetProfit=t.finance.nnetprofit),isNaN(t.finance.nnprofitincrease)||(this.NnProfitIncrease=t.finance.nnprofitincrease),isNaN(t.finance.nnprofitspeed)||(this.NnProfitSpeed=t.finance.nnprofitspeed),isNaN(t.finance.benford)||(this.Benford=t.finance.benford)}}function\x20CapitalData(){this.Date,this.A,this.Total,this.ARate,this.SetData=function(t){isNaN(t.capital.date)||(this.Date=t.capital.date),isNaN(t.capital.a)||(this.A=t.capital.a),isNaN(t.capital.total)||(this.Total=t.capital.total),isNaN(t.capital.arate)||(this.ARate=t.capital.arate)}}function\x20CapitalFlowDayData(){this.SuperIn,this.SuperOut,this.BigIn,this.BigOut,this.MidIn,this.MidOut,this.SmallIn,this.SmallOut,this.MainIn,this.MainOut,this.MainNetIn,this.SetData=function(t){this.SuperIn=t.superin,this.SuperOut=t.superout,this.BigIn=t.bigin,this.BigOut=t.bigout,this.MidIn=t.midin,this.MidOut=t.midout,this.SmallIn=t.smallin,this.SmallOut=t.smallout,this.MainIn=t.mainin,this.MainOut=t.mainout,this.MainNetIn=t.mainnetin}}function\x20CapitalFlowDaysData(){this.SuperIn,this.SuperOut,this.BigIn,this.BigOut,this.MidIn,this.MidOut,this.SmallIn,this.SmallOut,this.MainIn,this.MainOut,this.MainNetIn,this.MainNetInRatio,this.SetData=function(t){this.SuperIn=t.superin,this.SuperOut=t.superout,this.BigIn=t.bigin,this.BigOut=t.bigout,this.MidIn=t.midin,this.MidOut=t.midout,this.SmallIn=t.smallin,this.SmallOut=t.smallout,this.MainIn=t.mainin,this.MainOut=t.mainout,this.MainNetIn=t.mainnetin,this.MainNetInRatio=t.mainnetinratio}}function\x20DDEData(){this.DDX,this.DDY,this.DDZ,this.SetData=function(t){this.DDX=t.ddx,this.DDY=t.ddy,this.DDZ=t.ddz}}function\x20CompanyData(){this.Name,this.Business,this.Vol,this.Price,this.ReleaseDate,this.Competence,this.SetData=function(t){t.company&&(this.Name=t.company.name,this.Business=t.company.business,this.Vol=t.company.vol,this.Price=t.company.price,this.ReleaseDate=t.company.releasedate,this.Competence=t.company.corecompetence)}}function\x20PlateData(){this.Industry,this.Region,this.Concept,this.SetData=function(t){this.SetIndustryData(t),this.SetRegionData(t),this.SetConceptData(t)},this.SetIndustryData=function(t){if(t.industry){this.Industry=[];for(let\x20e\x20in\x20t.industry){let\x20a=t.industry[e];this.Industry.push({Name:a.name,Symbol:a.symbol})}}},this.SetRegionData=function(t){if(t.region){this.Region=[];for(let\x20e\x20in\x20t.region){let\x20a=t.region[e];this.Region.push({Name:a.name,Symbol:a.symbol})}}},this.SetConceptData=function(t){if(t.concept){this.Concept=[];for(let\x20e\x20in\x20t.concept){let\x20a=t.concept[e];this.Concept.push({Name:a.name,Symbol:a.symbol})}}}}function\x20EventData(){this.IsMargin=!1,this.IsHK=!1,this.IsSHHK=!1,this.IsSZHK=!1,this.STType=0,this.HK,this.SetData=function(t){t.events&&(isNaN(t.events.margin)||(this.IsMargin=1==t.events.margin),isNaN(t.events.hk)||(this.IsHK=1==t.events.hk),isNaN(t.events.shhk)||(this.IsSHHK=1==t.events.shhk),isNaN(t.events.szhk)||(this.IsSZHK=1==t.events.szhk),isNaN(t.events.st)||(this.STType=t.events.st),this.IsHK&&t.events.hksymbol&&t.events.hkname&&(this.HK={Symbol:t.events.hksymbol,Name:t.events.hkname}))}}function\x20IsIndexSymbol(t){var\x20e=t.toUpperCase();if(e.indexOf(\x22.SH\x22)>0){if(\x220\x22==(e=e.replace(\x22.SH\x22,\x22\x22)).charAt(0)&&parseInt(e)<=3e3)return!0}else\x20if(e.indexOf(\x22.SZ\x22)>0){if(\x223\x22==(e=e.replace(\x22.SZ\x22,\x22\x22)).charAt(0)&&\x229\x22==e.charAt(1))return!0}else\x20if(e.indexOf(\x22.CI\x22)>0)return!0;return!1}function\x20StockData(t){this.Symbol=t,this.Name,this.Open,this.Price,this.High,this.Low,this.YClose,this.Vol,this.Amount,this.Date,this.Time,this.ExchangeRate,this.Amplitude,this.VolRatio,this.Increase,this.MaxPrice,this.MinPrice,this.RFPrice,this.IndexTop,this.Week,this.MinuteAmplitude={},this.RiseFallSpeed={},this.MAmount={},this.GetBaseData=function(t,e){switch(this.BaseDataTagID.add(t),e){case\x20STOCK_FIELD_NAME.SYMBOL:return\x20this.Symbol;case\x20STOCK_FIELD_NAME.NAME:return\x20this.Name;case\x20STOCK_FIELD_NAME.OPEN:return\x20this.Open;case\x20STOCK_FIELD_NAME.PRICE:return\x20this.Price;case\x20STOCK_FIELD_NAME.YCLOSE:return\x20this.YClose;case\x20STOCK_FIELD_NAME.HIGH:return\x20this.High;case\x20STOCK_FIELD_NAME.LOW:return\x20this.Low;case\x20STOCK_FIELD_NAME.VOL:return\x20this.Vol;case\x20STOCK_FIELD_NAME.AMOUNT:return\x20this.Amount;case\x20STOCK_FIELD_NAME.DATE:return\x20this.Date;case\x20STOCK_FIELD_NAME.TIME:return\x20this.Time;case\x20STOCK_FIELD_NAME.INCREASE:return\x20this.Increase;case\x20STOCK_FIELD_NAME.EXCHANGE_RATE:return\x20this.ExchangeRate;case\x20STOCK_FIELD_NAME.AMPLITUDE:return\x20this.Amplitude;case\x20STOCK_FIELD_NAME.MAX_PRICE:return\x20this.MaxPrice;case\x20STOCK_FIELD_NAME.MIN_PRICE:return\x20this.MinPrice;case\x20STOCK_FIELD_NAME.RISE_FALL_PRICE:return\x20this.RFPrice;case\x20STOCK_FIELD_NAME.VOLRATIO:return\x20this.VolRatio;case\x20STOCK_FIELD_NAME.INDEXTOP:return\x20this.IndexTop;case\x20STOCK_FIELD_NAME.WEEK:return\x20this.Week}},this.Heat,this.GetHeatData=function(t){return\x20this.HeatTagID.add(t),this.Heat},this.Sort=new\x20Map,this.GetSortData=function(t,e,a){var\x20i=e.toString()+\x22-\x22+a.toString();if(!this.Sort.has(i)){var\x20s=new\x20SortData(e,a,t);return\x20this.Sort.set(i,s),s}return(s=this.Sort.get(i)).TagID.add(t),s},this.Buy5,this.GetBuy5=function(t){return\x20this.BuySellTagID.add(t),this.Buy5},this.Sell5,this.GetSell5=function(t){return\x20this.BuySellTagID.add(t),this.Sell5},this.Deal,this.GetDeal=function(t){return\x20this.DealTagID.add(t),this.Deal},this.MarketValue,this.FlowMarketValue,this.Bookrate,this.Bookdiffer,this.PE,this.PE2,this.PE3,this.PB,this.GetDerivative=function(t,e){switch(this.DerivativeTagID.add(t),e){case\x20STOCK_FIELD_NAME.MARKET_VALUE:return\x20this.MarketValue;case\x20STOCK_FIELD_NAME.FLOW_MARKET_VALUE:return\x20this.FlowMarketValue;case\x20STOCK_FIELD_NAME.BOOK_RATE:return\x20this.Bookrate;case\x20STOCK_FIELD_NAME.BOOK_DIFFER:return\x20this.Bookdiffer;case\x20STOCK_FIELD_NAME.PE:return\x20this.PE;case\x20STOCK_FIELD_NAME.PE2:return\x20this.PE2;case\x20STOCK_FIELD_NAME.PE3:return\x20this.PE3;case\x20STOCK_FIELD_NAME.PB:return\x20this.PB}},this.Finance,this.GetFinance=function(t,e){if(!this.Finance)return\x20this.FinanceTagID.add(t),null;switch(e){case\x20STOCK_FIELD_NAME.ROE:return\x20this.Finance.ROE;case\x20STOCK_FIELD_NAME.FINANCE_DATE:return\x20this.Finance.Date;case\x20STOCK_FIELD_NAME.FINANCE_PERSEARNING:return\x20this.Finance.PerSEarning;case\x20STOCK_FIELD_NAME.FINANCE_PERNETASSET:return\x20this.Finance.PerNetAsset;case\x20STOCK_FIELD_NAME.FINANCE_NPROFIT:return\x20this.Finance.NProfit;case\x20STOCK_FIELD_NAME.FINANCE_NPROFITINCREASE:return\x20this.Finance.NProfitIncrease;case\x20STOCK_FIELD_NAME.FINANCE_NNETPROFIT:return\x20this.Finance.NnetProfit;case\x20STOCK_FIELD_NAME.FINANCE_NNPROFITINCREASE:return\x20this.Finance.NnProfitIncrease;case\x20STOCK_FIELD_NAME.FINANCE_NNPROFITSPEED:return\x20this.Finance.NnProfitSpeed;case\x20STOCK_FIELD_NAME.FINANCE_EPS:return\x20this.Finance.EPS;case\x20STOCK_FIELD_NAME.FINANCE_BENFORD:return\x20this.Finance.Benford}},this.Capital,this.GetCapital=function(t,e){if(!this.Capital)return\x20this.CapitalTagID.add(t),null;switch(e){case\x20STOCK_FIELD_NAME.CAPITAL_TOTAL:return\x20this.Capital.Total;case\x20STOCK_FIELD_NAME.CAPITAL_A:return\x20this.Capital.A;case\x20STOCK_FIELD_NAME.CAPTIAL_ARATE:return\x20this.Capital.ARate}},this.CapitalFlowDay,this.CapitalFlowDay3,this.CapitalFlowDay5,this.CapitalFlowDay10,this.GetCapitalFlowDay=function(t,e){let\x20a=null;switch(e){case\x20STOCK_FIELD_NAME.CAPITAL_FLOW_DAY:this.CapitalFlowDayID.add(t),this.CapitalFlowDay&&(a=this.CapitalFlowDay);break;case\x20STOCK_FIELD_NAME.CAPITAL_FLOW_DAY3:this.CapitalFlowDay3ID.add(t),this.CapitalFlowDay3&&(a=this.CapitalFlowDay3);break;case\x20STOCK_FIELD_NAME.CAPITAL_FLOW_DAY5:this.CapitalFlowDay5ID.add(t),this.CapitalFlowDay5&&(a=this.CapitalFlowDay5);break;case\x20STOCK_FIELD_NAME.CAPITAL_FLOW_DAY10:this.CapitalFlowDay10ID.add(t),this.CapitalFlowDay10&&(a=this.CapitalFlowDay10)}return\x20a},this.DDE,this.DDE3,this.DDE5,this.DDE10,this.GetDDE=function(t,e){let\x20a=null;switch(e){case\x20STOCK_FIELD_NAME.DDE:this.DDEID.add(t),this.DDE&&(a=this.DDE);break;case\x20STOCK_FIELD_NAME.DDE3:this.DDE3ID.add(t),this.DDE3&&(a=this.DDE3);break;case\x20STOCK_FIELD_NAME.DDE5:this.DDE5ID.add(t),this.DDE5&&(a=this.DDE5);break;case\x20STOCK_FIELD_NAME.DDE10:this.DDE10ID.add(t),this.DDE10&&(a=this.DDE10)}return\x20a},this.Event,this.GetEvent=function(t,e){return\x20this.Event?this.Event:(this.EventTagID.add(t),null)},this.Company,this.GetCompany=function(t,e){if(!this.Company)return\x20this.CompanyTagID.add(t),null;switch(e){case\x20STOCK_FIELD_NAME.COMPANY_NAME:return\x20this.Company.Name;case\x20STOCK_FIELD_NAME.COMPANY_BUSINESS:return\x20this.Company.Business;case\x20STOCK_FIELD_NAME.COMPANY_VOL:return\x20this.Company.Vol;case\x20STOCK_FIELD_NAME.COMPANY_PRICE:return\x20this.Company.Price;case\x20STOCK_FIELD_NAME.COMPANY_RELEASEDATE:return\x20this.Company.ReleaseDate;case\x20STOCK_FIELD_NAME.COMPANY_COMPETENCE:return\x20this.Company.Competence}},this.Plate,this.GetPlate=function(t,e){if(!this.Plate)return\x20this.PlateTagID.add(t),null;switch(e){case\x20STOCK_FIELD_NAME.PLATE_INDUSTRY:return\x20this.Plate.Industry;case\x20STOCK_FIELD_NAME.PLATE_CONCEPT:return\x20this.Plate.Concept;case\x20STOCK_FIELD_NAME.PLATE_REGION:return\x20this.Plate.Region}},this.TagID=new\x20Set,this.BaseDataTagID=new\x20Set,this.HeatTagID=new\x20Set,this.BuySellTagID=new\x20Set,this.DealTagID=new\x20Set,this.DerivativeTagID=new\x20Set,this.FinanceTagID=new\x20Set,this.CapitalTagID=new\x20Set,this.CapitalFlowDayID=new\x20Set,this.CapitalFlowDay3ID=new\x20Set,this.CapitalFlowDay5ID=new\x20Set,this.CapitalFlowDay10ID=new\x20Set,this.DDEID=new\x20Set,this.DDE3ID=new\x20Set,this.DDE5ID=new\x20Set,this.DDE10ID=new\x20Set,this.EventTagID=new\x20Set,this.CompanyTagID=new\x20Set,this.PlateTagID=new\x20Set,this.AttachTagID=function(t){this.TagID.add(t)},this.ClearTagID=function(){for(var\x20t\x20of(this.TagID.clear(),this.BaseDataTagID.clear(),this.HeatTagID.clear(),this.BuySellTagID.clear(),this.DealTagID.clear(),this.DerivativeTagID.clear(),this.FinanceTagID.clear(),this.CapitalTagID.clear(),this.CapitalFlowDayID.clear(),this.CapitalFlowDay3ID.clear(),this.CapitalFlowDay5ID.clear(),this.CapitalFlowDay10ID.clear(),this.DDEID.clear(),this.DDE3ID.clear(),this.DDE5ID.clear(),this.DDE10ID.clear(),this.EventTagID.clear(),this.CompanyTagID.clear(),this.Sort))t[1].TagID.clear()},this.RemoveTagID=function(t){for(var\x20e\x20of(this.TagID.delete(t),this.BaseDataTagID.delete(t),this.HeatTagID.delete(t),this.BuySellTagID.delete(t),this.DealTagID.delete(t),this.DerivativeTagID.delete(t),this.FinanceTagID.delete(t),this.CapitalTagID.delete(t),this.CapitalFlowDayID.delete(t),this.CapitalFlowDay3ID.delete(t),this.CapitalFlowDay5ID.delete(t),this.CapitalFlowDay10ID.delete(t),this.DDEID.delete(t),this.DDE3ID.delete(t),this.DDE5ID.delete(t),this.DDE10ID.delete(t),this.EventTagID.delete(t),this.CompanyTagID.delete(t),this.Sort))e[1].TagID.delete(t)},this.SetBaseData=function(t){this.Name=t.name,this.YClose=t.yclose,this.Price=t.price,this.High=t.high,this.Low=t.low,this.Open=t.open,this.Vol=t.vol,this.Amount=t.amount,this.Date=t.date,this.Time=t.time,this.Increase=t.increase,isNaN(t.exchangerate)||(this.ExchangeRate=t.exchangerate),isNaN(t.amplitude)||(this.Amplitude=t.amplitude),isNaN(t.volratio)||(this.VolRatio=t.volratio),this.Name.indexOf(\x22ST\x22)>=0?(this.MaxPrice=1.05*this.Open,this.MinPrice=.95*this.Open):(this.MaxPrice=1.1*this.Open,this.MinPrice=.9*this.Open),this.Price&&this.YClose&&(this.RFPrice=this.Price-this.YClose),t.week&&(this.Week={},this.Week.Week1=t.week.week1,this.Week.Week4=t.week.week4,this.Week.Week13=t.week.week13,this.Week.Week26=t.week.week26,this.Week.Week52=t.week.week52)},this.SetDerivativeData=function(t){this.MarketValue=t.marketvalue,this.FlowMarketValue=t.flowmarketvalue,this.Bookrate=t.bookrate,this.Bookdiffer=t.bookdiffer,this.PE=t.pe,this.PE2=t.pe2,this.PE3=t.pe3,this.PB=t.pb},this.SetFinanceData=function(t){console.log(t),t.finance&&(this.Finance=new\x20FinanceData,this.Finance.SetData(t))},this.SetCapitalData=function(t){t.capital&&(this.Capital=new\x20CapitalData,this.Capital.SetData(t))},this.SetIndexBaseData=function(t){this.SetBaseData(t);var\x20e=new\x20IndexTopData;t.indextop&&(e.Up=t.indextop.up,e.Down=t.indextop.down,e.Unchanged=t.indextop.unchanged,e.Stop=t.indextop.stop,e.UpStock.Symbol=t.indextop.upstock.symbol,e.UpStock.Name=t.indextop.upstock.name,e.DownStock.Symbol=t.indextop.downstock.symbol,e.DownStock.Name=t.indextop.downstock.name),this.IndexTop=e},this.SetBuySellData=function(t){for(var\x20e\x20in\x20this.SetBaseData(t),this.Buy5=new\x20Array,this.Sell5=new\x20Array,t.buy){var\x20a=t.buy[e];this.Buy5.push({Price:a.price,Vol:a.vol})}for(var\x20e\x20in\x20t.sell){a=t.sell[e];this.Sell5.push({Price:a.price,Vol:a.vol})}},this.SetDealData=function(t){for(var\x20e\x20in\x20this.Price=t.price,this.High=t.high,this.Low=t.low,this.Vol=t.vol,this.Amount=t.amount,this.Date=t.date,this.Time=t.time,this.Increase=t.increase,this.Deal=new\x20Array,t.deal){var\x20a=t.deal[e];if(!isNaN(a.price)&&!isNaN(a.time)){var\x20i=\x22\x22;0===a.bs?i=\x22B\x22:1===a.bs&&(i=\x22S\x22),this.Deal.push({Price:a.price,Amount:a.amount,Vol:a.vol,Time:a.time,BS:i})}}},this.SetHeatData=function(t){var\x20e=new\x20IndexHeatData;e.Good=t.quadrant.good,e.GoodIncrease.Day1=t.quadrant.gincrease.day1,e.GoodIncrease.Week1=t.quadrant.gincrease.week1,e.GoodIncrease.Week4=t.quadrant.gincrease.week4,this.Heat=e},this.SetCapitalFlowDayData=function(t,e){if(t)switch(e){case\x20RECV_DATA_TYPE.CAPITAL_FLOW_DAY_DATA:this.CapitalFlowDay=new\x20CapitalFlowDayData,this.CapitalFlowDay.SetData(t);break;case\x20RECV_DATA_TYPE.CAPITAL_FLOW_DAY3_DATA:this.CapitalFlowDay3=new\x20CapitalFlowDaysData,this.CapitalFlowDay3.SetData(t);break;case\x20RECV_DATA_TYPE.CAPITAL_FLOW_DAY5_DATA:this.CapitalFlowDay5=new\x20CapitalFlowDaysData,this.CapitalFlowDay5.SetData(t);break;case\x20RECV_DATA_TYPE.CAPITAL_FLOW_DAY10_DATA:this.CapitalFlowDay10=new\x20CapitalFlowDaysData,this.CapitalFlowDay10.SetData(t)}},this.SetDDE=function(t,e){if(t){switch(e){case\x20RECV_DATA_TYPE.DDE_DAY_DATA:this.DDE=new\x20DDEData,this.DDE.SetData(t);break;case\x20RECV_DATA_TYPE.DDE_DAY3_DATA:this.DDE3=new\x20DDEData,this.DDE3.SetData(t);break;case\x20RECV_DATA_TYPE.DDE_DAY5_DATA:this.DDE5=new\x20DDEData,this.DDE5.SetData(t);break;case\x20RECV_DATA_TYPE.DDE_DAY10_DATA:this.DDE10=new\x20DDEData,this.DDE10.SetData(t)}return\x20t}},this.SetEventData=function(t){t.events&&(this.Event=new\x20EventData,this.Event.SetData(t))},this.SetCompanyData=function(t){t.company&&(this.Company=new\x20CompanyData,this.Company.SetData(t))},this.SetPlateData=function(t){(t.industry||t.region||t.concept)&&(this.Plate=new\x20PlateData,this.Plate.SetData(t))},this.SetData=function(t){t.name&&(this.Name=t.name),isNaN(t.yclose)||(this.YClose=t.yclose),isNaN(t.price)||(this.Price=t.price),isNaN(t.high)||(this.High=t.high),isNaN(t.low)||(this.Low=t.low),isNaN(t.vol)||(this.Vol=t.vol),isNaN(t.amount)||(this.Amount=t.amount),isNaN(t.date)||(this.Date=t.date),isNaN(t.time)||(this.Time=t.time),isNaN(t.increase)||(this.Increase=t.increase),isNaN(t.marketvalue)||(this.MarketValue=t.marketvalue),isNaN(t.flowmarketvalue)||(this.FlowMarketValue=t.flowmarketvalue),isNaN(t.bookrate)||(this.Bookrate=t.bookrate),isNaN(t.bookdiffer)||(this.Bookdiffer=t.bookdiffer),isNaN(t.pe)||(this.PE=t.pe),isNaN(t.pb)||(this.PB=t.pb),t.finance&&this.SetFinanceData(t),t.finance&&this.SetFinanceDetailData(t),t.capital&&this.SetCapitalData(t),t.mamplitude&&(isNaN(t.mamplitude[1])||(this.MinuteAmplitude.M1=t.mamplitude[1]),isNaN(t.mamplitude[3])||(this.MinuteAmplitude.M3=t.mamplitude[3]),isNaN(t.mamplitude[5])||(this.MinuteAmplitude.M5=t.mamplitude[5]),isNaN(t.mamplitude[10])||(this.MinuteAmplitude.M10=t.mamplitude[10]),isNaN(t.mamplitude[15])||(this.MinuteAmplitude.M15=t.mamplitude[15])),t.risefallspeed&&(isNaN(t.risefallspeed[1])||(this.RiseFallSpeed.M1=t.risefallspeed[1]),isNaN(t.risefallspeed[3])||(this.RiseFallSpeed.M3=t.risefallspeed[3]),isNaN(t.risefallspeed[5])||(this.RiseFallSpeed.M5=t.risefallspeed[5]),isNaN(t.risefallspeed[10])||(this.RiseFallSpeed.M10=t.risefallspeed[10]),isNaN(t.risefallspeed[15])||(this.RiseFallSpeed.M15=t.risefallspeed[15])),t.mamount&&(isNaN(t.mamount[1])||(this.MAmount.M1=t.mamount[1]),isNaN(t.mamount[3])||(this.MAmount.M5=t.mamount[3]),isNaN(t.mamount[5])||(this.MAmount.M5=t.mamount[5]),isNaN(t.mamount[10])||(this.MAmount.M10=t.mamount[10]),isNaN(t.mamount[15])||(this.MAmount.M15=t.mamount[15]))}}var\x20STOCK_FIELD_NAME={SYMBOL:0,NAME:1,OPEN:2,PRICE:3,HIGH:4,LOW:5,YCLOSE:6,VOL:7,AMOUNT:8,DATE:9,TIME:10,INCREASE:11,BUY5:12,SELL5:13,DEAL:14,AMPLITUDE:15,MARKET_VALUE:16,FLOW_MARKET_VALUE:17,BOOK_RATE:18,BOOK_DIFFER:19,PE:20,PB:21,EXCHANGE_RATE:23,ROE:24,FINANCE_DATE:25,FINANCE_PERSEARNING:26,FINANCE_PERNETASSET:27,FINANCE_NPROFIT:28,FINANCE_NPROFITINCREASE:29,FINANCE_NNETPROFIT:30,FINANCE_NNPROFITINCREASE:31,FINANCE_NNPROFITSPEED:32,FINANCE_EPS:33,MAX_PRICE:34,MIN_PRICE:35,RISE_FALL_PRICE:36,FINANCE_BENFORD:37,RISEFALLSPEED_1:38,RISEFALLSPEED_3:39,RISEFALLSPEED_5:40,RISEFALLSPEED_10:41,RISEFALLSPEED_15:42,MINUTE_AMPLITUDE_1:43,MINUTE_AMPLITUDE_3:44,MINUTE_AMPLITUDE_5:45,MINUTE_AMPLITUDE_10:46,MINUTE_AMPLITUDE_15:47,MINUTE_AMOUNT_1:48,MINUTE_AMOUNT_3:49,MINUTE_AMOUNT_5:50,MINUTE_AMOUNT_10:51,MINUTE_AMOUNT_15:52,COMPANY_NAME:53,PLATE_INDUSTRY:54,PLATE_CONCEPT:55,PLATE_REGION:56,COMPANY_BUSINESS:57,COMPANY_VOL:58,COMPANY_PRICE:59,COMPANY_RELEASEDATE:60,COMPANY_COMPETENCE:61,CAPITAL_FLOW_DAY:67,CAPITAL_FLOW_DAY3:68,CAPITAL_FLOW_DAY5:69,CAPITAL_FLOW_DAY10:70,DDE:71,DDE3:72,DDE5:73,DDE10:74,EVENTS:75,CAPITAL_A:76,CAPITAL_TOTAL:77,CAPTIAL_ARATE:78,VOLRATIO:79,PE2:80,PE3:81,INDEXTOP:100,WEEK:101,HEAT:102},StockDataFieldName={m_mapFiled:new\x20Map([[STOCK_FIELD_NAME.NAME,\x22name\x22],[STOCK_FIELD_NAME.SYMBOL,\x22symbol\x22],[STOCK_FIELD_NAME.PRICE,\x22price\x22],[STOCK_FIELD_NAME.INCREASE,\x22increase\x22],[STOCK_FIELD_NAME.PE,\x22pe\x22],[STOCK_FIELD_NAME.FINANCE_BENFORD,\x22finance.benford\x22],[STOCK_FIELD_NAME.YCLOSE,\x22yclose\x22],[STOCK_FIELD_NAME.RISEFALLSPEED_1,\x22risefallspeed.1\x22],[STOCK_FIELD_NAME.RISEFALLSPEED_3,\x22risefallspeed.3\x22],[STOCK_FIELD_NAME.RISEFALLSPEED_5,\x22risefallspeed.5\x22],[STOCK_FIELD_NAME.RISEFALLSPEED_10,\x22risefallspeed.10\x22],[STOCK_FIELD_NAME.RISEFALLSPEED_15,\x22risefallspeed.15\x22],[STOCK_FIELD_NAME.MINUTE_AMPLITUDE_1,\x22mamplitude.1\x22],[STOCK_FIELD_NAME.MINUTE_AMPLITUDE_3,\x22mamplitude.3\x22],[STOCK_FIELD_NAME.MINUTE_AMPLITUDE_5,\x22mamplitude.5\x22],[STOCK_FIELD_NAME.MINUTE_AMPLITUDE_10,\x22mamplitude.10\x22],[STOCK_FIELD_NAME.MINUTE_AMPLITUDE_15,\x22mamplitude.15\x22],[STOCK_FIELD_NAME.MINUTE_AMOUNT_1,\x22mamount.1\x22],[STOCK_FIELD_NAME.MINUTE_AMOUNT_3,\x22mamount.3\x22],[STOCK_FIELD_NAME.MINUTE_AMOUNT_5,\x22mamount.5\x22],[STOCK_FIELD_NAME.MINUTE_AMOUNT_10,\x22mamount.10\x22],[STOCK_FIELD_NAME.MINUTE_AMOUNT_15,\x22mamount.15\x22]]),GetFieldName:function(t){return\x20this.m_mapFiled.has(t)?this.m_mapFiled.get(t):null}};function\x20StockRead(t,e){this.JSStock=t,this.TagID=e,this.Get=function(e,a){var\x20i=t.Get(e,this.TagID);if(!i)return\x20null;switch(a){case\x20STOCK_FIELD_NAME.SYMBOL:case\x20STOCK_FIELD_NAME.NAME:case\x20STOCK_FIELD_NAME.OPEN:case\x20STOCK_FIELD_NAME.PRICE:case\x20STOCK_FIELD_NAME.YCLOSE:case\x20STOCK_FIELD_NAME.HIGH:case\x20STOCK_FIELD_NAME.LOW:case\x20STOCK_FIELD_NAME.VOL:case\x20STOCK_FIELD_NAME.AMOUNT:case\x20STOCK_FIELD_NAME.DATE:case\x20STOCK_FIELD_NAME.TIME:case\x20STOCK_FIELD_NAME.INCREASE:case\x20STOCK_FIELD_NAME.EXCHANGE_RATE:case\x20STOCK_FIELD_NAME.AMPLITUDE:case\x20STOCK_FIELD_NAME.MAX_PRICE:case\x20STOCK_FIELD_NAME.MIN_PRICE:case\x20STOCK_FIELD_NAME.RISE_FALL_PRICE:case\x20STOCK_FIELD_NAME.INDEXTOP:case\x20STOCK_FIELD_NAME.WEEK:case\x20STOCK_FIELD_NAME.VOLRATIO:return\x20i.GetBaseData(this.TagID,a);case\x20STOCK_FIELD_NAME.HEAT:return\x20i.GetHeatData(this.TagID);case\x20STOCK_FIELD_NAME.BUY5:return\x20i.GetBuy5(this.TagID);case\x20STOCK_FIELD_NAME.SELL5:return\x20i.GetSell5(this.TagID);case\x20STOCK_FIELD_NAME.DEAL:return\x20i.GetDeal(this.TagID);case\x20STOCK_FIELD_NAME.MARKET_VALUE:case\x20STOCK_FIELD_NAME.FLOW_MARKET_VALUE:case\x20STOCK_FIELD_NAME.BOOK_RATE:case\x20STOCK_FIELD_NAME.BOOK_DIFFER:case\x20STOCK_FIELD_NAME.PE:case\x20STOCK_FIELD_NAME.PE2:case\x20STOCK_FIELD_NAME.PE3:case\x20STOCK_FIELD_NAME.PB:return\x20i.GetDerivative(this.TagID,a);case\x20STOCK_FIELD_NAME.ROE:case\x20STOCK_FIELD_NAME.FINANCE_DATE:case\x20STOCK_FIELD_NAME.FINANCE_PERSEARNING:case\x20STOCK_FIELD_NAME.FINANCE_PERNETASSET:case\x20STOCK_FIELD_NAME.FINANCE_NPROFIT:case\x20STOCK_FIELD_NAME.FINANCE_NPROFITINCREASE:case\x20STOCK_FIELD_NAME.FINANCE_NNETPROFIT:case\x20STOCK_FIELD_NAME.FINANCE_NNPROFITINCREASE:case\x20STOCK_FIELD_NAME.FINANCE_NNPROFITSPEED:case\x20STOCK_FIELD_NAME.FINANCE_EPS:case\x20STOCK_FIELD_NAME.FINANCE_BENFORD:return\x20i.GetFinance(this.TagID,a);case\x20STOCK_FIELD_NAME.PLATE_INDUSTRY:case\x20STOCK_FIELD_NAME.PLATE_CONCEPT:case\x20STOCK_FIELD_NAME.PLATE_REGION:return\x20i.GetPlate(this.TagID,a);case\x20STOCK_FIELD_NAME.CAPITAL_FLOW_DAY:case\x20STOCK_FIELD_NAME.CAPITAL_FLOW_DAY3:case\x20STOCK_FIELD_NAME.CAPITAL_FLOW_DAY5:case\x20STOCK_FIELD_NAME.CAPITAL_FLOW_DAY10:return\x20i.GetCapitalFlowDay(this.TagID,a);case\x20STOCK_FIELD_NAME.DDE:case\x20STOCK_FIELD_NAME.DDE3:case\x20STOCK_FIELD_NAME.DDE5:case\x20STOCK_FIELD_NAME.DDE10:return\x20i.GetDDE(this.TagID,a);case\x20STOCK_FIELD_NAME.EVENTS:return\x20i.GetEvent(this.TagID,a);case\x20STOCK_FIELD_NAME.COMPANY_NAME:case\x20STOCK_FIELD_NAME.COMPANY_BUSINESS:case\x20STOCK_FIELD_NAME.COMPANY_VOL:case\x20STOCK_FIELD_NAME.COMPANY_PRICE:case\x20STOCK_FIELD_NAME.COMPANY_RELEASEDATE:case\x20STOCK_FIELD_NAME.COMPANY_COMPETENCE:return\x20i.GetCompany(this.TagID,a);case\x20STOCK_FIELD_NAME.CAPITAL_A:case\x20STOCK_FIELD_NAME.CAPTIAL_ARATE:case\x20STOCK_FIELD_NAME.CAPITAL_TOTAL:return\x20i.GetCapital(this.TagID,a);default:return\x20null}},this.GetSort=function(e,a,i){var\x20s=t.Get(e,this.TagID);return\x20null==s?s:s.GetSortData(this.TagID,a,i)},this.EndRead=function(t){1==t&&this.JSStock.ReqeustData()},this.SetQueryField=function(t,e){for(var\x20a\x20in\x20e)this.Get(t,e[a])}}function\x20JSStockHistory(){this.Symbol,this.Callback,this.Order=-1,this.SortField,this.Field,this.Plate,this.Data=new\x20Map,this.ApiUrl=g_JSStockResource.Domain+\x22/API/StockHistoryDay\x22,this.PageSize=20,this.PageIndex=1,this.Count,this.currentData=null,this.RequsetData=function(t,e){var\x20a=this,i=\x22string\x22==typeof\x20a.Symbol?[this.Symbol]:this.Symbol,s=i?i.length:0;this.Plate?this.currentData={plate:this.Plate,symbol:i,start:0,end:this.PageSize,field:this.Field,orderfield:this.SortField,order:this.Order,condition:t.GetQuery(),condition2:e?e.GetQuery():[]}:this.currentData={symbol:i,start:0,end:s,field:this.Field,orderfield:this.SortField,order:this.Order,condition:t.GetQuery(),condition2:e?e.GetQuery():[]},$.ajax({url:this.ApiUrl,data:a.currentData,method:\x22POST\x22,dataType:\x22json\x22,success:function(e){a.Count=e.data.count,a.RecvData(e,t)},fail:function(e){a.RecvError(e,t)}})},this.GetNextPage=function(){var\x20t=this;this.PageSize*this.PageIndex<this.Count?(this.currentData.start=this.PageSize*this.PageIndex,this.PageIndex++,this.currentData.end=this.PageSize*this.PageIndex,$.ajax({url:this.ApiUrl,data:t.currentData,method:\x22POST\x22,dataType:\x22json\x22,success:function(e){t.RecvData(e)},fail:function(e){t.RecvError(e)}})):alert(\x22数据已全部加载\x22)},this.RecvData=function(t,e){let\x20a=t.data;for(let\x20t\x20in\x20a.stock){let\x20e=a.stock[t],i=e.symbol,s={};this.Data.has(i)?s=this.Data.get(i):(s={Symbol:e.symbol,Name:e.name,Data:new\x20Map},this.Data.set(i,s)),this.SetStockData(e,s)}this.Callback&&this.Callback(this,e)},this.SetStockData=function(t,e){for(let\x20a\x20in\x20t.stockday){let\x20i=t.stockday[a],s=i.date,n=new\x20Map;this.SetFinanceData(i,n),this.SetBlocktradingData(i,n),this.SetChangesData(i,n),this.SetLiftingData(i,n),this.SetPforecastData(i,n),this.SetShortIndicatorsData(i,n),e.Data.set(s,n)}return\x20e},this.SetFinanceData=function(t,e){var\x20a,i;(a=t.finance1)&&(isNaN(a.nprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE1_NPROFITINCREASE,a.nprofitincrease),isNaN(a.nnprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE1_NNPROFITINCREASE,a.nnprofitincrease),isNaN(a.nnprofitspeed)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE1_NNPROFITSPEED,a.nnprofitspeed),isNaN(a.benford)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE1_BENFORD,a.benford)),(i=t.announcement1)&&(isNaN(i.year)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE1_YEAR,i.year),isNaN(i.quarter)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE1_QUARTER,i.quarter)),(a=t.finance2)&&(isNaN(a.nprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE2_NPROFITINCREASE,a.nprofitincrease),isNaN(a.nnprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE2_NNPROFITINCREASE,a.nnprofitincrease),isNaN(a.nnprofitspeed)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE2_NNPROFITSPEED,a.nnprofitspeed),isNaN(a.benford)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE2_BENFORD,a.benford)),(i=t.announcement2)&&(isNaN(i.year)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE2_YEAR,i.year),isNaN(i.quarter)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE2_QUARTER,i.quarter)),(a=t.finance3)&&(isNaN(a.nprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE3_NPROFITINCREASE,a.nprofitincrease),isNaN(a.nnprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE3_NNPROFITINCREASE,a.nnprofitincrease),isNaN(a.nnprofitspeed)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE3_NNPROFITSPEED,a.nnprofitspeed),isNaN(a.benford)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE3_BENFORD,a.benford)),(i=t.announcement3)&&(isNaN(i.year)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE3_YEAR,i.year),isNaN(i.quarter)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE3_QUARTER,i.quarter)),(a=t.finance4)&&(isNaN(a.nprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE4_NPROFITINCREASE,a.nprofitincrease),isNaN(a.nnprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE4_NNPROFITINCREASE,a.nnprofitincrease),isNaN(a.nnprofitspeed)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE4_NNPROFITSPEED,a.nnprofitspeed),isNaN(a.benford)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE4_BENFORD,a.benford)),(i=t.announcement4)&&(isNaN(i.year)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE4_YEAR,i.year),isNaN(i.quarter)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE4_QUARTER,i.quarter))},this.SetBlocktradingData=function(t,e){var\x20a=t.blocktrading;a&&e.set(STOCK_HISTORY_FIELD_NAME.BLOCK_TRADING,{Premium:a.premium,Price:a.price,Vol:a.vol,Amount:a.amount})},this.SetChangesData=function(t,e){var\x20a=t.changes;a&&e.set(STOCK_HISTORY_FIELD_NAME.HOLDERS_CHANGES,{List:a.list})},this.SetLiftingData=function(t,e){var\x20a=t.lifting;a&&e.set(STOCK_HISTORY_FIELD_NAME.LIFTING,{Lifting:a})},this.SetPforecastData=function(t,e){var\x20a=t.pforecast;a&&e.set(STOCK_HISTORY_FIELD_NAME.PFORECAST,{Lowprofit:a[0].lowprofit,Highprofit:a[0].highprofit,Lowchange:a[0].lowchange,Highchange:a[0].highchange,Reportdate:a[0].reportdate})},this.SetShortIndicatorsData=function(t,e){var\x20a=t.policy;if(a){const\x20t=[\x22三只乌鸦\x22,\x22乌云盖顶\x22,\x22黄昏之星\x22,\x22巨量阴线\x22,\x22头肩顶\x22,\x22射击之星\x22,\x22倾盆大雨\x22,\x22断头铡刀\x22,\x22淡友反攻\x22,\x22空方炮\x22,\x22连续1周空头排列\x22];let\x20i=0,s=[],n=0,o=\x22\x22;a.forEach(e=>{t.some(t=>t===e.name)&&(i++,s.push(e.time))}),i?(n=Math.max.apply(s,s),o=a.find(t=>t.time===n).name):o=\x22\x22,console.log(o,i,\x22latestName-targetedCount\x22),e.set(STOCK_HISTORY_FIELD_NAME.SHORTIND_ICATORS,{latestIndicatorName:o,indicatorCount:i})}},this.RecvError=function(t,e){},this.CreateCondition=function(t){return\x20new\x20QueryCondition(t)}}JSStock.Init=function(){return\x20new\x20JSStock},JSStock.SetDomain=function(t,e){t&&(g_JSStockResource.Domain=t),e&&(g_JSStockResource.CacheDomain=e)},JSStock.GetSearchStock=function(t){return\x20new\x20SearchStock(t)},JSStock.GetShortTerm=function(t){return\x20new\x20ShortTerm(t)},JSStock.GetDealDay=function(t){return\x20new\x20DealDay(t)},JSStock.GetBlockMember=function(t){return\x20new\x20BlockMember(t)},JSStock.GetBlockTop=function(){return\x20new\x20BlockTop},JSStock.GetMinuteImage=function(t){return\x20new\x20MinuteImage(t)},JSStock.GetHistoryDayData=function(t){return\x20new\x20HistoryDayData(t)},JSStock.GetDealPriceListData=function(t){return\x20new\x20DealPriceListData(t)},JSStock.GetLatestDetailData=function(t){return\x20new\x20LatestDetailData(t)},JSStock.GetAnalylisPlate=function(){return\x20new\x20AnalylisPlate},JSStock.GetStockHistory=function(){return\x20new\x20JSStockHistory};var\x20RECV_DATA_TYPE={BASE_DATA:1,INDEX_BASE_DATA:2,HEAT_DATA:3,SORT_DATA:4,BUY_SELL_DATA:5,DEAL_DATA:6,DERIVATIVE_DATA:7,FINANCE_DATA:8,SEARCH_STOCK_DATA:9,SELF_STOCK_DATA:10,LOGON_DATA:11,BLOCK_MEMBER_DATA:13,SHORT_TERM_DATA:14,COMPANY_DATA:15,PLATE_DATA:16,CAPITAL_DATA:17,CAPITAL_FLOW_DAY_DATA:23,CAPITAL_FLOW_DAY3_DATA:24,CAPITAL_FLOW_DAY5_DATA:25,CAPITAL_FLOW_DAY10_DATA:26,DDE_DAY_DATA:27,DDE_DAY3_DATA:28,DDE_DAY5_DATA:29,DDE_DAY10_DATA:30,DEAL_DAY_DATA:105,EVENT_DATA:106,IMAGE_MINUTE_DATA:107,HISTORY_DAY_DATA:108,DEAL_PRICE_LIST_DATA:109,LATEST_DETAIL_DATA:110};function\x20JSStock(){window.JSStock=this,this.MapStock=new\x20Map,this.MapTagCallback=new\x20Map,this.RequestVersion=new\x20Array([100,100,100]),this.RealtimeApiUrl=g_JSStockResource.Domain+\x22/API/Stock\x22,this.PlateQuadrantApiUrl=g_JSStockResource.Domain+\x22/API/StockPlateQuadrant\x22,this.IsAutoUpdate=!0,this.AutoUpateTimeout=15e3,this.Timeout,this.NetworkFilter,this.Interval=null,this.GetStockRead=function(t,e){for(var\x20a\x20of\x20this.MapStock)a[1].RemoveTagID(t);return\x20this.MapTagCallback.set(t,e),new\x20StockRead(this,t)},this.Unsubscribe=function(t){for(var\x20e\x20of\x20this.MapStock)e[1].RemoveTagID(t)},this.UnsubscribeStock=function(t,e){for(var\x20a\x20of\x20this.MapStock)if(a[0]===t){e?a[1].RemoveTagID(e):a[1].ClearTagID(),console.log(`[JSStock::UnsubscribeStock]\x20symbol=${t},\x20tagID=${e}`);break}},this.Get=function(t,e){this.MapStock.has(t)||this.MapStock.set(t,new\x20StockData(t));var\x20a=this.MapStock.get(t);return\x20e&&a.AttachTagID(e),a},this.RequestData=function(){this.ClearTimer();var\x20t=new\x20Array,e=new\x20Array,a=new\x20Array,i=new\x20Array,s=new\x20Array,n=new\x20Array,o=new\x20Array,r=[],D=[],h=[],l=[],c=[],A=[],E=[],u=[],T=new\x20Array,_=new\x20Array,S=new\x20Array,I=new\x20Array;for(var\x20C\x20of\x20this.MapStock){var\x20p=C[1],N=C[0];p.BaseDataTagID.size>0&&(IsIndexSymbol(N)?e.push(N):t.push(N)),p.BuySellTagID.size>0&&i.push(N),p.CapitalFlowDayID.size>0&&r.push(N),p.CapitalFlowDay3ID.size>0&&D.push(N),p.CapitalFlowDay5ID.size>0&&h.push(N),p.CapitalFlowDay10ID.size>0&&l.push(N),p.DDEID.size>0&&c.push(N),p.DDE3ID.size>0&&A.push(N),p.DDE5ID.size>0&&E.push(N),p.DDE10ID.size>0&&u.push(N),p.HeatTagID.size>0&&a.push(N),p.DealTagID.size>0&&s.push(N),p.DerivativeTagID.size>0&&n.push(N),p.FinanceTagID.size>0&&o.push(N),p.CapitalTagID.size>0&&I.push(N),null==p.Event&&p.EventTagID.size>0&&T.push(N),null==p.Company&&p.CompanyTagID.size>0&&_.push(N),null==C[1].Plate&&C[1].PlateTagID.size>0&&S.push(C[0])}getalldata(),i.length>0&&this.RequestBuySellData(i),t.length>0&&this.RequestBaseData(t),e.length>0&&this.RequestIndexBaseData(e),a.length>0&&this.RequestIndexHeatData(a),s.length>0&&this.RequestDealData(s),n.length>0&&this.RequestDerivativeData(n),o.length>0&&this.RequestFinanceData(o),I.length>0&&this.RequestCapitalData(I),r.length>0&&this.RequestSubDocumentData(r,\x22flowday\x22),D.length>0&&this.RequestSubDocumentData(D,\x22flowday3\x22),h.length>0&&this.RequestSubDocumentData(h,\x22flowday5\x22),l.length>0&&this.RequestSubDocumentData(l,\x22flowday10\x22),c.length>0&&this.RequestSubDocumentData(c,\x22dde\x22),A.length>0&&this.RequestSubDocumentData(A,\x22dde3\x22),E.length>0&&this.RequestSubDocumentData(E,\x22dde5\x22),u.length>0&&this.RequestSubDocumentData(u,\x22dde10\x22),T.length>0&&this.RequestEventData(T),_.length>0&&this.RequestCompanyData(_),S.length>0&&this.RequestPlateData(S),this.ReqeustAllSortData()},this.ReqeustData=this.RequestData,this.RequestBaseData=function(t){var\x20e=this,a=[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22,\x22amount\x22,\x22date\x22,\x22time\x22,\x22week\x22,\x22increase\x22,\x22exchangerate\x22,\x22amplitude\x22,\x22volratio\x22];if(this.NetworkFilter){var\x20i={Name:\x22JSStock::RequestBaseData\x22,Explain:\x22股票基础数据\x22,ID:RECV_DATA_TYPE.BASE_DATA,Request:{Url:ChartApiBase,Data:{field:a,symbol:t},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,function(t){e.RecvData(t,RECV_DATA_TYPE.BASE_DATA)}),1==i.PreventDefault)return}$.ajax({url:ChartApiBase,data:{field:a,symbol:t},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,RECV_DATA_TYPE.BASE_DATA)},error:function(t){e.RecvError(t,RECV_DATA_TYPE.BASE_DATA)}})},this.RequestDerivativeData=function(t){var\x20e=this,a=[\x22name\x22,\x22symbol\x22,\x22marketvalue\x22,\x22flowmarketvalue\x22,\x22pe\x22,\x22pe2\x22,\x22pe3\x22,\x22pb\x22,\x22bookrate\x22,\x22bookdiffer\x22];if(this.NetworkFilter){var\x20i={Name:\x22JSStock::RequestDerivativeData\x22,Explain:\x22实时衍生数据\x22,ID:RECV_DATA_TYPE.DERIVATIVE_DATA,Request:{Url:ChartApiDerivative,Data:{field:a,symbol:t},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,function(t){e.RecvData(t,RECV_DATA_TYPE.DERIVATIVE_DATA)}),1==i.PreventDefault)return}$.ajax({url:ChartApiDerivative,data:{field:a,symbol:t},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,RECV_DATA_TYPE.DERIVATIVE_DATA)},error:function(t){e.RecvError(t,RECV_DATA_TYPE.DERIVATIVE_DATA)}})},this.RequestFinanceData=function(t){var\x20e=this,a=[\x22name\x22,\x22symbol\x22,\x22roe\x22,\x22finance\x22];if(this.NetworkFilter){var\x20i={Name:\x22JSStock::RequestFinanceData\x22,Explain:\x22财务数据\x22,ID:RECV_DATA_TYPE.FINANCE_DATA,Request:{Url:ChartApiFinance,Data:{field:a,symbol:t},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,function(t){e.RecvData(t,RECV_DATA_TYPE.FINANCE_DATA)}),1==i.PreventDefault)return}$.ajax({url:ChartApiFinance,data:{field:a,symbol:t},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,RECV_DATA_TYPE.FINANCE_DATA)},error:function(t){e.RecvError(t,RECV_DATA_TYPE.FINANCE_DATA)}})},this.RequestCapitalData=function(t){var\x20e=this,a=[\x22name\x22,\x22symbol\x22,\x22capital\x22];if(this.NetworkFilter){var\x20i={Name:\x22JSStock::RequestCapitalData\x22,Explain:\x22股本数据\x22,ID:RECV_DATA_TYPE.CAPITAL_DATA,Request:{Url:e.RealtimeApiUrl,Data:{field:a,symbol:t},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,function(t){e.RecvData(t,RECV_DATA_TYPE.CAPITAL_DATA)}),1==i.PreventDefault)return}$.ajax({url:this.RealtimeApiUrl,data:{field:a,symbol:t},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,RECV_DATA_TYPE.CAPITAL_DATA)},error:function(t){e.RecvError(t,RECV_DATA_TYPE.CAPITAL_DATA)}})},this.RequestBuySellData=function(t,e){if(e){console.log(\x22------------------------------------JSStock::RequestBuySellData---------买卖盘数据\x22),this.RecvData(e,RECV_DATA_TYPE.BUY_SELL_DATA)}},this.RequestDealData=function(t,e){if(e){console.log(\x22------------------------------------JSStock::RequestDealData----------分笔数据\x22),this.RecvData(e,RECV_DATA_TYPE.DEAL_DATA)}},this.RequestIndexBaseData=function(t){var\x20e=this,a=[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22,\x22amount\x22,\x22date\x22,\x22time\x22,\x22week\x22,\x22indextop\x22,\x22increase\x22];if(this.NetworkFilter){var\x20i={Name:\x22JSStock::RequestIndexBaseData\x22,Explain:\x22指数基础数据(包含上涨下跌家数)\x22,ID:RECV_DATA_TYPE.INDEX_BASE_DATA,Request:{Url:e.RealtimeApiUrl,Data:{field:a,symbol:t},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,function(t){e.RecvData(t,RECV_DATA_TYPE.INDEX_BASE_DATA)}),1==i.PreventDefault)return}$.ajax({url:this.RealtimeApiUrl,data:{field:a,symbol:t},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){console.log(t),e.RecvData(t,RECV_DATA_TYPE.INDEX_BASE_DATA)},error:function(t){e.RecvError(t,RECV_DATA_TYPE.INDEX_BASE_DATA)}})},this.RequestIndexHeatData=function(t){var\x20e=this;$.ajax({url:this.PlateQuadrantApiUrl,data:{plate:t},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,RECV_DATA_TYPE.HEAT_DATA)},error:function(t){e.RecvError(t,RECV_DATA_TYPE.HEAT_DATA)}})},this.ReqeustAllSortData=function(){var\x20t=new\x20Array;for(var\x20e\x20of\x20this.MapStock)if(IsIndexSymbol(e[0])&&!(null==e[1].Sort||e[1].Sort.size<=0))for(var\x20a\x20of\x20e[1].Sort){var\x20i=a[1],s={Plate:e[0],SortField:i.SortField,Order:i.Order,TagID:i.TagID};t.push(s)}for(var\x20n\x20in\x20t){a=t[n];this.ReqeustSortData(a)}},this.ReqeustSortData=function(t){var\x20e=this,a=t,i=\x22\x22;switch(a.SortField){case\x20STOCK_FIELD_NAME.INCREASE:i=\x22increase\x22;break;case\x20STOCK_FIELD_NAME.PRICE:i=\x22price\x22;break;default:return}var\x20s=[\x22name\x22,\x22symbol\x22,\x22yclose\x22,\x22open\x22,\x22price\x22,\x22high\x22,\x22low\x22,\x22vol\x22,\x22amount\x22,\x22date\x22,\x22time\x22,\x22week\x22,\x22increase\x22,\x22exchangerate\x22];if(this.NetworkFilter){var\x20n={Name:\x22JSStock::ReqeustSortData\x22,Explain:\x22板块排序数据\x22,ID:RECV_DATA_TYPE.SORT_DATA,Request:{Url:e.RealtimeApiUrl,Data:{field:s,plate:[t.Plate],orderfield:i,order:t.Order,ordernull:1,filterstop:1},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,function(t){e.RecvData(t,RECV_DATA_TYPE.SORT_DATA,a)}),1==n.PreventDefault)return}$.ajax({url:this.RealtimeApiUrl,data:{field:s,plate:[t.Plate],orderfield:i,order:t.Order,ordernull:1,filterstop:1},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){e.RecvData(t,RECV_DATA_TYPE.SORT_DATA,a)},error:function(t){e.RecvError(t,RECV_DATA_TYPE.SORT_DATA,a)}})},this.RequestSubDocumentData=function(t,e){var\x20a=this;const\x20i=new\x20Map([[\x22flowday\x22,{Field:\x22flowday\x22,RecvID:RECV_DATA_TYPE.CAPITAL_FLOW_DAY_DATA}],[\x22flowday3\x22,{Field:\x22flowday3\x22,RecvID:RECV_DATA_TYPE.CAPITAL_FLOW_DAY3_DATA}],[\x22flowday5\x22,{Field:\x22flowday5\x22,RecvID:RECV_DATA_TYPE.CAPITAL_FLOW_DAY5_DATA}],[\x22flowday10\x22,{Field:\x22flowday10\x22,RecvID:RECV_DATA_TYPE.CAPITAL_FLOW_DAY10_DATA}],[\x22dde\x22,{Field:\x22dde\x22,RecvID:RECV_DATA_TYPE.DDE_DAY_DATA}],[\x22dde3\x22,{Field:\x22dde3\x22,RecvID:RECV_DATA_TYPE.DDE_DAY3_DATA}],[\x22dde5\x22,{Field:\x22dde5\x22,RecvID:RECV_DATA_TYPE.DDE_DAY5_DATA}],[\x22dde10\x22,{Field:\x22dde10\x22,RecvID:RECV_DATA_TYPE.DDE_DAY10_DATA}]]);if(i.has(e)){var\x20s=i.get(e);if(this.NetworkFilter){var\x20n={Name:\x22JSStock::RequestSubDocumentData\x22,Explain:\x22子文档数据\x22,ID:s.RecvID,Request:{Url:a.RealtimeApiUrl,Data:{field:[\x22symbol\x22,s.Field],symbol:t,start:0,end:50},Type:\x22POST\x22},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,function(t){a.RecvData(t,s.RecvID)}),1==n.PreventDefault)return}$.ajax({url:this.RealtimeApiUrl,data:{field:[\x22symbol\x22,s.Field],symbol:t,start:0,end:50},type:\x22post\x22,dataType:\x22json\x22,success:function(t){a.RecvData(t,s.RecvID)},error:function(t){a.RecvError(t,s.RecvID)}})}},this.RequestEventData=function(t){var\x20e=this;$.ajax({url:this.RealtimeApiUrl,data:{field:[\x22symbol\x22,\x22events.margin\x22,\x22events.shhk\x22,\x22events.hk\x22,\x22events.st\x22,\x22events.hksymbol\x22,\x22events.hkname\x22,\x22events.szhk\x22],symbol:t,start:0,end:50},type:\x22POST\x22,dataType:\x22json\x22,success:function(t){e.RecvData(t,RECV_DATA_TYPE.EVENT_DATA)},error:function(t){e.RecvError(t,RECV_DATA_TYPE.EVENT_DATA)}})},this.RequestCompanyData=function(t){var\x20e=this;$.ajax({url:this.RealtimeApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22company\x22],symbol:t,start:0,end:50},type:\x22POST\x22,dataType:\x22json\x22,success:function(t){e.RecvData(t,RECV_DATA_TYPE.COMPANY_DATA)},error:function(t){e.RecvError(t,RECV_DATA_TYPE.COMPANY_DATA)}})},this.RequestPlateData=function(t){var\x20e=this;$.ajax({url:this.RealtimeApiUrl,data:{field:[\x22name\x22,\x22symbol\x22,\x22industry\x22,\x22region\x22,\x22concept\x22],symbol:t,start:0,end:50},type:\x22POST\x22,dataType:\x22json\x22,success:function(t){e.RecvData(t,RECV_DATA_TYPE.PLATE_DATA)},error:function(t){e.RecvError(t,RECV_DATA_TYPE.PLATE_DATA)}})},this.RecvError=function(t,e,a){console.log(\x22RecvError:\x20datatype=\x22+e.toString()),console.log(t);var\x20i=this;this.Timeout&&clearTimeout(this.Timeout),this.Timeout=setTimeout(function(){i.ReqeustData()},2*this.AutoUpateTimeout)},this.RecvData=function(t,e,a){var\x20i;switch(e){case\x20RECV_DATA_TYPE.BASE_DATA:case\x20RECV_DATA_TYPE.INDEX_BASE_DATA:i=this.RecvBaseData(t,e);break;case\x20RECV_DATA_TYPE.HEAT_DATA:i=this.RecvHeatData(t,e);break;case\x20RECV_DATA_TYPE.SORT_DATA:i=this.RecvSortData(t,e,a);break;case\x20RECV_DATA_TYPE.BUY_SELL_DATA:i=this.RecvBuySellData(t,e);break;case\x20RECV_DATA_TYPE.DEAL_DATA:i=this.RecvDealData(t,e);break;case\x20RECV_DATA_TYPE.DERIVATIVE_DATA:i=this.RecvDerivativeData(t,e);break;case\x20RECV_DATA_TYPE.FINANCE_DATA:i=this.RecvFinanceData(t,e);break;case\x20RECV_DATA_TYPE.CAPITAL_DATA:i=this.RecvCapitalData(t,e);break;case\x20RECV_DATA_TYPE.CAPITAL_FLOW_DAY_DATA:case\x20RECV_DATA_TYPE.CAPITAL_FLOW_DAY3_DATA:case\x20RECV_DATA_TYPE.CAPITAL_FLOW_DAY5_DATA:case\x20RECV_DATA_TYPE.CAPITAL_FLOW_DAY10_DATA:case\x20RECV_DATA_TYPE.DDE_DAY_DATA:case\x20RECV_DATA_TYPE.DDE_DAY3_DATA:case\x20RECV_DATA_TYPE.DDE_DAY5_DATA:case\x20RECV_DATA_TYPE.DDE_DAY10_DATA:i=this.RecvSubDocumentData(t,e);break;case\x20RECV_DATA_TYPE.EVENT_DATA:i=this.RecvEventData(t,e);break;case\x20RECV_DATA_TYPE.COMPANY_DATA:i=this.RecvCompanyData(t,e);break;case\x20RECV_DATA_TYPE.PLATE_DATA:i=this.RecvPlateData(t,e)}for(var\x20s\x20of\x20i)this.MapTagCallback.has(s[0])&&this.MapTagCallback.get(s[0])(s[0],s[1],e,this);this.AutoUpdate()},this.ClearTimer=function(){this.Timeout&&(clearTimeout(this.Timeout),this.Timeout=null)},this.AutoUpdate=function(){if(this.ClearTimer(),this.IsAutoUpdate){var\x20t=0;this.Interval||(this.Interval=setInterval(function(){if(window.chartdata){(t+=100)>=2e3&&(t=0,getalldata()),\x22on\x22==localStorage.buysell?$(\x22#rightMinute2\x22).show():$(\x22#rightMinute2\x22).hide();var\x20e=localStorage.chartcontrol,a=\x2200\x22==chartdata.viewperiod?chartdata.Mchart:chartdata.Kchart;switch(localStorage.chartcontrol=\x22\x22,e){case\x22zoomup\x22:zoomup(a);break;case\x22zoomdown\x22:zoomdown(a);break;case\x22panleft\x22:pan(a,!1);break;case\x22panright\x22:pan(a,!0);break;case\x22pantoend\x22:pan(a,!0,!0)}}},100))}},this.RecvBaseData=function(t,e){var\x20a=new\x20Map;for(var\x20i\x20in\x20t.stock){var\x20s=t.stock[i],n=this.MapStock.get(s.symbol);if(n){switch(e){case\x20RECV_DATA_TYPE.BASE_DATA:n.SetBaseData(s);break;case\x20RECV_DATA_TYPE.INDEX_BASE_DATA:n.SetIndexBaseData(s);break;default:continue}if(n.TagID.size>0)for(var\x20o\x20of\x20n.TagID)a.has(o)?a.get(o).push(n.Symbol):a.set(o,new\x20Array(n.Symbol))}}return\x20a},this.RecvBuySellData=function(t,e){var\x20a=new\x20Map;for(var\x20i\x20in\x20t.stock){var\x20s=t.stock[i],n=this.MapStock.get(s.symbol);if(n){if(n.SetBuySellData(s),n.TagID.size>0)for(var\x20o\x20of\x20n.TagID)a.has(o)?a.get(o).push(n.Symbol):a.set(o,new\x20Array(n.Symbol));if(n.BuySellTagID.size>0)for(var\x20o\x20of\x20n.BuySellTagID)a.has(o)?a.get(o).push(n.Symbol):a.set(o,new\x20Array(n.Symbol))}}return\x20a},this.RecvDerivativeData=function(t,e){var\x20a=new\x20Map;for(var\x20i\x20in\x20t.stock){var\x20s=t.stock[i],n=this.MapStock.get(s.symbol);if(n&&(n.SetDerivativeData(s),n.DerivativeTagID.size>0))for(var\x20o\x20of\x20n.DerivativeTagID)a.has(o)?a.get(o).push(n.Symbol):a.set(o,new\x20Array(n.Symbol))}return\x20a},this.RecvFinanceData=function(t,e){var\x20a=new\x20Map;for(var\x20i\x20in\x20t.stock){var\x20s=t.stock[i],n=this.MapStock.get(s.symbol);if(n&&(n.SetFinanceData(s),n.FinanceTagID.size>0))for(var\x20o\x20of\x20n.FinanceTagID)a.has(o)?a.get(o).push(n.Symbol):a.set(o,new\x20Array(n.Symbol))}return\x20a},this.RecvCapitalData=function(t,e){var\x20a=new\x20Map;for(var\x20i\x20in\x20t.stock){var\x20s=t.stock[i],n=this.MapStock.get(s.symbol);if(n&&(n.SetCapitalData(s),n.CapitalTagID.size>0))for(var\x20o\x20of\x20n.CapitalTagID)a.has(o)?a.get(o).push(n.Symbol):a.set(o,new\x20Array(n.Symbol))}return\x20a},this.RecvDealData=function(t,e){var\x20a=new\x20Map;for(var\x20i\x20in\x20t.stock){var\x20s=t.stock[i],n=this.MapStock.get(s.symbol);if(n&&(n.SetDealData(s),n.DealTagID.size>0))for(var\x20o\x20of\x20n.DealTagID)a.has(o)?a.get(o).push(n.Symbol):a.set(o,new\x20Array(n.Symbol))}return\x20a},this.RecvHeatData=function(t,e){var\x20a=new\x20Map;for(var\x20i\x20in\x20t.data){var\x20s=t.data[i],n=this.MapStock.get(s.symbol);if(n&&(n.SetHeatData(s),n.HeatTagID.size>0))for(var\x20o\x20of\x20n.HeatTagID)a.has(o)?a.get(o).push(n.Symbol):a.set(o,new\x20Array(n.Symbol))}return\x20a},this.RecvSortData=function(t,e,a){var\x20i=new\x20Map,s=new\x20Array,n=this.MapStock.get(a.Plate);for(var\x20o\x20in\x20t.stock){var\x20r,D=t.stock[o];if(s.push(D.symbol),this.MapStock.has(D.symbol))(r=this.MapStock.get(D.symbol)).SetBaseData(D);else(r=new\x20StockData(D.symbol)).SetBaseData(D),this.MapStock.set(D.symbol,r)}var\x20h=a.SortField.toString()+\x22-\x22+a.Order.toString();if(!n.Sort.has(h))return\x20i;var\x20l=n.Sort.get(h);for(var\x20D\x20of(l.arySymbol=s,a.TagID))i.set(D,new\x20Array([n.Symbol]));return\x20i},this.RecvSubDocumentData=function(t,e){var\x20a=new\x20Map;for(var\x20i\x20in\x20t.stock){var\x20s=t.stock[i],n=this.MapStock.get(s.symbol);if(n){var\x20o=null;switch(e){case\x20RECV_DATA_TYPE.CAPITAL_FLOW_DAY_DATA:n.SetCapitalFlowDayData(s.flowday,e),o=n.CapitalFlowDayID;break;case\x20RECV_DATA_TYPE.CAPITAL_FLOW_DAY3_DATA:n.SetCapitalFlowDayData(s.flowday3,e),o=n.CapitalFlowDay3ID;break;case\x20RECV_DATA_TYPE.CAPITAL_FLOW_DAY5_DATA:n.SetCapitalFlowDayData(s.flowday5,e),o=n.CapitalFlowDay5ID;break;case\x20RECV_DATA_TYPE.CAPITAL_FLOW_DAY10_DATA:n.SetCapitalFlowDayData(s.flowday10,e),o=n.CapitalFlowDay10ID;break;case\x20RECV_DATA_TYPE.DDE_DAY_DATA:n.SetDDE(s.dde,e),o=n.DDEID;break;case\x20RECV_DATA_TYPE.DDE_DAY3_DATA:n.SetDDE(s.dde3,e),o=n.DDE3ID;break;case\x20RECV_DATA_TYPE.DDE_DAY5_DATA:n.SetDDE(s.dde5,e),o=n.DDE5ID;break;case\x20RECV_DATA_TYPE.DDE_DAY10_DATA:n.SetDDE(s.dde10,e),o=n.DDE10ID}if(o&&o.size>0)for(var\x20r\x20of\x20o)a.has(r)?a.get(r).push(n.Symbol):a.set(r,new\x20Array(n.Symbol))}}return\x20a},this.RecvEventData=function(t,e){var\x20a=new\x20Map;for(var\x20i\x20in\x20t.stock){var\x20s=t.stock[i],n=this.MapStock.get(s.symbol);if(n&&(n.SetEventData(s),n.EventTagID.size>0))for(var\x20o\x20of\x20n.EventTagID)a.has(o)?a.get(o).push(n.Symbol):a.set(o,new\x20Array(n.Symbol))}return\x20a},this.RecvCompanyData=function(t,e){var\x20a=new\x20Map;for(var\x20i\x20in\x20t.stock){var\x20s=t.stock[i],n=this.MapStock.get(s.symbol);if(n&&(n.SetCompanyData(s),n.CompanyTagID.size>0))for(var\x20o\x20of\x20n.CompanyTagID)a.has(o)?a.get(o).push(n.Symbol):a.set(o,new\x20Array(n.Symbol))}return\x20a},this.RecvPlateData=function(t,e){var\x20a=new\x20Map;for(var\x20i\x20in\x20t.stock){var\x20s=t.stock[i],n=this.MapStock.get(s.symbol);if(n&&(n.SetPlateData(s),n.PlateTagID.size>0))for(var\x20o\x20of\x20n.PlateTagID)a.has(o)?a.get(o).push(n.Symbol):a.set(o,new\x20Array(n.Symbol))}return\x20a}}function\x20SearchStock(t){this.SearchStockApiUrl=g_JSStockResource.Domain+\x22/API/StockSpell\x22,this.UpdateUICallback=t,this.PageSize=50,this.Count,this.EndOffset,this.Data=new\x20Array,this.SearchString=\x22\x22,this.SearchType=0,this.Search=function(t,e){if(this.SearchString==t&&this.SearchType==e)\x22function\x22==typeof\x20this.UpdateUICallback&&this.UpdateUICallback(this);else{this.SearchString=t,this.SearchType=e,this.Count=0,this.EndOffset=0,this.Data=[];var\x20a=this.PageSize-1;this.ReqeustSearchStock(this.SearchString,this.SearchType,this.EndOffset,a)}},this.IsEndPage=function(){return\x20this.Count<=0||this.EndOffset>this.Count-1},this.NextPage=function(){if(!(this.EndOffset+1>this.Count)){var\x20t=this.EndOffset+this.PageSize;this.ReqeustSearchStock(this.SearchString,this.SearchType,this.EndOffset,t)}},this.ReqeustSearchStock=function(t,e,a,i){var\x20s=this;$.ajax({url:this.SearchStockApiUrl,data:{input:t,start:a,end:i,type:e},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){s.RecvSearchStockData(t,RECV_DATA_TYPE.SEARCH_STOCK_DATA)},error:function(t){s.RecvError(t,RECV_DATA_TYPE.SEARCH_STOCK_DATA)}})},this.RecvSearchStockData=function(t){for(var\x20e\x20in\x20t.stock){var\x20a=t.stock[e];this.Data.push({Name:a.name,Symbol:a.symbol,Type:a.type})}0==t.count?(this.Count=0,this.EndOffset=0):(0==this.Count&&(this.Count=t.count),this.EndOffset=t.end,this.Count>0&&this.EndOffset>this.Count&&(this.EndOffset=this.Count-1)),\x22function\x22==typeof\x20this.UpdateUICallback&&this.UpdateUICallback(this)},this.RecvError=function(t,e){console.log(\x22[SearchStock::RecvError]\x20datatype=\x22+e.toString()),console.log(t),\x22function\x22==typeof\x20this.UpdateUICallback&&this.UpdateUICallback(this,\x22error\x22)}}function\x20IStockData(){this.IsAutoUpdate=!0,this.AutoUpateTimeout=5e3,this.Timeout,this.ApiUrl,this.Data,this.Error,this.UpdateUICallback,this.RequestData=function(){},this.Stop=function(){this.IsAutoUpdate=!1,this.Timeout&&clearTimeout(this.Timeout)},this.AutoUpate=function(){if(this.Timeout&&clearTimeout(this.Timeout),this.IsAutoUpdate&&(this.Timeout&&clearTimeout(this.Timeout),this.IsAutoUpdate)){var\x20t=this;if(this.Symbol){var\x20e=STOCK_MARKET.GetMarketStatus(this.Symbol);2==e?this.Timeout=setTimeout(function(){t.RequestData()},this.AutoUpateTimeout):1==e&&(this.Timeout=setTimeout(function(){t.AutoUpdate()},this.AutoUpateTimeout))}else{t=this;let\x20e=new\x20Date;e.getHours(),e.getMinutes();this.Timeout=setTimeout(function(){t.RequestData()},this.AutoUpateTimeout)}}},this.InvokeUpdateUICallback=function(){this.UpdateUICallback&&this.UpdateUICallback(this)}}function\x20ShortTerm(t){this.newMethod=IStockData,this.newMethod(),delete\x20this.newMethod,this.Symbol=t,this.ApiUrl=g_JSStockResource.Domain+\x22/API/StockShortTerm\x22,this.Count=20,this.RequestData=function(){var\x20t=this;let\x20e={count:this.Count};this.Symbol&&(e.symbol=this.Symbol),$.ajax({url:this.ApiUrl,data:e,type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){t.RecvData(e,RECV_DATA_TYPE.SHORT_TERM_DATA)},fail:function(e){t.RecvError(e,RECV_DATA_TYPE.SHORT_TERM_DATA)}})},this.RecvData=function(t,e){this.Data=[];for(let\x20e\x20in\x20t.shortterm){let\x20a=t.shortterm[e];this.Data.push({Date:a.date,Name:a.name,Symbol:a.symbol,Time:a.time,Content:a.content,TypeInfo:a.typeinfo,Type:a.type})}this.UpdateUICallback&&this.UpdateUICallback(this),this.AutoUpate()},this.RecvError=function(t,e){}}function\x20DealDay(t){this.newMethod=IStockData,this.newMethod(),delete\x20this.newMethod,this.Symbol=t,this.Date,this.RequestData=function(){this.Data=null,this.Error=null;var\x20t=this,e=g_JSStockResource.CacheDomain+\x22/cache/dealday/day/\x22+this.Date+\x22/\x22+this.Symbol+\x22.json\x22;console.log(\x22[DealDay::RequestData]\x20cache\x20url\x20\x22,e),$.ajax({url:e,type:\x22get\x22,dataType:\x22json\x22,async:!0,success:function(e){t.RecvData(e,RECV_DATA_TYPE.DEAL_DAY_DATA)},error:function(e){t.RecvError(e,RECV_DATA_TYPE.DEAL_DAY_DATA)}})},this.RecvData=function(t,e){if(t.day&&t.deal){var\x20a=t.deal.amount,i=t.deal.price,s=t.deal.time,n=t.deal.vol,o=t.deal.flag;if(o&&n&&s&&i&&a){var\x20r={Date:t.date,Open:t.day.open,Close:t.day.price,YClose:t.day.yclose,Symbol:t.symbol,Name:t.name,Deal:[],PriceList:[]},D=new\x20Map,h=0,l=Math.min(s.length,n.length,o.length,i.length,a.length);for(let\x20t=0;t<l;++t){let\x20e={Time:s[t],Vol:n[t],Flag:\x22\x22,Price:i[t],Amount:a[t]};var\x20c;0===o[t]?e.Flag=\x22B\x22:1===o[t]&&(e.Flag=\x22S\x22),e.Time>15e4&&(e.Time=15e4),r.Deal.push(e),D.has(e.Price)?(c=D.get(e.Price)).Vol+=e.Vol:(c={Vol:e.Vol,Price:e.Price,BuyVol:0,SellVol:0,NoneVol:0},D.set(e.Price,c)),0===o[t]?c.BuyVol+=e.Vol:1===o[t]?c.SellVol+=e.Vol:c.NoneVol+=e.Vol,h+=e.Vol}for(var\x20A\x20of\x20D){var\x20E=A[1];h>0&&(E.Proportion=E.Vol/h),r.PriceList.push(E)}r.PriceList.sort(function(t,e){return\x20e.Price-t.Price}),this.Data=r,this.InvokeUpdateUICallback()}else\x20this.InvokeUpdateUICallback()}else\x20this.InvokeUpdateUICallback()},this.RecvError=function(t,e){console.log(`[DealDay::RecvError]\x20status=${t.status}\x20statusText=${t.statusText}\x20responseText=${t.responseText}`),this.Error={Status:t.status,Message:t.responseText},this.InvokeUpdateUICallback()}}function\x20BlockMember(t){this.newMethod=IStockData,this.newMethod(),delete\x20this.newMethod,this.ApiUrl=g_JSStockResource.Domain+\x22/API/StockBlockMember\x22,this.PageSize=10,this.Start=0,this.OrderField,this.Order,this.Symbol=t,this.OrderNull=0,this.Field=new\x20Array,this.Data=new\x20Array,this.PageInfo,this.SetField=function(t){this.Field=new\x20Array;for(let\x20e\x20in\x20t){let\x20a=t[e],i=StockDataFieldName.GetFieldName(a);null!=i&&this.Field.push(i)}return\x20this.Field.length>0},this.SetOrder=function(t,e){this.Order=null,this.OrderField=null;let\x20a=StockDataFieldName.GetFieldName(t);return\x20null!=a&&(this.OrderField=a,this.Order=e,!0)},this.RequestData=function(){this.Data=[];var\x20t=this;$.ajax({url:this.ApiUrl,data:{symbol:this.Symbol,field:this.Field,order:this.Order,orderfield:this.OrderField,start:this.Start,end:this.Start+this.PageSize,ordernull:this.OrderNull},type:\x22post\x22,dataType:\x22json\x22,success:function(e){t.RecvData(e,RECV_DATA_TYPE.BLOCK_MEMBER_DATA)},error:function(e){t.RecvError(e,RECV_DATA_TYPE.BLOCK_MEMBER_DATA)}})},this.RecvData=function(t,e){for(let\x20e\x20in\x20t.stock){let\x20i=t.stock[e];if(null!=i.symbol){var\x20a=new\x20StockData(i.symbol);a.SetData(i),this.Data.push(a)}}this.PageInfo={Count:t.count,Start:t.start,End:t.end},\x22function\x22==typeof\x20this.UpdateUICallback&&this.UpdateUICallback(this),this.AutoUpate()},this.RecvError=function(t,e){}}function\x20BlockTop(){this.newMethod=IStockData,this.newMethod(),delete\x20this.newMethod,this.BlockType=1,this.Count=20,this.OrderField=\x22increase\x22,this.Order=-1,this.Field=[\x22symbol\x22,\x22price\x22,\x22name\x22,\x22vol\x22,\x22increase\x22,\x22indextop\x22,\x22risefall\x22],this.ApiUrl=g_JSStockResource.Domain+\x22/API/StockBlockTop\x22,this.SetField=function(t){},this.ReqeustData=function(){var\x20t=this;$.ajax({url:this.ApiUrl,data:{blocktype:this.BlockType,start:0,end:this.Count,field:this.Field,orderfield:this.OrderField,order:this.Order},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){t.RecvData(e,RECV_DATA_TYPE.BLOCK_TOP_DATA)},fail:function(e){t.RecvError(e,RECV_DATA_TYPE.BLOCK_TOP_DATA)}})},this.RecvData=function(t,e){let\x20a=t;this.Data=[],this.resCount=a.count;for(let\x20t\x20in\x20a.stock){let\x20e=a.stock[t];if(null!=e.indextop)var\x20i={Down:e.indextop.down,Stop:e.indextop.stop,Up:e.indextop.up,Unchanged:e.indextop.unchanged,DownStock:{Name:e.indextop.downstock.name,Symbol:e.indextop.downstock.symbol},UpStock:{Name:e.indextop.upstock.name,Symbol:e.indextop.upstock.symbol}};this.Data.push({Name:e.name,Symbol:e.symbol,Increase:e.increase,Risefall:e.risefall,IndexTop:i})}this.UpdateUICallback&&this.UpdateUICallback(this),this.AutoUpate()},this.RecvError=function(t,e){}}function\x20MinuteImage(t){this.newMethod=IStockData,this.newMethod(),delete\x20this.newMethod,this.ApiUrl=g_JSStockResource.Domain+\x22/API/StockMinuteImage\x22,this.Symbol=[t],this.Data=[],this.RequestData=function(){this.Data=[];var\x20t=this;$.ajax({url:this.ApiUrl,data:{symbol:this.Symbol},type:\x22post\x22,dataType:\x22json\x22,success:function(e){t.RecvData(e,RECV_DATA_TYPE.IMAGE_MINUTE_DATA)},error:function(e){t.RecvError(e,RECV_DATA_TYPE.IMAGE_MINUTE_DATA)}})},this.RecvData=function(t,e){for(let\x20e\x20in\x20t.symbol){let\x20a={Symbol:t.symbol[e],Image:t.imagerelative[e]};this.Data.push(a)}\x22function\x22==typeof\x20this.UpdateUICallback&&this.UpdateUICallback(this)},this.RecvError=function(t,e){}}function\x20HistoryDayData(t){this.newMethod=IStockData,this.newMethod(),delete\x20this.newMethod,this.Symbol=t,this.RequestData=function(){this.Data=null,this.Error=null;var\x20t=this,e=g_JSStockResource.CacheDomain+\x22/cache/historyday/all/\x22+this.Symbol+\x22.json\x22;console.log(\x22[HistoryDayData::RequestData]\x20cache\x20url\x20\x22,e),$.ajax({url:e,type:\x22get\x22,dataType:\x22json\x22,async:!0,success:function(e){t.RecvData(e,RECV_DATA_TYPE.HISTORY_DAY_DATA)},error:function(e){t.RecvError(e,RECV_DATA_TYPE.HISTORY_DAY_DATA)}})},this.RecvData=function(t,e){if(t.symbol&&t.name){var\x20a=t.amount,i=t.close,s=t.date,n=t.high,o=t.low,r=t.open,D=t.vol,h=t.yclose;if(a&&i&&s&&n&&o&&r&&D&&h){var\x20l={UpdateDate:t.update,Symbol:t.symbol,Name:t.name,KLine:[]};for(let\x20t=0;t<s.length;++t){let\x20e={Date:s[t],YClose:h[t],Open:r[t],High:n[t],Low:o[t],Close:i[t],Vol:D[t],Amount:a[t]};l.KLine.push(e)}this.Data=l,this.InvokeUpdateUICallback()}else\x20this.InvokeUpdateUICallback()}else\x20this.InvokeUpdateUICallback()},this.RecvError=function(t,e){console.log(`[HistoryDayData::RecvError]\x20status=${t.status}\x20statusText=${t.statusText}\x20responseText=${t.responseText}`),this.Error={Status:t.status,Message:t.responseText},this.InvokeUpdateUICallback()},this.GetWeekData=function(){return\x20this.Data&&this.Data.KLine?this.GetDayPeriodData(1):[]},this.GetMonthData=function(){return\x20this.Data&&this.Data.KLine?this.GetDayPeriodData(2):[]},this.GetDayPeriodData=function(t){var\x20e=new\x20Array,a=0,i=null;for(var\x20s\x20in\x20this.Data.KLine){var\x20n=!1,o=this.Data.KLine[s];switch(t){case\x201:var\x20r=this.GetFirday(o.Date);r!=a&&(n=!0,a=r);break;case\x202:parseInt(o.Date/100)!=parseInt(a/100)&&(n=!0,a=o.Date);break;case\x203:parseInt(o.Date/1e4)!=parseInt(a/1e4)&&(n=!0,a=o.Date)}if(n){if((i={}).Date=o.Date,e.push(i),null==o.Open||null==o.Close)continue;i.Open=o.Open,i.High=o.High,i.Low=o.Low,i.YClose=o.YClose,i.Close=o.Close,i.Vol=o.Vol,i.Amount=o.Amount}else{if(null==i)continue;if(null==o.Open||null==o.Close)continue;null==i.Open||null==i.Close?(i.Open=o.Open,i.High=o.High,i.Low=o.Low,i.YClose=o.YClose,i.Close=o.Close,i.Vol=o.Vol,i.Amount=o.Amount):(i.High<o.High&&(i.High=o.High),i.Low>o.Low&&(i.Low=o.Low),i.Close=o.Close,i.Vol+=o.Vol,i.Amount+=o.Amount,i.Date=o.Date)}}return\x20e},this.GetFirday=function(t){var\x20e=new\x20Date(parseInt(t/1e4),t/100%100-1,t%100),a=e.getDay();if(5==a)return\x20t;var\x20i=e.getTime();a<5?i+=864e5*(5-a):i-=864e5*(a-5);e.setTime(i);var\x20s=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();e.getDay();return\x20s}}function\x20DealPriceListData(t){this.newMethod=IStockData,this.newMethod(),delete\x20this.newMethod,this.Symbol=t,this.ApiUrl=g_JSStockResource.Domain+\x22/API/StockPriceList\x22,this.RequestData=function(){if(this.Symbol){var\x20t=this,e={};Array.isArray(this.Symbol)?e.Symbol=this.Symbol:e.Symbol=[this.Symbol],$.ajax({url:this.ApiUrl,data:e,type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){t.RecvData(e,RECV_DATA_TYPE.DEAL_PRICE_LIST_DATA)},fail:function(e){t.RecvError(e,RECV_DATA_TYPE.DEAL_PRICE_LIST_DATA)}})}},this.RecvData=function(t,e){if(this.Data=null,!(t.statistics.length<=0)){this.Data={Day:{},PriceList:[]};var\x20a=t.data[0];this.Data.Day={Date:a.date,YClose:a.yclose,Price:a.price,Vol:a.vol,Time:a.time},this.Data.Stock={Symbol:a.symbol,Name:a.name};var\x20i=t.statistics[0];for(var\x20s\x20in\x20i.list){var\x20n=i.list[s],o={Price:n[0],Vol:n[1],BuyVol:n[2],SellVol:n[3],NoneVol:n[4]};a.vol>0&&(o.Proportion=o.Vol/a.vol),this.Data.PriceList.push(o)}this.UpdateUICallback&&this.UpdateUICallback(this),this.AutoUpate()}},this.RecvError=function(t,e){}}function\x20LatestDetailData(t){this.newMethod=IStockData,this.newMethod(),delete\x20this.newMethod,this.IsAutoUpdate=!1,this.Symbol=t,this.PageSize=20,this.Request=function(t,e){this.Error=null;var\x20a=this,i=t*e,s=i+e,n=g_JSStockResource.Domain+\x22/API/StockDetail\x22;console.log(`[LatestDetailData::RequestData]\x20url=${n},\x20start=${i}\x20,\x20end=${s}`),$.ajax({url:n,data:{symbol:this.Symbol,start:i,end:s},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(t){a.RecvData(t,RECV_DATA_TYPE.LATEST_DETAIL_DATA)},error:function(t){a.RecvError(t,RECV_DATA_TYPE.LATEST_DETAIL_DATA)}})},this.RequestData=function(){this.Data={Deal:[],Count:0,Reqeust:{PageIndex:0},Response:{}},this.Request(0,this.PageSize)},this.RequestPage=function(t){this.Data||(this.Data={Deal:[],Count:0}),this.Data.Reqeust={PageIndex:t},this.Data.Response={};for(var\x20e=t*this.PageSize,a=e+this.PageSize,i=!0,s=e;s<a;++s)if(!this.Data.Deal[s]){i=!1;break}i?(this.Data.Response={Start:e,End:a},this.InvokeUpdateUICallback()):this.Request(t,this.PageSize)},this.RecvData=function(t,e){if(this.Data.Count=t.count,t.detail){this.Data.Day={YClose:t.yclose,Open:t.open,Close:t.price,Date:t.date},this.Data.Stock={Symbol:t.symbol,Name:t.name};for(var\x20a=0,i=t.start;a<t.detail.length;++a,++i){var\x20s=t.detail[a],n={Time:s[0],Price:s[1],Vol:s[2],Amount:s[3],Flag:\x22\x22};0===s[4]?n.Flag=\x22B\x22:1===s[4]&&(n.Flag=\x22S\x22),this.Data.Deal[i]=n}this.Data.Response={Start:t.start,End:t.end},this.InvokeUpdateUICallback()}else\x20this.InvokeUpdateUICallback()},this.RecvError=function(t,e){console.log(`[LatestDetailData::RecvError]\x20status=${t.status}\x20statusText=${t.statusText}\x20responseText=${t.responseText}`),this.Error={Status:t.status,Message:t.responseText},this.InvokeUpdateUICallback()}}function\x20AnalylisPlate(){this.newMethod=IStockData,this.newMethod(),delete\x20this.newMethod,this.ApiUrl=g_JSStockResource.Domain+\x22/api/StockListAnalyze\x22,this.PolicyGuid,this.Plate=\x22\x22,this.SymbolList=[],this.RequestData=function(){var\x20t=this;$.ajax({url:t.ApiUrl,data:{PolicyGuid:t.PolicyGuid,Plate:t.Plate,Symbol:t.SymbolList},type:\x22post\x22,dataType:\x22json\x22,async:!0,success:function(e){t.RecvData(e)},error:function(e){t.RecvError(e)}})},this.RecvData=function(t){this.Data={};var\x20e=t;if(0!=e.count){if(e.concept){var\x20a=[];for(var\x20i\x20in\x20e.concept.data){var\x20s=e.concept.data[i],n={};n.Name=s[0],n.Symbol=s[1],n.Ratio=s[2],n.Count=s[3],n.Increase=s[4],n.Price=s[5],n.Week1=s[6],n.Week4=s[7],a.push(n)}this.Data.Concept=a}e.distributed&&(this.Data.Distributed=e.distributed),e.industry&&(this.Data.Industry=e.industry),e.quadrant&&(this.Data.Quadrant=e.quadrant),e.region&&(this.Data.Region=e.region),this.UpdateUICallback&&this.UpdateUICallback(this)}},this.RecvError=function(t){console.log(t)}}var\x20STOCK_MARKET={SH:\x22.SH\x22,SZ:\x22.SZ\x22,HK:\x22.HK\x22,SHFE:\x22.SHF\x22,CFFEX:\x22.CFE\x22,DCE:\x22.DCE\x22,CZCE:\x22.CZC\x22,USA:\x22.USA\x22,IsUSA:function(t){return!!t&&t.indexOf(this.USA)>0},IsSH:function(t){var\x20e=t.length-this.SH.length;return\x20t.indexOf(this.SH)==e},IsSZ:function(t){var\x20e=t.length-this.SZ.length;return\x20t.indexOf(this.SZ)==e},IsHK:function(t){var\x20e=t.length-this.HK.length;return\x20t.indexOf(this.HK)==e},IsSHFE:function(t){return\x20t.indexOf(this.SHFE)>0},IsCFFEX:function(t){return\x20t.indexOf(this.CFFEX)>0},IsDCE:function(t){return\x20t.indexOf(this.DCE)>0},IsCZCE:function(t){return\x20t.indexOf(this.CZCE)>0},IsChinaFutures:function(t){return\x20this.IsCFFEX(t)||this.IsCZCE(t)||this.IsDCE(t)||this.IsSHFE(t)},IsSHSZ:function(t){return\x20this.IsSZ(t)||this.IsSH(t)},IsSHSZFund:function(t){if(!t)return!1;if(this.IsSH(t)){if(\x225\x22==t.charAt(0)&&\x221\x22==t.charAt(1))return!0}else\x20if(this.IsSZ(t)&&\x221\x22==t.charAt(0)&&(\x225\x22==t.charAt(1)||\x226\x22==t.charAt(1)||\x227\x22==t.charAt(1)||\x228\x22==t.charAt(1)))return!0;return!1},IsSHSZIndex:function(t){if(!t)return!1;var\x20e=t.toUpperCase();if(this.IsSH(e)){var\x20a=e.replace(\x22.SH\x22,\x22\x22);if(\x220\x22==e.charAt(0)&&parseInt(a)<=3e3)return!0}else\x20if(this.IsSZ(e)){if(\x223\x22==e.charAt(0)&&\x229\x22==e.charAt(1))return!0}else\x20if(e.indexOf(\x22.CI\x22)>0)return!0;return!1},IsSHSZStockA:function(t){if(!t)return!1;var\x20e=t.toUpperCase();if(this.IsSH(e)){e.replace(\x22.SH\x22,\x22\x22);if(\x226\x22==e.charAt(0))return!0}else\x20if(this.IsSZ(e)&&\x220\x22==e.charAt(0)){if(\x220\x22==e.charAt(1)&&\x222\x22==e.charAt(1))return!0;if(\x227\x22!=e.charAt(1)&&\x228\x22!=e.charAt(1))return!0}return!1},IsSHStockSTAR:function(t){if(!t)return!1;var\x20e=t.toUpperCase();return!!this.IsSH(e)&&(\x226\x22==e.charAt(0)&&\x228\x22==e.charAt(1)&&\x228\x22==e.charAt(2))},GetMarketStatus:function(t){if(!t)return\x200;var\x20e=t.toUpperCase();if(this.IsUSA(e)){var\x20a=GetLocalTime(-4);return\x20s=a.getDay(),n=100*a.getHours()+a.getMinutes(),6==s||0==s?0:n>1730?3:n<930?1:2}var\x20i=new\x20Date,s=i.getDay(),n=100*i.getHours()+i.getMinutes();return\x206==s||0==s?0:n>1540?3:n<925?1:2}};';eval(_code);